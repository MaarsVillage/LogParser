# LogParser
Repository for LogParser scripts and other goodies

echo %Date% !Time! [MSG] : Last Updated: 2025-02-01 11:32 AM
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
╔════════════════════════════════════════════════════════════════════════════════════════════════╗
║   Microsoft LogParser 2.2 Toolkit on Steroids Including Lizard Labs LPL                        ║
║   This document is UTF-8 and "Always a work in progress"                                       ║
║     What Mother Never Told You About Log Parsing Commands and Beyond                           ║
║         List All Provider Log file names: Similar to: wevtutil el (See html example)           ║
║  NOTE: There May be Many URL references that are no longer maintained and have gone. Sorry!    ║
║  NOTE: There May be Many duplicate LogParser examples due to grouping similar examples         ║
║  NOTE: LogParser does not support nested SELECT statements                                     ║
║  NOTE: LogParser commands prefixed with   ::# "prefixin requires fixing."                      ║
║  Grant Access to Windows Event folders:                                                        ║
║  icacls "C:\Windows\System32\winevt\Logs" /grant %username%:F                                  ║
║  takeown /f "C:\Windows\System32\winevt\Logs" /r /d y                                          ║
║  Desktop : https://github.com/apps/desktop                                                     ║
║  Download: https://central.github.com/deployments/desktop/desktop/latest/win32                 ║
╚════════════════════════════════════════════════════════════════════════════════════════════════╝
┌───────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  START "AboutMe_LogParser" /D "%OneDrive%\" /NORMAL Notepad++.exe "%OneDrive%\AboutMe_LogParser.txt"  │
└───────────────────────────────────────────────────────────────────────────────────────────────────────┘
:: Folder: Dir "C:\Program Files (x86)\Log Parser 2.2\LogParser"
:: Download ready to use scripts from Microsoft Log Parser Toolkit : A Complete Toolkit for Microsoft's Undocumented Log Analysis Tool 1st Edition - February 10, 2005 - eBook ISBN: 9780080489391  :: Authors: Gabriele Giuseppini, Mark Burnett
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
┌────────────────────────────────────────────────────────────┐
│ LogParser Install .msi and Chart associated apps           │
└────────────────────────────────────────────────────────────┘
:: Error: Task completed with errors. Unexpected internal error calling chart object method ExportPicture:   Exception occurred.
:: RE: Charts: If not installed properly, ERROR:  Unexpected internal error calling chart object method ExportPicture: - Re-Install owc10/owc11
msiexec.exe /i "%OneDrive%\Log Parser 2.2\Log Parser 2.2_InstallPackage\LogParser-V2.2.10.msi" /NoRestart /L*V "%ohtm%\%ComputerName%_Install_LP22.log"
Start "SW-Installation" /D %tmp% /I /Min /High /Wait "%OneDrive%\Log Parser 2.2\Log Parser 2.2_InstallPackage\owc11.exe"
Start "SW-Installation" /D %tmp% /I /Min /High /Wait "%OneDrive%\Log Parser 2.2\Log Parser 2.2_InstallPackage\MSChart.exe"
::file:*_20240813_135523609-MSI_DataVisualization_SetupCore.msi.txt
Dir /S /B "%UserProfile%\AppData\Local\Temp\Microsoft*" | Find /I "SetupCore.msi.txt"
NotePad++ "%UserProfile%\AppData\Local\Temp\Microsoft Chart Controls for Microsoft .NET Framework 3.5_20240813_135523609-MSI_DataVisualization_SetupCore.msi.txt"
:: Test LogParser Native command where Output will prove successful installation...
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT PATH, NAME, SIZE FROM 'C:\Program Files (x86)\Log Parser 2.2\*.*'"
:: SET an Alias for LogParser
:: NOTE: You need Microsoft Visual Basic SP6 (KB3096896) installed with MSVB 6.0 Installed
:: May need additional MSCOMCTL.OCX - Once downloaded, open the MSI package using the freeware 7-Zip utility. Extract/copy the module MSCOMCTL.OCX and save it to the Windows\System32 or Windows\SysWOW64 folder. Then register the module using RegSvr32.exe command-line : regsvr32 C:\Windows\SysWOW64\MSCOMCTL.OCX
:: Download: Microsoft Visual Basic 6.0 Service Pack 6 Security Rollup Update: https://www.microsoft.com/en-us/download/details.aspx?id=50722
Start "Install-msi" /High /WAIT /B "C:\$Data\OneDrive\Log Parser 2.2\Log Parser 2.2_InstallPackage\VB60SP6-KB3096896-x86-ENU.msi"&&echo %Date% !Time! [RC !ErrorLevel!] Installing .MSI file.
:: See Registering all .ocx files below:
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: SEE: Formatting, Reporting, and Charting • Chapter 10 Page 329
:: EXAMPLES using MSChart Control and MSChart Add-On For VS 2008
:: Within the Microsoft Office Web Components Object Model: Chart and ChartSpace. Both of these are documented on the MSDN Developer’s area of the Microsoft website, and will allow you to customize almost every aspect of your charts. For example, the following script will modify the title, the font size used in the title, as well as the color scheme used by a chart.
:: More on: Chart and ChartSpace documented n MSDN Developer for Microsoft Chart Controls for Microsoft .NET Framework
:: 1) Chart Class Documentation: Chart Class (System.Windows.Forms.DataVisualization.Charting: https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.datavisualization.charting.chart?view=netframework-4.8.1&form=MG0AV3
:: 2) Getting Started Guide: Getting Started With Microsoft Chart Control for .NET Framework 3.5: https://www.codeguru.com/csharp/getting-started-with-microsoft-chart-control-for-net-framework-3-5/?form=MG0AV3
:: .vbs Examples using Microsoft Chart Control for .NET Framework 3.5 using Microsoft Office Web Components Object Model: Chart and ChartSpace
:: Microsoft Chart Control for .NET Framework 3.5 with VB.NET:
:: CodeProject - A Guide to using MSChart for .NET: This guide covers the use of MSChart Control in a typical business application, including Pyramid, Pie, and Column Graphs: https://www.codeproject.com/Articles/65803/A-Guide-to-using-MSChart-for-NET?form=MG0AV3
:: . You can find it here: .CodeGuru - Getting Started With Microsoft Chart Control for .NET Framework 3.5: This article provides a comprehensive introduction to the Chart Control, focusing on ASP.NET capabilities but also applicable to WinForm applications:
:: . Check it out here: https://www.codeguru.com/csharp/getting-started-with-microsoft-chart-control-for-net-framework-3-5/?form=MG0AV3
:: .GitHub - geomatics-io/Samples-Environments-for-Microsoft-Chart-Controls: This repository contains sample environments and code for the Microsoft Chart Controls for .NET Framework 3.5: https://github.com/geomatics-io/Samples-Environments-for-Microsoft-Chart-Controls?form=MG0AV3
:: . ASP.NET: https://asp.net/?form=MG0AV3
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
┌────────────────────────────────────────────────────────────┐
│ LogParser References - Some URL's may no longer be active  │
└────────────────────────────────────────────────────────────┘
:: Download LogParser :
http://www.microsoft.com/downloads/en/details.aspx?FamilyID=890cd06b-abf8-4c25-91b2-f8d975cf8c07&displaylang=en
:: Download Office 2003 Add-in Office Web Components: Microsoft Office Web Components 9.0, Microsoft Office XP Web Components, or Microsoft Office Web Components 11.0
https://www.microsoft.com/en-us/download/details.aspx?id=14422
:: https://microsoft-office-web-components.updatestar.com/en
:: https://download.cnet.com/Office-2003-Add-in-Office-Web-Components/3000-2070_4-10742090.html
:: https://support.microsoft.com/en-us/topic/how-to-find-office-web-components-owc-programming-documentation-and-samples-70f98573-cf2c-755a-9b13-747d4ec6e693
https://documentation.help/Log-Parser/
https://learn.microsoft.com/en-us/previous-versions/office/developer/office-xp/aa155751(v=office.10)?redirectedfrom=MSDN
https://www.amazon.com/Microsoft-Log-Parser-Toolkit-Undocumented/dp/1932266526
https://LogParserplus.com/functions/
https://LogParserplus.com/examples/
https://conetrix.com/blog/microsoft-log-parser-beginners-guide
Related Links
Home Page (http://www.iis.net/community/default.aspx?tabid=34&g=6&i=1976)
Log Parser 2.2 Documentation (http://www.iis.net/community/default.aspx?tabid=34&g=6&i=1976)
Download (http://www.microsoft.com/downloads/en/details.aspx?FamilyID=890cd06b-abf8-4c25-91b2-f8d975cf8c07&displaylang=en)
TechNet Article (http://technet.microsoft.com/en-us/library/ee692937.aspx)
Other examples of IIS log queries (http://blogs.iis.net/carlosag/archive/2010/03/25/analyze-your-iis-log-Files-favorite-log-parser-queries.aspx)
Log Parser Forums (http://forums.iis.net/default.aspx?GroupID=51)
Graphing Ping Results (http://www.adopenstatic.com/cs/blogs/ken/archive/2005/05/30/22.aspx)
Query Windows Event Log (http://oreilly.com/pub/a/windows/2005/07/12/LogParser.html)
:: Book: Microsoft Log Parser Toolkit: A complete toolkit for Microsoft's undocumented log analysis tool (ISBN: 1932266526 / 1-932266-52-6)
::	by (Authors) Gabriele Giuseppini, Mark Burnett, Jeremy Faircloth, Dave Kleiman
https://www.oreilly.com/library/view/microsoft-log-parser/1932266526/
https://vdoc.pub/download/microsoft-log-parser-toolkit-1f2sk9e1h9v0      <-- Download the Book
:: Save Book Examples located in: dir /s "%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\ch*.*"
echo Open LogParser Toolkit&START CHROME "C:\inetpub\wwwroot\LogParser 2.2\microsoft-log-parser-toolkit.pdf"
echo Open LogParser Toolkit&START CHROME "file:///C:/$Data/OneDrive/Desktop/Tools/$Manuals/LogParserV2.2-Toolkit.pdf"
echo Open Security Log Management&START CHROME "file:///C:/$Data/OneDrive/Desktop/Tools/$Manuals/Security-log-management-identifying-patterns-in-the-chaos.pdf"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Security auditing:
https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/security-auditing-overview
:: Security monitoring recommendations for many audit events.
https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/appendix-a-security-monitoring-recommendations-for-many-audit-events
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +---------------------------------------------------------------------------+
:: | LogParser Related References                                              |
:: | LogParser WEB reference Examples of IIS log queries                       |
:: +---------------------------------------------------------------------------+
Log Parser 2.2 Documentation: http://www.iis.net/community/default.aspx?tabid=34&g=6&i=1976
Log Parser Forums           : https://learn.microsoft.com/en-us/search/?terms=iis%20and%20LogParser
Examples of IIS log queries : http://blogs.iis.net/carlosag/archive/2010/03/25/analyze-your-iis-log-Files-favorite-log-parser-queries.aspx
Log Parser Lizard           : https://www.lizard-labs.com/log_parser_lizard_download.aspx
IIS                         : https://forums.iis.net/1140.aspx/1?General+Discussion
IIS                         : https://www.iis.net/downloads/community/2010/04/log-parser-22
IIS                         : https://aggressivevirusdefense.wordpress.com/2010/04/23/log-parser/
IIS                         : https://leastprivilege.com/2004/06/26/fun-with-LogParser /
IIS                         : https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=3fe87d70-07ad-4cee-811f-ce4f8b8429ae&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments
Security Log Management: Identifying Patterns in the Chaos 1st Edition Author Jacob Babbin
https://vdoc.pub/documents/security-log-management-identifying-patterns-in-the-chaos-1b8vs4i42reg
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Microsoft Office XP Web Component Toolpack
http://msdn.microsoft.com/en-us/library/aa155751.aspx
https://learn.microsoft.com/en-us/previous-versions/office/developer/office-xp/aa155751(v=office.10)?redirectedfrom=MSDN
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +---------------------------------------------------------------------------+
:: | Create your own Eventid                                                   |
:: +---------------------------------------------------------------------------+
Advanced security auditing FAQ: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/advanced-security-auditing-faq
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +---------------------------------------------------------------------------+
:: | PowerShell to list the event IDs associated with each log file            |
:: +---------------------------------------------------------------------------+
Get-WinEvent -ListProvider * -ErrorAction SilentlyContinue | Select-Object Name, ID, Description  | Out-GridView
| Format-Table -Property Name, ID, Description
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +---------------------------------------------------------------------------+
:: | Create your own Eventid                                                   |
:: +---------------------------------------------------------------------------+
eventcreate /l Application /so %~n0 /T information /id 2024 /d "%Date% !Time! %~n0"
eventcreate /l Application /so LogParser /T information /id 101 /d "%Date% !Time! LogParser"
:: SUCCESS: An event of type 'information' was created in the 'Application' log with 'LogParser ' as the source.
eventcreate /l Application /so "LogParser Lizard" /T information /id 102 /d "%Date% !Time! LogParser Lizard"
:: SUCCESS: An event of type 'information' was created in the 'Application' log with 'LogParser Lizard' as the source.
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Don't try this from home kids: "Select whole from woman where tool = large and when tool is done extract tool order by now" ugghhh That's disgusting...
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│  Allow LogParser and DotNet35 through Firewall    │
└───────────────────────────────────────────────────┘
:: LogParser Firewall
Netsh Advfirewall Firewall ADD Rule Name="Village Allow App LogParser p In" Dir=IN action=allow program="C:\Program Files (x86)\Log Parser 2.2\LogParser" Enable=yes&echo RC=%ErrorLevel%
Netsh Advfirewall Firewall ADD Rule Name="Village Allow App LogParser p Out" Dir=Out action=allow program="C:\Program Files (x86)\Log Parser 2.2\LogParser" Enable=yes&echo RC=%ErrorLevel%
:: dotnetfx35.exe Firewall
Netsh Advfirewall Firewall ADD Rule Name="Village Allow App DotNet35 p In" Dir=IN action=allow program="C:\$Software\$Microsoft\Microsoft .NET Framework 3.5 Service pack 1 (Full Package)\dotnetfx35.exe" Enable=yes&echo RC=%ErrorLevel%
Netsh Advfirewall Firewall ADD Rule Name="Village Allow App DotNet35 p Out" Dir=Out action=allow program="C:\$Software\$Microsoft\Microsoft .NET Framework 3.5 Service pack 1 (Full Package)\dotnetfx35.exe" Enable=yes&echo RC=%ErrorLevel%
:: Office 2003 Add-in Firewall
Netsh Advfirewall Firewall ADD Rule Name="Village Allow App Office 2003 Add-in p In" Dir=IN action=allow program="C:\$Software\$Microsoft\Microsoft Office Professional Plus 2016 x64\MSChart\owc11.exe" Enable=yes&echo RC=%ErrorLevel%
Netsh Advfirewall Firewall ADD Rule Name="Village Allow App Office 2003 Add-in p Out" Dir=Out action=allow program="C:\$Software\$Microsoft\Microsoft Office Professional Plus 2016 x64\MSChart\owc11.exe" Enable=yes&echo RC=%ErrorLevel%
┌───────────────────────────────────────────────────┐
│    Install LogParser 2.2 and supporting Apps      │
└───────────────────────────────────────────────────┘
echo %Date% !Time! ------------------------------------------------------------------------------------------------
SET "PATH=%PATH%;C:\Program Files\Notepad++";"C:\Program Files (x86)\Log Parser 2.2";"C:\SysInternalsSuite"
:: ALso Run: Rundll32.exe sysdm.cpl,EditEnvironmentVariables - and check/add paths as necessary
::SET "PATH=C:\WINDOWS\System32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\WINDOWS\System32\OpenSSH\;C:\Program Files\dotnet\;C:\Program Files\PowerShell\7\;C:\ProgramData\chocolatey\bin;C:\Program Files\Git\cmd;%UserProfile%\AppData\Local\Microsoft\WindowsApps;C:\SysInternalsSuite;C:\Program Files\Notepad++;%OneDrive%\Scripts;C:\$Data\Logs;C:\Program Files (x86)\Log Parser 2.2;"
:: 'C:\Program Files (x86)\Log Parser 2.2\LogParser'
IF EXIST %odl% (Echo Folder: %odl%\ Found) ELSE SET odl=%OneDrive%\Logs
SET msg= %Date% !Time! --[ Installing: Microsoft LogParser 2.2 ]-----
echo %msg%
SET SWInst="C:\$Software\$Microsoft\Log Parser 2.2\LogParser.msi"
SET cmd=msiexec.exe /i "%SWInst%" /Passive /NoReSTART /L*V "%ohtm%\%ComputerName%_Install_LogParser .log"
START "SW-Installation" /D "%odl%" /I /Min /High /Wait %SWInst% 2>&1
echo %Date% !Time! ------------------------------------------------------------------------------------------------
SET msg= %Date% !Time! --[ Installing: Microsoft Office 2003 Add-in Office Web Components\owc11.exe for LogParser 2.2 ]-----
echo %msg%
SET SWInst="C:\$Software\$Microsoft\Microsoft Office Professional Plus 2016 x64\MSChart\owc11.exe"
START "SW-Installation" /D "%odl%" /I /Min /High /Wait %SWInst% 2>&1
echo %Date% !Time! ------------------------------------------------------------------------------------------------
:: NOTE: Microsoft Chart Controls for Microsoft .NET Framework 3.5 can only be Installed if Microsoft .NET Framework 3.5 SP1 is Installed.
SET msg= %Date% !Time! --[ Installing: NET Framework 3.5 SP1 for LogParser 2.2 ]-----
echo %msg%
SET SWInst="C:\$Software\$Microsoft\Microsoft .NET Framework 3.5 Service pack 1 (Full Package)\dotnetfx35.exe"
START "SW-Installation" /D "%odl%" /I /Min /High /Wait %SWInst% 2>&1
echo %Date% !Time! ------------------------------------------------------------------------------------------------
SET msg= %Date% !Time! --[ Installing: Microsoft Office MSChart for LogParser 2.2 ]-----
echo %msg% && echo %msg% >>log%
SET SWInst="C:\$Software\$Microsoft\Microsoft Office Professional Plus 2016 x64\MSChart\MSChart.exe"
START "SW-Installation" /D "%odl%" /I /Min /High /Wait %SWInst% 2>&1
echo %Date% !Time! ------------------------------------------------------------------------------------------------
echo %Date% !Time! ---- Add C:\Program Files\WindowsApps to Path ------------
REG ADD "HKEY_CURRENT_USER\Environment" /V pfwa /T REG_SZ /f /d "C:\Program Files\WindowsApps"
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V pfwa /T REG_SZ /f /d "C:\Program Files\WindowsApps"
SETX pfwa "C:\Program Files\WindowsApps"
SETX /M pfwa "C:\Program Files\WindowsApps"
echo %Date% !Time! ------------------------------------------------------------------------------------------------
echo %Date% !Time! ---- Add Log Parser 2.2 to Path ------------
REG ADD "HKEY_CURRENT_USER\Environment" /V LogParser /T REG_SZ /f /d "C:\Program Files (x86)\Log Parser 2.2"
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LogParser /T REG_SZ /f /d "C:\Program Files (x86)\Log Parser 2.2"
SETX LogParser "C:\Program Files (x86)\Log Parser 2.2"
SETX /M LogParser "C:\Program Files (x86)\Log Parser 2.2"
echo %Date% !Time! ------------------------------------------------------------------------------------------------
SET msg= %Date% !Time! --[ Installing: Chrome ]-----
echo %msg% && echo %msg% >>log%
SET SWInst="C:\$Software\$General\Chrome\ChromeSetup.exe"
START "SW-Installation" /D "%odl%" /I /Min /High /Wait %SWInst% 2>&1
echo %Date% !Time! ------------------------------------------------------------------------------------------------
SET msg= %Date% !Time! --[ Installing: Scooter Software Beyond Compare ]-----
echo %msg% && echo %msg% >>log%
SET SWInst="C:\$Software\$General\Scooter Software Beyond Compare\BCompare-4.4.1.26165.exe"
START "SW-Installation" /D "%odl%" /I /Min /High /Wait %SWInst% 2>&1
echo %Date% !Time! ------------------------------------------------------------------------------------------------
echo LogParser exe - "%LogParser %\LogParser"
SET | Find /i "LogParser"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: https://download.cnet.com/Office-2003-Add-in-Office-Web-Components/3001-2070_4-10742090.html
:: https://www.microsoft.com/en-US/download/details.aspx?id=14422
SET dlin=------------------------------------------------------------------------------------------------
echo %Date% !Time! %dlin%
SET msg= %Date% !Time! --[ Installing: Microsoft LogParser 2.2 ]-----
SET SWInst="C:\$Software\$Microsoft\Log Parser 2.2\LogParser.msi"
SET cmd=msiexec.exe /i "%SWInst%" /Passive /NoReSTART /L*V "%ohtm%\%ComputerName%_Install_LogParser .log" 2>&1
START "SW-Installation" /D "%odl%" /I /Min /High /Wait %SWInst% 2>&1
echo %Date% !Time! %dlin%
SET msg= %Date% !Time! --[ Installing: Microsoft Office 2003 Add-in Office Web Components\owc11.exe for LogParser 2.2 ]-----
SET SWInst="C:\$Software\$Microsoft\Microsoft Office Professional Plus 2016 x64\MSChart\owc11.exe"
START "SW-Installation" /D "%odl%" /I /Min /High /Wait %SWInst% 2>&1
echo %Date% !Time! %dlin%
SET msg= %Date% !Time! --[ Installing: Microsoft Office MSChart for LogParser 2.2 ]-----
SET SWInst="C:\$Software\$Microsoft\Microsoft Office Professional Plus 2016 x64\MSChart\MSChart.exe"
START "SW-Installation" /D "%odl%" /I /Min /High /Wait %SWInst% 2>&1
echo %Date% !Time! %dlin%
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Error: LogParser is not recognized as an internal or external command, operable program or batch file.
::  Fix: Add the full path to Environment Variables - rundll32.exe sysdm.cpl,EditEnvironmentVariables
::	Path "C:\Program Files (x86)\Log Parser 2.2\LogParser"
::	My Computer -> Advanced -> Environment Variables -> System Variables. Then edit the PATH variable and append the directory to which you Installed LogParser at the end of the current contents of the variable.
C:\Program Files (x86)\Log Parser 2.2
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +----------------------------------------------------------------------------------------------------------------------------+
:: |  In LogParser, AND and OR are logical operators used to combine conditions in your SQL-like queries. Here's how they differ:
:: |  AND
:: |  Usage: Combines conditions such that all conditions must be true for the overall condition to be true.
:: |  OR
:: |  Usage: Combines conditions such that if any condition is true, the overall condition is true.
::: +----------------------------------------------------------------------------------------------------------------------------+
: +--------------------------------------------------------------------------------------+
:: |  Below LogParser -h -i:* Will display Every Field Header associated with input type  |
:: |  LogParser -h -i:* | FIND "Input format:" | SORT /+15                                |
:: |  LogParser Help queries - Requires LogParser V2.2                                    |
:: |  LogParser -h GRAMMAR  |  LogParser -h FUNCTIONS  | LogParser -h EXAMPLES            |
:: +--------------------------------------------------------------------------------------+
:: | Help:
:: |  LogParser -h GRAMMAR                  : SQL Language Grammar
:: |  LogParser -h FUNCTIONS [ <function> ] : Functions Syntax
:: |  LogParser -h EXAMPLES                 : Example queries and commands e.g.: LogParser -h EXAMPLES|Findstr /I /C:"TEXT"
:: |  LogParser -h -i:<input_format>        : Help on <input_format>
:: |  LogParser -h -o:<output_format>       : Help on <output_format>
:: |  LogParser -h -c                       : Conversion help
:: |  LogParser -h -o:CHART                 : Chart Specific Help
:: |            -q[:ON|OFF]                 :  quiet mode; default is OFF
:: |            -stats[:ON|OFF]             :  display statistics after executing query; default is ON
:: +--------------------------------------------------------------------------------------+
:: |  LogParser -h -i:ADS 			 (Active Directory)
:: |  LogParser -h -i:BIN 			 (IIS Centralized Binary Log Format)
:: |  LogParser -h -i:COM 			 (Custom COM Input Format)
:: |  LogParser -h -i:CSV 			 (CSV Format) Parses text Files containing comma-separated values
:: |  LogParser -h -i:ETW 			 (Event Tracing for Windows) FROM myFile.etl
:: |  LogParser -h -i:EVT 			 (Windows Event Log)
:: |  LogParser -h -i:FS             (Filesystem properties) convert Bytes to Mb - ROUND(DIV(TO_REAL(SUM(Size)), 1048576), 3) AS SizeMB,
:: |  LogParser -h -i:HTTPERR 		 (HTTPError Log Format) Parses HTTP Error log Files in: Dir %SystemRoot%\System32\LogFiles\HTTPERR
:: |  LogParser -h -i:IIS 			 (Microsoft IIS Log Format)     FROM '%IISLogs%\*.log'
:: |  LogParser -h -i:IISMSID 		 (Microsoft IIS Log Format with MSID Filter fields)
:: |  LogParser -h -i:IISODBC 		 (IIS ODBC Log Format)
:: |  LogParser -h -i:IISW3C         (IIS W3C Extended Log Format)  FROM '%IISLogs%\*.log'
:: |  LogParser -h -i:NCSA 			 (NCSA Common Log Format) Parses NCSA Common, Combined, and Extended Log Format log Files
:: |  LogParser -h -i:NETMON 		 (NetMon capture Files)
:: |  LogParser -h -i:REG 			 (Registry properties)
:: |  LogParser -h -i:TEXTLINE 		 (TextLine Format)
:: |  LogParser -h -i:TEXTWORD 		 (TextWord Format)
:: |  LogParser -h -i:TSV            (TSV Format) Parses text Files containing tab- or space- separated values - myfile.tsv -headerRow:on
:: |  LogParser -h -i:URLSCAN 		 (URLScan Log Format)
:: |  LogParser -h -i:W3C 			 (Generic W3C Log Format)
:: |  LogParser -h -i:XML 			 (XML Format)
:: |  :: LogParser -h -i:STREAM      (Unknown input format "STREAM")  ??
:: +---------------------------------------------------------------------------+
:: | When using the help function for LogParser -h, look at the "Fields:" available in SELECT to analyze...
:: +---------------------------------------------------------------------------+
:: |  LogParser -h -saveDefaults
:: |  LogParser -h -o:CSV
:: |  LogParser -h -i:CSV myfile.csv -headerRow:on
:: |  LogParser -h -i:TSV myfile.tsv -headerRow:on
:: |  LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 ( See -i:FS File System ) default is -1 (ignore all)
:: |  LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT PATH, NAME,SIZE FROM '%odl%\*.*'"
:: |  LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName%  Line" "SELECT
:: |  LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ..., resolve_sid(sid) AS UserName "
:: |  LogParser -i:EVT -o:NAT                  : The NAT output format writes output records in a readable tabulated column format.
:: |  LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename AS URL, REPLACE_STR(Text, ' ', '') AS CleanedText FROM http://www.microsoft.com WHERE Text LIKE '%href=%' AND Text IS NOT NULL"
:: |  LogParser -i:TEXTLINE -Recurse:-1 -o:datagrid "SELECT LogFilename, 'Startup-W10', Text FROM %odl%\*.log WHERE Text LIKE '%RC=%'"
:: +---------------------------------------------------------------------------+
:: |  LogParser -o:CSV -fileMode  0|1|2 : Action to perform when output file already exists (0=append, 1=overwrite, 2=ignore) [default value=1]
:: |  The -headers AUTO option will insert field names onto the first line of a CVS file, except when the -fileMode option is set to append to an existing file.
:: |  Option 						Definition
:: |  -headers ON|OFF|AUTO 			Write field names on first line; when AUTO, don't write headers when appending to an existing file [default value=AUTO]
:: |  -oDQuotes ON|OFF|AUTO 		Enclose fields within double quotes; when AUTO, quote fields only if contain separators [default value=AUTO]
:: |  -tabs ON|OFF 					Write a tab character between values [default value=OFF]
:: |  -oTsFormat <timestamp-format> Format in which TIMESTAMP fields are rendered [default value=yyyy-MM-dd hh:mm:ss]
:: |  -oCodepage <codepage_ID> 		File codepage (special values: 0=system codepage, -1=UNICODE) [default value=0] -fileMode 0|1|2 Action to perform when the file already exists:	0=append, 1=overwrite, 2=ignore[default value=1]
:: +---------------------------------------------------------------------------+
:: |  The TSV format is fundamentally similar to CSV, except that the delimiting character is a Tab instead of a comma.
:: |  Option 						Definition
:: |  -headers ON|OFF|AUTO 			Write field names on first line; when AUTO, don't write headers when appending to an existing file [default value=AUTO]
:: |  -oSeparator <separator> 		Separator between fields; '<string>', 'spaces' (any space character), 'space', or 'tab' [default
:: |  value='tab']
:: |  -oTsFormat <timestamp-format> Format in which TIMESTAMP fields are rendered [default value=yyyy-MM-dd hh:mm:ss]
:: |  -oCodepage <codepage_ID> 		File codepage (special values: 0=system codepage, -1=UNICODE) [default value=0]
:: |  -fileMode 0|1|2 				Action to perform when the file already exists: 0=append, 1=overwrite, 2=ignore [default value=1]
:: +---------------------------------------------------------------------------+
:: |  Below encloses output fields with double quotes:
:: |  LogParser -i:FS -o:CSV -oDQuotes ON -fileMode  0|1|2
:: +---------------------------------------------------------------------------+
:: |  Chart Sizes: e.g. -groupSize:640x480 -groupSize:1024x768 - (720X576) (1024X768) (1280X720) (1920X1080) (3840X2160)
:: |  echo Get Screen Resolution&WMIC Path Win32_VideoController get CurrentHorizontalResolution,CurrentVerticalResolution
:: +---------------------------------------------------------------------------+
:: | -o:<output_format>                    : one of CSV, TSV, XML, DATAGRID, CHART, SYSLOG, NEUROVIEW, NAT, W3C, IIS, SQL, TPL, NULL
:: +---------------------------------------------------------------------------+
:: | -chartType         <chart type>      : Chart type; one of: [default value=Line]
:: +---------------------------------------------------------------------------+
:: | -i:REG Parameters: -multiSZSep   <any string> usually | or ,
:: | -i:REG Parameters: -binaryFormat ASC|PRINT|HEX REG_BINARY type ASC", data bytes belonging to the 0x20-0x7F range are returned as ASCII characters
:: | e.g. LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,Value FROM \HK. WHERE KeyName LIKE '%<?>%'"
:: |    Fields:  ComputerName, Path, KeyName, ValueName, ValueType, Value, LastWriteTime
:: +---------------------------------------------------------------------------+
:: |  LogParser -h -O:CHART -chartType -- See: Test Charts - Loop Input: %bats%\LogParserAllCHARTs.ini
:: |     -chartType:Area
:: |     -chartType:Area3D
:: |     -chartType:AreaOverlapped3D
:: |     -chartType:AreaStacked
:: |     -chartType:AreaStacked100
:: |     -chartType:AreaStacked1003D
:: |     -chartType:AreaStacked3D
:: |     -chartType:Bar3D
:: |     -chartType:BarClustered
:: |     -chartType:BarClustered3D
:: |     -chartType:BarStacked
:: |     -chartType:BarStacked100
:: |     -chartType:BarStacked1003D
:: |     -chartType:BarStacked3D
:: |     -chartType:Bubble
:: |     -chartType:BubbleLine
:: |     -chartType:Column3D
:: |     -chartType:ColumnClustered
:: |     -chartType:ColumnClustered3D
:: |     -chartType:ColumnStacked
:: |     -chartType:ColumnStacked100
:: |     -chartType:ColumnStacked1003D
:: |     -chartType:ColumnStacked3D
:: |     -chartType:Doughnut
:: |     -chartType:DoughnutExploded
:: |     -chartType:Line
:: |     -chartType:Line3D
:: |     -chartType:LineMarkers
:: |     -chartType:LineOverlapped3D
:: |     -chartType:LineStacked
:: |     -chartType:LineStacked100
:: |     -chartType:LineStacked1003D
:: |     -chartType:LineStacked100Markers
:: |     -chartType:LineStacked3D
:: |     -chartType:LineStackedMarkers
:: |     -chartType:Pie
:: |     -chartType:Pie3D
:: |     -chartType:PieExploded
:: |     -chartType:PieExploded3D
:: |     -chartType:PieStacked
:: |     -chartType:PolarLine
:: |     -chartType:PolarLineMarkers
:: |     -chartType:PolarMarkers
:: |     -chartType:PolarSmoothLine
:: |     -chartType:PolarSmoothLineMarkers
:: |     -chartType:RadarLine
:: |     -chartType:RadarLineFilled
:: |     -chartType:RadarLineMarkers
:: |     -chartType:RadarSmoothLine
:: |     -chartType:RadarSmoothLineMarkers
:: |     -chartType:ScatterLine
:: |     -chartType:ScatterLineFilled
:: |     -chartType:ScatterLineMarkers
:: |     -chartType:ScatterMarkers
:: |     -chartType:ScatterSmoothLine
:: |     -chartType:ScatterSmoothLineMarkers
:: |     -chartType:SmoothLine
:: |     -chartType:SmoothLineMarkers
:: |     -chartType:SmoothLineStacked
:: |     -chartType:SmoothLineStacked100
:: |     -chartType:SmoothLineStacked100Markers
:: |     -chartType:SmoothLineStackedMarkers
:: |     -chartType:StockHLC
:: |     -chartType:StockOHLC
:: |     Line, LineMarkers, LineStacked, LineStackedMarkers, LineStacked100, LineStacked100Markers, Line3D, LineOverlapped3D, LineStacked3D, LineStacked1003D, SmoothLine, SmoothLineMarkers, SmoothLineStacked, SmoothLineStackedMarkers, SmoothLineStacked100, SmoothLineStacked100Markers, BarClustered, BarStacked, BarStacked100, Bar3D, BarClustered3D, BarStacked3D, BarStacked1003D, ColumnClustered, ColumnStacked, ColumnStacked100, Column3D, ColumnClustered3D, ColumnStacked3D, ColumnStacked1003D, Pie, PieExploded, PieStacked, Pie3D, PieExploded3D, ScatterMarkers, ScatterSmoothLine, ScatterSmoothLineMarkers, ScatterLine, ScatterLineMarkers, ScatterLineFilled, Bubble, BubbleLine, Area, AreaStacked, AreaStacked100, Area3D, AreaOverlapped3D, AreaStacked3D, AreaStacked1003D, Doughnut, DoughnutExploded, RadarLine, RadarLineMarkers, RadarLineFilled, RadarSmoothLine, RadarSmoothLineMarkers, StockHLC, StockOHLC, PolarMarkers, PolarLine, PolarLineMarkers, PolarSmoothLine, PolarSmoothLineMarkers
:: +---------------------------------------------------------------------------+
:: | echo Example to display all charts&START "LPCharts" /D "%odl%" /High /WAIT /B "%OneDrive%\Batch\LogParser-DisplayALLCharts.bat"
:: +---------------------------------------------------------------------------+
:: | When you use "SELECT *", the first two fields are LogFilename and LogRow
:: +---------------------------------------------------------------------------+
:: |   Suppress Stats and verbiage, use: LogParser -stats:On -q:ON
:: |   include Specific areas of interest ....
:: |   WHERE EventTypeName = 'Error event' -OR- EventTypeNam <> 'Information event'  GROUP BY EventTypeName HAVING EventTypeName = 'Error event'
:: |   Comparison operators (such as ">", "<=", "<>", "LIKE", "BETWEEN", etc.) and boolean operators (such as "AND", "OR", "NOT"). IS NOT NULL
:: |   Sometimes the field is a x20 or x40 blank, use this to filter out the null or blank field: WHERE Choice IS NOT NULL AND Choice <> ''  :: WHERE NOT (Choice IS NULL OR Choice = '')
:: +---------------------------------------------------------------------------+
:: |   Selecting information from Multiple Source Folders
:: |   FROM Application, Security, Setup, System, ForwardedEvents WHERE
:: |   FROM 'C:\ProgramData','C:\Program Files','C:\Program Files (x86)' WHERE
:: +---------------------------------------------------------------------------+
:: | SELECT TimeGenerated AS EventTime, EventID, ComputerName, Message, Data FROM Application, Security, System WHERE
:: | GROUP BY EventTypeName HAVING EventTypeName = 'Error event'
:: | GROUP BY EventTypeName HAVING EventTypeName = 'Warning event'
:: | GROUP BY EventTypeName HAVING EventTypeName = 'Success event'
:: | GROUP BY EventTypeName HAVING EventTypeName = 'Success Audit event'
:: | GROUP BY EventTypeName HAVING EventTypeName = 'Failure Audit event'
:: | Single   EventID : WHERE EventID = '4768'"
:: | Multiple EventIDs: WHERE EventID IN (4647;4648;4724)  -OR-  AND Ext IN ('.backup';'.db';'.dbg')
:: | Between  EventIDs: WHERE EventID BETWEEN 500 AND 599
:: | FirewAll EventIDs: WHERE EventID BETWEEN 5024 AND 5037
:: | COUNT(*) -OR-  HAVING COUNT(*) -OR-  COUNT(ALL *) AS Counts -OR-  COUNT(ext,size)
:: | Search string should be:  Text LIKE '%<SearchString>%'
:: | Search string for Specific : , ;tab = etc, string use EXTRACT_SUFFIX(SearchEndString,0,':') OR EXTRACT_PREFIX(SearchBegString,0,'=')
:: | Event Types Logs: (NOTE Each has a SET of DISTINCT EventID's associated with the Log)
:: | Application, HardwareEvents, Internet Explorer, Key Management Service, OAlerts, Parameters, Security, State, System, Windows PowerShell
:: | ref: https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/appendix-l--events-to-monitor
:: +------------------------------------------------------------------------------------------------------------------+
:: | Microsoft Log Parser timestamp formats timestamp format specifiers accepted by Microsoft Log Parser. TIMESTAMP(...)
:: | NOTE: There appears to be no apparent difference between using TO_TIMESTAMP() and TIMESTAMP()
:: | DATE:
:: | . Year
:: |     . y, yy, yyy, yyyy = last 1, 2, 3, or 4 digits, relative to 2000
:: | . Month
:: |     . M = no leading zero
:: |     . MM = leading zero
:: |     . MP = leading space
:: |     . MX = no leading zero, or with or without zero when parsing
:: |     . MMM = 3-character abbreviation
:: |     . MMMM = full name of month
:: | . Day
:: |     . d = no leading zero
:: |     . dd = leading zero
:: |     . dp = leading space
:: |     . dx = no leading zero, or with or without zero when parsing
:: |     . ddd = 3-character abbreviation
:: |     . dddd = full name of day
:: | . Time
:: |     . Hour
:: |     . h or H = no leading zero
:: |     . hh or HH = leading zero
:: |     . hp or HP = leading space
:: |     . hx or HX = leading zero, or with or without leading zero when parsing
:: | . Minute
:: |     . m = no leading zero
:: |     . mm = leading zero
:: |     . mp = leading space
:: |     . mx = leading zero, or with or without leading zero when parsing
:: | . Second
:: |     . s = no leading zero
:: |     . ss = leading zero
:: |     . sp = leading space
:: |     . sx = leading zero, or with or without leading zero when parsing
:: | . Millisecond
:: |     . l = no leading zero
:: |     . ll = leading zero
:: |     . lp = leading space
:: |     . lx = leading zero, or with or without leading zero when parsing
:: | . Nanosecond
:: |     . n = no leading zero
:: |     . nn = leading zero
:: |     . np = leading space
:: |     . nx = leading zero, or with or without leading zero when parsing
:: | . Other
:: |     . tt = AM/PM
:: |     . ? = space, or any character (wildcard) when parsing
:: |     . any other character, not listed above, is listed verbatim
:: +------------------------------------------------------------------------------------------------------------------+
:: | ┌───────────────────────────────────────────────────┐
:: | │  LogParser Manipulating Date Fields               │
:: | └───────────────────────────────────────────────────┘
:: | . Using LogParser how do I correctly sort a text date field that has a format mm/dd/yy. problem is i need the order of the sort in the format of dd/mm/yy
:: | . One solution is to use the TO_TIMESTAMP and TO_STRING functions to convert the text date field to a TIMESTAMP and then back to a string with the desired format. For example, you can use the following expression:
:: | TRIM(TO_STRING (TO_TIMESTAMP (Text, 'MM/dd/yy'), 'dd/MM/yy'))
:: | . This will return the string '15/02/09' for the text date '02/15/09'. You can use this expression in your SELECT or ORDER BY clauses as needed.
:: | . For more information on the date and time functions in Log Parser, you can refer to the Log Parser documentation1 or the web search results2.
:: | . Another solution is to use the SUBSTR function to extract the parts of the text date field and rearrange them in the desired order. For example, you can use the following expression:
:: | SUBSTR (Text, 4, 2) + '/' + SUBSTR (Text, 1, 2) + '/' + SUBSTR (Text, 7, 2)
:: | . This will return the string '15/02/09' for the text date '02/15/09'. You can use this expression in your SELECT or ORDER BY clauses as needed.
:: | . For more information on the string functions in Log Parser, you can refer to the Log Parser documentation1 or the web search results3.
:: | LogParser -i:TEXTLINE -RTP:-1 "SELECT TOP 1 EXTRACT_SUFFIX(text,0,'TIMESTAMP') from '%log%' where text like '%TIMESTAMP%'"
:: | TRIM(TO_STRING (TO_TIMESTAMP ('2023-01-01 00:11:00', 'yyyy-MM-dd HH:mm:ss'), 'MM/dd/yy')) - OR - Use today's date Batch time below...
:: | TRIM(TO_STRING (TO_TIMESTAMP ('%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00', 'yyyy-MM-dd HH:mm:ss'), 'yyyy-mm-dd'))
:: | - TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% %time:~-0,8%')
:: | . This will return the string '01/01/23'. You can use this expression in your SELECT or WHERE clauses as needed.
:: +------------------------------------------------------------------------------------------------------------------+
:: | -----------------------------------------------------------------------------------------------------------------
:: | TO_TIME(TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time), 3600))) AS [Hour] - Create a timestamp from the date and time of a request, drops the minutes from the time, converts it to local time, and pulls just the time.
:: | The query is returning all of the records, so look again at the USING clause and see that the timestamp value is converted to an integer. Next, look at the third column of Table 11.1 and notice that all of the values are evenly divisible by 300.The result of the QUANTIZE function will always end with a multiple equal to the value passed to QUANTIZE.This is important because this degree of consistency provides a basis for a very efficient WHERE clause.
:: | The MOD function returns the leftover parts or remainder of a division equation.The dividend of the MOD function must be an even multiple of the value used in the QUANTIZE function. In this way the WHERE clause will only keep records where the QUANTIZE value and the dividend are both factors of myTime. 900 is divisible 3 times by 300, so the MOD function in the WHERE clause keeps every third 300 second interval.The casual translation of this query is, "Produce 5 minutes of records from the Security log every fifteen minutes.
:: | Example: ---Ch11Intervals.sql--- SELECT DISTINCT TimeGenerated USING -- duration of sample TO_INT(QUANTIZE(TimeGenerated, 300)) as myTime FROM security WHERE -- frequency of sample MOD(myTime, 900) = 0
:: | -----------------------------------------------------------------------------------------------------------------
:: | SELECT TO_STRING(TO_TIMESTAMP(EXTRACT_PREFIX(REPLACE_STR([#Fields: datetime],'T',' '),0,'.'), 'yyyy-MM-dd hh:mm:ss'),'yyMMdd') AS Day
:: | -----------------------------------------------------------------------------------------------------------------
:: | By default LogParser (as well as most of programs) changes last access TIMESTAMP of file system objects it accesses.
:: |  There's a switch to control this behavior: -preserveLastAccTime ON|OFF (default is OFF)
:: | -----------------------------------------------------------------------------------------------------------------
:: | Perform Date arithmetic in the WHERE clause - The origin Date for TIMESTAMP values is 0000-01-02 00:00:00,    [yyyy-mm-dd hh:mm:ss]
:: | 'M' or 'd' mean 'Month/Day without leading zeroes'. '0' does not have a leading zero ('00' does), and '25' is a valid value for 'd'.
:: | -----------------------------------------------------------------------------------------------------------------
:: | Different -i:<input_format> have Time Stamps defined differently: i.e. TimeGenerated (EVT) and CreationTime (FS)
:: |  Check the Specific <input_format> help to see field names available for that format.
:: |  WHERE SUB(TO_INT(TimeGenerated), TO_INT(SYSTEM_TIMESTAMP())) < -2592000   (last 30 Days...)
:: |  SUB(..., ...) >= -604800: Subtracts the current timestamp from the file date and checks if the result is within the last 7 days (7 days * 24 hours * 60 minutes * 60 seconds = 604800 seconds).
:: |  The timestamp corresponding to "two days ago" is then: SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-03 00:00:00', 'yyyy-MM-dd hh:mm:ss')
)
:: |  WHERE EventID='xx' AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%2022-01%'
:: |  WHERE TimeGenerated >= TO_LOCALTIME(SUB(SYSTEM_TIMESTAMP(), TIMESTAMP('3', 'd')))
:: |  TIMESTAMP('2', 'd') -OR- TIMESTAMP('3', 'd') -NOT- TIMESTAMP('1', 'd')
:: | Last 30 Mins: SELECT TimeGenerated AS Time, ... where.. AND Time >SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()),TIMESTAMP('00:30:00','hh:mm:ss'))
:: | Last 30 Mins: SELECT TimeGenerated AS Time, ... where.. AND Time >= TO_LOCALTIME(SUB(SYSTEM_TIMESTAMP(),TIMESTAMP('30','mm')))
:: | Last 1 Day  : SELECT SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd hh:mm:ss') ) AS LastDay
:: |                                                                        |    |  |  |  |  +-> Secs
:: |                                                                        |    |  |  |  +----> Mins
:: |                                                                        |    |  |  +-------> Hour   (01=1 hour)
:: |                                                                        |    |  +----------> Day 1  (02=1 day, 03=2 days, 08=7 days etc)
:: |                                                                        |    +-------------> Month 1
:: |                                                                        +------------------> Year 0000
:: | Note: IF TIMESTAMP('2022-12-31 23:59:59')                                <-- This is the actual data in the log we're looking for
:: | then: IF TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% %time:~-0,8%') <-- This is a Current variable Date and Time NOW... (Note: mm:ss is wrong as log may not be there yet.)
:: |  TO_DATE(TimeGenerated)='%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00' <--- This will select events using today's date
:: | NOTE: Above Example one day can be specified as day 2 of month 1 of year zero
:: | Using QUANTIZE and  TIMESTAMP returns in Seconds...
:: | Also: QUANTIZE(12475,20) Is the same as : TIMESTAMP('11:35:47','hh:mm:ss'),30)
:: |
:: |       echo Date: %Date:~7,2% - Month: %Date:~4,2% - Year: %Date:~10,4%
:: | NOTE: For analyzing date and time format in LogParser , the format is: yyyyy-mm-dd hh:mm:ss
:: |   ==> echo Split Date Time: (yyyy-mm-dd hh:mm:ss) %DATE:~-4%-%DATE:~4,2%-%DATE:~7,2% %time:~0,2%:%time:~3,2%:%time:~6,2%
:: |   ==> echo Split Date Time: (yyyy-mm-dd hh:mm:ss) %date:~-4%-%date:~-10,2%-%date:~-7,2% %time:~-0,8%
:: | --> echo Split Date Time: (yyyymmdd_hhmmsstt) %DATE:~-4%%DATE:~4,2%%DATE:~7,2%_%time:~0,2%%time:~3,2%%time:~6,2%%time:~9,2%
:: |       echo Split Date Time: (mmddyyyy_hhmmsstt) %DATE:~4,2%%DATE:~7,2%%DATE:~-4%_%time:~0,2%%time:~3,2%%time:~6,2%%time:~9,2%
:: |       echo Split Date: (yyyy-dd-mm) %date:~-4%-%date:~-7,2%-%date:~-10,2%
:: |       echo Split Date: (dd-mm-yyyy) %date:~-7,2%-%date:~-10,2%-%date:~-4%
:: |       echo Split Date: (Dow-dd-mm-yyyy) %date:~-0,3%-%date:~-7,2%-%date:~-10,2%-%date:~-4%
:: |       echo Split Date: (Dow-yyyy-mm-dd) %date:~-0,3%-%date:~-4%-%date:~-10,2%-%date:~-7,2%
:: |       echo Split Date: (yyyy-mm-dd-Dow) %date:~-4%-%date:~-10,2%-%date:~-7,2%-%date:~-0,3%
:: |       echo Split Date: (yyyy-mm-dd) %date:~-4%-%date:~-10,2%-%date:~-7,2%
:: |       echo Split Date: (mm/dd/yyyy) %date:~-10,2%/%date:~-7,2%/%date:~-4%
:: |       echo Split Date: (dd mm yyyy) %date:~-7,2% %date:~-10,2% %date:~-4%
:: | <===> echo Split Date: (yyyymmdd) echo %date:~-4%%date:~-10,2%%date:~-7,2%
:: |       echo Split Date: (ddmmmyyyy) echo %date:~-7,2%%date:~-4%%date:~-10,2%
:: |       echo Split Date: (yyyy) echo %date:~-4%
:: |       echo Split Time: (hh:mm:ss) %time:~-0,8% -OR- (hh:mm:ss.tt) %time:~-0,12% -OR- (mm:ss.tt) %time:~-8%
:: |
:: | To get the current System Date as a TIMESTAMP with System_Date() and the current System time as a TIMESTAMP with System_TIME(),
:: | Example Getting events for past  1 hour  = 3600  Seconds OR events for past 24 hours = 86400 Seconds.
:: |  The TO_INT function helps convert the date value to number of seconds which then DIV divided by 86400 to obtain the number of days.
:: |   Therefore, 0000-01-02 00:00:00 represents a span of exactly one day.
:: |   SET ToDay=%date:~-4%-%date:~-7,2%-%date:~-10,2% & echo %ToDay%... (s/b No spaces...)
:: |   echo Note there may be a space before ... If so use: LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%' - instead of LIKE '%%ToDay%%'
:: |   echo LIKE %date:~-4%-%date:~-7,2%-%date:~-10,2%... This is better...
:: |   QUANTIZE(DateTime, 1) AS Second, SUM(FrameBytes) INTO DATAGRID FROM myCapture.cap GROUP BY Second
:: |  Below are long winded replacement for SYSTEM_TIMESTAMP() -  TO_TIMESTAMP(System_Date(), System_TIME())
:: |  Returning a 24-hour TIMESTAMP:
:: | .. WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventType IN (%myEvents%) ORDER BY TimeGenerated DESC"
:: |  Use above examples for last hour or day instead of the long winded examples below...
:: |  12-hour TIMESTAMP (holds twelve hours in the first day of the year zero) - TIMESTAMP('12:00:00', 'hh:mm:ss')
:: | .. Seconds:- SELECT ADD(DIV(QUANTIZE(time-taken, 1000), 1000), 1) AS [Seconds], COUNT(*) AS [Requests] -- and -- GROUP BY [Seconds] ORDER BY [Seconds] DESC"
:: | .. 05 Mins:- SELECT TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) AND Message LIKE '%chromoting%' ORDER BY Time"
:: | .. 15 Mins:- SELECT TO_LOCALTIME(TO_TIMESTAMP(date, time)) AS [LocalTime], * ...
:: | .. 15 Mins:- SELECT LocalTime > SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 00:15', 'yyyy-MM-dd HH:mm'))"
:: | .. 1 Hour:-  SELECT QUANTIZE(TimeGenerated, 3600) AS LastHr, --- and --- GROUP BY [Date] ORDER BY [Date]
:: | .. 1 Hour:-  SELECT TO_TIME(TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time), 3600))) AS [Hour], COUNT(*) AS [Requests -and- GROUP BY [Hour] ORDER BY [Hour]
:: |   TO_TIMESTAMP(date, time) -   Converts the date and time of a request into a timestamp, for use with other functions.
:: |   TO_TIMESTAMP('2009-02-06', 'yyyy-MM-dd') -  Creates a timestamp of the date February 6, 2009.
:: |   TO_TIMESTAMP('2010-02-15 10:15', 'yyyy-MM-dd HH:mm') -  Creates a timestamp of February 25, 2010, at 10:15 in the morning.
:: |   TO_TIMESTAMP('24 Jun 2011 13:22:21', 'dd MMM yyyy HH:mm:ss') -  Creates a timestamp of a date/time in 'short' format.
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: |
:: |    NOTE: The DIV function returns The quotient of The two argument value
:: |    1) splitting hh:mm:ss into it's components Then totaling up ss->Mins Mins->hours , SUBSTR(Duration,0,2) AS hh, SUBSTR(Duration,3,2) AS mm, SUBSTR(Duration,6,2) AS ss
:: |    2) splitting hh:mm:ss into it's components Then totaling up ss->Mins Mins->hours , SUM(TO_INT(SUBSTR(Duration,0,2))) AS Thh, SUM(TO_INT(SUBSTR(Duration,3,2))) AS Tmm, SUM(TO_INT(SUBSTR(Duration,6,2))) AS Tss
:: |    3) Need to DIVIDE ss (seconds) by 60 and get mm and ss Keep ss and add mm to SUM mm TheN DIV mm (minutes) by 60 and keep hh and mm and add hh to hh (DIV Integer and remainder)
:: |       , DIV(SUM(TO_INT(SUBSTR(Duration,3,2))), 60) AS hhmm, DIV(SUM(TO_INT(SUBSTR(Duration,6,2))), 60) AS mmss
:: | -OR- Multiply hh * 3600 to get Hseconds, Then Multiply mm * 60 to get Seconds TheN SUM(Hseconds,Sseconds,ss) AS TotalSeconds TheN Divide TotalSeconds by 3600 to get hours, HOWEVER WE NEED Remainders for Minutes...
:: |    , MOD( dividend <INTEGER | REAL>, divisor <INTEGER | REAL> ) The MOD function returns The remainder of The quotient of its argument. e.g. 145(Dividend)/60(Divisor)=2(Quo tent) 25(Remainder)
:: |    , MOD(SUM(TO_INT(SUBSTR(Duration,3,2))), 60) AS Mhhmm
:: |   _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: |    You can't have line 1 as heading and Then skip lines at The same time.....
:: |    LogParser -stats:on -q:on -rtp:-1 -o:datagrid -i:CSV -headerRow:ON -fixedFields:OFF -nFields:-1 -dtLines:10id -nSkipLines:1 -iTsFormat:"MM/dd/yyyy hh:mm:ss" "SELECT
:: |    Error: SELECT clause: Syntax Error: unknown field 'Title' -headerRow:ON
:: |   When used with TIMESTAMP arguments, The TO_TIMESTAMP function returns a TIMESTAMP value built after merging The data portion and The time portion of The specified arguments.
:: |   When used with STRING arguments, The TO_TIMESTAMP function parses The string representation of a date and/or time specified as The first argument according to The format specifiers described with The format argument, returning The resulting TIMESTAMP value.
:: |   When used with INTEGER or REAL arguments, The TO_TIMESTAMP function returns The TIMESTAMP value of The instant of time corresponding to The specified number of seconds since January 1, year 0.
:: |    Going one step furTher with TO_TIMESTAMP is The tidbit that if you specify a value and a format that can't work togeTher, such as ('57', 'dd'), Log Parser will return a NULL because 57 is not a valid day of The month. While this is not a complete data validation solution, it is nice to know it is There.
:: |   [QUANTIZE rounds values based on a quantization value.QUANTIZE The date and time to The nearest hour, which results in an hourly grouping of The results. We don't want to know The actual time value;(3600) AS Hour, we simply want to know what hour range it is in.]
:: |   The following example returns 11:35:30: QUANTIZE( TO_TIMESTAMP( '11:35:47', 'hh:mm:ss' ), 30 )
:: |   QUANTIZE(TO_TIME(TimeGenerated), 3600) AS Hour,
:: |   QUANTIZE(TO_TIMESTAMP(date, time), 3600) AS Hour,
:: |   QUANTIZE(TO_TIMESTAMP(date, time), 3600) AS Hour, TO_DATE(TO_LOCALTIME(TO_TIMESTAMP(date, time))),
:: |   QUANTIZE(TO_TIMESTAMP(date,time), 3600), 'yyyyMMdd-hh') AS stamp,
:: |   QUANTIZE(DateTime, 30) AS HalfMinute, SUM(FrameBytes)
:: |   TO_DATE(TO_TIMESTAMP(EXTRACT_PREFIX(EXTRACT_SUFFIX(Filename, 0, '\\'), 0, '.'), 'yyyyMMdd') ) as CollectionDate
:: |   TO_DATE(TO_UTCTIME(TO_TIMESTAMP(Date, Time))) AS date,
:: |   TO_DATE(TimeGenerated) AS Date,
:: |   TO_STRING(QUANTIZE(TO_TIMESTAMP(date,time), 3600), 'yyyyMMdd-hh') AS Stamp,
:: |   TO_STRING(TO_TIMESTAMP(date, time), 'MM-dd') AS Day, [ The TO_TIMESTAMP function to consolidate The date and time field into month/month – day/day format.]
:: |   TO_STRING(TO_TIMESTAMP(date, time), 'MMMM') AS Month,
:: |   TO_TIME( TIMESTAMP <TIMESTAMP> ) The TO_TIME function returns a TIMESTAMP value that contains The time portion only of The specified argument.
:: |   TO_TIME(TO_UTCTIME( TO_TIMESTAMP(Date, Time))) AS time,
:: |   TO_TIMESTAMP( dateTime1 <TIMESTAMP>, dateTime2 <TIMESTAMP> )
:: |   TO_TIMESTAMP( seconds <INTEGER | REAL> )
:: |   TO_TIMESTAMP( string <STRING>, format <STRING> )
:: |   TO_TIMESTAMP( SYSTEM_DATE(), time) AS TimeGenerated,
:: |   TO_TIMESTAMP(date, time) AS TIMESTAMP, [ The TO_TIMESTAMP function, which takes a date and a time as arguments, merges The values into a single date and time field called a TIMESTAMP field.]
:: |   TO_TIMESTAMP(SUBSTR(Text,0,19), 'yyyy-MM-dd hh:mm:ss') AS TimeGenerated,
:: |   USING TO_TIMESTAMP(REPLACE_IF_NOT_NULL(TO_STRING(INDEX_OF(TO_STRING(SUB(TO_INT(CreationTime),TO_INT(LastWriteTime)),'yy'),'-')),TO_STRING(LastWriteTime,'yyyy-MM-dd hh:mm:ss')),'yyyy-MMdd hh:mm:ss') As LastWrite FROM
:: |   TO_DATE(TO_LOCALTIME(SUB(SYSTEM_TIMESTAMP(), TIMESTAMP('%day%', 'd')))) AS Days,
:: |
:: |        <hr>
:: |        <p>DISPLAY HTML Programming PDF: MICROSOFT_PRESS_EBOOK PROGRAMMING WINDOWS 8 APPS WITH HTML CSS AND JAVASCRIPT.PDF<p>
:: |        <iframe src="C:\inetpub\wwwroot\HTML\PROGRAMMING WINDOWS 8 APPS WITH HTML CSS AND JAVASCRIPT.PDF" width="75%" height="950px">
:: |        </iframe>
:: |        <hr>
:: |        <p>Advanced HTML5 and CSS3 Specialist<p>
:: |        <iframe src="C:\inetpub\wwwroot\HTML\Advanced HTML5 and CSS3 Specialist.PDF" width="75%" height="950px">
:: |        </iframe>
:: |        <hr>
:: |        <p>HTML Tutorial - Duckett<p>
:: |        <iframe src="C:\Inetpub\wwwroot\Duckett\HTML Tutorial - Duckett.pdf" width="75%" height="950px">
:: |        </iframe>
:: |        <hr>
:: |
:: +------------------------------------------------------------------------------------------------------------------+
:: |   Examples to extract the data FROM the 0-xth delimited field in the "strings" column we need to add this to our query:
:: |   Examples using: LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT....
:: |   EXTRACT_TOKEN(Strings,  0, '|') AS User,
:: |   EXTRACT_TOKEN(Strings,  1, '|') AS Domain,
:: |   EXTRACT_TOKEN(Strings,  2, '|') AS Service,
:: |   EXTRACT_TOKEN(Strings,  5, '|') AS Cipher,
:: |   EXTRACT_TOKEN(Strings,  8, '|') AS LogonType,
:: |   EXTRACT_TOKEN(Strings,  8, '|') AS SrcIp,
:: |   EXTRACT_TOKEN(Strings, 13, '|') AS DstIp,
:: |   EXTRACT_TOKEN(Strings, 11, '|') AS Workstation,
:: |   EXTRACT_TOKEN(Strings, 17, '|') AS ProcName,
:: |    Using the EXTRACT_TOKEN function, extracts specific sub-strings from within a string, convert to Uppercase e.g.  first word only
:: |     ("Warning", "Information", etc.) TO_UPPERCASE( EXTRACT_TOKEN(EventTypeName, 0, ' ') ), SourceName FROM System"
:: +---------------------------------------------------------------------------+
:: | E.g.: LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS LogonTime,EXTRACT_TOKEN(Strings,  0, '|') AS User, EXTRACT_TOKEN(Strings,  1, '|') AS Domain, EXTRACT_TOKEN(Strings,  2, '|') AS Service, EXTRACT_TOKEN(Strings,  5, '|') AS Cipher, EXTRACT_TOKEN(Strings,  8, '|') AS LogonType, EXTRACT_TOKEN(Strings,  8, '|') AS SrcIp, EXTRACT_TOKEN(Strings, 13, '|') AS DstIp, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcName FROM Application,Security,System WHERE EventID BETWEEN 500 AND 599 AND to_string(TimeGenerated,'yyyy-MM-dd HH:mm:ss') like '%%date:~-4%%'"
:: +---------------------------------------------------------------------------+
:: |   Using -i:TEXTLINE to find Specific data string in columns in file
:: |   SUBSTR(text, 0, 41) AS first41,
:: |   SUBSTR(text, 42, 57) AS from42,
:: |   SUBSTR(text, 58, 9999) AS rest
:: |   0....5....1....5....2....5....3....5....4....5....5....5....6....5....7   <- Note SUBSTR counts FROM 0 and not 1
:: |   1...5....1....5....2....5....3....5....4....5....5....5....6....5....70   <- Normal positioning...
:: |   <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-gb" lang="en-gb" >
:: |   pre  char 0>41    is pre
:: |   xml  char 42,15   is xml --> 49 xml:lang="en-gb"
:: |   post char 58,9999 is post
:: +---------------------------------------------------------------------------+
:: |   WHERE EXTRACT_TOKEN(Strings, 1, '|') LIKE '%logon&' AND (TimeGenerated > SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP( '10', 'mm')) OR SID IS NOT NULL)
:: +---------------------------------------------------------------------------+
:: |   EXTRACT_PREFIX splits the string at the specified instance of the separator (counting from the left-hand side) and returns the sub-string before (ie on the left-hand side of) the separator
:: |   EXTRACT_PREFIX and EXTRACT_SUFFIX - lets you nominate a character as a separator character where the string should be split.
:: |   EXTRACT_PREFIX reads from Left to Right, 0 most left hit on character  e.g. EXTRACT_PREFIX(text,0,':')
:: |   EXTRACT_SUFFIX splits the string at the specified instance of the separator (counting from the right-hand side) and returns the sub-string after (ie on the right-hand side of) the separator
:: |   EXTRACT_SUFFIX reads from Right to Left, 0 most right hit on character e.g. EXTRACT_SUFFIX(text,0,'=')
:: |   EXTRACT_PREFIX(EXTRACT_SUFFIX(Text, 0, '- '), 0, ':') AS Who, EXTRACT_PREFIX(EXTRACT_SUFFIX(Text, 0, ':'), 0, '- ') AS Choice - Grabs data to the left and right of : or -. NICE!
:: +---------------------------------------------------------------------------+
:: |   Monitor these Particular Events:
:: |   	Application Allow listing
:: |   	Application Crashes
:: |   	System or Service Failures
:: |   	Windows UpDate Errors
:: |   	Windows FirewAll
:: |   	Clearing Event Logs
:: |   	Software and Service Installation
:: |   	Account Usage Kernel Driver Signing
:: |   	Group Policy Errors
:: |   	Windows Defender Activities
:: |   	Mobile Device Activities
:: |   	External Media Detection
:: |   	Printing Services
:: |   	Pass the Hash Detection Remote Desktop Logon Detection
:: +---------------------------------------------------------------------------+
:: |   All logs are assigned an event level:
:: |   	Audit Success - (Security category only)
:: |   	Audit Failure - (Security category only)
:: |   	Critical
:: |   	Error
:: |   	Warning
:: |   	Information
:: |   	Verbose
:: +---------------------------------------------------------------------------+
:: |   	Parse errors: execute the command again with a non-zero value for the "-e" -e:-1
:: |	If you get: Error while parsing field e.g.<sc-status>: Value is not a relative integer - Then Replace -i:W3C with -i:IISW3C
:: +------------------------------------------------------------------+
:: |	Additional Non Standard Event Log Files can be found here: Dir /s "%UserProfile%\*.etl"
:: |	SET some common environmental parameters to shorten the line commands...
:: +------------------------------------------------------------------+
:: |	Export Security Events: 	WEVTUtil query-events Security > %ohtm%\%ComputerName%_SecurityLog.txt
:: |	get-winevent -logname "Microsoft-Windows-TerminalServices-LocalSessionManager/Operational" | Export-Csv "%ohtm%\%ComputerName%_SecurityLog.txt" -Encoding UTF8
:: +------------------------------------------------------------------+
:: |	Below should give you more accurate results with fractions to the desired number of decimal places
:: +------------------------------------------------------------------+
:: |	File Size Conversions from LogParser -I:FS size field - DIV(size,1048576) AS Size(Mb)
:: |	DIV(TO_REAL(SUM(Size)),1024) AS Size(Kb), DIV(TO_REAL(SUM(Size)),1048576) AS Size(Mb), DIV(TO_REAL(SUM(Size)),1073741824) AS Size(Gb)
:: |	SELECT    This works                                  |Err>|  SELECT Error: Syntax Error: argument of function DIV is not a valid <field-expr-list>
:: |	    DIV(TO_REAL(SUM(Size)), 1024) AS SizeKB,          |Err>|      DIV(CAST(TO_REAL(SUM(Size)) * 1000 AS INT), 1000) AS SizeKB, 
:: |	    DIV(TO_REAL(SUM(Size)), 1048576) AS SizeMB,       |Err>|      DIV(CAST(TO_REAL(SUM(Size)) * 1000 / 1048576 AS INT), 1000) AS SizeMB,
:: |	    DIV(TO_REAL(SUM(Size)), 1073741824) AS SizeGB,    |Err>|      DIV(CAST(TO_REAL(SUM(Size)) * 1000 / 1073741824 AS INT), 1000) AS SizeGB,
:: |	    DIV(TO_REAL(SUM(Size)), 1099511627776) AS SizeTB  |Err>|      DIV(CAST(TO_REAL(SUM(Size)) * 1000 / 1099511627776 AS INT), 1000) AS SizeTB
:: |	SELECT     This Works                                 |Err>|  SELECT  Error: SELECT clause: Semantic Error: function ROUND takes 1 argument
:: |	    DIV(TO_REAL(SUM(Size)), 1024) AS SizeKB,          |Err>|      ROUND(DIV(TO_REAL(SUM(Size)), 1024), 3) AS SizeKB,
:: |	    DIV(TO_REAL(SUM(Size)), 1048576) AS SizeMB,       |Err>|      ROUND(DIV(TO_REAL(SUM(Size)), 1048576), 3) AS SizeMB,
:: |	    DIV(TO_REAL(SUM(Size)), 1073741824) AS SizeGB,    |Err>|      ROUND(DIV(TO_REAL(SUM(Size)), 1073741824), 3) AS SizeGB,
:: |	    DIV(TO_REAL(SUM(Size)), 1099511627776) AS SizeTB  |Err>|      ROUND(DIV(TO_REAL(SUM(Size)), 1099511627776), 3) AS SizeTB
:: |	1 Kb = 1024 bytes
:: |	1 Mb = 1048576 bytes -OR- 1024 Kb
:: |	1 Gb = 1073741824 bytes -OR- 1024 Mb
:: |	1 Tb = 1099511627776 bytes -OR- 1024 Gb
:: |	1 Tb = 1024 * 1 Gb = 1024 * 1024 * 1 Mb = 1024 * 1024 * 1024 * 1 KB = 1024 * 1024 * 1024 * 1024 = 1,099,511,627,776 Bytes
:: |	DIV(DIV(SUM(Size), 1024), 1024) AS MBytes
:: |	DIV(Sum(cs-bytes),1024) AS Incoming(K), DIV(Sum(sc-bytes),1024) AS Outgoing(K)
:: |	To convert from MBytes to GBs, we’ll divide by 1024 once more (because 1 GB = 1024 MB).
:: |	So, our new expression will be: SUM(Size) / (1024 * 1024) AS MBytes -AND- SUM(Size) / (1024 * 1024 * 1024) AS GBytes
:: +------------------------------------------------------------------+
::------------------------------------------------------------------------------------------------------------------
:: |  NOTE: Using: -fileMode:0 - the command is to instruct Log Parser to append to the Files rather than overwrite them.
:: |  -fileMode: 0|1|2 Action to perform when the file already exists: 0=append, 1=overwrite, 2=ignore[default value=1]
::------------------------------------------------------------------------------------------------------------------
::------------------------------------------------------------------------------------------------------------------
::	LogParser How to exclude a character from a string where I need to filter out the character: '_' from a string.
::  This works: ...                             AND EXTRACT_TOKEN(Name, 0, '_') = Name ...  <-- Works...
::  Do not try and use something like this: ... AND Name NOT LIKE '%\_%' ...                <-- Does NOT work!
::------------------------------------------------------------------------------------------------------------------
:: _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::	LogParser -i:FS Input Format Fields - The input records generated by the FS input format contain the following fields:
:: +--------------------+-----------+--------------------------------------------------------------
:: | -i:FS Name         | Type		| Description
:: +--------------------+-----------+--------------------------------------------------------------
:: | Path				| STRING	| Full path of the file or directory
:: | Name				| STRING	| Name of the file or directory
:: | FullName			| STRING	| EXTRACT_PATH(Path) AS Pat, STRCAT(TO_STRING(Pat),STRCAT('.',TO_STRING(Name))) AS FullName - Created if needed
:: | Size				| INTEGER	| Size of the file, in bytes   DIV(size,1048576) AS Size(Mb)
:: | Attributes			| STRING	| Attributes of the file or directory
:: | CreationTime		| TIMESTAMP	| Date and time at which the file or directory has been created (local or UTC time, depending on the value of the useLocalTime parameter)
:: | LastAccessTime		| TIMESTAMP	| Date and time at which the file or directory has been last accessed (local or UTC time, depending on the value of the useLocalTime parameter)
:: | LastWriteTime		| TIMESTAMP	| Date and time at which the file or directory has been last modified (local or UTC time, depending on the value of the useLocalTime parameter)
:: | FileVersion		| STRING	| Version of the file
:: | ProductVersion		| STRING	| Version of the product the file is distributed with
:: | InternalName		| STRING	| Internal name of the file
:: | ProductName		| STRING	| Name of the product the file is distributed with
:: | CompanyName		| STRING	| Name of the vendor company that produced the file
:: | LegalCopyright		| STRING	| Copyright notices that apply to the file
:: | LegalTrademarks	| STRING	| Trademarks and registered trademarks that apply to the file
:: | PrivateBuild		| STRING	| Private version information of the file
:: | SpecialBuild		| STRING	| Special file build notes
:: | Comments			| STRING	| Comments associated with the file
:: | FileDescription	| STRING	| Description of the file
:: | OriginalFilename	| STRING	| Original name of the file
:: +--------------------+-----------+--------------------------------------------------------------
:: |  Path (S) Name (S) Size (I) Attributes (S) CreationTime (T) LastAccessTime (T) LastWriteTime (T) FileVersion (S) ProductVersion (S) InternalName (S) ProductName (S) CompanyName (S) LegalCopyright (S) LegalTrademarks (S) PrivateBuild (S) SpecialBuild (S) Comments (S) FileDescription (S) OriginalFilename (S)
:: |   Path, Name, Size, Attributes, CreationTime, LastAccessTime, LastWriteTime, FileVersion, ProductVersion, InternalName, ProductName, CompanyName, LegalCopyright, LegalTrademarks, PrivateBuild, SpecialBuild, Comments, FileDescription, OriginalFilename
:: | Parameters:
:: | -recurse             <level> : Max sub-directory recursion level (0=no recurse, -1=All levels) [default value=-1]
:: | -preserveLastAccTime ON|OFF  : Preserve Files' last access time [default value=OFF]
:: | -useLocalTime        ON|OFF  : Use local time for dates [default value=ON]
:: +-----------------------------------------------------------------------------------------------
echo Display LogParser Help&LogParser -h >%ohtm%\%ComputerName%_LogParser Help.txt&LogParser -h GRAMMAR >>%ohtm%\%ComputerName%_LogParser Help.txt&LogParser -h FUNCTIONS >>%ohtm%\%ComputerName%_LogParser Help.txt&LogParser -h EXAMPLES >>%ohtm%\%ComputerName%_LogParser Help.txt&LogParser -h -c >>%ohtm%\%ComputerName%_LogParser Help.txt&Notepad++ %ohtm%\%ComputerName%_LogParser Help.txt
:: +-----------------------------------------------------------------------------------------------
:: |  LogParser -h -i >>%ohtm%\%ComputerName%_LogParser Help.txt&LogParser -h -o >>%ohtm%\%ComputerName%_LogParser Help.txt
:: | -i:<input_format>   :  one of IISW3C, NCSA, IIS, IISODBC, BIN, IISMSID,
:: |                          HTTPERR, URLSCAN, CSV, TSV, W3C, XML, EVT, ETW,
:: |                          NETMON, REG, ADS, TEXTLINE, TEXTWORD, FS, COM (if
:: |                          omitted, will guess from the FROM clause)
:: | -o:<output_format>  :  one of CSV, TSV, XML, DATAGRID, CHART, SYSLOG,
:: |                          NEUROVIEW, NAT, W3C, IIS, SQL, TPL, NULL (if omitted,
:: |                          will guess from the INTO clause)
:: +-----------------------------------------------------------------------------------------------
:: |   To-Do: Look more into: LogParser -i:COM -iprogid:
:: +-----------------------------------------------------------------------------------------------
::------------------------------------------------------------------------------------------------------------------
::Path,Name,Size,Attributes,CreationTime,LastWriteTime,FileVersion,ProductVersion,InternalName,ProductName,CompanyName,LegalCopyright,LegalTrademarks,PrivateBuild,Comments,FileDescription,OriginalFilename
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::LogParser -i:EVT Input Format Fields - The input records generated by the EVT input format contain the following fields:
:: +--------------------+-----------+--------------------------------------------------------------
:: | EVT Name	    | Type		| Description
:: +--------------------+-----------+--------------------------------------------------------------
:: | EventLog			| STRING	| Name of the Event Log or Event Log backup file containing this event
:: | RecordNumber		| INTEGER	| Index of this event in the Event Log or Event Log backup file containing this event
:: | TimeGenerated		| TIMESTAMP	| The date and time at which the event was generated (local time)
:: | TimeWritten		| TIMESTAMP	| The date and time at which the event was logged (local time)
:: | EventID			| INTEGER	| The ID of the event
:: | EventType			| INTEGER	| The numeric type of the event
:: | EventTypeName		| STRING	| The descriptive type of the event
:: | EventCategory		| INTEGER	| The numeric category of the event
:: | EventCategoryName	| STRING	| The descriptive category of the event
:: | SourceName			| STRING	| The source that generated the event
:: | Strings			| STRING	| The textual data associated with the event
:: | ComputerName		| STRING	| The name of the computer on which the event was generated
:: | SID				| STRING	| The Security Identifier associated with the event
:: | Message			| STRING	| The full event message
:: | Data				| STRING	| The binary data associated with the event
:: +--------------------+-----------+--------------------------------------------------------------
:: |    396 Appendix C • Input Format Reference
:: |  :EVT Fields - The EVT input format generates input records containing the following fields:
:: |    ■ EventLog
:: |    ■ EventNumber
:: |    ■ TimeGenerated
:: |    ■ TimeWritten
:: |    ■ EventID
:: |    ■ EventType
:: |    ■ EventTypeName
:: |    ■ EventCategory
:: |    ■ EventCategoryName
:: |    ■ SourceName
:: |    ■ Strings
:: |    ■ ComputerName
:: |    ■ SID
:: |    ■ Message
:: |    ■ Data
:: |  Parameters
:: |    ■ fullText When set to ON (the default), the EVT input format retrieves the text of
:: |    the event log message; when set to OFF, the EVT input format does not retrieve the
:: |    message text.
:: |    ■ resolveSIDs When set to ON, the EVT input format resolves the event log SID into
:: |    a full account name. When set to OFF (the default), the EVT input format returns the
:: |    SID in alphanumerical form.
:: |    ■ formatMsg When set to ON, the EVT input format removes multiple white space
:: |    characters and carriage-return/line-feed characters from the event log message to preserve readability. When set to OFF, the event log message is returned as is.
:: |    ■ msgErrorMode Setting this parameter to NULL causes the Message or
:: |    EventCategoryName fields to be returned as NULL when their text value cannot
:: |    be retrieved. Setting this parameter to ERROR causes the EVT input format to
:: |    return a parse error in these situations, and setting this parameter to MSG causes the
:: |    EVT input format to return an error message as the value of the Message or
:: |    EventCategoryName fields.
:: |    ■ fullEventCode When set to ON, the EVT input format returns the full 32-bit value
:: |    of the EventID field. When set to OFF (the default), the EVT input format returns
:: |    only the lower 16 bits of the EventID field, as displayed by the Windows Event
:: |    Viewer.
:: |    ■ direction When set to FW (the default), events are returned from the oldest to the
:: |    newest. When set to BW, events are returned from the newest to the oldest.
:: |    ■ stringsSep This parameter specifies the string used as a separator between the values
:: |    of the Strings field.The default value is the pipe (|) character.
:: |    ■ iCheckpoint Specifies the path of the checkpoint file to use when parsing the input
:: |    file(s) incrementally.
:: |    ■ binaryFormat Specifies the format of the binary data returned in the Data field as
:: |    one of the ASC, HEX, or PRINT values
:: +-----------------------------------------------------------------------------------------------
:: | RegKey data types: [ REG_SZ | REG_MULTI_SZ | REG_EXPAND_SZ | REG_DWORD | REG_QWORD  | REG_BINARY  | REG_NONE ]
:: +-----------------------------------------------------------------------------------------------
:: | HEX_TO_ASC | HEX_TO_HEX16 | HEX_TO_HEX32 | HEX_TO_HEX8 | HEX_TO_INT | HEX_TO_PRINT
:: +-----------------------------------------------------------------------------------------------
::EventLog,RecordNumber,TimeGenerated,TimeWritten,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message,Data
::-------------------------------------------------------------------------------------------------
:: +----------------------------------------------------------------------------------------------+
:: | Using DOS Date: Split Date or Part date - split Date into its dd mm yy parts in various ways.|
:: +----------------------------------------------------------------------------------------------+
:: +-----------------------------------------------------------------------------------------------------------------------------+
:: | NOTE: For analyzing date and time format in LogParser, The format is: yyyyy-mm-dd hh:mm:ss
:: |   ==> echo Split Date Time: (yyyy-mm-dd hh:mm:ss) %DATE:~-4%-%DATE:~4,2%-%DATE:~7,2% %time:~0,2%:%time:~3,2%:%time:~6,2%
:: |   ==> echo Split Date Time: (yyyy-mm-dd hh:mm:ss) %date:~-4%-%date:~-10,2%-%date:~-7,2% %time:~-0,8%
:: |   --> echo Split Date Time: (yyyymmdd_hhmmsstt) %DATE:~-4%%DATE:~4,2%%DATE:~7,2%_%time:~0,2%%time:~3,2%%time:~6,2%%time:~9,2%
:: |       echo Split Date Time: (mmddyyyy_hhmmsstt) %DATE:~4,2%%DATE:~7,2%%DATE:~-4%_%time:~0,2%%time:~3,2%%time:~6,2%%time:~9,2%
:: |       echo Split Date: (yyyy-dd-mm) %date:~-4%-%date:~-7,2%-%date:~-10,2%
:: |       echo Split Date: (yyyymmdd) echo %date:~-4%%date:~-10,2%%date:~-7,2%
:: |       echo Split Time: (hh:mm:ss) %time:~-0,8% -OR- (hh:mm:ss.tt) %time:~-0,12% -OR- (mm:ss.tt) %time:~-8%
:: +-----------------------------------------------------------------------------------------------------------------------------+
:: +-----------------------------------------------------------------------------------------------------------------------------+
:: +----------------------------------------------------------------------------------------------+
:: | Passing a parameter to LogParser from DOS Batch use 3% e.g. WHERE Text LIKE %%%variable%%%   |
:: +----------------------------------------------------------------------------------------------+
:: +-----------------------------------------------------------------------------------------------------------------------------+
::-------------------------------------------------------------------------------------------------
:: +----------------------------------------------------------------------------------------------+
:: | Passing a parameter to LogParser from DOS Batch use 3% e.g. WHERE Text LIKE %%%variable%%%   |
:: +----------------------------------------------------------------------------------------------+
:: |   LogParser offers a wide variety of functions that you can use in your queries. Here are some of the key categories and examples of functions available:
:: |   Ref: https://documentation.help/Log-Parser/Functions.htm
:: |   -----------------------
:: |   Arithmetical Functions
:: |   -----------------------
:: |   ADD: Adds two numbers.
:: |   SUB: Subtracts one number from another.
:: |   MUL: Multiplies two numbers.
:: |   DIV: Divides one number by another.
:: |   MOD: Returns the remainder of a division.
:: |   ROUND: Rounds a number to the nearest integer.
:: |   FLOOR: Returns the largest integer less than or equal to a number.
:: |   ----------------------
:: |   Conversion Functions
:: |   ----------------------
:: |   TO_DATE: Converts a string to a date.
:: |   TO_TIME: Converts a string to a time.
:: |   TO_TIMESTAMP: Converts a string to a timestamp.
:: |   TO_STRING: Converts a value to a string.
:: |   TO_INT: Converts a value to an integer.
:: |   TO_REAL: Converts a value to a real number.
:: |   ------------------------------
:: |   String Manipulation Functions
:: |   ------------------------------
:: |   EXTRACT_EXTENSION: Extracts the file extension from a path.
:: |   EXTRACT_FILENAME: Extracts the file name from a path.
:: |   EXTRACT_PATH: Extracts the directory path from a full path.
:: |   SUBSTR: Extracts a substring from a string.
:: |   STRCAT: Concatenates two strings.
:: |   STRLEN: Returns the length of a string.
:: |   TO_LOWERCASE: Converts a string to lowercase.
:: |   TO_UPPERCASE: Converts a string to uppercase.
:: |   ------------------------------
:: |   System Information Functions
:: |   ------------------------------
:: |   SYSTEM_DATE: Returns the current system date.
:: |   SYSTEM_TIME: Returns the current system time.
:: |   SYSTEM_TIMESTAMP: Returns the current system timestamp.
:: |   COMPUTER_NAME: Returns the name of the computer.
:: |   ------------------------
:: |   Miscellaneous Functions
:: |   ------------------------
:: |   CASE: Evaluates a list of conditions and returns one of multiple possible result expressions.
:: |   COALESCE: Returns the first non-null value in a list of expressions.
:: |   HASHMD5_FILE: Computes the MD5 hash of a file.
:: |   SEQUENCE: Generates a sequence of numbers.
:: |   ------------------------------
:: |   These functions can be very powerful when combined in your LogParser queries to manipulate and analyze data effectively
:: +-----------------------------------------------------------------------------------------------------------------------------+
::-------------------------------------------------------------------------------------------------
:: +----------------------------------------------------------------------------------------------+
:: | Log Parser supports arithmetic operations like addition, subtraction, multiplication, and division. Here are some examples |
:: +----------------------------------------------------------------------------------------------+
:: |   *Calculate average response time:*
:: |   logparser "SELECT AVG(time-taken) AS AvgResponseTime FROM [your_log_file]"
:: |   *Find the total bytes transferred:*
:: |   logparser "SELECT SUM(bytes) AS TotalBytes FROM [your_log_file]"
:: |   *Calculate the difference between two timestamps:*
:: |   logparser "SELECT DATEDIFF(SECOND, time1, time2) AS TimeDiff FROM [your_log_file]"
:: |   *Calculate percentage of requests with a specific status code:*
:: |   logparser "SELECT COUNT(*) AS TotalRequests, COUNT(*) * 100.0 / SUM(COUNT(*)) OVER() AS Percentage FROM [your_log_file] WHERE status = 200"
::-------------------------------------------------------------------------------------------------
:: +----------------------------------------------------------------------------------------------+
:: | Below example is to compute calculate Size of a specific folder using -i:FS                  |
:: +----------------------------------------------------------------------------------------------+
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT PATH, NAME, SUM(Size) AS TotalSize FROM 'C:\$Data\OneDrive\Batch\*.*' GROUP BY PATH, NAME"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT PATH, NAME, DIV(TO_REAL(SUM(Size)), 1024) AS SizeKB FROM 'C:\$Data\OneDrive\Batch\*.*' GROUP BY PATH, NAME"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT PATH, NAME, DIV(TO_REAL(SUM(Size)), 1024) AS SizeKB, DIV(TO_REAL(SUM(Size)), 1048576) AS SizeMB, DIV(TO_REAL(SUM(Size)), 1073741824) AS SizeGB, DIV(TO_REAL(SUM(Size)), 1099511627776) AS SizeTB FROM 'C:\$Data\OneDrive\Batch\*.*' GROUP BY PATH, NAME"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT PATH, NAME, DIV(TO_REAL(SUM(Size)), 1024) AS SizeKB, DIV(TO_REAL(SUM(Size)), 1048576) AS SizeMB, DIV(TO_REAL(SUM(Size)), 1073741824) AS SizeGB, DIV(TO_REAL(SUM(Size)), 1099511627776) AS SizeTB FROM 'C:\$Data\OneDrive\Batch\*.*' GROUP BY PATH, NAME"
REM Step 1: Write to CSV
LogParser -i:FS -o:CSV "SELECT NAME, DIV(TO_REAL(SUM(Size)), 1024) AS SizeKB, DIV(TO_REAL(SUM(Size)), 1048576) AS SizeMB, DIV(TO_REAL(SUM(Size)), 1073741824) AS SizeGB, DIV(TO_REAL(SUM(Size)), 1099511627776) AS SizeTB INTO '%odl%\%ComputerName%_output.csv' FROM 'C:\$Data\OneDrive\Batch\*.*' GROUP BY PATH, NAME"
REM Step 2: Read from CSV
LogParser -i:CSV -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT NAME, SizeKB, SizeMB, SizeGB, SizeTB FROM '%odl%\%ComputerName%_output.csv'"
:: Below attempt to get Decimal places but has issues...
:: LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT PATH, NAME, DIV(CAST(TO_REAL(SUM(Size)) * 1000 AS INT), 1000) AS SizeKB, DIV(CAST(TO_REAL(SUM(Size)) * 1000 / 1048576 AS INT), 1000) AS SizeMB, DIV(CAST(TO_REAL(SUM(Size)) * 1000 / 1073741824 AS INT), 1000) AS SizeGB, DIV(CAST(TO_REAL(SUM(Size)) * 1000 / 1099511627776 AS INT), 1000) AS SizeTB FROM 'C:\$Data\OneDrive\Batch\*.*'"
:: Error: Syntax Error: argument of function DIV is not a valid <field-expr-list> 
:: ROUND(DIV(TO_REAL(SizeMB), 1048576), 3) AS sMB,  Error: SELECT clause: Semantic Error: function ROUND takes 1 argument
:: ROUND(TO_REAL(SUM(Size)) / 1048576, 2) AS SizeMB,  Error: Syntax Error: <function-expr>: cannot find closing parenthesis for function ROUND
:: ROUND(SUM(SizeMB)) / 1048576, 2) AS sMB,   Error: Syntax Error: <from-clause>: expecting FROM keyword instead of token '/'
:: DIV(CAST(TO_REAL(SizeMB) * 1000 / 1048576 AS INT), 1000) AS sMB, Error: Syntax Error: argument of function DIV is not a valid <field-expr-list>
WHERE Attributes NOT LIKE 'D%' AND Size >=10 
::-------------------------------------------------------------------------------------------------
:: +----------------------------------------------------------------------------------------------+
:: | Below example is to List Specific hive using -i:REG                                          |
:: +----------------------------------------------------------------------------------------------+
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,Value From \HKEY_LOCAL_MACHINE WHERE KeyName LIKE '%Bob - Personal%'" 3>&1 2>&1
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,Value From '\HKEY_CURRENT_USER\Village Inc.' " 3>&1 2>&1
::-------------------------------------------------------------------------------------------------
:: +----------------------------------------------------------------------------------------------+
:: | One Time SET up Environmental Variables to make this process easier using line commands...   |
:: | These use Environmental Variable to run a command... Parameters are optional                 |
:: +----------------------------------------------------------------------------------------------+
:: Add LastUpdated Key and Value to Registry:
:: SET LastUpdated="Last Updated: 18 Dec 2023 10:08 AM"
:: REG ADD "HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Explorer" /V LastUpdated /T REG_SZ /d %LastUpdated% /f
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V IISlogs /T REG_EXPAND_SZ /f /d "C:\inetpub\logs\LogFiles\W3SVC1"
REG ADD "HKEY_CURRENT_USER\Environment" /V IISlogs /T REG_EXPAND_SZ /f /d "C:\inetpub\logs\LogFiles\W3SVC1"
REG QUERY "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V IISlogs 2>&1
REG QUERY "HKEY_CURRENT_USER\Environment" /V IISlogs 2>&1
SETX IISlogs "C:\inetpub\logs\LogFiles\W3SVC1"
SETX /M IISlogs "C:\inetpub\logs\LogFiles\W3SVC1"
SET | Find /I "IISlogs"

:: Increase Default Log Parser buffer.
REG ADD "HKEY_LOCAL_MACHINE\Software\WOW6432Node\Microsoft\Log Parser" /V CSVInMaxRowSize /T REG_DWORD /d 393216
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V wlogs /T REG_SZ /f /d "C:\Windows\System32\winevt\Logs"
REG ADD "HKEY_CURRENT_User\Environment" /V wlogs /T REG_SZ /f /d "C:\Windows\System32\winevt\Logs"
REG QUERY "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V wlogs
REG QUERY "HKEY_CURRENT_User\Environment" /V wlogs
SETX wlogs "C:\Windows\System32\winevt\Logs"
SETX /M wlogs "C:\Windows\System32\winevt\Logs"
SET | Find /I "wlogs"

REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPdg /T REG_SZ /f /d "LogParser -rtp:-1 -o:datagrid"
REG ADD "HKEY_CURRENT_User\Environment" /V LPdg /T REG_SZ /f /d "LogParser -rtp:-1 -o:datagrid"
REG QUERY "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPdg
REG QUERY "HKEY_CURRENT_User\Environment" /V LPdg
SETX LPdg "LogParser -rtp:-1 -o:datagrid"
SETX /M LPdg "LogParser -rtp:-1 -o:datagrid"
SET | Find /I "LPdg"

REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPEc /T REG_SZ /f /d "LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
REG ADD "HKEY_CURRENT_User\Environment" /V LPEc /T REG_SZ /f /d "LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
REG QUERY "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPEc
REG QUERY "HKEY_CURRENT_User\Environment" /V LPEc
SETX LPEc "LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
SETX /M LPEc "LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
SET | Find /I "LPEc"

REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPWc /T REG_SZ /f /d "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
REG ADD "HKEY_CURRENT_User\Environment" /V LPWc /T REG_SZ /f /d "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
REG QUERY "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPWc
REG QUERY "HKEY_CURRENT_User\Environment" /V LPWc
SETX LPWc "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
SETX /M LPWc "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
SET | Find /I "LPWc"

:: Windows Logs
SET wlogs=C:\Windows\System32\winevt\Logs & Dir /B /O:N /S %wlogs% | Find /I "Security"
SET IISlogs="C:\inetpub\logs\LogFiles\W3SVC1" & Dir /B /O:N /S %IISLogs%
echo Log Settings: WindowsLogs=%wlogs% -AND- IISLogs=%IISLogs%
FROM '%IISLogs%\*.log'
:: +----------------------------------------------------------------------------------------------+
:: | Other LogParser Registry Variable Resources                                                  |
:: +----------------------------------------------------------------------------------------------+
REG ADD "HKEY_CURRENT_User\Environment" /V LogParser /T REG_SZ /f /d "C:\Program Files (x86)\Log Parser 2.2"
REG ADD "HKEY_CURRENT_User\Environment" /V LPdg /T REG_SZ /f /d "LogParser -rtp:-1 -o:datagrid"
REG ADD "HKEY_CURRENT_User\Environment" /V LPEc /T REG_SZ /f /d "LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
REG ADD "HKEY_CURRENT_User\Environment" /V LPWc /T REG_SZ /f /d "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LogParser /T REG_SZ /f /d "C:\Program Files (x86)\Log Parser 2.2"
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPdg /T REG_SZ /f /d "LogParser -rtp:-1 -o:datagrid"
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPEc /T REG_SZ /f /d "LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPWc /T REG_SZ /f /d "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
SETX /M LogParser"C:\Program Files (x86)\Log Parser 2.2"
SETX /M LPdg "LogParser -rtp:-1 -o:datagrid"
SETX /M LPEc "LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
SETX /M LPWc "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
SETX LogParser"C:\Program Files (x86)\Log Parser 2.2"
SETX LPdg "LogParser -rtp:-1 -o:datagrid"
SETX LPEc "LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
SETX LPWc "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
::------------------------------------------------------------------------------------------------------------------
::	To create the sample COM plug-in, copy the following code INTO a text file, and save that file AS "%Scripts%\Generic.LogParser .Scriptlet.sct" to your computer. (Note: The *.SCT file extension tells Windows that this is a scriptlet file.)The first thing that you should try is to simply retrieve data FROM your custom plug-in, and the following query should serve AS an example:
::	Charts: Error creating output format "CHART": This output format requires a licensed Microsoft Office Chart Web Component to be Installed on the local machine
::	Install: "N:\$Software\$Microsoft\Microsoft Office 2003 Add-in Office Web Components\owc11.exe"
::	https://download.cnet.com/Office-2003-Add-in-Office-Web-Components/3001-2070_4-10742090.html
:: Chart Types: Area3D Bar3D BarClustered3D Column3D DoughnutExploded Line3D Pie3D PieExploded3D RadarLineMarkers RadarSmoothLine RadarSmoothLineMarkers SmoothLine SmoothLineMarkers SmoothLineStackedMarkers
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
┌────────────────────────────────────────────────────────────────┐
│  LogParser Example to display specific events past 24 hours    │
└────────────────────────────────────────────────────────────────┘
lpsdt=echo List StartDTaps events for past 24 hours&&LogParser -i:EVT -stats:off -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, TO_INT(QUANTIZE(TimeGenerated, 300)) AS ToDay, EventID, ComputerName, Message FROM Application WHERE TimeGenerated >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 01:00', 'yyyy-MM-dd HH:mm') ) AND EventID BETWEEN 500 AND 599 ORDER BY Today"
:: TO_DATE(TimeGenerated)='%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00'
┌────────────────────────────────────────────────────────────────────────┐
│  Example using Powershell to find all System Windows Update issues.    │
└────────────────────────────────────────────────────────────────────────┘
Get-WinEvent -FilterHashTable @{LogName='System'; ProviderName='Microsoft-Windows-WindowsUpdateClient'; Level=@(1,2,3)} -ErrorAction SilentlyContinue
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
┌────────────────────────────────────────────────────────────────┐
│  LogParser enhansing and expanding Chart output experience     │
└────────────────────────────────────────────────────────────────┘
Page 328 Chapter 10 • Formatting, Reporting, and Charting
:: use configuration scripts to exert granular control over the appearance of your charting output.
:: In a two-dimensional graph, the horizontal axis is referred to as the x-axis, while the vertical axis is the y-axis.
:: NOTE: The rules for using the CHART output format are simple: All the fields in our query output records have to be numeric, with a single exception—the first field only can be a string field, in which case its values are used as the category (X-axis) labels displayed on the chart.
:: For example, the following script will modify the title, the font size used in the title, as well as the color scheme used by a chart.
' Last Updated: 12 Oct 2024 07:25 PM
Option Explicit
' Dim strMessage
' strMessage = "LogParser, VBS Script!"
' MsgBox strMessage
' Caption
chartSpace.HasChartSpaceTitle = true
chartSpace.ChartSpaceTitle.Caption = "Generated by Log Parser 2.2"
chartSpace.ChartSpaceTitle.Font.Size = 6
chartSpace.ChartSpaceTitle.Position = chartSpace.Constants.chTitlePositionBottom
' Background color
chart.PlotArea.Interior.Color = chartSpace.Constants.chColorNone

:: Create a file %OneDrive%\LP-Templates\LP-ChartScript.vbs
:: To use this script in LogParser, use: -config "%OneDrive%\LP-Templates\LP-ChartScript.vbs"

Page 330 Chapter 10 • Formatting, Reporting, and Charting Figure 10.8 Creating a Pie Chart
A Poor (Wo)Man’s Network Monitor
---Ch10ChartingPingTimes.sql---
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
┌────────────────────────────────────────────────────────────────┐
│  LogParser Example to display All Chart Types - Test Charts    │
└────────────────────────────────────────────────────────────────┘
:: SET out=%ohtm%\%ComputerName%_LogParser_Test-chartType.log&echo %Date% !Time! Output file:  %out% > %out% 2>&1
SETLOCAL enableExtensions enableDelayedExpansion
echo Below Test code loops through all LogParser Chart Types to demonstrate what they look like.
cmd /V:ON /K "SET out=%ohtm%\%ComputerName%_LogParser_Test-chartType.log&&echo %Date% !Time! [RC] cmd /V:ON /K SET out= !out! RC=%ErrorLevel%"
FOR /F "tokens=*" %i IN (%bats%\LogParserAllCHARTs.ini) DO (
    echo Processing LogParser -chartType:%i
    LogParser -i:FS -stats:on -q:Off -view:ON -o:CHART -groupSize:1024x768 -chartType:%i -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"File Extension Counts (Type:%i) %date:~-7,2%-%date:~-10,2%-%date:~-4%" "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as FilCts INTO "%ohtm%\%ComputerName%-FC_%1.gif" FROM 'C:\DCIM\*.*' WHERE Attributes NOT LIKE 'D%'GROUP BY Extension ORDER BY FilCts DESC" >>%out% 2>&1 &echo LogParser chartType:%i >>%out% 2>&1
)
echo Show LogParser Ststistics&&Notepad++ %out%
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
FOR /F "tokens=*" %i IN (%bats%\LogParserAllCHARTs.ini) DO echo Processing LogParser -chartType:%i >>%out% 2>&1 &Notepad++ %out%
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
FOR %i IN (
Area
Area3D
AreaOverlapped3D
AreaStacked
AreaStacked100
AreaStacked1003D
AreaStacked3D
Bar3D
BarClustered
BarClustered3D
BarStacked
BarStacked100
BarStacked1003D
BarStacked3D
Bubble
BubbleLine
Column3D
ColumnClustered
ColumnClustered3D
ColumnStacked
ColumnStacked100
ColumnStacked1003D
ColumnStacked3D
Doughnut
DoughnutExploded
Line
Line3D
LineMarkers
LineOverlapped3D
LineStacked
LineStacked100
LineStacked1003D
LineStacked100Markers
LineStacked3D
LineStackedMarkers
Pie
Pie3D
PieExploded
PieExploded3D
PieStacked
PolarLine
PolarLineMarkers
PolarMarkers
PolarSmoothLine
PolarSmoothLineMarkers
RadarLine
RadarLineFilled
RadarLineMarkers
RadarSmoothLine
RadarSmoothLineMarkers
ScatterLine
ScatterLineFilled
ScatterLineMarkers
ScatterMarkers
ScatterSmoothLine
ScatterSmoothLineMarkers
SmoothLine
SmoothLineMarkers
SmoothLineStacked
SmoothLineStacked100
SmoothLineStacked100Markers
SmoothLineStackedMarkers
StockHLC
StockOHLC
) DO (
echo **-chartType:%i***&LogParser -i:FS -view:ON -o:CHART -groupSize:1024x768 -chartType:%i -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"File Extension Counts (Type:%i) %date:~-7,2%-%date:~-10,2%-%date:~-4%" "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as FilCts INTO "%ohtm%\%ComputerName%-FC_%1.gif" FROM 'C:\DCIM\*.*' WHERE Attributes NOT LIKE 'D%'GROUP BY Extension ORDER BY FilCts DESC"&echo LogParser -chartType:%i [RC]=%ErrorLevel%
)
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as FilCts FROM 'C:\Garmin\*.*' WHERE Attributes NOT LIKE 'D%'GROUP BY Extension ORDER BY FilCts DESC"
:: Select Specific file extensions using IN(list)... WHERE Extension IN ()
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Test
LogParser -i:FS -stats:on -q:Off -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"File Extension Counts (Type:Bar3D) %date:~-7,2%-%date:~-10,2%-%date:~-4%" "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as FilCts INTO "%ohtm%\%ComputerName%-FC_%1.gif" FROM 'C:\inetpub\wwwroot\*.*' WHERE Attributes NOT LIKE 'D%'GROUP BY Extension ORDER BY FilCts DESC"
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  Using Find or LogParser to search for Common Log Keywords                                              │
│  Below is a good example using Text to search log files for most Common Log Keywords:                   │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────┘
SET "LPlog=%OneDrive%\About*.*"
SET "LPlog=%OneDrive%\AboutMe_Combined.txt"
LogParser -i:TEXTLINE  -stats:on -q:off -rtp:-1 -o:datagrid -iCodepage:0 -splitLongLines:ON -Recurse:-1 -E:-1 "SELECT TOP 500 LogFileName, Text FROM '%LPlog%' WHERE Text LIKE '%error%' OR Text LIKE '%warning%' OR Text LIKE '%critical%' OR Text LIKE '%info%' OR Text LIKE '%debug%' OR Text LIKE '%failed%' OR Text LIKE '%success%' OR Text LIKE '%Exception%' OR Text LIKE '%fatal%' OR Text LIKE '%Connection%' OR Text LIKE '%Timeout%' OR Text LIKE '%[Access Denied]%'"
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  Sysstate Eventids                                                                                      │
│  These event IDs help track system changes, security extensions, and other critical system activities.  │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────┘
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS EventTime, EventID, ComputerName, Message, Data FROM Application,Security,System WHERE EventID IN (4;8;16;4608;4609;4616;4610;4611;4614;4622;4697) ORDER BY EventTime, EventID DESC"

Event ID 4: Indicates the backup operation has started.
Event ID 8: Indicates the backup operation has completed successfully.
Event ID 16: Indicates a backup error occurred.
Event ID 4608: Windows is starting up
Event ID 4609: Windows is shutting down
Event ID 4616: The system time was changed
Event ID 4610: An authentication package has been loaded by the Local Security Authority
Event ID 4611: A trusted logon process has been registered with the Local Security Authority
Event ID 4614: A notification package has been loaded by the Security Account Manager
Event ID 4622: A security package has been loaded by the Local Security Authority
Event ID 4697: A service was installed in the system
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
┌──────────────────────────────────────────────────────────────────────────────────────┐
│   Complex Command to Find Character and Replace using Index, SubStr and Replace_str  │
│   See Snort example using this statement and script:  ---Ch05RulesBySID.sql---       │
└──────────────────────────────────────────────────────────────────────────────────────┘
:: Breakdown logparser command step by step: REPLACE_STR(REPLACE_CHR(SUBSTR(Name,ADD(INDEX_OF(Name,'('),1),LAST_INDEX_OF(Name,')')),':','='),'; ','&') AS Name,
INDEX_OF(Name, '('):
::This function finds the position of the first occurrence of the character '(' in the Name field.
ADD(INDEX_OF(Name, '('), 1):
::This adds 1 to the position found in the previous step, effectively moving the starting point to the character immediately after '('.
LAST_INDEX_OF(Name, ')'):
::This function finds the position of the last occurrence of the character ')' in the Name field.
SUBSTR(Name, ADD(INDEX_OF(Name, '('), 1), LAST_INDEX_OF(Name, ')')):
::This extracts a substring from the Name field, starting just after '(' and ending at the last ')'.
REPLACE_CHR(SUBSTR(Name, ADD(INDEX_OF(Name, '('), 1), LAST_INDEX_OF(Name, ')')), ':', '='):
::This replaces all occurrences of the character ':' with '=' in the extracted substring.
REPLACE_STR(REPLACE_CHR(SUBSTR(Name, ADD(INDEX_OF(Name, '('), 1), LAST_INDEX_OF(Name, ')')), ':', '='), '; ', '&'):
::This further replaces all occurrences of the string '; ' with '&' in the result from the previous step.
AS Name:
::This assigns the final transformed string to a new field named Name. In summary, this command extracts a portion of the Name field between parentheses, replaces colons with equals signs, and replaces semicolon-space sequences with ampersands. The result is then assigned to a new field named Name.
---Ch05RulesBySID.sql--- See Page 160 Chapter 5 • Managing Snort Alerts
SELECT DISTINCT
TO_INT(EXTRACT_VALUE(Params, 'sid')) AS SID,
Rule
USING
Field1 AS Rule,
REPLACE_STR(REPLACE_CHR(SUBSTR(Rule,ADD(INDEX_OF(Rule,'('),1),LAST_INDEX_OF(Rule,')')),':','='),'; ','&') AS Params,
INTO all.rules
FROM *.rules
ORDER BY SID
---Ch05RulesBySID.sql---
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: ---Ch11Exclude.sql--- There are fifteen fields in the Event Logs; seventeen if the select statement is written with the * symbol. Select clause is built by slicing and dicing the Message field:  Log Parser has condensed the log to just the data for the cleanup process, making it much faster to review
:: NOTE: STRCAT(TO_STRING(SUB(StartItems, EndItems)), ' items were deleted clearing '  <--> Change accordingly to particular events.....
LogParser -i:evt -o:datagrid -rtp:50 -autoscroll:off "SELECT TimeGenerated, STRCAT(cat1, cat2) AS Solution USING INDEX_OF(Message, ' For more information, ') AS Exclude, SUBSTR(Message, 0, Exclude) AS myMessage, SUBSTR(myMessage, INDEX_OF(myMessage, 'Start: ')) AS CutHere, SUBSTR(CutHere, 0, INDEX_OF(CutHere, 'End: ')) AS part1, SUBSTR(CutHere, INDEX_OF(CutHere, 'End: ')) AS part2, TO_INT(EXTRACT_TOKEN(part1, 1, ' ')) AS StartItems, TO_INT(EXTRACT_TOKEN(part1, 3, ' ')) AS StartBytes, TO_INT(EXTRACT_TOKEN(part2, 1, ' ')) AS EndItems, TO_INT(EXTRACT_TOKEN(part2, 3, ' ')) AS EndBytes, STRCAT(TO_STRING(SUB(StartItems, EndItems)), ' items were deleted clearing ' ) AS cat1, STRCAT(TO_STRING(SUB(StartBytes, EndBytes)), 'Kb') AS cat2 FROM APPLICATION WHERE EventID IN (4004;4042;4960;4976;4977;4978;5480;5483;5484;7485;6273;6374;6275;6276;6277;6278;6279;6280;5031;5032;5140;5479;5632;5633)"
:: ---Ch11Exclude.sql---
:: Below is the same as above but using * for all fields
LogParser -i:evt -o:datagrid -rtp:50 -autoscroll:off "SELECT * FROM APPLICATION WHERE EventID IN (4004;4042;4960;4976;4977;4978;5480;5483;5484;7485;6273;6374;6275;6276;6277;6278;6279;6280;5031;5032;5140;5479;5632;5633)"
:: Results from Query:
Application	998	2023-12-08 17:05:04	2023-12-08 17:05:04	4004	4	Information event	0	None	Wlclntfy	NULL	DESKTOP-G6IQV3L	NULL	The Windows logon process has failed to terminate the currently logged on user's processes. 	E303000003201104
Application	5023	2023-12-18 12:47:05	2023-12-18 12:47:05	4004	4	Information event	0	None	Wlclntfy	NULL	X570	NULL	The Windows logon process has failed to terminate the currently logged on user's processes. 	E303000001200100
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/* We only want to retrieve event logs whose type name contains 'service' */
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName AS TypeName, COUNT(*) AS TotalCount FROM System WHERE TypeName LIKE '%service%' GROUP BY TypeName HAVING TotalCount > 5 ORDER BY TotalCount DESC"
:: Error: SELECT clause: Syntax Error: unknown field 'TypeName'. The closest match for input format 'EVT' is 'EventTypeName'.
echo %Date% !Time! [MSG] --- Ch03ExcludeBenignEvents.sql ---&&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime,EventId AS ID,sourcename AS Name,Message INTO '%ohtm%\%ComputerName%_sysenv.xml' FROM system WHERE sourcename NOT IN ('Print';'MRxSmb';'w32time';'TermServDevices')"

echo %Date% !Time! [MSG] --- Ch03SingleVsMltplEvents.sql ---&&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventId AS ID,count(*) AS number_of_events FROM system WHERE SUB(to_int(TimeGenerated), to_int(system_timestamp())) < -2592000 GROUP BY ID ORDER BY number_of_events desc"
:: Auditing for System Startups
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, message AS Message FROM system WHERE eventid= '6005'"
:: Auditing for Unexpected Shutdowns
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, message AS Message FROM system WHERE eventid= '6008'"
:: Trending System Startups file:Ch03TrendingSystemStartups.sql
LogParser -i:EVT -o:CHART -groupSize:1024x768 -chartType:column3d -legend:AUTO -values:AUTO -categories:AUTO -chartTitle "Number of Netlogon Failures" -view:ON "SELECT quantize(TimeGenerated, 3600) AS Time, Count(*) AS [Number_of_Events] INTO '%odl%\%ComputerName%_Startup.gif' FROM system WHERE EventID= '6005' GROUP BY Time ORDER BY [Number_of_Events]"
:: Below Check all Successful and Unsuccessful Logon and Logoff Events registered today
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT resolve_sid(sid) AS UserName, eventid, TimeGenerated, message, strings FROM Security WHERE EventID IN (528;4624;4625;4625) AND to_date(TimeGenerated)='%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00' AND sid not in ( SELECT DISTINCT sid FROM Security WHERE EventID IN (538;4800;4801;4802) AND TO_DATE(TimeGenerated)='%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00')"
:: Windows 11 Pro Logon and Logoff Event IDs:
:: Event ID 4624: Logs successful logon attempts.
:: Event ID 4625: Logs failed logon attempts.
:: Logoff Event IDs:
:: Event ID 4800: Logs successful logoff attempts.
:: Event ID 4801: Logs failed logoff attempts.
:: Event ID 4802: Logs screensaver invocation
:: Unsuccessful Logon Event IDs:
:: Event ID 4625: Logs unsuccessful logon attempts, such as incorrect passwords or user account lockouts
:: Unsuccessful Logoff Event IDs:
:: Event ID 4801: Logs failed logoff attempts
:: echo Test All Fields Logon Logoff Events&&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (528;4624;4625;4625) AND to_date(TimeGenerated)='%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00' AND sid not in ( SELECT DISTINCT sid FROM Security WHERE EventID IN (538;4800;4801;4802) AND TO_DATE(TimeGenerated)='%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00')"
:: Auditing for Dr. Watson Errors
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, extract_token(strings, 0, '|') AS Program FROM system where sourcename= 'DrWatson'"
:: Generating a Useful System Error Report  file:Ch03SystemErrorReport.sql
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName AS Name, EventId AS ID, count(*) AS number_of_events FROM system WHERE SUB(to_int(TimeGenerated), to_int(system_timestamp())) > -2592000 AND sourcename not in ('Print'; 'MRxSmb'; 'w32time'; 'TermServDevices') GROUP BY ID, Name HAVING number_of_events > 1 ORDER BY number_of_events desc"
:: Finding Events From a Specific Application  ---Ch03SpecificApplicationEvents.sql ---
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SourceName AS AppName FROM application ORDER BY AppName ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Time, EventTypeName AS Event, SourceName AS Application FROM application WHERE Application like '%W10Start%'"
:: Identifying Served Application Login Failures --- Ch03ServedApplicationLoginFailures.sql ---
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Time, EventTypeName AS Event, SourceName AS Application FROM application WHERE Application like 'vmauthd failure' AND event like 'error event'"
:: Identifying Served Application Security Failures --- Ch03ServedApplicationSecurityFailures.sql ---
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Time, EventTypeName AS Event, SourceName AS Application FROM application WHERE Application like 'ipsec-violation' AND event like 'error event'"
:: Page 130 Chapter 4 • Examining Network Traffic and Performance Logs with Log Parser
:: Getting Started with Log Parser's Netmon Format - NOTE: Netmon is NO LONGER SUPPORTED...
:: ---Ch04TCPConn.sql---       ---Ch04TCPIP.sql--- file:Ch04TCPConn.sql?filename=FOO.cap   %filename%
:: Replace NetMon with WireShark Command: "C:\Program Files\Wireshark\dumpcap.exe" -i Wi-Fi -f "tcp" -w %odl%\%ComputerName%_WireSharkWi-FiOutput.pcap
"C:\Program Files\Wireshark\dumpcap.exe" -D
"C:\Program Files\Wireshark\dumpcap.exe" -i 1 -f "tcp" -w %odl%\%ComputerName%_WireSharkOutput.pcap

:: "C:\Program Files\Wireshark\Wireshark.exe"
logparser -fmode:TCPConn "SELECT SrcIP, DstIP, DstPort, Payload FROM FOO.cap WHERE DstPort = 80 OR SrcPort = 80"
logparser -fmode:TCPConn "SELECT TimeTaken, SrcPayload, DstPayload FROM FOO.cap WHERE DstPayload like '%UseMethodX%' ORDER BY SrcPayload"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_DATE(TimeGenerated), TO_UPPERCASE( EXTRACT_TOKEN(EventTypeName, 0, ' ') ) AS EventTypeName, SourceName FROM System WHERE EventTypeName LIKE '%Error%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_DATE(TimeGenerated) AS DateGenerated, TO_UPPERCASE( EXTRACT_TOKEN(EventTypeName, 0, ' ') ) AS TypeName, SourceName FROM System WHERE EventTypeName LIKE '%Error%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT to_date(TimeGenerated) AS Date, quantize(to_time(TimeGenerated), 3600) AS Hour, Count(*) AS Number_of_Events FROM Security WHERE EventType IN (528;4624;538;4634;4647;538;4649;4624;4634;4647) AND date='2024-05-19 00:00:00' GROUP BY date, hour"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
EventID IN (1069;1207;1050;1051;1052;1211)"
EventID IN (100;104;106;202;204)"
EventID IN (1102;4616;1108)"
BETWEEN 500 AND 599"
EventID IN (4618;4649;4719;612;4765;4766;4794;4897;801;4964;5124;550;1102;517)"
echo View Network Events& LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Application,Security,System WHERE EventID IN (4004;4042;4960;4976;4977;4978;5480;5483;5484;7485;6273;6374;6275;6276;6277;6278;6279;6280;5031;5032;5140;5479;5632;5633)"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: List All eventlogs:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT SourceName, EventID, PROPCOUNT(*) FROM System GROUP BY SourceName, EventID"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT DISTINCT SourceName AS Provider FROM System ORDER BY Provider"
LogParser -i:EVT -stats:on -q:on -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS LogonTime,extract_token(strings, 0, '|') AS UserName FROM Security WHERE EventID IN (529;530;531;532;533;534;535;537;539) AND to_string(TimeGenerated,'yyyy-MM-dd HH:mm:ss') like '%2023%'"
:: LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COMPUTER_NAME() as ThisMchine, TimeGenerated AS Time, SUM(4,5) FROM System" <- Error: Syntax Error: <sqlfunction-expr>: no matching closing parenthesis
PushD %OneDrive%  -- Then PopD
Setlocal
PushD &cd \ &  cd "%SystemRoot%\System32\Winevt\Logs" &SET lfh='Microsoft-Windows-FileHistory-Engine%4BackupLog.evtx'
dir "Microsoft-Windows-FileHistory-Engine*.*"  :: &dir &pause &PopD
IF EXIST %lfh% (Echo Microsoft-Windows-FileHistory-Engine exists for: %lfh%) ELSE Echo Microsoft-Windows-FileHistory-Engine missing for: %lfh%
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS Date, EventID, message AS Message FROM System WHERE EventID IN (100;104;106;202;204) ORDER BY Date, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EventID, ComputerName, Message, Data FROM Application, Security, System WHERE EventID IN (100;104;106;202;204) ORDER BY EventTime, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS taskname, EXTRACT_TOKEN(Strings, 1, '|') AS User FROM 'Microsoft-Windows-FileHistory-Engine%4BackupLog.evtx' WHERE EventID = 204"
:: +---------------------------------------------------------------------------+
:: | EVT and IIS example skeletons for IISW3C HTML and Charts                  |
:: +---------------------------------------------------------------------------+
echo Chart Skeleton:&LogParser -i:xxx -view:ON -o:CHART -groupSize:1024x768 -chartType:??? -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% LogParser Chart Examples" "SELECT....  INTO '%ohtm%\%ComputerName%_Chart.gif' ..."
echo Chart Skeleton:&LogParser -i:xxx -view:ON -o:CHART -groupSize:1024x768 -chartTypeBar3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Bar3D  " -Recurse:-1 -E:-1 "SELECT...."
echo Chart IIS Skeleton:&LogParser -i:IISW3C -stats:on -q:off -E:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:ColumnClustered -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% " -Recurse:-1 "SELECT ... INTO '%ohtm%\%ComputerName%_Name.gif' FROM '%IISLogs%\*.log' ..."
echo Chart EVT Skeleton:&LogParser -i:EVT -stats:on -q:off -E:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName%  Name" "SELECT ... INTO '%ohtm%\%ComputerName%_Name.gif' FROM System ...."
echo Skel HTML EVT Skeleton:&LogParser -i:EVT -stats:on -q:off -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-EventUptime.tpl" "SELECT .... INTO '%ohtm%\%ComputerName%_DiskUsageReport.html' FROM System ...."&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_MyReport.html"

for /f "delims=" %a in ('Dir /B "%OneDrive%\LP-Templates\*.tpl"') do set "tpl=%~na%~xa"&&echo %Date% !Time! [MSG] File found: %tpl%
logparser.exe "echo Chart Skeleton:&LogParser -i:xxx -view:ON -o:CHART -groupSize:1024x768 -chartType:PieExploded -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% LogParser Chart Examples" "Processes.GIF FROM Win32_Process GROUP BY Name ORDER BY Percent DESC" -i:COM -
iProgID:LP_Toolkit.WMIQuery
-chartType:PieExploded -View -ChartTitle:"Percent Memory Used"
-categories:off
DIR /S /B C:\$Data\*WMIQuery*.*
Copy /A /V /Y "%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 09\Building Input Processors\LP_Toolkit\*.*" "%OneDrive%\Scripts\VBA"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌────────────────────────────────────────┐
│  LogParser - Using Templates           │
└────────────────────────────────────────┘
:: Ref: Formatting, Reporting, and Charting • Chapter 10 317
:: Implementing templates is a two-step process: first you need to create the Log Parser query as usual, but you must also create the template file that will dictate how the output will be formatted. So the Log Parser syntax for creating template file output will look like the following: Needs Work!
:: ---Ch10CreateTemplateOutput.sql---
:: LogParser –i:W3C –o:TPL –tpl:"%OneDrive%\LP-Templates\%ComputerName%_IISLogMyTest.txt" "SELECT * FROM '%IISLogs%\u_ex240812.log' TO '%OneDrive%\LP-Templates\%ComputerName%_IISLogTest.tpl'"
:: ---Ch10CreateTemplateOutput.sql---
:: NotePad++  "%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 10\Ch10CreateTemplateOutput.sql"
:: List all IIS Log Files: file: CreateTemplateOutput.sql
SET IISlogs="C:\inetpub\logs\LogFiles\W3SVC1" & Dir /B /O:N /S %IISLogs%
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────┐
│  Using for loop, search for a specific value in a hive          │
└─────────────────────────────────────────────────────────────────┘
┌────────────────────────────────────────────────┐
│ Names of Registry Hives.                       |
|  Computer\HKEY_CLASSES_ROOT                    |
|  Computer\HKEY_CURRENT_USER                    |
|  Computer\HKEY_LOCAL_MACHINE                   |
|  Computer\HKEY_USERS                           |
|  Computer\HKEY_CURRENT_CONFIG                  |
└────────────────────────────────────────────────┘
:: HKEY_LOCAL_MACHINE key has The following subkeys: HARDWARE, SAM, SECURITY, SOFTWARE, and SYSTEM.
:: Note: Create a FOR Loop to loop through all Hives in search of the holy grail...
SET myKey=License&echo %Date% !Time! [MSG] Scan Registry for key: %myKey%
SET myKey=\\Surf5\surf5_c$\Program&echo %Date% !Time! [MSG] Scan Registry for key: %myKey%
SET msg=%Date% !Time! [MSG] --------------------------------------------------------------------------
SET "log= "&&SET "log=%ohtm%\%ComputerName%_LogParser_%myKey%.log" && echo %Date% !Time! [MSG] LogParser Log File: %log% && echo %Date% !Time! [MSG] LogParser Log File: %log% >>%log%
echo %msg% & echo %msg% >>%log%
echo %Date% !Time! [MSG] Scan Registry for key: %myKey% >>%log%
SET prc=%Date% !Time! [PRC] Processing Registry Hive: %i - For: %myKey%
echo %msg% & echo %msg% >>%log%
SET cmd=LogParser -i:REG -o:CSV -stats:On -recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,Value INTO %ohtm%\%ComputerName%_%i.csv From \%i WHERE KeyName LIKE '%%myKey%%'" 3>&1 2>&1
SET exe=%Date% !Time! [CMD] Executing Command: %cmd%
FOR /D %i IN (
HKEY_CLASSES_ROOT
HKEY_CURRENT_USER
HKEY_LOCAL_MACHINE
HKEY_USERS
HKEY_CURRENT_CONFIG
) DO (
echo
echo %prc% & echo %prc% >>%log%
echo %exe% & echo %exe% >>%log%
%cmd% 3>&1 2>&1 >>%log%
echo %msg% & echo %msg% >>%log%
)
Dir /B %ohtm%\%ComputerName%_HKEY*.csv
:: Merge Files into 1 document, sort
cd %odl%
IF EXIST %ComputerName%_HKEY_Merged.csv (Del %ComputerName%_HKEY_Merged.csv&echo %Date% !Time! [RC] File Deleted RC=%ErrorLevel%)
COPY %ComputerName%_HKEY*.csv %ComputerName%_HKEY_Merged.csv&echo %Date% !Time! [RC] Append Copy/Merge RC=%ErrorLevel%
|Sort /+1 %ComputerName%_HKEY_Merged.csv&Notepad++ %ComputerName%_HKEY_Merged.csv
:: Manual Search: e.g. Error opening Settings -> Apps -> Startup -> See We couldn't find this app! (Delete these issues)
SET "myKey="&&SET "myKey=Surf5\surf5_c$"&&echo %Date% !Time! [MSG] Scan Registry for key: %myKey%
LogParser -i:REG -o:CSV -stats:On -recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,Value From '\HKEY_LOCAL_MACHINE' WHERE KeyName LIKE '%%myKey%%'"
LogParser -i:REG -o:CSV -stats:On -recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,Value From '\HKEY_CURRENT_USER' WHERE KeyName LIKE '%%myKey%%'"
LogParser -i:REG -o:CSV -stats:On -recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,Value From '\HKEY_USERS' WHERE KeyName LIKE '%%myKey%%'"
:: 
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,Value From \HKEY_LOCAL_MACHINE WHERE KeyName LIKE '%Bob - Personal%'" 3>&1 2>&1
:: Below will count all The Value Types in The hive
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT ValueType, Count(*) From \HKLM\software\microsoft\windows\currentversion GROUP BY ValueType"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT * From \HKCU\SOFTWARE\Microsoft\Office\16.0\Outlook ORDER BY Path"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT * From \HKLM\HARDWARE\DESCRIPTION\System ORDER BY Path"
RecursiveRegKey -ComputerName $(hostname) -RegPath "HARDWARE\DESCRIPTION"

Most of The supporting Files for The hives are in The %SystemRoot%\System32\Config directory.
When The application is Installed it should record The computer-specific data under The HKEY_LOCAL_MACHINE key.
In particular it should create keys for The company name product name and version number as shown in The following example:
    HKEY_LOCAL_MACHINE\Software\MyCompany\MyProduct\1.0
If The application supports COM it should record that data under HKEY_LOCAL_MACHINE\Software\Classes.
An application should record user-specific data under The HKEY_CURRENT_USER key as shown in The following example:
    HKEY_CURRENT_USER\Software\MyCompany\MyProduct\1.0
Most of The supporting Files for The hives are in The %SystemRoot%\System32\Config directory.
;denotes a comment
;This will delete The key below because of The - sign
;\[-HKEY_LOCAL_MACHINE\SOFTWARE\SavillTech\key\]
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Below Example: Search through Registry HIVES to locate a value and write that to output file.
SET regv="English Dictionary - Offline"
SET regv="EnglishDictionaryOffline"

:: NOTE: Below search is SLOW as it has to go through The whole hive...
REG QUERY "HKEY_LOCAL_MACHINE" /s /f %regv% >"%ohtm%\%ComputerName%_HKLM_%date:~-4%%date:~-10,2%%date:~-7,2%.reg"
REG QUERY "HKEY_CLASSES_ROOT" /s /f %regv% >"%ohtm%\%ComputerName%_HKCR_%date:~-4%%date:~-10,2%%date:~-7,2%.reg"
REG QUERY "HKEY_CURRENT_USER" /s /f %regv% >"%ohtm%\%ComputerName%_HKCU_%date:~-4%%date:~-10,2%%date:~-7,2%.reg"
REG QUERY "HKEY_LOCAL_MACHINE" /s /f %regv% >"%ohtm%\%ComputerName%_HKLM_%date:~-4%%date:~-10,2%%date:~-7,2%.reg"
REG QUERY "HKEY_USERS" /s /f %regv% >"%ohtm%\%ComputerName%_HKU_%date:~-4%%date:~-10,2%%date:~-7,2%.reg"
REG QUERY "HKEY_CURRENT_CONFIG" /s /f %regv% >"%ohtm%\%ComputerName%_HKCC_%date:~-4%%date:~-10,2%%date:~-7,2%.reg"
Dir >"%ohtm%\%ComputerName%_HK*"

REG FLAGS HKEY_LOCAL_MACHINE\SOFTWARE\Pinnacle QUERY
REG FLAGS HKEY_LOCAL_MACHINE\SOFTWARE\Windows QUERY
:: Use WMIC or WUSA to uninstall product:
WMIC product where name=%regv% call uninstall
wusa.exe <Example.msu> /quiet /noRestart​­
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Run and RunOnce Registry Keys. Run and RunOnce registry keys cause programs to run each time that a user logs on.
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce
:: Correct way to Add OneDrive To Startup - Open Startup Folder: Press Windows Key + R, type shell:startup
REG DELETE "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /V OneDrive /f
REG ADD "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /V OneDrive /T REG_EXPAND_SZ /F /D "C:\Program Files\Microsoft OneDrive\OneDrive.exe /background" 
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value FROM '\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run'"
::----
:: Cleanup Some Obsolete apps from here: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\BCClipboard
REG QUERY "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v BCClipboard
REG DELETE "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v BCClipboard /f
REG QUERY "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v BingSvc
REG DELETE "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v BingSvc /f
:: also search Registry Recursivly for this bad entry:: \\Surf5\surf5_c$\Program" files\Microsoft OneDrive\OneDrive.exe
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,Value FROM \HKEY_CURRENT_USER\Environment ORDER BY Value,ValueName" :: WHERE KeyName LIKE '%..%' OR ValueName LIKE '%..%' OR Value LIKE '%..%'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -I
 -STATS:On -RTP:-1 -O:Datagrid -Recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,Value FROM \HKEY_... WHERE KeyName LIKE '%...%'"
:: MOVEit Transfer Critical Vulnerability (May 2023) (CVE-2023-34362)
W11 22H2 CVE-2023-32019 CVE-2023-34362 - LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,Value FROM \HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Policies\Microsoft\FeatureManagement\Overrides"
 WHERE KeyName LIKE '%Microsoft-Windows%'"
:: Check for  DWORD name: 4237806220 Value data: 1
┌─────────────────────────────────────────────────────────────────┐
│  Using for loop, search for a Specific value Netflix in a hive  │
└─────────────────────────────────────────────────────────────────┘
:: SET myKey=Netflix&echo %Date% !Time! [MSG] Scan Registry for key: %myKey%
:: SET myKey=Norton&echo %Date% !Time! [MSG] Log File: %log%

SET myKey=GeoPhoto&echo %Date% !Time! [MSG] Log File: %log%
SET log=%ohtm%\%ComputerName%_%myKey%.log
SET cmd=LogParser -i:REG -o:CSV -stats:On -recurse:-1 -E:-19 "SELECT Path,KeyName,ValueName,Value INTO %ohtm%\%ComputerName%_%i.csv FROM \%i WHERE KeyName LIKE '%%myKey%%'"
SET msg=[MSG] --------------------------------------------------------------------------
SET exe=[EXE] %cmd%
echo %Date% !Time! [CMD] %cmd% >>%log%
FOR /D %i IN (
HKEY_CLASSES_ROOT
HKEY_CURRENT_USER
HKEY_LOCAL_MACHINE
HKEY_USERS
HKEY_CURRENT_CONFIG
) DO (
echo %Date% !Time! [MSG] Processing Registry Hive: %i
echo %Date% !Time! %exe% & echo %Date% !Time! %exe% >>%log%
%cmd% 2>&1 >>%log%
echo %Date% !Time! %msg% & echo %Date% !Time! %msg% >>%log%
)
Dir %ohtm%\%ComputerName%_HKEY_*.csv
NotePad++ %log%
:: NOTE: The %log% file splits the output on col 78. To fix and join the lines back together do the following:
Open Notepad++. > Select the lines you need to join >  Press Ctrl+H to open the "Replace" dialog box.
In the "Find what" field, enter (.\{78\})\r\n (this represents a line of exactly 78 characters followed by a line break).
In the "Replace with" field, enter \1 (this represents the matched line without the line break).
In the "Search Mode" at the bottom, select "Regular expression".
Click on "Replace All".
This will join lines that were split at column 78.
Microsoft-Windows-AppxPackagingOM

::LogParser -i:REG -o:CSV -stats:On -recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,Value INTO %ohtm%\%ComputerName%_%%i.csv FROM \%%i WHERE KeyName LIKE '%%myKey%%'" 3>&1 2>&1 >>%log%

https://support.microsoft.com/en-us/topic/how-to-add-modify-or-delete-registry-subkeys-and-values-by-using-a-reg-file-9c7f37cf-a5e9-e1cd-c4fa-2a26218a1a23
regini to grant full control permission to a registry hive: HKEY_LOCAL_MACHINE\Software\MyApp [1 5 7 11] "Full Control"
regini [-m \\machinename | -h hivefile hiveroot][-i n] [-o outputwidth][-b] textFiles..
REG DELETE <KeyName> [{/v ValueName | /ve | /va}] [/f]
REG DELETE HKLM\Software\HowToGeekSubkey
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Using LogParser and FINDSTR multiple search fields using a single command
sc query type= service|FindStr /I /C:"SERVICE_NAME:" /C:"DISPLAY_NAME:" /C:"STATE"
:: To find multiple strings use CMD with LogParser...
sc query type= service | LogParser -i:TSV -nSkipLines:1 -iSeparator:space -fixedSep:OFF -nSep:1 -headerROFF -rtp:-1 -o:datagrid "SELECT Field1 AS NameType, Field2 AS Description FROM STDIN WHERE Field1 LIKE '%SERVICE_NAME:%' OR Field1 LIKE '%DISPLAY_NAME:%' OR Field1 LI'%state%'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
┌──────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ Using LogParser and Dos Command to crete an html web page.                                               │
│ Some examples using -rtp:-1 -o:datagrid  AND -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-DiskUsage3.tpl"     │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────┘
Table 10.9 Wildcard Values for Template Output
Tag Example Substitution Can Be Used In:
%FIELDS_NUM% This query contains Number of fields in Header, Body, Footer
%FIELDS_NUM% the SELECT clause.
fields.
%FIELD_<N>% First field value: Value of the Body
%FIELD_1% specified field.
%<field name>% First field value: Value of the Body
%cs-bytes% specified field.
%FIELDNAME_ %FIELDNAME_1% Name of the Header, Body, Footer
<N>% value: %FIELD_1% specified field
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: -i:FS Count Specific Files... - Path, Name, Size, Attributes, CreationTime, LastAccessTime, LastWriteTime, FileVersion, ProductVersion, InternalName, ProductName, CompanyName, LegalCopyright, LegalTrademarks, PrivateBuild, SpecialBuild, Comments, FileDescription, OriginalFilename, HASHMD5_FILE(Path) AS Hash INTO "%ohtm%\%ComputerName%_MRFiles.log"
echo PS Lists all Full Paths of Files found:&& Get-ChildItem -Path 'C:\$Data' -File -Recurse -Include *.js, *.7z, *.rar, *.cab, *.zip | Select-Object FullName| Out-GridView -Title "CompressedFiles" -OutputMode Multiple
echo Count Extensions DataGrid Report on ALL File Types in C:\$Data&&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Ext, COUNT(*) as Files FROM 'C:\$Data\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Ext ORDER BY Files DESC"
echo Count Specific Compressed File Extensions in Folder&&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Ext, COUNT(*) as Files FROM 'C:\$Data\*.*' WHERE Attributes NOT LIKE 'D%' AND Ext LIKE '%.js%' OR Ext LIKE '%.zip%' OR Ext LIKE '%.7z%' OR Ext LIKE '%.rar%' OR Ext LIKE '%.cab%' GROUP BY Ext ORDER BY Files DESC"
echo Find Specific Files in folders&&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes, CreationTime, LastWriteTime, HASHMD5_FILE(Path) AS Hash FROM 'C:\*.*' WHERE Ext LIKE '%.appx%' AND Attributes NOT LIKE 'D%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Path DESC"
:: Below needs work... No Files are found... But Count extensions above does work...
echo Find Specific Files in folder&&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes, CreationTime, LastWriteTime, HASHMD5_FILE(Path) AS Hash FROM 'C:\$Data\*.*'  WHERE Attributes NOT LIKE 'D%' AND Ext LIKE '%.js%' OR Ext LIKE '%.zip%' OR Ext LIKE '%.7z%' OR Ext LIKE '%.rar%' OR Ext LIKE '%.cab%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Path DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
See AboutMe_Combined.txt for: Find Specific Files using LogParser as well as ForFiles
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Three Elements used below for creating a LogParser HTML file using .tpl Template
 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-<Name>.tpl" -AND-  INTO '%ohtm%\%ComputerName%_<Name>.html' -AND-  &&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_<Name>.html"

::Using StdIn and Dir with TSV as Input Split Path into 3 parts: Path, FileName, Ext: SELECT Field1 AS FilePath, EXTRACT_PREFIX(EXTRACT_FILENAME(FilePath),0,'.') As FilName, EXTRACT_EXTENSION(Field1) AS Ext
::Using -i:FS as Input Split Path into 3 parts: Path, FileName, Ext: SELECT Field1 AS FilePath, EXTRACT_PREFIX(EXTRACT_FILENAME(FilePath),0,'.') As FilName, EXTRACT_EXTENSION(Field1) AS Ext

LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, EXTRACT_SUFFIX(Path,0,'-') As FullName, EXTRACT_PREFIX(Name,0,'-') As Artist, EXTRACT_PREFIX(Name,-1,'.') as Song, EXTRACT_EXTENSION(Name) AS Ext FROM 'E:\$Music\Eagles\*.*' WHERE Attributes NOT LIKE 'D%' AND Ext NOT LIKE '%jpg%'  ORDER BY Artist,Song"
:: Below issue is when you have Recursive Folders LogParser does not know how to handle multiple folders...
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PREFIX(Name,0,'-') As Artist, EXTRACT_PREFIX(Name,-1,'.') as Song, EXTRACT_EXTENSION(Name) AS Ext, EXTRACT_PREFIX(EXTRACT_FILENAME(Path),0,'.') As ArtistSong FROM 'E:\$Music\Eagles\*.*' WHERE Attributes NOT LIKE 'D%' AND Ext NOT LIKE '%jpg%'  ORDER BY Artist,Song"
:: Using Windows DOS Command with LogParser -i:TSV -headerRow:off -rtp:-1 -o:datagrid and Field names and types are retrieved at runtime from the specified input file(s)
echo Split Dir File into 3 Parts&Dir /B /s "C:\Windows\System32\winevt\Logs\*.evtx" | LogParser -i:TSV -headerRow:off -rtp:-1 -o:datagrid "SELECT Field1 AS FilePath, EXTRACT_PREFIX(EXTRACT_FILENAME(FilePath),0,'.') As FilName, EXTRACT_EXTENSION(Field1) AS Ext FROM STDIN ORDER BY FilName"
<br>-AND-<br>
echo Split Dir File into 3 Parts HTML&Dir /B /s "C:\Windows\System32\winevt\Logs\*.evtx" |LogParser -i:TSV -headerRow:off -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-DiskUsage3.tpl" "SELECT Field1 AS FilePath, EXTRACT_PREFIX(EXTRACT_FILENAME(FilePath),0,'.') As FilName, EXTRACT_EXTENSION(Field1) AS Ext INTO '%ohtm%\%ComputerName%_DiskUsageReport.html' FROM STDIN ORDER BY FilName"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_DiskUsageReport.html"

echo Split Dir File into 4 Parts&Dir /B /s "C:\Windows\System32\winevt\Logs\*.evtx" | LogParser -i:TSV -headerRow:off -rtp:-1 -o:datagrid "SELECT EXTRACT_PATH(Field1) AS Path, EXTRACT_FILENAME(Field1) AS FullName, EXTRACT_PREFIX(FullName,0,'.') As FilName, EXTRACT_EXTENSION(Field1) AS Ext FROM STDIN ORDER BY FilName"
<br>-AND-<br>
echo Split Dir File into 4 PartsHTML&Dir /B /s "C:\Windows\System32\winevt\Logs\*.evtx" |LogParser -i:TSV -headerRow:off -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-DiskUsage4.tpl" "SELECT EXTRACT_PATH(Field1) AS Path, EXTRACT_FILENAME(Field1) AS FullName, EXTRACT_PREFIX(FullName,0,'.') As FilName, EXTRACT_EXTENSION(Field1) AS Ext INTO '%ohtm%\%ComputerName%_DiskUsageReport.html' FROM STDIN ORDER BY FilName"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_DiskUsageReport.html"

:: Using <Command> to pull data FROM command line - Parse the output of a "Dir" command:
Dir /B /O:N /S D:\Hyper-V\*.vhdx | LogParser -i:TSV -iSeparator:space -nSep:2 -fixedSep:off -nSkipLines:3 -rtp:-1 -o:datagrid "SELECT * FROM STDIN"
Dir /S "%OneDrive%\*.txt">"%ohtm%\%ComputerName%_DirText.txt"&LogParser -i:TEXTLINE -rtp:-1 -o:datagrid -iCheckpoint:"%ohtm%\%ComputerName%_DirCP.txt" "SELECT * FROM '%ohtm%\%ComputerName%_DirText.txt'"

:: SELECT TOP 20 EXTRACT_PREFIX(Field1, 0, '=') AS DKCmd
:: Using DOS Command ald LogParser Web to view results of a search
echo %Date% !Time! [MSG] Find Data in Macro&&doskey /MACROS:ALL | FINDSTR /I /C:"$1" | LogParser -i:TSV -iSeparator:space -nSep:2 -fixedSep:off -nSkipLines:3 -rtp:-1 -o:datagrid "SELECT * FROM STDIN"

LogParser -i:TEXTLINE -Stats:Off -q:off -iCodepage:0 -splitLongLines:ON -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-DoskeySearch2.tpl" "SELECT EXTRACT_PREFIX(Text,0,'=') AS DKShortcut, EXTRACT_SUFFIX(Text,0,'&&') AS Command INTO '%ohtm%\%ComputerName%_DoskeySearchReport.html' FROM '%Onedrive%\Batch\macros.doskey' WHERE Text LIKE '%$1%' AND Text NOT LIKE '%;=%' Order by DKShortcut ASC"&&Start "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_DoskeySearchReport.html"

echo %Date% !Time! [MSG] Display All DosKey Macros&&doskey /MACROS:ALL | FINDSTR /I /C:"=" | LogParser -i:TSV -fixedSep:off -headerRow:Off -linefilter:-; -rtp:-1 -o:datagrid "SELECT EXTRACT_PREFIX(Field1, 0, '=') AS DKCmd FROM STDIN WHERE DKCmd NOT LIKE '%..%' AND DKCmd NOT LIKE '%;%' AND DKCmd NOT LIKE '%::%' AND DKCmd NOT LIKE '%4f%' AND DKCmd NOT LIKE '%99%' AND DKCmd NOT LIKE '%99c%' AND DKCmd NOT LIKE '%camera%' ORDER BY DKCmd"
doskey /MACROS:ALL | FINDSTR /I /C:"=" | LogParser -i:TSV -fixedSep:off -headerRow:Off -linefilter:-; -rtp:-1 -o:datagrid "SELECT EXTRACT_PREFIX(Field1, 0, '=') AS DKCmd, EXTRACT_SUFFIX(Field1,0,'&&') AS Command FROM STDIN WHERE DKCmd NOT LIKE '%..%' AND DKCmd NOT LIKE '%;%' AND DKCmd NOT LIKE '%::%' AND DKCmd NOT LIKE '%4f%' AND DKCmd NOT LIKE '%99%' AND DKCmd NOT LIKE '%99c%' AND DKCmd NOT LIKE '%camera%' ORDER BY DKCmd"

:: Bad... Dir /O:N /S D:\Hyper-V\*.vhdx | LogParser -i:TSV -iSeparator:space -nSep:2 -fixedSep:off -nSkipLines:3 -rtp:-1 -o:datagrid "SELECT Filename, RowNumber, Data FROM STDIN WHERE Data NOT LIKE '%Files()%' OR Data NOT LIKE '%Directory%'"
:: display all active TCP connections and the associated executable Files that are using them...
NETSTAT | LogParser -i:TSV -iSeparator:space -nSep:2 -fixedSep:off -nSkipLines:3 -rtp:-1 -o:datagrid "SELECT * FROM STDIN"
NETSTAT -a | LogParser –i:TSV –iSeparator:space –nSep:2 –fixedSep:OFF –nSkipLines:3 -rtp:-1 -o:datagrid "SELECT [Local Address] FROM STDIN WHERE State = 'LISTENING'"
echo %Date% !Time! [MSG] Netstat Listening Ports&NETSTAT -ab | LogParser –i:TSV –iSeparator:space –nSep:2 –fixedSep:OFF –nSkipLines:3 -rtp:-1 -o:datagrid "SELECT [Local Address] FROM STDIN WHERE State = 'LISTENING'"
:: Below command is the same as above, however, the output is directed to HTML using .tpl
echo %Date% !Time! [MSG] Netstat Listening Ports&NETSTAT -ab | LogParser –i:TSV –iSeparator:space –nSep:2 –fixedSep:OFF –nSkipLines:3 -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-ListeningPorts.tpl" "SELECT [Local Address] INTO '%ohtm%\%ComputerName%_ListeningPorts.html' FROM STDIN WHERE State = 'LISTENING'"
:: Find Specific DISTINCT Path from %Root%
SET Root=C:&echo Root: %Root% & echo Find All Specific Folders: %Root%%&LogParser -i:FS -rtp:-1 -o:datagrid -stats:On -q:off -Recurse:-1 -E:-1 "SELECT DISTINCT EXTRACT_PATH(Path) AS Pat INTO '%ohtm%\%ComputerName%_SpecificFolders_C.csv' FROM '%Root%\*.*' WHERE Attributes LIKE 'D%' AND Pat LIKE '%Google%' AND Pat NOT LIKE '%\.%' ORDER BY Pat ASC"&Notepad++ "%ohtm%\%ComputerName%_SpecificFolders_C.csv"
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  Information about Windows Event Log Names and locations and publishers             │
└─────────────────────────────────────────────────────────────────────────────────────┘
::ref: https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil
echo Look for Event logNames in Registry: SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,Value FROM \HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\System WHERE KeyName LIKE '%Microsoft-Windows%'"
echo List the Version of Office installed...
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,Value FROM '\HKEY_CURRENT_USER\SOFTWARE\Microsoft' WHERE ValueName LIKE '%BuildNumber%' ORDER BY KeyName,Value DESC"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,Value FROM '\HKEY_CURRENT_USER\SOFTWARE\Microsoft' WHERE KeyName LIKE '%office%' ORDER BY KeyName,Value DESC"
echo Windows Capability SIDs&LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,Value FROM '\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SecurityManager\CapabilityClasses' ORDER BY KeyName,Value DESC"
:: +------------------------------------------------------------------+
:: | LogParser Use mm/dd/yy convert to proper date                    |
:: +------------------------------------------------------------------+
:: One way to convert a text field date format mm/dd/yy into a proper date that Log Parser can use to group the date is to use the TO_TIMESTAMP function with the appropriate format string. For example, if you have a log file with a date field in the format mm/dd/yy, you can use this query: (This query will return the number of hits for each date in the log file.)
LogParser "SELECT TO_TIMESTAMP(date, 'MM/dd/yy') AS LogDate, COUNT(*) AS Hits FROM my.log GROUP BY LogDate"
:: Another way to convert a text field date format mm/dd/yy into a proper date that Log Parser can use to group the date is to use the TRIM function to remove any leading or trailing spaces from the date field, and then use the TO_TIMESTAMP function with the format string. For example, if you have a log file with a date field in the format mm/dd/yy with some spaces, you can use this query: (This query will also return the number of hits for each date in the log file.)
LogParser "SELECT TO_TIMESTAMP(TRIM(date), 'MM/dd/yy') AS LogDate, COUNT(*) AS Hits FROM my.log GROUP BY LogDate"
:: using Log Parser to group dates together is to use the TO_TIMESTAMP function to convert the date field to a standard format, and then use the GROUP BY clause to aggregate the records by date. For example, if you have a log file with a date field in the format MM/dd/yyyy, you can use this query: (This query will return the number of hits for each date in the log file.)
LogParser "SELECT TO_TIMESTAMP(date, 'MM/dd/yyyy') AS LogDate, COUNT(*) AS Hits FROM my.log GROUP BY LogDate"
:: use the TO_LOCALTIME function to convert the date field to the local time zone, and then use the WITH ROLLUP argument to display additional summary rows. For example, if you have a log file with a date field in the format yyyy-MM-dd, you can use this query: (This query will return the number of hits for each date in the log file, as well as the total number of hits.)
LogParser "SELECT TO_LOCALTIME(TO_TIMESTAMP(date, 'yyyy-MM-dd')) AS LogDate, COUNT(*) AS Hits FROM my.log GROUP BY LogDate WITH ROLLUP"
:: +------------------------------------------------------------------+
:: | LogParser List All eventlogs:                                    |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SourceName AS Provider FROM System ORDER BY Provider"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS Date, EventID, message AS Message FROM System WHERE EventID IN (100;104;106;202;204) ORDER BY Date, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EventID, ComputerName, Message, Data FROM Application, Security, System WHERE EventID IN (100;104;106;202;204) ORDER BY EventTime, EventID DESC"
:: Syntax Error: <sqlfunction-expr>: no matching closing parenthesis - LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COMPUTER_NAME() as ThisMchine, TimeGenerated AS Time, SUM(4,5) FROM System"
:: Error retrieving Files: Error opening fileLogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS taskname, EXTRACT_TOKEN(Strings, 1, '|') AS User FROM 'Microsoft-Windows-FileHistory-Engine%4BackupLog.evtx' WHERE EventID = 204"
:: echo Daily  Today's Daily Event errors and SourceName=Disk errors
:: Make a 3dbar chart
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName As ApSeSySrc, COUNT(*) As TotErrors FROM System, Security, Application WHERE TimeWritten = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND EventType = 1 OR EventType = 2 GROUP BY SourceName ORDER BY TotErrors DESC"
echo Get Number of logons&LogParser -i:EVT -stats:on -q:on -rtp:-1 -o:datagrid -E:-1 "SELECT SID, resolve_sid(sid) AS UserName, COUNT(*) AS Number_of_Logons FROM Security WHERE EventID IN (552;528;4624;4625;4634;4647;4648;4779;4800;4801;4802;4803) AND to_string(TimeGenerated,'yyyy-MM-dd HH:mm:ss') like '2023%' GROUP BY SID"

echo Get Number of logon failures&LogParser -i:EVT -stats:on -q:on -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS LogonTime, EXTRACT_TOKEN(strings, 0, '|') AS UserName FROM Security WHERE EventID IN (529;530;531;532;533;534;535;536;537;539;4625) AND to_string(TimeGenerated,'yyyy-MM-dd HH:mm:ss') like '%date:~-4%%'

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName AS ApplicSrc, COUNT(*) As AppErrors FROM Application WHERE TimeWritten = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) GROUP BY ApplicSrc ORDER BY AppErrors DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName AS SecuritySrc, COUNT(*) As SecErrors FROM Security WHERE TimeWritten = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) GROUP BY SecuritySrc ORDER BY SecErrors DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName AS SystemSrc, COUNT(*) As SysErrors FROM System WHERE TimeWritten = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) GROUP BY SystemSrc ORDER BY SysErrors DESC"
:: Daily Disk Error Stats
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName AS SysSrc, COUNT(*) As TotErrors FROM System WHERE SourceName LIKE '%Disk%' AND TimeWritten = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND EventType = 1 OR EventType = 2 GROUP BY SourceName ORDER BY TotErrors DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName AS AppSrc, COUNT(*) As TotErrors FROM Application WHERE SourceName LIKE '%Disk%' AND TimeWritten = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND EventType = 1 OR EventType = 2 GROUP BY SourceName ORDER BY TotErrors DESC"
::------------------------------------------------------------------------------------------------------------------
:: echo Display MUI Cache Registry Entries&LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \HKEY_CURRENT_USER\Software\Microsoft\Windows\ShellNoRoam\MUICache"
:: Error: Error opening key "HKEY_CURRENT_USER\Software\Microsoft\Windows\ShellNoRoam\MUICache": The system cannot find the file specified.
::------------------------------------------------------------------------------------------------------------------
:: PushD &cd \& cd "%SystemRoot%\System32\Winevt\Logs" &SET lfh='Microsoft-Windows-FileHistory-Engine%4BackupLog.evtx'
:: dir "Microsoft-Windows-FileHistory-Engine*.*"  :: &dir &pause &PopD
:: IF EXIST %lfh% (Echo Microsoft-Windows-FileHistory-Engine exists for: %lfh%) ELSE Echo Microsoft-Windows-FileHistory-Engine missing for: %lfh%
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +------------------------------------------------------------------+
:: | Windows Events Command Line Utility. wevtutil /?                 |
:: | List the names of All Provider logs: --> wevtutil el             |
:: +------------------------------------------------------------------+
:: Ref: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil
:: Using LogParser, Display the stdout to HTML: (See: %OneDrive%\LP-Templates)
wevtutil el|LogParser -i:TSV -fixedSep:off -headerRow:Off -iSeparator:, -Stats:on -q:on -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-wevtutil.tpl" "SELECT Field1 AS Providerlog INTO '%ohtm%\%ComputerName%_LP-wevtutil.html' FROM StDIN"&Start "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LP-wevtutil.html"
wevtutil el|LogParser -i:TSV -fixedSep:off -headerRow:Off -iSeparator:, -Stats:on -q:on -E:-1 -rtp:-1 -o:datagrid "SELECT Field1 AS Providerlog FROM StDIN"&Start "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LP-wevtutil.html"
wevtutil ep|LogParser -i:TSV -fixedSep:off -headerRow:Off -iSeparator:, -Stats:on -q:on -E:-1 -rtp:-1 -o:datagrid "SELECT Field1 AS Provider FROM StDIN"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
ipconfig /displaydns|LogParser -i:textline -rtp:-1 "SELECT DISTINCT SUBSTR(text,ADD(INDEX_OF(text,':'),2)) AS [DNS Name] FROM stdin WHERE text like '%record name%' ORDER BY [DNS Name]"
:: TO_TIMESTAMP(substr(Text,0,19), 'yyyy-MM-dd hh:mm:ss') AS TimeGenerated, substr(Text,23,9) AS Source, substr(Text,33) AS Message
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Example: Find a file in C-Drive: LP-wevtutil.tpl&Dir /B /S "%OneDrive%\LP-wevtutil.tpl"|LogParser -i:TSV -fixedSep:off -headerRow:Off -iSeparator:, -Stats:on -q:on -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-DirFindFile3.tpl" "SELECT FileName, RowNumber, Field1 AS FileFound INTO '%ohtm%\%ComputerName%_LP-DirFindFile.html' FROM StDIN"&Start "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LP-DirFindFile.html"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: List EVERY Microsoft Log file your system: wevtutil el
wevtutil el | FINDSTR /I "Microsoft"
wevtutil gp Microsoft-Windows-Eventlog /ge:true | FIND /I "Name"
:: Below: Display information about the Microsoft-Windows-Eventlog event publisher, including metadata about the events that the publisher can raise:
wevtutil gp Microsoft-Windows-Eventlog /ge:true
Display configuration information about the System log --> wevtutil gl System    /f:xml
Display information about the Microsoft-Windows-Eventlog event publisher, including metadata about the events that the publisher can raise:
--> wevtutil gp Microsoft-Windows-Eventlog /ge:true>%odl%_%ComputerName%_wevtutil.txt | Findstr /C:"name:" /C:"id:" /C:"value:" %odl%_%ComputerName%_wevtutil.txt
Display the three most recent events FROM the Application log in textual format: --> wevtutil qe Application /C:3 /rd:true /f:text
Display the status of the Application log: --> wevtutil gli Application
Display the status of the Security log: --> wevtutil gli Security
Display the status of the System log: --> wevtutil gli System
Display Active Directory            : --> wevtutil gp "Active Directory Web Services" /ge /gm:true
:: wevtutil qe Microsoft-Windows-Backup /f:text /q:"*[System/EventID=14] OR *[EventData/Data[@Name='HRESULT']='0']"
:: Display the three most recent events from the Application log in textual format:
::------------------------------------------------------------------------------------------------------------------
:: +------------------------------------------------------------------+
:: | Look for REG values in Registry                                  |
:: +------------------------------------------------------------------+
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\System WHERE KeyName LIKE '%Microsoft-Windows%'"
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
┌──────────────────────────────────────────────────────────────────────────┐ 
│                          Count files in Folder                           │
│  Count the number of the same extensions THEN count the number of files  │
└──────────────────────────────────────────────────────────────────────────┘ 
SET "Root=C:\$Software\$Microsoft"
SET "csv=%odl%\%ComputerName%_FileExtCount.csv"
echo Count Files in folder %Root% & LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as ExtCntrs FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension HAVING COUNT(*) > 5 ORDER BY ExtCntrs DESC"
:: :: Sum up the Size of each Extension type - add in a column to sum up the File Sizes
echo Count Files in folder %Root% & LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, SUM(Size) AS Bytes, COUNT(*) as ExtCntrs FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension HAVING COUNT(*) > 5 ORDER BY ExtCntrs DESC"
echo Count Files in folder %Root% & LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, DIV(TO_REAL(SUM(Size)), 1048576) AS SizeMB, COUNT(*) as ExtCntrs FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension HAVING COUNT(*) >= 1 ORDER BY SizeMB, ExtCntrs DESC"
:: TEST
echo Count Files in folder %Root% & LogParser -i:FS -o:CSV -stats:on -q:off -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as ExtCntrs INTO '%csv%' FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY ExtCntrs DESC" & echo Sum the total Extensions to see how many files we have & LogParser -i:CSV -headerRow:On -fixedFields:OFF -nFields:2 -rtp:-1 -o:datagrid "SELECT SUM(ExtCntrs) AS TotalFiles FROM '%csv%'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
┌───────────────────────────────────────────────────┐
│   Count Files in Folders - LogParser limitation   │
│   Count Files in Folders using DU64 App  😊      │
└───────────────────────────────────────────────────┘
echo Count all Files in all folders use Sysinternals App C:\SysInternalsSuite\du64.exe /?
echo Count Music Files using DU64&&C:\SysInternalsSuite\du64.exe -c -nobanner -u -v "C:\$Music">"%odl%\%ComputerName%_$MusicFolderCounts.csv"
NotePad++ "%odl%\%ComputerName%_$MusicFolderCounts.csv"
:: LogParser .. -iHeaderFile "C:\$Data\OneDrive\LP-Templates\DU64Header.hdr"
:: Path,CurrentFileCount,CurrentFilesize,FileCount,DirectoryCount,DirectorySize,DirectorySizeOnDisk
echo Read CSV and Header Count all Files in all folders using DU64&&LogParser -i:CSV -stats:On -rtp:-1 -o:datagrid -iHeaderFile "C:\$Data\OneDrive\LP-Templates\DU64Header.hdr" "SELECT Path,CurrentFileCount,CurrentFilesize,FileCount,DirectoryCount,DirectorySize,DirectorySizeOnDisk FROM "%odl%\%ComputerName%_$MusicFolderCounts.csv" ORDER BY DirectorySize DESC"
echo Read CSV File from DU64 and create HTML Output&&LogParser -i:CSV -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-DU64.tpl" -iHeaderFile "C:\$Data\OneDrive\LP-Templates\DU64Header.hdr" "SELECT TOP 500 Path,CurrentFileCount,CurrentFilesize,FileCount,DirectoryCount,DirectorySize,DirectorySizeOnDisk INTO '%ohtm%\%ComputerName%_DU64-Report.html' FROM StDIN ORDER BY DirectorySize DESC"&& Start "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_DU64-Report.html"
echo Count all Files in all folders Direct from DU64&& %SysInternals%\du64.exe -c -l 1 -nobanner -u "C:\$Music"|LogParser -i:TSV -fixedSep:off -headerRow:On -iSeparator:, -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-DU64.tpl" "SELECT Path,CurrentFileCount,CurrentFilesize,FileCount,DirectoryCount,DirectorySize,DirectorySizeOnDisk INTO '%ohtm%\%ComputerName%_DU64-Report.html' FROM StDIN ORDER BY DirectorySize DESC"&& Start "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_DU64-Report.html"

LogParser is a powerful tool that can parse various types of log Files and other system data1. However, it doesn't directly support looping through directories or counting Files. For such tasks, you might want to use a scripting language like PowerShell or a batch script in combination with LogParser
Here's an example of how you can use a batch script to loop through directories and count the number of Files in each directory:
@echo off
for /d %a in (C:\$Music) do (
    echo Directory: %a
    Dir /B "%a" | find /v /c "::"
)
In this script, for /d %%a in (*) loops over all directories in the current directory. The Dir /B "%%a" command lists all Files in the directory, and find /v /c "::" counts the number of lines (i.e., Files) in the output5.

If you want to use LogParser to parse log Files in each directory, you can modify the script to call LogParser for each directory36. However, please note that you need to replace "query.sql" with your actual LogParser query:

LogParser -i:FS -stats:on -q:on -rtp:-1 -o:datagrid -E:-1 -Recurse:-1 "SELECT EXTRACT_PATH(Path) AS Pat, Name, EXTRACT_EXTENSION(Name) AS Ext, CreationTime As CDate, Size, HASHMD5_FILE(Path) AS Hash FROM '%IISLogs%\*.log'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +--------------------------------------------------------------------+
:: | Analyze and count Music Files and Folders   DU64.exe               ¦
:: +--------------------------------------------------------------------+
:: count music Files- Count number of Files under the Root folder e.g. E:\$Music
SET "Root=C:\$Music\$Missing songs"&&echo %Date% !Time! [MSG] Root = %Root%
SET "Root=C:\$Music"&&echo %Date% !Time! [MSG] Root = %Root%
:: Below Query returns good information regarding Files and sizes in Music Folder...
:: Using above Query, Output to HTML 6 columns LogParser .tpl
LogParser -i:FS -Recurse:-1 -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-MusicFileCounts.tpl" -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, DIV(TO_REAL(SUM(Size)),1024) AS Size(Kb), DIV(TO_REAL(SUM(Size)),1048576) AS Size(Mb), DIV(DIV(SUM(Size), 1024), 1024) AS MBytes, DIV(TO_REAL(SUM(Size)),1073741824) AS Size(Gb), COUNT(*) as Files INTO '%ohtm%\%ComputerName%_LP-MusicFileCounts.html' FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LP-MusicFileCounts.html"
:: LogParser -i:FS -Recurse:-1 -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-FilesChangedToday.tpl" "SELECT CreationTime,LastWriteTime,LastAccessTime, Path, Name, Size, Attributes INTO '%ohtm%\%ComputerName%_FilesChangedToday-Report.html' FROM %OneDrive%\*.* WHERE Attributes NOT LIKE 'D%' AND TO_DATE(LastAccessTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) OR TO_DATE(LastWriteTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) OR TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) ORDER BY LastWriteTime DESC"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_FilesChangedToday-Report.html"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Display New Downloaded Audials music counts, Total, Distinct and duplicates
:: NOTE: run these queries separately and then combine their results by using ForFiles. Unfortunately, LogParser doesn't support combining these specific queries directly into 1 query due to its syntax limitations and UNION is not supported.
:: Below Display in DataGrid - Below LogParser writes output to Screen :: Need to rename .mp3 Extension to another Value:
setlocal enabledelayedexpansion
cmd /V:ON /K "SET Root=%UserProfile%\Music\Audials\Audials Music&&echo %Date% !Time! [RC] cmd /V:ON /K SET Root= !Root! RC=%ErrorLevel%"
cmd /V:ON /K "SET lpq=LogParser -i:FS -Stats:On -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1&&echo %Date% !Time! [RC] cmd /V:ON /K SET lpq= !lpq! RC=%ErrorLevel%"
cmd /V:ON /K "SET Root=%UserProfile%\Music\Audials\Audials Music&&echo %Date% !Time! [RC] cmd /V:ON /K SET Root= !Root! RC=%ErrorLevel%"
echo Count All Audials Files&&%lpq% "SELECT DISTINCT TO_LOWERCASE(SUBSTR(Name, Last_INDEX_OF(Name,'.'), StRLEN(Name))) AS Ext, REPLACE_STR(Ext, '.mp3', 'AudTotal') AS AudTotal, Count(*) AS Totals FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Ext"
echo Count All Distinct Audials Files&&%lpq% "SELECT DISTINCT TO_LOWERCASE(SUBSTR(Name, Last_INDEX_OF(Name,'.'), StRLEN(Name))) AS Ext, REPLACE_STR(Ext, '.mp3', 'AudDistinct') AS AudDistinct, Count(*) AS Totals FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' AND EXTRACT_TOKEN(Name, 0, '_') = Name GROUP BY Ext"
echo Count All Duplicate Audials Files&&%lpq% "SELECT DISTINCT TO_LOWERCASE(SUBSTR(Name, Last_INDEX_OF(Name,'.'), StRLEN(Name))) AS Ext, REPLACE_STR(Ext, '.mp3', 'AudDups') AS AudDups, Count(*) AS Totals FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' AND EXTRACT_TOKEN(Name, 0, '_') <> Name GROUP BY Ext"

:: e.g. LogParser -o:CSV -fileMode  0|1|2 : Action to perform when output file already exists (0=append, 1=overwrite, 2=ignore) [default value=1]:: To Gather ALL Statistics Need to Append/Wite data into a file and put results from the final file as there is NO Union function in LogParser.
echo Count All Audials Files (Distinct and Duplicate) && LogParser -i:FS -Stats:On -q:off -o:CSV -fileMode:1 -Recurse:-1 -E:-1 "SELECT DISTINCT TO_LOWERCASE(SUBSTR(Name, Last_INDEX_OF(Name,'.'), StRLEN(Name))) AS Ext, REPLACE_STR(Ext, '.mp3', 'AudTotal') AS AudTotal, Count(*) AS Totals INTO '%odl%\%ComputerName%_AudialsTotal.csv' FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Ext"
echo Count All Distinct Audials Files && LogParser -i:FS -Stats:On -q:off -o:CSV -fileMode:1 -Recurse:-1 -E:-1 "SELECT DISTINCT TO_LOWERCASE(SUBSTR(Name, Last_INDEX_OF(Name,'.'), StRLEN(Name))) AS Ext, REPLACE_STR(Ext, '.mp3', 'AudDistinct') AS AudDistinct, Count(*) AS Totals INTO '%odl%\%ComputerName%_AudialsTotDist.csv' FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' AND EXTRACT_TOKEN(Name, 0, '_') = Name GROUP BY Ext"
echo Count All Duplicate Audials Files && LogParser -i:FS -Stats:On -q:off -o:CSV -fileMode:1 -Recurse:-1 -E:-1 "SELECT DISTINCT TO_LOWERCASE(SUBSTR(Name, Last_INDEX_OF(Name,'.'), StRLEN(Name))) AS Ext, REPLACE_STR(Ext, '.mp3', 'AudDups') AS AudDups, Count(*) AS Totals INTO '%odl%\%ComputerName%_AudialsTotDups.csv' FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' AND EXTRACT_TOKEN(Name, 0, '_') <> Name GROUP BY Ext"
echo Display the Audials Files && LogParser -i:FS -Recurse:-1 -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT Path, Name, Size FROM '%odl%\%ComputerName%_AudialsTot*.csv'"
:: Now we need to merge these 3 Files into one then read that file using LogParser
:: Define the Input and output Files
cmd /V:ON /K "SET AudInput=%odl%\%ComputerName%_AudialsTot*.csv&&echo %Date% !Time! [RC] cmd /V:ON /K SET AudInput= !AudInput! RC=%ErrorLevel%"
cmd /V:ON /K "SET AudMerged=%odl%\%ComputerName%_AudialsMerged.csv&&echo %Date% !Time! [RC] cmd /V:ON /K SET AudMerged= !AudMerged! RC=%ErrorLevel%"
:: Clear the output file if it exists
IF EXIST "%AudMerged%" (Echo Deleting File: "%AudMerged%" Found&&DEL "%AudMerged%") ELSE echo File "%AudMerged%" Not Found.
:: Use ForFiles to loop through the Files and append their contents to the output file: ForFiles /M AudialsTot*.csv /C "cmd /c type @file >> merged.csv
ForFiles /P %odl% /S /M %ComputerName%_AudialsTot*.csv /C "cmd /c type @file" >> "%AudMerged%"
:: echo Display the Audials Files && LogParser -i:CSV -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT Field1 FROM '%AudMerged%'"
echo Display the Audials Files && LogParser -i:CSV -headerRow:Off -fixedFields:OFF -nFields:2 -rtp:-1 -o:datagrid "SELECT EXTRACT_PREFIX(Field1,0,'.') As Ext, Field2 AS Type, Field3 AS Totals FROM '%AudMerged%' WHERE Totals NOT LIKE '%Totals%' ORDER BY Totals DESC"

:: ForFiles /P %odl% /S /M %ComputerName%_AudialsTot*.csv /C "cmd /c echo @file"
:: IF EXIST %AudMerged% (Echo File found: %AudMerged%) ELSE echo File NOT found: %AudMerged%
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET Root=C:\inetpub\wwwroot\VSDCDocumentation
SET Root=%UserProfile%\Music\Audials\Audials Music
echo List All Files LastAccessTime Today in %Root%&SET today=%date:~-4%-%date:~-10,2%-%date:~-7,2%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT Path,Name,Size,LastAccessTime FROM '%Root%\*.*' where LastAccessTime=TO_LOCALTIME(TIMESTAMP('%today%', 'yyyy-MM-dd')) ORDER BY LastAccessTime"
echo List All Files CreationTime Today in %Root%&SET today=%date:~-4%-%date:~-10,2%-%date:~-7,2%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT Path,Name,Size,CreationTime,LastAccessTime FROM '%Root%\*.*' where CreationTime=TO_LOCALTIME(TIMESTAMP('%today%', 'yyyy-MM-dd')) ORDER BY CreationTime"
:: changed between two dates
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET Root=C:\inetpub\wwwroot\Audacity
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, DIV(TO_REAL(SUM(Size)),1024) AS Size(Kb), DIV(TO_REAL(SUM(Size)),1048576) AS Size(Mb), DIV(DIV(SUM(Size), 1024), 1024) AS MBytes, DIV(TO_REAL(SUM(Size)),1073741824) AS Size(Gb), COUNT(*) as Files FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT SUBSTR(text, 0, 8) AS Index, SUBSTR(text, 8, 41) AS Song, SUBSTR(text, 49, 999) AS Artist FROM "%OneDrive%\AboutMe\JazzArtistsIndex.txt" ORDER BY Artist ASC"

LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT DISTINCT SUBSTR(text, 49, 999) AS Artist FROM "%OneDrive%\AboutMe\JazzArtistsIndex.txt" ORDER BY Artist ASC"
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT DISTINCT SUBSTR(text, 49, 999) AS Artist FROM "%OneDrive%\AboutMe\JazzArtistsIndex.txt" ORDER BY Artist ASC"
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT DISTINCT SUBSTR(text, 49, 999) AS Artist FROM "%OneDrive%\AboutMe\JazzArtistsIndex.txt" ORDER BY Artist ASC"
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT DISTINCT SUBSTR(text, 8, 41) AS Song FROM "%OneDrive%\AboutMe\JazzArtistsIndex.txt" ORDER BY Song ASC"
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT Count(SUBSTR(text, 8, 41)) AS Song, SUBSTR(text, 49, 999) AS Artist FROM "%OneDrive%\AboutMe\JazzArtistsIndex.txt" Group By Artist ORDER BY Song DESC"
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT SUBSTR(text, 8, 41) AS Song, Count(SUBSTR(text, 49, 999)) AS Artist FROM "%OneDrive%\AboutMe\JazzArtistsIndex.txt" Group By Song ORDER BY Artist DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Dump All .mp3 Files to csv and use Excel to manage whatever needs to be sorted out...
SET csv=%ohtm%\%ComputerName%_MusicFiles.csv
SET Root=E:\$Music
SET myFiles=*.mp3
echo Creating csv for All %myFiles% Files in Folder: %Root%  Output To: %csv%
::echo file;fname;ext;path;relpath;isDir;fsize;fdate;ftime >%csv%
::ForFiles /P %Root% /M %myFiles% /S /C "cmd /c echo @file 0x3b@fname 0x3b@ext 0x3b@path 0x3b@relpath 0x3b@isDir 0x3b@fsize 0x3b@fdate 0x3b0x22@ftime0x22" >>%csv%
:: /D Selects Files with a last modified date greater than or equal to (+), or less than or equal to (-), the specified date using the "MM/dd/yyyy" format; or selects Files with a last modified date greater than or equal to (+) the current date plus "dd" days, or less than or equal to (-) the current date minus "dd" days. A valid "dd" number of days can be any number in the range of 0 - 32768. "+" is taken as default sign if not specified.
echo Today's date: %date:~-10,2%/%date:~-7,2%/%date:~-4%
echo Find All mp3 Files created after 05/01/2022
echo path;fsize;fdate;ftime >%csv%
ForFiles /D %date:~-10,2%/%date:~-7,2%/%date:~-4% /P %Root% /M %myFiles% /S /C "cmd /c echo @path 0x3b@fsize 0x3b@fdate 0x3b0x22@ftime0x22" >>%csv%
Notepad++ %csv%

SET csv=%ohtm%\%ComputerName%_AllMP3Files.csv
SET hdr=%ohtm%\%ComputerName%_AllMP3Files.hdr
echo path;fsize;fdate;ftime >%hdr%
SET Root=E:\$Music
SET myFiles=*.mp3
echo Creating csv for All %myFiles% Files in Folder: %Root%  Output To: %csv%
:: list all of the Files in the directory that are at least one year old
START "AllMP3Files" /D "%odl%" /I /Min /High /Wait ForFiles /P %Root% /M %myFiles% /S /D %date:~-10,2%/%date:~-7,2%/2022 /C "cmd /c echo @path 0x3b@fsize 0x3b@fdate 0x3b0x22@ftime0x22">>%csv%
:: ForFiles /P %Root% /M %myFiles% /S /D -365 /C "cmd /c echo @path 0x3b@fsize 0x3b@fdate 0x3b0x22@ftime0x22">>%ohtm%\%ComputerName%_AllMP3Files.csv
START "AllMP3Files" /D "%odl%" /I /Min /High /Wait ForFiles /D 07/05/2022 /P %Root% /M %myFiles% /S /C "cmd /c echo @path 0x3b@fsize 0x3b@fdate 0x3b0x22@ftime0x22">>%csv%
:: Using ForFiles has a CATCH! The Default DELIMITER is ; and I need a Comma...
:: NOTE: ForFiles: Use the TSV input format instead of -i:CSV - you can use -iSeparator:; as the delimiter
:: ForFiles /M *.txt /C "cmd /c if @isdir==FALSE notepad.exe @file"
:: DIFFICULTY splitting on \ ASCII for "\" &bsol;   &#92;   92 - 134 - 5B
LogParser -i:TSV -rtp:-1 -o:datagrid -iSeparator:; -fixedSep:OFF -stats:On -headerRow:Off -iHeaderFile:%hdr% -iw:On -dtLines:10 -E:-1 "SELECT path, EXTRACT_TOKEN(path, 0, '.') AS ArtistSong,EXTRACT_PREFIX(ArtistSong,0,'-') As Artist,EXTRACT_SUFFIX(ArtistSong,0,&bsol;) As Song FROM '%csv%' ORDER BY Artist DESC"
LogParser -i:TSV -rtp:-1 -o:datagrid -iSeparator:; -fixedSep:OFF -stats:On -headerRow:Off -iHeaderFile:%hdr% -iw:On -dtLines:10 -E:-1 "SELECT path, EXTRACT_TOKEN(path, 0, '.') AS ArtistSong,EXTRACT_PREFIX(ArtistSong,0,'-') As Artist,EXTRACT_SUFFIX(ArtistSong,0,'-') As Song FROM '%csv%' ORDER BY Artist DESC"
, fsize, fdate, ftime
:: LogParser -i:TSV -rtp:-1 -o:datagrid -iSeparator:; -fixedSep:OFF -stats:On -headerRow:Off -iHeaderFile:%hdr% -iw:On -dtLines:10 -E:-1 "SELECT path, fsize, fdate, ftime, EXTRACT_TOKEN(path, 0, '.') AS ArtistSong,EXTRACT_PREFIX(ArtistSong,0,'-') As Artist,EXTRACT_SUFFIX(ArtistSong,0,'-') As Song FROM '%csv%' ORDER BY fdate DESC"

:: "SELECT path
, EXTRACT_SUFFIX(path,0,'-') as Song
:: Bad as data has ; as delimiter - LogParser -i:CSV –o:DATAGRID -headerRow:on -iDQuotes:Ignore "SELECT path, fsize, fdate, ftime FROM '%csv%'"
:: SQL Convert sizes... SELECT Count(X570_MusicFiles.fsize) AS CountOffsize, Sum(X570_MusicFiles.fsize) AS TotalSize, Avg(X570_MusicFiles.fsize) AS Average, Sum([fsize]/1024) AS Kb, Sum([fsize]/1048576) AS Mb, Sum([fsize]/1073741824) AS Gb FROM X570_MusicFiles;
echo Create DISTINCT Folders for Artists and Move Files...&CALL Powershell -ExecutionPolicy ByPass -File "%OneDrive%\Scripts\Music-CreateFoldersFromSplitFN-Jazz.ps1"
echo RoboCopy newer Files. Files of the same age will be skipped. & RoboCopy "%Root%" "%Root%" "*.*" /XO /MT:4 /R:1 /W:1 /TS /TEE /XF ntuser*.*dat*
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│       LogParser Queries output to HTML            │
└───────────────────────────────────────────────────┘
 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-DiskUsage.tpl"  ...  INTO '%ohtm%\%ComputerName%_DiskUsageReport.html' FROM  ...  &START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_DiskUsageReport.html"
echo List all Songs in Audials by Composer and SongName&LogParser -i:FS -Recurse:-1 -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-DiskUsage.tpl" "SELECT Name, EXTRACT_TOKEN(Name, 0, '.') AS ArtistSong,EXTRACT_PREFIX(ArtistSong,0,'-') As Artist,EXTRACT_SUFFIX(ArtistSong,0,'-') As Song,Size,CreationTime INTO '%ohtm%\%ComputerName%_DiskUsageReport.html' FROM '%UserProfile%\Music\Audials\Audials Music\*.*' WHERE Attributes NOT LIKE 'D%' ORDER BY ArtistSong ASC"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_DiskUsageReport.html"

echo List all Songs in Audials by Composer and SongName&LogParser -i:FS -Recurse:-1 -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-AudialsArtistSong.tpl" "SELECT Name, EXTRACT_TOKEN(Name, 0, '.') AS ArtistSong,EXTRACT_PREFIX(ArtistSong,0,'-') As Artist,EXTRACT_SUFFIX(ArtistSong,0,'-') As Song,Size,CreationTime INTO '%ohtm%\%ComputerName%_AudialsArtistSongReport.html' FROM '%UserProfile%\Music\Audials\Audials Music\*.*' WHERE Attributes NOT LIKE 'D%' ORDER BY ArtistSong ASC"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_AudialsArtistSongReport.html"

echo List all Saved Audials Music Files&LogParser -i:FS -Recurse:-1 -q:off "SELECT Path,Name,Size,CreationTime,HASHMD5_FILE(Path) AS Hash INTO '%ohtm%\%ComputerName%_LogOnLogOff-Report.html' FROM '%UserProfile%\Music\Audials\Audials Music\*.*' WHERE Attributes NOT LIKE 'D%' ORDER BY Name ASC" -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-AudialsMusicFilesH.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LogOnLogOff-Report.html"

echo List all Saved Audials Music Files&LogParser -i:FS -Recurse:-1 -q:off "SELECT Path,Name,Size,CreationTime,HASHMD5_FILE(Path) AS Hash INTO '%ohtm%\%ComputerName%_LogOnLogOff-Report.html' FROM '%UserProfile%\Music\Audials\Audials Music\*.*' WHERE Attributes NOT LIKE 'D%' ORDER BY Name ASC" -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-AudialsMusicFiles.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LogOnLogOff-Report.html"

echo Count Extensions HTML Report on ALL Music Types in E:\$Music&&LogParser -i:FS -stats:on -E:5 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as Files INTO '%ohtm%\%ComputerName%_AllMusicTypesReport.html' FROM 'E:\$Music\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC" -o:TPL -TPL:"%OneDrive%\Batch\LP-AllMusicFiles.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_AllMusicTypesReport.html"

echo Count Extensions DataGrid Report on ALL Music Types in E:\$Music&&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as Files FROM '%OneDrive%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"

echo Count Extensions Report on ALL Music Types in E:\$Music&LogParser -i:FS -stats:on -E:5 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as Files INTO '%ohtm%\%ComputerName%_AllMusicTypesReport.html' FROM 'E:\$Music\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC" -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-AllMusicFiles.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_AllMusicTypesReport.html"

echo Retrieve Reg PrivateKey&LogParser -i:REG -stats:on "SELECT ValueName, Value, STRLEN(Value) as StrLen, TO_HEX(Value) as ToHexValue, HEX_TO_ASC(Value) as HexToAsc INTO '%ohtm%\%ComputerName%_LPPK-Report.html' FROM \HKEY_CURRENT_USER\Software\PrivateKey" -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-PkkList.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LPPK-Report.html"

echo Find Hive '\HKLM\HARDWARE\DESCRIPTION\System' and value 'REG_' in Registry&LogParser -i:REG -stats:On "SELECT KeyName as Hive,ValueName, Value, LastWriteTime INTO '%ohtm%\%ComputerName%_FindDataInReg-Report.html' FROM '\HKLM\HARDWARE\DESCRIPTION\System' ORDER BY Hive ASC" -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-RegHive.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_FindDataInReg-Report.html"

echo LogOn/LogOff Report&LogParser -i:EVT -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-LogOnOff.tpl" "SELECT STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username, ComputerName, TimeGenerated AS LogonTime, Message, Data INTO '%ohtm%\%ComputerName%_LogOnLogOff-Report.html' FROM Security WHERE EventID IN (541;542;543;528;552;4624;4625;4634;4647;4648;4779)"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LogOnLogOff-Report.html"

echo Test for Logon/LogOff&LogParser -i:EVT -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-TableSort.tpl" "SELECT STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username, ComputerName, TimeGenerated AS LogonTime, Message, Data INTO '%ohtm%\%ComputerName%_LogOnLogOff-Report.html' FROM Security WHERE EventID IN (541;542;543;528;552;4624;4625;4634;4647;4648;4779)"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LogOnLogOff-Report.html"

echo List all software installed&LogParser -i:REG -stats:On "SELECT KeyName as App, ValueName as What, Value as Data, LastWriteTime AS InstalDate INTO '%ohtm%\%ComputerName%_AllInstalledSoftware-Report.html' FROM \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall WHERE ValueName LIKE '%Display%' OR ValueName LIKE '%Publisher%' OR ValueName LIKE '%%inno%' OR ValueName LIKE '%%install%' ORDER BY App ASC" -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-AllDetSoftware.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_AllInstalledSoftware-Report.html"

echo Retrieve Reg PrivateKey&LogParser -i:REG -stats:on "SELECT ValueName, Value, STRLEN(Value) as StrLen, TO_HEX(Value) as ToHexValue, HEX_TO_ASC(Value) as HexToAsc INTO '%ohtm%\%ComputerName%_LPPK-Report.html' FROM \HKEY_CURRENT_USER\Software\PrivateKey" -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-PkList.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LPPK-Report.html"

echo Translate ASCI to Hex&LogParser -i:CSV -stats:on -q:off -headerRow:on -E:-1 "SELECT String, TO_HEX(String) as HexString INTO '%ohtm%\%ComputerName%_ToHexTrans-Report.html' FROM '%OneDrive%\AboutMe\TranslateToHex.txt'" -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-ToHexTrans.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_ToHexTrans-Report.html"

echo Translate ASCI to Hex HTML&LogParser -i:CSV -stats:on -q:off -headerRow:on -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-ToHexTrans.tpl" "SELECT String, TO_HEX(String) as HexString INTO '%ohtm%\%ComputerName%_ToHexTrans-Report.html' FROM %OneDrive%\AboutMe\TranslateToHex.txt"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_ToHexTrans-Report.html"
echo Translate ASCI to Hex Datagrid&LogParser -i:CSV -stats:on -q:off -headerRow:on -stats:On -rtp:-1 -o:datagrid -E:-1 "SELECT String, TO_HEX(String) as HexString FROM %OneDrive%\AboutMe\TranslateToHex.txt"
edit %OneDrive%\AboutMe\TranslateToHex.txt
CrazyName1!	        0x00,43,00,72,00,61,00,7A,00,79,00,4E,00,61,00,6D,00,65,00,31,00,21
DontUseThisOne1!	0x00,44,006F006E00740055007300650054006800690073004F006E006500310021
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: To-Do and Working On:
:: Done: Top 20 Files from OneDrive both DataGrid and HTML
echo Top 50 Files from $Data exclude OneDrive&LogParser -i:FS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT TOP 50 Path, Name, CreationTime, LastAccessTime, LastWriteTime, ProductName, FileVersion, FileDescription, Size, HASHMD5_FILE(Path) AS Hash FROM 'C:\$Data\*.*' WHERE Path NOT LIKE '%OneDrive%' ORDER BY Size,Hash DESC"

echo Top 20 Files from OneDrive&LogParser -i:FS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT TOP 20 Path, Name, CreationTime, LastAccessTime, LastWriteTime, ProductName, FileVersion, FileDescription, Size, HASHMD5_FILE(Path) AS Hash FROM '%OneDrive%\*.*' ORDER BY Size,Hash DESC"
echo Top 20 Files from OneDrive HTML&LogParser -i:FS -Recurse:-1 -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-FolderTop20.tpl" "SELECT TOP 20 Path, Name, Size, CreationTime, LastAccessTime, LastWriteTime, ProductName, FileVersion, FileDescription, HASHMD5_FILE(Path) AS Hash INTO '%ohtm%\%ComputerName%_FolderTop20.html' FROM '%OneDrive%\*.*' ORDER BY Size,Hash DESC"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_FolderTop20.html"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT DISTINCT Value,KeyName FROM \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\UnInstall WHERE ValueName LIKE '%DisplayName%' ORDER BY Value ASC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
┌───────────────────────────────────────────────────────────────────┐
│       List All Software Installed                                 │
└───────────────────────────────────────────────────────────────────┘
Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\UnInstall\* |  Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Out-GridView
Format-Table –AutoSize
Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\UnInstall\* |  Select-Object DisplayName | Out-GridView
:: Output to HTML template:
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\UnInstall WHERE ValueName LIKE '%DisplayName%' OR ValueName LIKE '%Publisher%' OR ValueName LIKE '%%installDate%' OR ValueName LIKE '%%installSource%' OR ValueName LIKE '%DisplayVersion%' OR ValueName LIKE '%VersionMajor%' OR ValueName LIKE '%VersionMinor%' OR ValueName LIKE '%%installSource%' ORDER BY KeyName,ValueName ASC"
LogParser -i:REG -stats:On -o:TPL -TPL:"%OneDrive%\LP-Templates\%OneDrive%\LP-Templates\LP-AllDetSoftware.tpl"
 INTO '%ohtm%\%ComputerName%_InstalledSoftware-Report.html'
 &START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_InstalledSoftware-Report.html"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Changing the look and feel of the HTML Template... White Background Usinf Calibri Font
LogParser -i:EVT -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-3ColTable.tpl" "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username INTO '%ohtm%\%ComputerName%_LogOnLogOff-Report.html' FROM Security WHERE EventID IN (541;542;543;528;552;4624;4625;4634;4647;4648;4779)"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LogOnLogOff-Report.html"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::----------------------------------------------------------------------------------------------------------
::  HTML Template for LogParser : %OneDrive%\LP-Templates\LP-LogParser Template.html -> copy to .tpl...
::----------------------------------------------------------------------------------------------------------
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value FROM '\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer'"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM '\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer' WHERE KeyName LIKE '%Color%'OR ValueName LIKE '%Color%' OR Value LIKE '%Color%'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +-----------------------------------------------------------------------------------+
:: | Check/Change the String Value of OneDrive in Registry File using Registry Editor  |
:: +-----------------------------------------------------------------------------------+
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value FROM '\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run'"
:: To: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run	Run	OneDrive	REG_SZ	"C:\Program Files\Microsoft OneDrive\OneDrive.exe" /background
:: Not To: <--> Error: File Not Found "C:\Users\%username%\AppData\Local\Microsoft\OneDrive\OneDrive.exe" /background
:: Query Registry Hive data
SET fields=Path,KeyName,ValueName,ValueType,Value,HEX_TO_ASC(Value) as HexValue,LastWriteTime
SET hive=HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT %fields% FROM \%hive% ORDER BY ValueName"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT ValueType, COUNT(*) INTO DATAGRID FROM \HKLM GROUP BY ValueType"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \HKLM\SYSTEM\CurrentControlSet\Services\EventLog\Application"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \HKLM\software\microsoft\windows\currentversion\Installer" # pschildname
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT ComputerName, KeyName, ValueName, ValueType, Value, LastWriteTime FROM \HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU ORDER BY ValueName"
:: Check which Programs are enabled on Startup
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \HKLM\Software\Microsoft\Windows\CurrentVersion\Run"
:: 10 most recently Installed programs, saving result as CSV file "SELECT TOP 10 Value AS Product, LastWriteTime AS [Date Installed] INTO RecentSoftware.csv
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion"
:: Needs work for Windows 11 - 10 most recently Installed programs - Windows 11 eventids for software updated, installed or modified
(3076;3077;3099)
REG QUERY "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT TOP 10 Value AS Product, LastWriteTime AS [InstallDate] FROM HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData WHERE ValueName='DisplayName' ORDER BY InstallDate DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Add an app to the Application hive
::	1) Create a new Key (ProgramName)
::	2) Under this new Key add 2 REG_SZ values...
::	(Default) ==> Fully Qualified Path and exe
::	Path      ==> Fully Qualified Path
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value FROM '\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\App Paths' ORDER BY ValueName"
REG ADD "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\notepad++.exe" /T REG_SZ /f /d "C:\\Program Files\\Notepad++\\notepad++.exe"
REG ADD "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\LogParser" /T REG_SZ /f /d "C:\\Program Files (x86)\\Log Parser 2.2\\LogParser"
REG ADD "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\notepad++.exe" /V Path /T REG_SZ /f /d "C:\\Program Files\\Notepad++"
REG ADD "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\LogParser" /V Path /T REG_SZ /f /d "C:\\Program Files (x86)\\Log Parser 2.2"
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LogParser /T REG_SZ /f /d "C:\\Program Files (x86)\\Log Parser 2.2"
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V Notepad++ /T REG_SZ /f /d "C:\\Program Files\\Notepad++"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::  Error: Semantic Error: presence of field expression(s) in the ORDER BY clause not existing in the SELECT clause
:: Bad echo List 100 most recently Installed programs, saving result as CSV file&LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT TOP 100 Value AS Product, LastWriteTime AS [Date Installed] FROM HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData WHERE ValueName='DisplayName' ORDER BY LastWriteTime DESC"
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────────────────────┐
│       Reg Setup and Show Last Login Details at Startup            │
│       NOTE: This displays a yellow page with info                 │
└───────────────────────────────────────────────────────────────────┘
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value FROM '\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System' ORDER BY ValueName"
REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /V DisplayLastLogonInfo
:: If ERROR: The system was unable to find the specified registry key or value., then it's not set!
REG ADD "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /V DisplayLastLogonInfo  /T REG_DWORD /d 1 /f
echo "Needs Reboot after REG ADD" Note:  After Reboot it asks you if this is the first time for interactive login...
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
SET "out="
echo SET "out=%odl%\LogParser-InputandOutputFormats.txt" && SET cmd=LogParser -h -i:* && echo Processing: %cmd% >"%out%" && CAll %cmd% >>"%out%" && Notepad++ "%out%"
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:IISW3C  (IIS W3C Extended Log Format)                              │
└─────────────────────────────────────────────────────────────────────────────────────┘
:: +--------------------+-----------+--------------------------------------------------------------
:: | -i:IISW3C Name	    | Type		| Description
:: +--------------------+-----------+--------------------------------------------------------------
Fields:
  LogFilename (S)             LogRow (I)                  date (T)
  time (T)                    c-ip (S)                    cs-username (S)
  s-sitename (S)              s-computername (S)          s-ip (S)
  s-port (I)                  cs-method (S)               cs-uri-stem (S)
  cs-uri-query (S)            sc-status (I)               sc-substatus (I)
  sc-win32-status (I)         sc-bytes (I)                cs-bytes (I)
  time-taken (I)              cs-version (S)              cs-host (S)
  cs(User-Agent) (S)          cs(Cookie) (S)              cs(Referer) (S)
  s-event (S)                 s-process-type (S)          s-user-time (R)
  s-kernel-time (R)           s-page-faults (I)           s-total-procs (I)
  s-active-procs (I)          s-stopped-procs (I)
 LogFilename, LogRow, date, time, c-ip, cs-username, s-sitename, s-computername, s-ip, s-port, cs-method, cs-uri-stem, cs-uri-query, sc-status, sc-substatus, sc-win32-status, sc-bytes, cs-bytes, time-taken, cs-version, cs-host, cs(User-Agent), cs(Cookie), cs(Referer), s-event, s-process-type, s-user-time, s-kernel-time, s-page-faults, s-total-procs, s-active-procs, s-stopped-procs

:: LogParser -i:IISW3C -----------------------------------------------------------------------------
:: -i:IISW3C (IIS W3C Extended Log Format) ---------------------------------------------------------
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────┐
│      Auditing IIS and Installed IIS Services        │
└─────────────────────────────────────────────────────┘
:: Determining which services to audit, it is important to know which services have been installed and which related sites have been created.
--- Ch03LogonLogoffBehavior.sql --- Determining Logon/Logoff Behavior
4624: A user successfully logged on to a computer.
4625: A logon attempt failed.
4634: A user logged off.
4647: A user initiated the logoff process.
4779: A user disconnected a terminal server session without logging off
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT resolve_sid(sid) AS UserName, eventid, TimeGenerated FROM Security WHERE EventID IN (4624;4625;528) AND to_date(TimeGenerated)='2024-09-06 00:00:00' AND sid not in ( SELECT DISTINCT sid FROM Security WHERE EventID IN (4634;4647;4779;538) AND to_date(TimeGenerated)='2024-09-06 00:00:00' )"
--- Ch03LogonLogoffBehavior.sql ---
--- file:Ch08IISservices.sql --- Installed IIS Services
LogParser –i:ADS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT ObjectName AS SiteID, PropertyValue AS SiteName, CASE ObjectClass WHEN 'IIsWebServer' THEN 'HTTP' WHEN 'IIsFtpServer' THEN 'FTP' WHEN 'IIsSmtpServer' THEN 'SMTP' WHEN 'IIsNntpServer' THEN 'NNTP' ELSE 'Unknown Service' END AS Service FROM IIS://LOCALHOST WHERE (ObjectClass LIKE '%Server') AND (ObjectPath NOT LIKE '%/W3SVC/Info/%') AND (ObjectPath NOT LIKE '%/MSFTPSVC/Info/%') AND (PropertyName = 'ServerComment') ORDER BY Service, SiteID"
---Ch08ContentTypes.sql---
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT [File Type], Total USING TO_LOWERCASE(EXTRACT_EXTENSION(name)) AS Type, CASE STRLEN(Type) WHEN 0 THEN 'No extension' ELSE Type END AS [File Type], COUNT() AS Total FROM 'C:\Garmin\*.*' WHERE (attributes NOT LIKE 'D%') GROUP BY [File Type] ORDER BY Total DESC"
Error: Syntax Error: <sqlfunction-expr>: not a valid <field-expr-list>
---Ch08ContentTypes.sql---
---Ch08IISservices.sql---
---Ch08SvrPorts.sql---  Retrieving IP and Port Bindings
LogParser –i:ADS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT Services, SiteID, IPAddr, Port USING STRLEN(EXTRACT_TOKEN(PropertyValue,0,':')) AS IPValue,CASE ObjectClass WHEN 'IIsWebServer' THEN 'HTTP' WHEN 'IIsFtpServer' THEN 'FTP' WHEN 'IIsSmtpServer' THEN 'SMTP' WHEN 'IIsNntpServer' THEN 'NNTP' ELSE 'Unknown Service' END AS Services, ObjectName AS SiteID, CASE IPValue WHEN 0 THEN 'All Unassigned' ELSE EXTRACT_TOKEN(PropertyValue,0,':') END AS IPAddr, EXTRACT_TOKEN(PropertyValue,1,':') AS Port FROM IIS://LOCALHOST WHERE  (PropertyName = 'ServerBindings') AND (ObjectClass LIKE '%Server') AND (ObjectPath NOT LIKE '%/W3SVC/Info/%') AND (ObjectPath NOT LIKE '%/MSFTPSVC/Info/%')"
---Ch08SvrPorts.sql---
---Ch08SysVolContents.sql--- Auditing Content Paths
LogParser –i:ADS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT EXTRACT_TOKEN(ObjectPath,1,'LOCALHOST/') AS [Sites or virtual directories], TO_LOWERCASE(PropertyValue) AS MappedPath FROM IIS://LOCALHOST WHERE (PropertyName = 'Path') AND (PropertyValue LIKE '%SystemDrive%%')  ORDER BY [Sites or virtual directories]"
---Ch08SysVolContents.sql---
---Ch08IISAuths.sql--- www.syngress.com 216 Chapter 8 • Security Auditing
LogParser –i:ADS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT EXTRACT_TOKEN(ObjectPath,1,'LOCALHOST/') AS [Sites or virtual directories], CASE TO_INT(PropertyValue) WHEN 1 THEN 'Anonymous Auth' WHEN 2 THEN 'Basic Auth' WHEN 3 THEN 'Anonymous|Basic' WHEN 4 THEN 'Integrated Windows Auth' WHEN 5 THEN 'Anonymous|Integrated' WHEN 6 THEN 'Basic|Integrated' WHEN 7 THEN 'Anonymous|Basic|Integrated' WHEN 16 THEN 'Digest Auth' WHEN 17 THEN 'Anonymous|Digest' WHEN 18 THEN 'Basic|Digest' WHEN 19 THEN 'Anonymous|Basic|Digest' WHEN 20 THEN 'Integrated|Digest' WHEN 21 THEN 'Anonymous|Integrated|Digest' WHEN 22 THEN 'Basic|Integrated|Digest' WHEN 23 THEN 'Anonymous|Basic|Integrated|Digest' WHEN 64 THEN 'Passport Auth' WHEN 65 THEN 'Anonymous|Passport' ELSE 'Unknown methods' END AS Authentication FROM IIS://LOCALHOST WHERE (PropertyName = 'AuthFlags') AND (ObjectClass NOT LIKE '%Service') AND (ObjectClass NOT LIKE '%WebServer') AND (ObjectPath NOT LIKE '%/W3SVC/Info/%') AND (ObjectPath NOT LIKE '%/MSFTPSVC/Info/%')"
---Ch08IISAuths.sql---
---Ch08BasicNoSSL.sql---
:: SELECT within a SELECT - Secure Sockets Layer (SSL) connection to secure the communication channel when using basic authentication
LogParser –i:ADS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT EXTRACT_TOKEN(ObjectPath,1,'LOCALHOST/') AS [Basic Auth enabled without SSL] FROM IIS://LOCALHOST/W3SVC WHERE (PropertyName='AccessSSL') AND (PropertyValue='0') HAVING ObjectPath IN (SELECT ObjectPath FROM IIS://LOCALHOST/W3SVC WHERE (PropertyName = 'AuthBasic') AND (PropertyValue = '1') AND (ObjectPath NOT LIKE '%/W3SVC/Info/%'))"
---Ch08BasicNoSSL.sql---
---Ch08LogonMethods.sql---
:: SELECT within a SELECT - sites or directories that are using different logon types other than the default NETWORK_CLEARTEXT type.
LogParser –i:ADS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT EXTRACT_TOKEN(ObjectPath,1,'LOCALHOST/') AS [Sites or virtual directories], CASE TO_INT(PropertyValue) WHEN 0 THEN 'Interactive Logon' WHEN 1 THEN 'Batch Logon' WHEN 2 THEN 'Network Logon' ELSE STRCAT('Unknown Method:',PropertyValue) END AS [Logon Method] FROM IIS://LOCALHOST/ WHERE (PropertyName = 'LogonMethod') AND (PropertyValue <> '3')"
---Ch08LogonMethods.sql---
---Ch08WriteAccess.sql---
:: analyzes the Metabase to locate write-enabled virtual directories along with other configured access permissions
:: example of a SELECT within a SELECT, where the inner SELECT statement looks for sites or virtual directories with write access enabled (in which the value for the AccessWrite key is 1).The main SELECT statement further processes the result and determines other configured permissions; this is done by obtaining the value of AccessFlags in the Metabase. www.syngres
LogParser –i:ADS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT EXTRACT_TOKEN(ObjectPath,1,'LOCALHOST/') AS [Sites or virtual directories], CASE TO_INT(PropertyValue) WHEN 2 THEN 'Write Only' WHEN 3 THEN 'Read|Write' WHEN 18 THEN 'Write|Script Source Access' WHEN 19 THEN 'Read|Write|Script Source Access' WHEN 514 THEN 'Write|Scripts Only' WHEN 515 THEN 'Read|Write|Scripts Only' WHEN 518 THEN 'Write|Scripts and Executables' WHEN 530 THEN 'Write|Script Source Access|Scripts Only' WHEN 531 THEN 'Read|Write|Script Source Access|Scripts Only' WHEN 534 THEN 'Write|Script Source Access|Scripts and Executables' WHEN 535 THEN 'Read|Write|Script Source Access|Scripts and Executables' ELSE STRCAT('Unknown properties :',PropertyValue) END AS [Access Mode] FROM IIS://LOCALHOST WHERE (PropertyName = 'AccessFlags') AND ((ObjectPath LIKE '%MSFTPSVC%') OR (ObjectPath LIKE '%W3SVC%')) HAVING ObjectPath IN (SELECT ObjectPath FROM IIS://LOCALHOST WHERE (PropertyName = 'AccessWrite') AND (PropertyValue='1'))"
---Ch08WriteAccess.sql---
---Ch08DirBrowsing.sql--- Security Auditing • Chapter 8 223
LogParser –i:ADS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT EXTRACT_TOKEN(ObjectPath,1,'LOCALHOST/') AS [Directory Browsing Enabled Path], CASE TO_INT(PropertyValue) WHEN 0 THEN 'Not Configured' WHEN 1 THEN 'Configured' ELSE STRCAT('Unknown status:',PropertyValue) END AS DefaultDoc FROM IIS://LOCALHOST/W3SVC WHERE (PropertyName = 'EnableDefaultDoc') HAVING ObjectPath IN (SELECT ObjectPath FROM IIS://LOCALHOST/W3SVC WHERE (PropertyName = 'EnableDirBrowsing') AND (PropertyValue = '1'))"
---Ch08DirBrowsing.sql---
---Ch08NoLogs.sql--- www.syngress.com Security Auditing • Chapter 8 223
LogParser –i:ADS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT EXTRACT_TOKEN(ObjectPath,1,'LOCALHOST/') AS [Path with logging disabled] FROM IIS://LOCALHOST/ WHERE (PropertyName = 'LogType') AND (PropertyValue = '0') AND (ObjectClass LIKE '%Server')"
---Ch08NoLogs.sql---
---Ch08AppPoolId.sql--- www.syngress.com 224 Chapter 8 • Security Auditing
LogParser –i:ADS -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT ObjectName AS [Application Pool], CASE TO_INT(PropertyValue) WHEN 0 THEN 'Local System' WHEN 1 THEN 'Local Service' WHEN 2 THEN 'Network Service (default)' WHEN 3 THEN 'Customize User' ELSE STRCAT('Unknown Identity:',PropertyValue) END AS [Application Identity] FROM IIS://LOCALHOST/W3SVC WHERE (PropertyName = 'AppPoolIdentityType') HAVING ObjectPath IN (SELECT DISTINCT ObjectPath FROM IIS://LOCALHOST/W3SVC WHERE (ObjectClass = 'IIsApplicationPool'))"
---Ch08AppPoolId.sql---
---Ch08ContentTypes.sql--- Security Auditing • Chapter 8 231
:: LogParser file:Ch08ContentTypes.sql?chartname="webcontenttypes.gif" +source="d:\web\." –i:fs -o:chart -chartType:PieExploded3d -chartTitle:"Website Content Types" –values:on -view -groupSize:800x600
LogParser -i:FS -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Ch08ContentTypes.sql" "SELECT [File Type], Total USING TO_LOWERCASE(EXTRACT_EXTENSION(name)) AS Type, CASE STRLEN(Type) WHEN 0 THEN 'No extension' ELSE Type END AS [File Type], COUNT() AS Total INTO '%ohtm%\%ComputerName%_Ch08ContentTypes.gif' FROM '%IISLogs%\*.log' WHERE (attributes NOT LIKE 'D%') GROUP BY [File Type] ORDER BY Total DESC"
Error: Syntax Error: <sqlfunction-expr>: not a valid <field-expr-list>
---Ch08ContentTypes.sql---
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  Daily -i:IISW3C log data performance monitoring and error mining                   │
│  Below are metrics to examine and short descriptions...                             │
└─────────────────────────────────────────────────────────────────────────────────────┘
Key IIS metrics to monitor https://www.datadoghq.com/blog/iis-metrics/#http-response-metrics
:: Check if the module required is Available or Installed (Powershell)
Get-CMIInstance ? -OR-  Get-WmiObject ?
Get-WindowsCompatibility -Name RSAT* -Online   :: ERROR: Get-WindowsCompatibility: The term 'Get-WindowsCompatibility' is not recognized as a name of a cmdlet, function, script file, or executable program.
Get-CimInstance CIM_Product | Select-Object Name, PackageCache | Sort-Object Name | Out-GridView
Install-module "Windows SDK" -force
Import-module  "Windows SDK" -force -verbose
:: Enabling the Web Service performance counter class (Powershell)
Get-WmiObject -List -Namespace root\cimv2 | select -Property name | where name -like "*Win32_PerfFormattedData_W3SVC*"
:: Installing Web Service:
Install-windowsfeature web-common-http
Get-WmiObject -Class Win32_PerfFormattedData_W3SVC_WebService

Metric to alert on
    TotalMethodRequestsPerSec
    CurrentQueueSize - Microsoft recommends setting the maximum queue length no higher than 10,000
    5xx server errors
    time-taken
Metrics to watch
    Requests / Sec
    cs-method, cs-uri-stem
    4xx client errors
    ElapsedTime
    ServiceUptime
    PercentProcessorTime
    WorkingSet
:: HTTP request metrics
Name	                    Description	                                                        Metric Type	        Availability
TotalMethodRequestsPerSec	Rate of requests received per second by the WWW Service, per site	Work: Throughput	Web Service counter set
Requests / Sec	            Rate of requests received by a given worker process	                Work: Throughput	W3SVC_W3WP performance counter set
CurrentQueueSize	        Number of requests in the HTTP.sys queue, per application pool	    Resource: Saturation HTTP Service Request Queues counter set
cs-uri-stem	                Rate of requests to a Specific URI path	                            Work: Throughput	IIS logs
cs-method	                Rate of requests sent through a Specific HTTP method	            Work: Throughput	IIS logs, Web Service counter set
:: HTTP response metrics
Name	                    Description	                                                        Metric Type	        Availability
4xx errors	                Count or rate of 4xx client errors	                                Work: Error	        IIS logs, W3SVC_W3WP performance counter SET (for certain error codes)
5xx errors	                Count or rate of 5xx server errors	                                Work: Error	        IIS logs, W3SVC_W3WP performance counter SET (for 500 error codes)
time-taken	                Time elapsed between the first byte of a request and the final byte of a response	Work: Performance	IIS logs
:: Availability metrics
Name	                    Description	                                                        Metric Type	        Availability
ElapsedTime	                Number of seconds a process has been running	            Resource: Availability	    Process performance counter set
ServiceUptime	Number of seconds the WWW Service has been running (per site or across All sites)	Resource: Availability	Web Service counter set
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo ***** determining IIS Errors by hour (Error code larger than 500) *****
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600)) AS LocalTime, COUNT(*) AS Error_Frequency FROM '%IISLogs%\*.log' WHERE sc-status >= 500 GROUP BY TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600)) ORDER BY TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600)) ASC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: The following query returns the distribution of the number of bytes sent by the server for each page type: ---Ch01BytesSentPerPageTypeChart.sql---
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:PieExploded3D -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Ch01BytesSentPerPageTypeChart" -E:-1 -view:ON "SELECT TO_LOWERCASE(EXTRACT_EXTENSION(cs-uri-stem)) AS PageType, MUL(PROPSUM(sc-bytes), 100.0) AS PercentBytes INTO %odl%\Ch01BytesSentPerPageTypeChart.jpg FROM '%IISLogs%\*.log' GROUP BY PageType HAVING PercentBytes >= 1.0 ORDER BY PercentBytes DESC"
:: Examples from: 5/4/2021 Log Parser Plus https://LogParserplus.com/examples/
echo %Date% !Time! [MSG] HTTP Status Codes (text):&&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT sc-status AS [HTTP Status Code], COUNT(*) AS Requests INTO HttpStatusCodes.txt FROM '%IISLogs%\*.log' GROUP BY [HTTP Status Code] ORDER BY Requests DESC"
echo %Date% !Time! [MSG]Data Sent and Received by File Type:&&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS [File Type], DIV(SUM(sc-bytes), 1024) AS [Sent (KB)], DIV(SUM(cs-bytes), 1024) AS [Received (KB)] INTO FileTypeDataSentRec.txt FROM '%IISLogs%\*.log' GROUP BY [File Type] ORDER BY [File Type]"
echo %Date% !Time! [MSG]Get a list of domains that referred traffic to your site&&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT EXTRACT_TOKEN(cs(Referer), 2, '/') AS [Domain], COUNT(*) AS [Requests] INTO ReferringDomains.txt FROM '%IISLogs%\*.log' GROUP BY [Domain] ORDER BY [Requests] DESC"
echo %Date% !Time! [MSG]HTTP Status Codes and Percentage of Total&&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT sc-status, COUNT(*) AS [Requests], MUL(PROPCOUNT(*), 100) AS [Percentage] FROM '%IISLogs%\*.log' GROUP BY sc-status"
:: Return a listing of Web pages, and referring pages, that returned a 400 status code
echo %Date% !Time! [MSG]Find Web pages and referring pages that returned a 400 status code.&&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT cs-uri-stem, cs-uri-query, date, sc-status, cs(Referer) FROM '%IISLogs%\*.log' WHERE (sc-status BETWEEN 400 AND 499) ORDER BY sc-status, date, cs-uri-stem, cs-uri-query"
:: Return a listing of Web pages, and referring pages, that returned a 300 status code
echo %Date% !Time! [MSG]Retrieve Web pages and referring pages that returned a 300 status code.&&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT cs-uri-stem, cs-uri-query, date, sc-status, cs(Referer) FROM '%IISLogs%\*.log' WHERE (sc-status >= 300 AND sc-status < 400) ORDER BY sc-status, date, cs-uri-stem, cs-uri-query"
:: Return a listing of Web pages, and referring pages, that returned a 200 status code
echo %Date% !Time! [MSG]Get a listing of Web pages and referring pages that returned a 200 status code.&&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT cs-uri-stem, cs-uri-query, date, sc-status, cs(Referer) FROM '%IISLogs%\*.log' WHERE (sc-status >= 200 AND sc-status < 300) ORDER BY sc-status, date, cs-uri-stem, cs-uri-query"
:: Returns a listing of requests by hour, per day, converted to local time.
echo %Date% !Time! [MSG]Retrieve requests by hour, per day, converted to local time.&&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time), 3600)) AS [DateTime], COUNT(*) AS [Requests] FROM '%IISLogs%\*.log' GROUP BY [DateTime] ORDER BY [DateTime]"
:: INTO '%ohtm%\%ComputerName%_HourlyDayReport.txt'
:: Returns a listing of requests by hour, across all days, converted to local time. - Requests by hour (using TO_TIME)
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_TIME(TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time), 3600))) AS [Hour], COUNT(*) AS [Requests], MUL(PROPCOUNT(*), 100) AS [PercentOfTotal] FROM '%IISLogs%\*.log' GROUP BY [Hour] ORDER BY [Hour]"
::Requests by seconds to process - Number of requests that took how x seconds to process, rounded up to the nearest second.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT ADD(DIV(QUANTIZE(time-taken, 1000), 1000), 1) AS [Seconds], COUNT(*) AS [Requests] FROM '%IISLogs%\*.log' GROUP BY [Seconds] ORDER BY [Seconds] DESC"
:: Bandwidth usage by request - Returns pages sorted by the total number of bytes transferred, as well as the total number of requests and average bytes
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT DISTINCT TO_LOWERCASE(cs-uri-stem) AS [Url], COUNT(*) AS [Requests], AVG(sc-bytes) AS [AvgBytes], SUM(sc-bytes) AS [Bytes sent] FROM '%IISLogs%\*.log' GROUP BY [Url] HAVING [Requests] >= 20 ORDER BY [Bytes sent] DESC"
:: POSTs per ip by total requests Returns a listing of ips doing POST requests, ordered by the number of POSTs. Helpful for tracking down users attempting to spam.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT c-ip, COUNT(*) AS [Requests] FROM '%IISLogs%\*.log' WHERE cs-method = 'POST' GROUP BY c-ip ORDER BY [Requests] DESC"
:: Cookie lengths Returns cookie lengths along with the ip and the number of requests made with that cookie/ip. Keywords:
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT STRLEN(cs(Cookie)) AS [CookieLength], c-ip, COUNT(*) AS [Requests], cs(Cookie) FROM '%IISLogs%\*.log' WHERE cs(cookie) IS NOT null GROUP BY cs(Cookie), c-ip, [CookieLength] ORDER BY [CookieLength] DESC"
:: Query parameters with counts and ips - Returns a listing of query parameters passed to pages, along with the number of times IP addresses made those requests.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT cs-uri-query, COUNT(*) AS [Requests], c-ip FROM '%IISLogs%\*.log' WHERE cs-uri-query IS NOT null GROUP BY cs-uri-query, c-ip ORDER BY cs-uri-query"
:: Query parameters with counts Returns a listing of query parameters passed to pages, with the number of times such requests were made. Helpful to get an idea on whether any hacking attempts were being made.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT cs-uri-query, COUNT(*) AS [Requests] FROM '%IISLogs%\*.log' WHERE cs-uri-query IS NOT null GROUP BY cs-uri-query ORDER BY cs-uri-query"
:: Query parameter hacking attempt - http://Returns a listing of IP addresses that may be making a hacking attempt by passing a site address.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT c-ip, COUNT(*) AS [Requests] FROM '%IISLogs%\*.log' WHERE cs-uri-query IS NOT null and STRCNT(TO_LOWERCASE(cs-uri-query), 'http://') > 0 GROUP BY c-ip ORDER BY [Requests] DESC"
:: Requests per day - Returns a listing of dates with the total number of requests
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_STRING(TO_LOCALTIME(TO_TIMESTAMP(date, time)), 'yyyy-MM-dd') AS [Day], COUNT(*) AS [Requests] FROM '%IISLogs%\*.log' GROUP BY [Day] ORDER BY [Day]"
:: Requests by seconds to process, with percentages Number of requests that took how x seconds to process, rounded up to the nearest second, with what percent of requests that is.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT ADD(DIV(QUANTIZE(time-taken,1000),1000),1) AS [Seconds], COUNT(*) AS [Requests], MUL(PROPCOUNT(*),100) AS [Percent] FROM '%IISLogs%\*.log' GROUP BY [Seconds] ORDER BY [Seconds]"
:: Requests in the last 15 minutes - Pull a listing of requests within the last 15 minutes.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_LOCALTIME(TO_TIMESTAMP(date, time)) AS [LocalTime], * FROM '%IISLogs%\*.log' WHERE LocalTime > SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 00:15', 'yyyy-MM-dd HH:mm'))"
:: User accounts used in IIS 6 FTP login attempts - The following Log Parser query can be used on FTP log Files in order to determine what user names were used to login, or attempt to login, to an FTP site.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT cs-uri-stem, count(cs-method) FROM '%IISLogs%\*.log'  WHERE cs-method like '%USER' GROUP BY cs-uri-stem ORDER BY count(cs-method), cs-uri-stem"
:: 500 status codes - Return a listing of Web pages, and referring pages, that returned a 500 status code
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT cs-uri-stem, cs-uri-query, date, sc-status, cs(Referer) FROM '%IISLogs%\*.log' WHERE (sc-status >= 500 AND sc-status < 600) ORDER BY sc-status, date, cs-uri-stem, cs-uri-query"
:: Request methods with ip and user agent - This query grabs all requests by method, excluding common GETs and POSTs. Returns ip address and user agents, with count for each, for determining whether any are testing vulnerabilities.
LogParser -i:W3C -rtp:-1 -o:datagrid -q:On -stats:On -E:-1 "SELECT cs-method, c-ip, cs(User-Agent), COUNT(*) AS [Requests] FROM '%IISLogs%\*.log' WHERE cs-method NOT IN ('GET';'POST') GROUP BY cs-method, c-ip, cs(User-Agent) ORDER BY cs-method, Requests"
LogParser -i:w3c -o:w3c -q:On -stats:On -E:-1 "SELECT cs-method, c-ip, cs(User-Agent), COUNT(*) AS [Requests] INTO %odl%\%ComputerName%_requestMethods.log FROM '%IISLogs%\*.log' WHERE cs-method NOT IN ('GET';'POST') GROUP BY cs-method, c-ip, cs(User-Agent) ORDER BY cs-method, Requests"
:: Bandwidth usage, with local dates - Returns bytes (as well as converted to KB and MB) received and sent, per date, for a Web site, with request date/time converted to local time.
:: LogParser -i:W3C -rtp:-1 -o:datagrid -q:On -stats:On -E:-1  Error: SELECT clause: Syntax Error: unknown field 'cs-bytes'
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_DATE(TO_LOCALTIME(TO_TIMESTAMP(date, time))) AS [LocalDate], SUM(cs-bytes) AS [Bytes received], DIV(SUM(cs-bytes), 1024) AS [KBytes received], DIV(DIV(SUM(cs-bytes), 1024), 1024) AS [MBytes received], SUM(sc-bytes) AS [Bytes sent], DIV(SUM(sc-bytes), 1024) AS [KBytes sent], DIV(DIV(SUM(sc-bytes), 1024), 1024) AS [MBytes sent], COUNT(*) AS Requests FROM '%IISLogs%\*.log' GROUP BY LocalDate ORDER BY LocalDate"
:: Request time - Returns the number of times a particular page (in this case .as* Files) was hit, with the average, minimum, and maximum time taken, along with the standard deviation. -o:csv INTO TimeTaken.csv
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(cs-uri-stem) AS csUriStem, COUNT(*) AS Hits, DIV ( MUL(1.0, SUM(time-taken)), Hits ) AS AvgTime, SQRROOT ( SUB ( DIV ( MUL(1.0, SUM(SQR(time-taken)) ), Hits ) , SQR(AvgTime) ) ) AS StDev, Max(time-taken) AS Max, Min(time-taken) AS Min, TO_REAL(STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus)))) AS Status, Min(TO_LOCALTIME(date)) AS LastUpdate FROM '%IISLogs%\*.log' WHERE cs-uri-stem like '%.as%' GROUP BY TO_LOWERCASE(cs-uri-stem), TO_REAL(STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus)))) HAVING COUNT(*) > 2"
:: Busiest Times Requests by hour (using TO_STRING) - Returns a listing of requests by hour, across all days, by converting the hour to a string.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_STRING(time, 'hh') AS [Hour], COUNT(*) AS [Requests], MUL(PROPCOUNT(*), 100) AS [PercentOfTotal] FROM '%IISLogs%\*.log' GROUP BY [Hour] ORDER BY [Hour]"
:: Average bandwidth per second by half hour - Returns the average bandwidth, as KBytes per second, broken into 30 minute blocks - LogParser -i:iis
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_LOCALTIME(QUANTIZE(time, 1800)) as HalfHour, ADD(SCKBytesSec, CSKBytesSec) as KBytesSec USING DIV(DIV(MUL(1.0, SUM(sc-bytes)), 1024), 1800) as SCKbytesSec, DIV(DIV(MUL(1.0, SUM(cs-bytes)), 1024), 1800) as CSKBytesSec FROM '%IISLogs%\*.log' GROUP BY HalfHour ORDER BY HalfHour ASC"
:: Average response time by half hour - Returns the average response time, in milliseconds, of a particular page (in this case .as* Files) broken into 30 minute blocks.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_LOCALTIME(QUANTIZE(time, 1800)) as HalfHour, AVG(time-taken) as Time FROM '%IISLogs%\*.log' WHERE cs-uri-stem like '%.as%' AND sc-status < 400 GROUP BY HalfHour ORDER BY HalfHour ASC"
:: Number of errors by half hour - Returns the total number of errors, broken into 30 minute blocks
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_LOCALTIME(QUANTIZE(time, 1800)) as HalfHour, COUNT(*) as Hits FROM '%IISLogs%\*.log' WHERE sc-status > 399 GROUP BY HalfHour ORDER BY HalfHour ASC"
:: Browsers accessing content - Return a listing of browsers (user agents), with counts, that accessed content.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT cs(User-Agent) AS Browser, COUNT(*) AS Requests FROM '%IISLogs%\*.log' GROUP BY Browser ORDER BY Requests DESC"
:: Requests by half hour - Total number of requests, broken into 30 minute blocks.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_LOCALTIME(QUANTIZE(time, 1800)) as HalfHour, COUNT(*) as Hits FROM '%IISLogs%\*.log' GROUP BY HalfHour ORDER BY HalfHour ASC"
:: HTTP status codes and sub-status - Returns a listing of status and sub-status codes, with number of requests returning each
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus))) AS Status, Count(*) as Hits FROM '%IISLogs%\*.log' GROUP BY Status ORDER BY Hits DESC"
:: Browsers accessing content, without operating system (image) - Returns a listing of browsers accessing content as a bar chart, based upon the number of requests made."SELECT... INTO %ohtm%\%ComputerName%_Browsers-accessing-content.jpg FROM '%IISLogs%\*.log'
:: NOTE. Based off below query Need to find out ALL browser values and add to this... cs(User-Agent)
LogParser -i:W3C -rtp:-1 -o:datagrid -q:On -stats:On -E:-1 "SELECT cs(User-Agent) AS Agents, COUNT(*) AS Ctr FROM '%IISLogs%\*.log' GROUP BY cs(User-Agent) ORDER BY Agents ASC"
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:barstacked -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Browsers accessing content" -E:-1 -view:ON "SELECT CASE strcnt(cs(user-agent),'Firefox') when 1 THEN 'Firefox' else case strcnt(cs(user-agent),'netscape') when 1 THEN 'netscape' else case strcnt(cs(user-agent),'AOL') when 1 THEN 'AOL' else case strcnt(cs(user-agent),'Opera') when 1 THEN 'Opera' else case strcnt(cs(user-agent),'Chrome') when 1 THEN 'Chrome' else case strcnt(cs(user-agent),'Mobile') when 1 THEN 'SmartPhone' else case strcnt(cs(user-agent),'Safari') when 1 THEN 'Safari' else case strcnt(cs(user-agent),'MSIE+5') when 1 THEN 'IE 5' else case strcnt(cs(user-agent),'MSIE+6') when 1 THEN 'IE 6' else case strcnt(cs(user-agent),'MSIE+7') when 1 THEN 'IE 7' else case strcnt(cs(user-agent),'MSIE+8') when 1 THEN 'IE 8' else case strcnt(cs(user-agent),'MSIE') when 1 THEN 'IE other' else case strcnt(cs(user-agent),'bot') when 1 THEN 'Bot' else case strcnt(cs(user-agent),'spider') when 1 THEN 'spider' else case strcnt(cs(user-agent),'PutHTTP') when 1 THEN 'PutHTTP' else case strcnt(cs(user-agent),'Mozilla/4.0') when 1 THEN 'Mozilla/4.0 other' ELSE 'Unknown' End End End End End End End End End End End End End End End End as Browser, COUNT(cs(User-Agent)) as Hits INTO '%ohtm%\%ComputerName%_Browsers-accessing-content.jpg' FROM '%IISLogs%\*.log' GROUP BY Browser ORDER BY Hits ASC"
:: Count of directory of iles requested - Returns a count of the parent directory of all file requests.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT COUNT(*) AS [Requests], EXTRACT_PATH(cs-uri-stem) AS [Path Requested] FROM '%IISLogs%\*.log' GROUP BY [Path Requested] ORDER BY [Requests] DESC"
:: SMTP usage with basic logs - Returns information from an IIS SMTP instance (Windows Server 2012) when all you have is basic logs.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT c-ip, REVERSEDNS(c-ip) AS [ClientHostName], cs-method, COUNT(*) AS [Requests] FROM '%IISLogs%\*.log' WHERE cs-method IN ('RCPT') GROUP BY c-ip, [ClientHostName], cs-method ORDER BY [Requests] DESC"
:: HTTP Status Codes (pie chart) - Returns a pie chart showing what percentage status codes account for. Requires Microsoft Office
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:Pie -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Status as Percent of Requests" -E:-1 -view:ON "SELECT sc-status AS [HTTP Status Code], COUNT(*) AS Requests INTO '%ohtm%\%ComputerName%_StatusCodePieChart.png' FROM '%IISLogs%\*.log' GROUP BY [HTTP Status Code] ORDER BY Requests DESC"
:: Task completed with errors. Unexpected internal error calling chart object method ExportPicture:   Exception occurred.
:: Bandwidth usage - Returns bytes (as well as converted to KB and MB) received and sent, per date, for a Web site.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT date, SUM(cs-bytes) AS [Bytes received], DIV(SUM(cs-bytes), 1024) AS [KBytes received], DIV(DIV(SUM(cs-bytes), 1024), 1024) AS [MBytes received], SUM(sc-bytes) AS [Bytes sent], DIV(SUM(sc-bytes), 1024) AS [KBytes sent], DIV(DIV(SUM(sc-bytes), 1024), 1024) AS [MBytes sent], COUNT(*) AS Requests FROM '%IISLogs%\*.log' GROUP BY date ORDER BY date"
:: Requests, bandwidth, and last visit, by IP address and user agent. - Returns a listing of requests, bandwidth, and last visit, by unique IP address and user agent.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT COUNT(*) AS [Requests], DIV(DIV(SUM(cs-bytes), 1024), 1024) AS [MBytes received], DIV(DIV(SUM(sc-bytes), 1024), 1024) AS [MBytes sent], c-ip AS [IP Address], cs(User-Agent) AS [User agent], MAX(date) AS [Last visit] FROM '%IISLogs%\*.log' GROUP BY [IP Address], [User agent] ORDER BY [Requests] DESC"
:: Requests by ile type (extension). - Returns a listing of file types and the total number of requests
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS [File Type], COUNT(*) AS [Requests] FROM '%IISLogs%\*.log' GROUP BY [File Type] ORDER BY [Requests] DESC"
::
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1
::
echo Downloading Stolen Data checking the IIS logs for any large file transfers&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs-uri-stem, Count(*) AS Hits, AVG(sc-bytes) AS Avg, Max(sc-bytes) AS Max, Min(sc-bytes) AS Min, Sum(sc-bytes) AS Total FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY Hits,Total DESC"
:: ORDER BY cs-uri-stem   WHERE (Total IS NOT NULL)     WHERE Hits >= 10  Error: WHERE clause: Semantic Error: WHERE clause contains aggregate functions
::  WHERE (Hits IS NOT NULL) GROUP BY ... Error: WHERE clause: Semantic Error: WHERE clause contains aggregate functions
:: Ref: https://LogParser plus.com/examples/
:: Requests by seconds to process, with percentages
:: LogParser -i:IISW3C -rtp:-1 -o:NAT -headers:OFF  TO c:\\myOutputParsedLog.txt
LogParser -i:EVT -o:NAT "SELECT * FROM System"
LogParser -i:EVT -o:NAT "SELECT * INTO STDOUT FROM System"
:: LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TO_STRING(TimeGenerated, 'yyyy MMM, dd h:m:s') AS FormattedTimestamp FROM '%IISLogs%\*.log'"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TRIM('my-website-custom-extra-column-name.com') AS siteName, TRIM('foo-bar-custom-extra-column-name') AS fooBar, AVG(time-taken) AS AverageTimeTaken, MAX(time-taken) AS MaxTimeTaken, COUNT(*) AS Hits, TO_LOWERCASE(cs-uri-stem) AS Uri FROM '%IISLogs%\*.log' WHERE (Extract_Extension(To_Lowercase(cs-uri-stem)) IN ('aspx')) GROUP BY TO_LOWERCASE(cs-uri-stem) ORDER BY AverageTimeTaken DESC"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT ADD(DIV(QUANTIZE(time-taken,1000),1000),1) AS [Seconds], COUNT(*) AS [Requests], MUL(PROPCOUNT(*),100) AS [Percent] INTO RequestTimes.txt FROM '%IISLogs%\*.log' GROUP BY [Seconds] ORDER BY [Seconds]"
:: Requests in the last 15 minutes
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TO_LOCALTIME(TO_TIMESTAMP(date, time)) AS [LocalTime], * INTO RecentRequests.txt FROM '%IISLogs%\*.log' WHERE LocalTime > SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 00:15', 'yyyy-MM-dd HH:mm'))"
:: User accounts used in IIS 6 FTP login attempts
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs-uri-stem, count(cs-method) INTO FTPUserAccountAttempts.txt FROM '%IISLogs%\*.log' WHERE cs-method like '%USER' GROUP BY cs-uri-stem ORDER BY count(cs-method), cs-uri-stem"
:: IP addresses successfully logging into IIS
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs-uri-stem, cs-uri-query, date, sc-status, cs(Referer) INTO 500sReport.txt FROM '%IISLogs%\*.log' WHERE (sc-status >= 500 AND sc-status < 600) ORDER BY sc-status, date, cs-uri-stem, cs-uri-query"
:: IP addresses attempting to log into an IIS 6 FTP site
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT c-ip AS IPAddr, COUNT(*) AS Cntr INTO FTPIPLoginAttempts.txt FROM '%IISLogs%\*.log' GROUP BY c-ip ORDER BY IPAddr, Cntr"
:: IP addresses attempting to log into an IIS 6 FTP site
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT c-ip AS IPAddr, COUNT(*) AS Cntr INTO FTPIPLoginAttempts.txt FROM '%IISLogs%\*.log' GROUP BY c-ip ORDER BY IPAddr, Cntr"
:: Number of Hits per Client IP, including a Reverse DNS lookup (SLOW)
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT c-ip As Machine, REVERSEDNS(c-ip) As Name, COUNT(*) As Hits FROM '%IISLogs%\*.log' GROUP BY Machine ORDER BY Hits DESC"
:: Extract Values from Query String (d and t) and use them for Aggregation
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TOP 50 EXTRACT_VALUE(cs-uri-query,'d') as Query_D, EXTRACT_VALUE(cs-uri-query,'t') as Query_T, COUNT(*) As Hits FROM '%IISLogs%\*.log' WHERE Query_D IS NOT NULL GROUP BY Query_D, Query_T ORDER BY Hits DESC"
:: List all the Win32 Error codes that have been logged
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT sc-win32-status As Win32-Status, WIN32_ERROR_DESCRIPTION(sc-win32-status) as Description, COUNT(*) AS Hits FROM '%IISLogs%\*.log' WHERE Win32-Status<>0 GROUP BY Win32-Status ORDER BY Win32-Status ASC"
::
LogParser -View:On "SELECT Date, COUNT(*) AS Hits INTO HitsByDay.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date" -i:W3C -fileType:GIF -groupSize:1024x768 -chartType:Area -categories:ON -values:ON -legend:OFF
:: Below is the COM interface for the above command:  %OneDrive%\Scripts\HitsByDay.js
Option Explicit

Dim objLogQuery, strSQL
Dim objInputW3CFormat, objOutputChartFormat

Set objLogQuery = WScript.CreateObject("MSUtil.LogQuery")
Set objInputW3CFormat = WScript.CreateObject("MSUtil.LogQuery.W3CInputFormat")
Set objOutputChartFormat = WScript.CreateObject("MSUtil.LogQuery.ChartOutputFormat")

strSQL = "SELECT Date, COUNT(*) AS Hits " & _
    " INTO HitsByDay.gif " & _
    " FROM %IISLogs%\*.log " & _
    " GROUP BY Date " & _
    " ORDER BY Date"

objOutputChartFormat.groupSize = "1024x768"
objOutputChartFormat.fileType = "GIF"
objOutputChartFormat.chartType = "Area"
objOutputChartFormat.categories = "ON"
objOutputChartFormat.values = "ON"
objOutputChartFormat.legend = "OFF"

objLogQuery.ExecuteBatch strSQL, objInputW3CFormat, objOutputChartFormat
:: Run Above: %OneDrive%\Scripts\HitsByDay.js
LogParser -View:On "SELECT Date, COUNT(*) AS Hits INTO HitsByDay.gif FROM %IISLogs%\*.log GROUP BY Date ORDER BY Date" -i:W3C -fileType:GIF -groupSize:1024x768 -chartType:Area -categories:ON -values:ON -legend:OFF -config:%OneDrive%\Scripts\HitsByDay.js
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Here we can see the sub-statuses, the count and the description. -- 5-19 are Request Filtering.  A full list of sub-statuses and their description can be found here https://support.microsoft.com/en-us/kb/943891
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT sc-status As Status,sc-substatus AS SubStatus,COUNT(sc-substatus) As SubStatusCount, CASE sc-substatus WHEN 1 THEN 'Site Not Found' WHEN 2 THEN 'ISAPI or CGI restriction' WHEN 3 THEN 'MIME type restriction' WHEN 4 THEN 'No handler configured' WHEN 9 THEN 'File attribute hidden' WHEN 16 THEN 'DAV request sent to the static file handler' WHEN 17 THEN 'Dynamic content mapped to the static file handler via a wildcard MIME mapping' WHEN 20 THEN 'Too Many URL Segments' WHEN 5 THEN 'URL Sequence Denied' WHEN 6 THEN 'Verb Denied' WHEN 7 THEN 'File extension denied' WHEN 8 THEN 'Hidden Namespace' WHEN 10 THEN 'Request Header Too Long' WHEN 11 THEN 'URL Double Escaped' WHEN 12 THEN 'URL Has High Bit Chars' WHEN 13 THEN 'Content Length Too Large' WHEN 14 THEN 'URL Too Long' WHEN 15 THEN 'Query String Too Long' WHEN 18 THEN 'Query String Sequence Denied' WHEN 19 THEN 'Denied by Filtering Rule' END AS SubStatusDescription FROM '%IISLogs%\*.log' WHERE sc-status = 404 GROUP BY Status, SubStatus ORDER BY Status"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:on -q:on -Recurse:-1 "SELECT c-ip AS IPAddr, COUNT(*) AS Cntr INTO FTPIPLoginAttempts.txt FROM '%IISLogs%\*.log' GROUP BY IPAddr ORDER BY IPAddr, Cntr"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:on -q:on -Recurse:-1 "SELECT REVERSEDNS(c-ip) AS IPAddr, COUNT(*) AS Hits FROM '%IISLogs%\*.log' GROUP BY IPAddr ORDER BY Hits DESC"
:: |	Chart Sizes: e.g. -groupSize:640x480 -groupSize:1024x768 - (720X576) (1024X768) (1280X720) (1920X1080) (3840X2160)
LogParser -i:CSV -o:CHART -groupSize:720X576 -chartType:ColumnClustered3D -chartTitle:"%ComputerName% Test" -view:ON
LogParser -i:IISW3C -o:CHART -groupSize:720X576 -chartType:ColumnClustered3D -chartTitle:"Resource Requests (DNS)" -Recurse:-1 -view:ON
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:ColumnStacked -E:-1 -view:ON "SELECT c-ip AS IPAddr, COUNT(*) AS Hits INTO '%ohtm%\Resource-Requests-DNS.gif' FROM '%IISLogs%\*.log' GROUP BY IPAddr ORDER BY Hits ASC"
:: LogParser Chart Error: Task completed with errors. Unexpected internal error calling chart object method ExportPicture:   Exception occurred.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT c-ip AS IPAddr, COUNT(*) AS Hits INTO '%ohtm%\Resource-Requests-DNS.gif' FROM '%IISLogs%\*.log' GROUP BY IPAddr ORDER BY Hits ASC"

LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT logrow, date, time, c-ip, cs-username, cs-method, cs-uri-stem, cs-uri-query from '%IISLogs%\*.log'  order by date, time, logrow"
where cs-username like '%%@example.com%%'
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: What is the difference between LogParser -i:W3C and -i:IISW3C
:: The W3C value indicates that the log Files are in the standard W3C Extended Log File Format, which is a space-delimited text file with a header that defines the fields 12. This is the default format for IIS 6.0 and later versions.
:: The IISW3C value indicates that the log Files are in a custom format that is similar to the W3C format, but with some additional fields that are specific to IIS, such as the service name, the instance number, and the Win32 status code 13. This format is used by IIS 5.0 and earlier versions.
:: The difference between these two values is that the IISW3C format has more fields than the W3C format, but it is not compatible with other tools that expect the standard W3C format. Therefore, it is recommended to use the W3C format for IIS log Files, unless you need the extra information provided by the IISW3C format.
::

LogParser -i:W3C -rtp:-1 -o:datagrid -q:off "SELECT c-ip, cs(User-Agent) AS [UserAgent], COUNT(*) AS [Requests], MIN(TO_DATE(TO_LOCALTIME(TO_TIMESTAMP(date, time)))) AS FirstDate, MAX(TO_DATE(TO_LOCALTIME(TO_TIMESTAMP(date, time)))) AS LastDate FROM '%IISLogs%\*.log' WHERE cs-uri-stem = 'robots' GROUP BY c-ip, UserAgent ORDER BY c-ip, UserAgent

echo Extracting Values from Query String&&LogParser -i:W3C -rtp:-1 -o:datagrid -q:off "SELECT EXTRACT_TOKEN(cs-uri-query, 0, '&') AS FirstParam, COUNT(*) AS Hits FROM '%IISLogs%\*.log' WHERE cs-uri-query IS NOT NULL GROUP BY FirstParam ORDER BY Hits DESC"

LogParser -i:W3C -o:xml -q:off "SELECT c-ip AS [ClientIp], cs(user-agent) AS [ClientUserAgent], COUNT(*) AS [Requests] INTO '%ohtm%\robots.xml' FROM '%IISLogs%\*.log' WHERE cs-uri-stem = '/robots.txt' GROUP BY ClientIp, ClientUserAgent ORDER BY Requests DESC"&Notepad++ %odl%\robots.xml
:: Request methods with ip and user agent
LogParser -i:W3C -o:w3c "SELECT cs-method, c-ip, cs(User-Agent), COUNT(*) AS [Requests] INTO '%ohtm%\requestMethods.log' FROM '%IISLogs%\*.log' WHERE cs-method NOT IN ('GET';'POST') GROUP BY cs-method, c-ip, cs(User-Agent) ORDER BY cs-method, Requests"&Notepad++ %odl%\requestMethods.log
:: Bandwidth usage, with local dates
:: Below error: Error: SELECT clause: Syntax Error: unknown field 'cs-bytes'
LogParser -i:W3C -o:CSV "SELECT TO_DATE(TO_LOCALTIME(TO_TIMESTAMP(date, time))) AS [LocalDate], SUM(cs-bytes) AS [Bytes received], DIV(SUM(cs-bytes), 1024) AS [KBytes received], DIV(DIV(SUM(cs-bytes), 1024), 1024) AS [MBytes received], SUM(sc-bytes) AS [Bytes sent], DIV(SUM(sc-bytes), 1024) AS [KBytes sent], DIV(DIV(SUM(sc-bytes), 1024), 1024) AS [MBytes sent], COUNT(*) AS Requests FROM '%IISLogs%\*.log' GROUP BY LocalDate ORDER BY LocalDate"
:: LogParser -i:W3C -o:CSV "SELECT TO_DATE(TO_LOCALTIME(TO_TIMESTAMP(date, time))) AS [LocalDate], SUM(cs-bytes) AS [Bytes received], DIV(SUM(cs-bytes), 1024) AS [KBytes received], DIV(DIV(SUM(cs-bytes), 1024), 1024) AS [MBytes received], SUM(sc-bytes) AS [Bytes sent], DIV(SUM(sc-bytes), 1024) AS [KBytes sent], DIV(DIV(SUM(sc-bytes), 1024), 1024) AS [MBytes sent], COUNT(*) AS Requests INTO '%ohtm%\Bandwidth.csv' FROM '%IISLogs%\*.log' GROUP BY LocalDate ORDER BY LocalDate"&Notepad++ %odl%\Bandwidth.csv
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 " '%IISLogs%\*.log'
:: find out how many times each different page took more than ten seconds to execute
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TOP 10 cs-uri-stem, COUNT(*) FROM '%IISLogs%\*.log' WHERE time-taken > 10000 GROUP BY cs-uri-stem ORDER BY COUNT(*) DESC"
:: Users logged into IIS 6 FTP site
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs-username, c-ip, COUNT(*) INTO FTPUsersLoggedIn.txt FROM '%IISLogs%\*.log' WHERE sc-status = '230' GROUP BY cs-username, c-ip ORDER BY COUNT(*), cs-username, c-ip"
::  list of all the browsers used to request pages
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT DISTINCT cs(User-Agent) FROM '%IISLogs%\*.log'"
::  retrieve the total number of different values
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT COUNT(DISTINCT cs(User-Agent)) AS Browsers, COUNT(DISTINCT c-ip) AS Clients FROM '%IISLogs%\*.log'"
:: Requests for robots.txt with ip and user agent
:: Request time Returns the number of times a particular page was hit, with the average, minimum, and maximum time
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TO_LOWERCASE(cs-uri-stem) AS csUriStem, COUNT(*) AS Hits, DIV ( MUL(1.0, SUM(time-taken)), Hits ) AS AvgTime, SQRROOT ( SUB ( DIV ( MUL(1.0, SUM(SQR(time-taken)) ), Hits ) , SQR(AvgTime) ) ) AS StDev, Max(time-taken) AS Max, Min(time-taken) AS Min, TO_REAL(STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus)))) AS Status, Min(TO_LOCALTIME(date)) AS LastUpdate FROM '%IISLogs%\*.log' WHERE cs-uri-stem like '%.as%' GROUP BY TO_LOWERCASE(cs-uri-stem), TO_REAL(STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus)))) HAVING COUNT(*) > 2"
:: Requests by hour (using TO_STRING) - Returns a listing of requests by hour, across all days, by converting the hour to a string.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TO_STRING(time, 'hh') AS [Hour], COUNT(*) AS [Requests], MUL(PROPCOUNT(*), 100) AS [PercentOfTotal] INTO HourlyReport.txt FROM '%IISLogs%\*.log' GROUP BY [Hour] ORDER BY [Hour]"
:: Average bandwidth per second by half hour
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TO_LOCALTIME(QUANTIZE(time, 1800)) as HalfHour, ADD(SCKBytesSec, CSKBytesSec) as KBytesSec USING DIV(DIV(MUL(1.0, SUM(sc-bytes)), 1024), 1800) as SCKbytesSec, DIV(DIV(MUL(1.0, SUM(cs-bytes)), 1024), 1800) as CSKBytesSec INTO AvgKBytesPerSec.txt FROM '%IISLogs%\*.log' GROUP BY HalfHour ORDER BY HalfHour ASC"
:: Average response time by half hour
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TO_LOCALTIME(QUANTIZE(time, 1800)) as HalfHour, AVG(time-taken) as Time INTO AvgResponse.txt FROM '%IISLogs%\*.log' WHERE cs-uri-stem like '%.as%' AND sc-status < 400 GROUP BY HalfHour ORDER BY HalfHour ASC"
:: Number of errors by half hour
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TO_LOCALTIME(QUANTIZE(time, 1800)) as HalfHour, COUNT(*) as Hits INTO ErrorCount.txt FROM '%IISLogs%\*.log' WHERE sc-status > 399 GROUP BY HalfHour ORDER BY HalfHour ASC"
:: Browsers accessing content
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs(User-Agent) AS Browser, COUNT(*) AS Requests INTO BrowserReport.txt FROM '%IISLogs%\*.log' GROUP BY Browser ORDER BY Requests DESC"
:: Requests by half hour
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TO_LOCALTIME(QUANTIZE(time, 1800)) as HalfHour, COUNT(*) as Hits INTO HalfHourRequestCount.txt FROM '%IISLogs%\*.log' GROUP BY HalfHour ORDER BY HalfHour ASC"
:: HTTP status codes and sub-status
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus))) AS Status, COUNT(*) as Hits INTO StatusCodes.txt FROM '%IISLogs%\*.log' GROUP BY Status ORDER BY Hits DESC"
:: Browsers accessing content, without operating system (image)
echo Browsers accessing content&LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:barstacked -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"Browsers accessing content %date:~-4%%date:~-7,2%%date:~-10,2% barstacked" "SELECT CASE strCntr(cs(user-agent),'Firefox') when 1 THEN 'Firefox' else case strCntr(cs(user-agent),'netscape') when 1 THEN 'netscape' else case strCntr(cs(user-agent),'AOL') when 1 THEN 'AOL' else case strCntr(cs(user-agent),'Opera') when 1 THEN 'Opera' else case strCntr(cs(user-agent),'Chrome') when 1 THEN 'Chrome' else case strCntr(cs(user-agent),'Mobile') when 1 THEN 'SmartPhone' else case strCntr(cs(user-agent),'Safari') when 1 THEN 'Safari' else case strCntr(cs(user-agent),'MSIE+5') when 1 THEN 'IE 5' else case strCntr(cs(user-agent),'MSIE+6') when 1 THEN 'IE 6' else case strCntr(cs(user-agent),'MSIE+7') when 1 THEN 'IE 7' else case strCntr(cs(user-agent),'MSIE+8') when 1 THEN 'IE 8' else case strCntr(cs(user-agent),'MSIE') when 1 THEN 'IE other' else case strCntr(cs(user-agent),'bot') when 1 THEN 'Bot' else case strCntr(cs(user-agent),'spider') when 1 THEN 'spider' else case strCntr(cs(user-agent),'PutHTTP') when 1 THEN 'PutHTTP' else case strCntr(cs(user-agent),'Mozilla/4.0') when 1 THEN 'Mozilla/4.0 other' ELSE 'Unknown' End End End End End End End End End End End End End End End End as Browser, COUNT(cs(User-Agent)) as Hits INTO %ohtm%\%ComputerName%_Browsers.jpg FROM '%IISLogs%\*.log' GROUP BY Browser ORDER BY Hits ASC"
:: Count of directory of Files requested
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT COUNT(*) AS [Requests], EXTRACT_PATH(cs-uri-stem) AS [Path Requested] INTO PathCounts.txt FROM '%IISLogs%\*.log' GROUP BY [Path Requested] ORDER BY [Requests] DESC"
:: SMTP usage with basic logs If you only have the very basic logs for an SMTP instance in Windows Server 2012
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT c-ip, REVERSEDNS(c-ip) AS [ClientHostName], cs-method, COUNT(*) AS [Requests] INTO SmtpClients.txt FROM '%IISLogs%\*.log' WHERE cs-method IN ('RCPT') GROUP BY c-ip, [ClientHostName], cs-method ORDER BY [Requests] DESC"
:: HTTP Status Codes (pie chart) : Below error: Unexpected internal error calling chart object method ExportPicture:
:: LogParser -i:IISW3C -q:off -Recurse:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Pie -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"Status as Percent of Requests %date:~-4%%date:~-7,2%%date:~-10,2% Pie" "SELECT sc-status AS [HTTP Status Code], COUNT(*) AS Requests INTO '%ohtm%\HttpStatusCodePieChart.png' FROM '%IISLogs%\*.log' GROUP BY [HTTP Status Code] ORDER BY Requests DESC"
:: Bandwidth usage - Returns bytes (as well as converted to KB and MB) received and sent, per date, for a Web site.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT date, SUM(cs-bytes) AS [Bytes received], DIV(SUM(cs-bytes), 1024) AS [KBytes received], DIV(DIV(SUM(cs-bytes), 1024), 1024) AS [MBytes received], SUM(sc-bytes) AS [Bytes sent], DIV(SUM(sc-bytes), 1024) AS [KBytes sent], DIV(DIV(SUM(sc-bytes), 1024), 1024) AS [MBytes sent], COUNT(*) AS Requests INTO Bandwidth.txt FROM '%IISLogs%\*.log' GROUP BY date ORDER BY date"
:: Requests, bandwidth, and last visit, by IP address and user agent. Returns a listing of requests, bandwidth, and last visit, by unique IP address and user agent.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT COUNT(*) AS [Requests], DIV(DIV(SUM(cs-bytes), 1024), 1024) AS [MBytes received], DIV(DIV(SUM(sc-bytes), 1024), 1024) AS [MBytes sent], c-ip AS [IP Address], cs(User-Agent) AS [User agent], MAX(date) AS [Last visit] FROM '%IISLogs%\*.log' GROUP BY [IP Address], [User agent] ORDER BY [Requests] DESC"
:: Daily Bandwidth
LogParser -i:IISW3C -o:CHART -groupSize:1024x768 -view:ON -chartType:ColumnClustered -chartTitle:"Daily Bandwidth" -Recurse:-1 "SELECT TO_STRING(TO_TIMESTAMP(date, time), 'MM-dd') AS Day, DIV(Sum(cs-bytes),1024) AS Incoming(K), DIV(Sum(sc-bytes),1024) AS Outgoing(K) INTO '%ohtm%\DailyBandwidth.gif' FROM '%IISLogs%\*.log' GROUP BY Day"
:: Requests by file type (extension). Returns a listing of file types and the total number of requests.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS [File Type], COUNT(*) AS [Requests] INTO '%odl%\%ComputerName%_FileTypeRequests.txt' FROM '%IISLogs%\*.log' GROUP BY [File Type] ORDER BY [Requests] DESC"
:: Below: Returns a listing of file types, as well as the amount of data sent and received by the server, for each request.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS [File Type], COUNT(*) AS [Requests], DIV(SUM(sc-bytes), 1024) AS [Sent(KB)], DIV(SUM(cs-bytes), 1024) AS [Received (KB)] FROM '%IISLogs%\*.log' GROUP BY [File Type] ORDER BY [Requests] DESC"
::Returns a listing of domains that referred traffic to the site
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT EXTRACT_TOKEN(cs(Referer), 2, '/') AS [Domain], COUNT(*) AS [Requests] FROM '%IISLogs%\*.log' GROUP BY [Domain] ORDER BY [Requests] DESC"
:: Returns a listing of HTTP status codes with counts and percentage per.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT sc-status, COUNT(*) AS [Requests], MUL(PROPCOUNT(*), 100) AS [Percentage] FROM '%IISLogs%\*.log' GROUP BY sc-status"
:: BETWEEN 400 AND 499
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Log Parser Examples
http://technet.microsoft.com/en-us/library/ee692659.aspx
Top 10 Topics for MSCOM Ops…Pull Out the Swiss Army Knife... (LogParser That Is)... The TOOL MAN Cometh!! (Part 4)
http://blogs.technet.com/b/mscom/archive/2005/10/19/412745.aspx
Download Log Parser 2.2
http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=24659
I tested this before, I can use this command to check for POP3 logs:
LogParser -i:CSV –o:DATAGRID "SELECT dataTime, user, command FROM C:\pop3logging\*log"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Ref: https://docs.microsoft.com/en-us/search/?terms=LogParser
:: Troubleshooting IIS Performance Issues or Application Errors using LogParser
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT COUNT(cs(User-Agent)) AS Client FROM '%IISLogs%\*.log' WHERE cs(User-Agent) LIKE '%chrome%' "
echo List Browser and Versions&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT DISTINCT cs(User-Agent) AS Client FROM '%IISLogs%\*.log' ORDER BY Client ASC"
:: if customers were complaining about performance
SET ToDay=%date:~-4%-%date:~-7,2%-%date:~-10,2% & echo %ToDay%
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TO_STRING(TO_LOCALTIME(TO_TIMESTAMP(date,time)),'yyyy-MM-dd hh:mm:ss') AS LocalTime,COUNT(*) AS Hits FROM '%IISLogs%\*.log' WHERE date='%ToDay%' GROUP BY LocalTime ORDER BY LocalTime"
:: overview of how IIS has been responding to the requests
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT sc-status, sc-substatus, COUNT(*) FROM '%IISLogs%\*.log' GROUP BY sc-status, sc-substatus ORDER BY sc-status"
:: Get the status code in the "status.substatus" form:
STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus))) AS Status
:: Get the request in the "uri-stem?uri-query" form:
STRCAT(cs-uri-stem, REPLACE_IF_NOT_NULL(cs-uri-query,STRCAT('?',cs-uri-query))) AS Request
:: Get the request extension:
Log Parser sample queries
http://cyprix.3x.ro/Files/LogParser /Samples/Queries/Readme.htm
SUBSTR(cs-uri-stem, LAST_INDEX_OF(cs-uri-stem,'.'), STRLEN(cs-uri-stem)) AS Extension

:: find which requests resulted in a 500 HTTP Status code.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs-uri-stem, COUNT(*) FROM '%IISLogs%\*.log' WHERE sc-status=500 GROUP BY cs-uri-stem ORDER BY COUNT(*) DESC"
::  top contributor for HTTP 500 Status codes
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TO_STRING(TO_TIMESTAMP(date,time),'yyyy-MM-dd hh') AS Hour, COUNT(*) FROM '%IISLogs%\*.log' WHERE sc-status=500 AND cs-uri-stem='/Start/default.aspx' AND date='2022-08-01' GROUP BY Hour ORDER BY Hour"
:: look at the maximum time-taken, that is way too much time
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs-method, COUNT(*) AS TotalCount, MAX(time-taken) AS MaximumTime, AVG(time-taken) AS AverageTime FROM '%IISLogs%\*.log' GROUP BY cs-method ORDER BY TotalCount DESC"
:: MAX and AVG time-taken
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs-uri-stem, time-taken, sc-bytes FROM '%IISLogs%\*.log' WHERE time-taken > 250000 ORDER BY time-taken DESC"
:: number of requests and their associated HTTP Status code
LogParser -i:IISW3C -q:off -Recurse:-1 -view:on -o:CHART -groupSize:1024x768 -chartType:PieExploded3D -ChartTitle:Request-Status "SELECT TO_INT(sc-status) AS Status, COUNT(*) AS Count INTO '%ohtm%\status.gif' FROM '%IISLogs%\*.log' WHERE sc-status > 200 GROUP BY Status ORDER BY Status"
echo Returns the distribution of the number of bytes sent by the server for each page type&LogParser -i:IISW3C -q:off -Recurse:-1 -view:on -o:CHART -groupSize:1024x768 -chartType:PieExploded3D -ChartTitle:Request-Status "SELECT TO_LOWERCASE(EXTRACT_EXTENSION(cs-uri-stem)) AS PageType, MUL(PROPSUM(sc-bytes), 100.0) AS PercentBytes INTO Chart.gif FROM '%IISLogs%\*.log' GROUP BY PageType HAVING PercentBytes >= 1.0 ORDER BY PercentBytes DESC"
:: Below 2 calculates the average, minimum, and maximum number of bytes served for each web page type
LogParser -i:IISW3C -Recurse:-1 -rtp:-1 -o:datagrid -q:off "SELECT TO_UPPERCASE(EXTRACT_EXTENSION(cs-uri-stem)) AS PageType, MIN(sc-bytes) AS Minimum, AVG(sc-bytes) AS Average, MAX(sc-bytes) AS Maximum FROM '%IISLogs%\*.log' GROUP BY PageType ORDER BY Average ASC"
echo calculates the average, minimum, and maximum number of bytes served for each web page type&LogParser -i:IISW3C -Recurse:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Web Page Type Bytes Served" "SELECT TO_UPPERCASE(EXTRACT_EXTENSION(cs-uri-stem)) AS PageType, MIN(sc-bytes) AS Minimum, AVG(sc-bytes) AS Average, MAX(sc-bytes) AS Maximum INTO %ohtm%\%ComputerName%_BytesChart.gif FROM '%IISLogs%\*.log' GROUP BY PageType ORDER BY Average ASC"
:: Error while parsing field sc-status: Value is not a relative integer
:: Error LogParser -i:W3C -o:CHART -groupSize:1024x768 -chartType:PieExploded3D -ChartTitle:"Request Status" -values:ON -view:on -E:-1 "SELECT sc-status AS Status, COUNT(*) AS Count INTO '%ohtm%\status.gif' FROM '%IISLogs%\*.log' WHERE sc-status > 200 GROUP BY Status ORDER BY Status"
:: Error: Syntax Error: extra token(s) after query: 'sc-status'
:: include the number of hits for each
LogParser -i:W3C -o:CHART -groupSize:1024x768 -chartType:PieExploded3D -ChartTitle:"Cache" -values:ON -view:on -E:-1 "SELECT sc-status AS Status, COUNT(*) AS Count INTO '%ohtm%\cache.gif' FROM '%IISLogs%\*.log' WHERE TO_INT(sc-status)=200 OR sc-status=304 GROUP BY Status ORDER BY Status"
LogParser "SELECT sc-status AS Status, COUNT(*) AS Count INTO cache.gif FROM '%IISLogs%\*.log' WHERE sc-status=200 OR sc-status=304 GROUP BY Status ORDER BY Status" -i:W3C -o:CHART -groupSize:1024x768 -chartType:PieExploded3D -ChartTitle:"Cache" -values:ON -view:on
:: Error while parsing field sc-status: Value is not a relative integer -- TO_INT  %odl%\cache.gif
:: count of 500 HTTPS Status codes per hour. NOTE: Error while parsing field sc-status: Value is not a relative integer
LogParser -i:W3C -o:CHART -groupSize:1024x768 -chartType:Column3D -ChartTitle:"500 Errors by Hour" -view:on -E:-1 "SELECT to_string(to_TIMESTAMP(date, time), 'yyyy-MM-dd hh') AS Hour, COUNT(*) AS Count INTO %odl%\500.gif FROM '%IISLogs%\*.log' WHERE sc-status=500 GROUP BY Hour ORDER BY Hour"
:: Error while parsing field sc-status: Value is not a relative integer
:: extracts the HTTP Status codes for All request which are not 200
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT sc-status AS Status, COUNT(*) AS Count FROM '%IISLogs%\*.log' GROUP BY Status ORDER BY Status"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT sc-status AS Status, COUNT(*) AS Count FROM '%IISLogs%\*.log' WHERE sc-status > 200 GROUP BY Status ORDER BY Status"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "
:: Below will extract Specific data into new file using only fields selected...
LogParser -i:W3C -o:w3c -q:off "SELECT date, time, c-ip, cs-uri-stem, cs-uri-query, sc-status, sc-substatus, sc-win32-status, sc-bytes, cs-bytes, time-taken INTO '%ohtm%\%ComputerName%_NewLog1.log' FROM '%IISLogs%\*.log'"
edit %ohtm%\%ComputerName%_NewLog1.log
LogParser -i:W3C -o:w3c -q:off "SELECT date, time, c-ip, cs-uri-stem, cs-uri-query, sc-status, sc-substatus, sc-win32-status, sc-bytes, cs-bytes, time-taken INTO '%ohtm%\%ComputerName%_NewLog2.log' FROM '%IISLogs%\*.log' WHERE to_TIMESTAMP(date, time) >= TIMESTAMP('2022-08-13 00:00:00', 'yyyy-MM-dd hh:mm:ss')"
edit %ohtm%\%ComputerName%_NewLog2.log
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo ***** determining IIS Errors and URL Stem errors>=400 *****
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT cs-uri-stem,sc-status,sc-win32-status,c-ip,s-port,cs-method,COUNT(cs-uri-stem) FROM '%IISLogs%\*.log' where sc-status>=400 GROUP BY cs-uri-stem,sc-status,sc-win32-status,c-ip,s-port,cs-method ORDER BY COUNT(cs-uri-stem) DESC"
echo ***** determining IIS Errors and URL Stem errors>=302 *****
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT cs-uri-stem,sc-status,sc-win32-status,c-ip,s-port,cs-method,COUNT(cs-uri-stem) FROM '%IISLogs%\*.log' where sc-status>=302 GROUP BY cs-uri-stem,sc-status,sc-win32-status,c-ip,s-port,cs-method ORDER BY COUNT(cs-uri-stem) DESC"
echo ***** Performing A count the Total Requests *****
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT COUNT(*) AS TotalRequests FROM '%IISLogs%\*.log'"
echo ***** Counting DISTINCT Clients *****
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT count(DISTINCT c-ip) AS TotalClients FROM '%IISLogs%\*.log'"
echo ***** determining the Top 20 URLs Hit *****
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TOP 20 cs-uri-stem, COUNT(*) AS Hits FROM '%IISLogs%\*.log' group by cs-uri-stem ORDER BY Hits DESC"
echo ***** determining Top 20 Clients Hitting this server *****
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT top 20 c-ip AS IPAddr_IP,count(c-ip) AS PageCount FROM '%IISLogs%\*.log' GROUP BY c-ip ORDER BY count(c-ip) DESC"
echo ***** determining Unique Clients per Hour ***** - output = %ohtm%\%ComputerName%_daily\dclientsperhour.LOG
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600)) as Times, c-ip AS IPAddrIP FROM '%IISLogs%\*.log' group by Times, ClientIP"
echo ***** URI-stem of the requests that took more than 30 seconds to execute:
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TO_TIMESTAMP(date, time) AS TIMESTAMP, cs-uri-stem FROM '%IISLogs%\*.log' WHERE time-taken >= 30000"

LogParser -i:IISW3C -Recurse -o:CSV "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600)) as Times, c-ip AS IPAddrIP into %ohtm%\%ComputerName%_daily\dclientsperhour.LOG FROM '%IISLogs%\*.log' group by Times, ClientIP"
LogParser -i:CSV -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT Times, COUNT(*) as Count from %ohtm%\%ComputerName%_daily\dclientsperhour.LOG to %ohtm%\%ComputerName%_daily\dclientsperhour.CSV group by Times ORDER BY Times ASC"
LogParser -i:CSV -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO "SELECT Times, COUNT(*) as ClientIPCount from %ohtm%\%ComputerName%_daily\dclientsperhour.LOG to %ohtm%\%ComputerName%_daily\Clientschart.gif group by Times ORDER BY Times ASC"
echo ***** determining Status Codes distribution *****
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT sc-status, COUNT(*) AS Times FROM '%IISLogs%\*.log' GROUP BY sc-status ORDER BY Times DESC"
:: Get browser name and version from IIS log
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT cs(User-Agent) As UserAgent, COUNT(*) as Hits FROM '%IISLogs%\*.log' GROUP BY UserAgent ORDER BY Hits DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Get the number of requests and total bytes sent during each hour
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -e:1
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT QUANTIZE(TO_TIMESTAMP(date, time), 3600) AS Hour, COUNT(*) AS Total, SUM(sc-bytes) AS TotBytesSent FROM '%IISLogs%\*.log' GROUP BY Hour ORDER BY Hour"
:: Get the total number of bytes generated by each extension
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT EXTRACT_EXTENSION( cs-uri-stem ) AS Extension, MUL(PROPSUM(sc-bytes),100.0) AS Bytes FROM '%IISLogs%\*.log' GROUP BY Extension ORDER BY Bytes DESC"
:: Get the Top 50 verbs with the maximum and average time taken, and with the average number of bytes sent
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TOP 50 cs-method, COUNT(*) AS Total, MAX(time-taken) AS MaxTime, AVG(time-taken) AS AvgTime, AVG(sc-bytes) AS AvgBytesSent FROM '%IISLogs%\*.log' GROUP BY cs-method ORDER BY Total DESC"
:: Get the Top 50 URIs with the maximum and average time taken, and with the average number of bytes sent
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TOP 50 cs-uri-stem, COUNT(*) AS Total, MAX(time-taken) AS MaxTime, AVG(time-taken) AS AvgTime, AVG(sc-bytes) AS AvgBytesSent FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY Total DESC"
:: Get the full HTTP status codes by number of hits
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus))) AS Status, COUNT(*) AS Total FROM '%IISLogs%\*.log' GROUP BY Status ORDER BY Total DESC"
:: For each ASP error, get the Url and the ASP script line number
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT EXTRACT_TOKEN(FullUri, 0, '|') AS Uri, EXTRACT_TOKEN(cs-uri-query, -1, '|') AS ErrorMsg, EXTRACT_TOKEN(cs-uri-query, 1, '|') AS LineNo, COUNT(*) AS Total USING STRCAT( cs-uri-stem, REPLACE_IF_NOT_NULL(cs-uri-query, STRCAT('?', cs-uri-query)) ) AS FullUri FROM '%IISLogs%\*.log' WHERE (sc-status = 500) AND (cs-uri-stem LIKE '%.asp') AND (cs-uri-stem LIKE '%.htm*') GROUP BY Uri, ErrorMsg, LineNo ORDER BY Total DESC"
:: Get requests and full status by number of hits Error 404 and URL
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT STRCAT(cs-uri-stem, REPLACE_IF_NOT_NULL(cs-uri-query, STRCAT('?',cs-uri-query)) ) AS Request, STRCAT(TO_STRING(sc-status), STRCAT('.', COALESCE(TO_STRING(sc-substatus), '?' ) ) ) AS Status, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status >= 400) GROUP BY Request, Status ORDER BY Total DESC"
:: Get hit counts for each extension
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT EXTRACT_EXTENSION( cs-uri-stem ) AS Extension, COUNT(*) AS Total FROM '%IISLogs%\*.log' GROUP BY Extension ORDER BY Total DESC"
echo Get authentication and authorization failures&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT cs-username, sc-status, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE cs-username IS NOT NULL AND sc-status BETWEEN 400 AND 408 GROUP BY cs-username,sc-status ORDER BY Total DESC"
echo Get authentication and authorization failures&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs-username, sc-status, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE cs-username IS NOT NULL AND sc-status>400 AND sc-status < 404 GROUP BY cs-username,sc-status ORDER BY Total DESC"
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT DISTINCT cs-uri-stem FROM '%IISLogs%\*.log' WHERE time-taken > 1000"
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TOP 20 cs-uri-stem, COUNT(*) FROM '%IISLogs%\*.log' WHERE time-taken > 1000 GROUP BY cs-uri-stem ORDER BY COUNT(*) DESC"
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT date, REVERSEDNS(c-ip) AS Client, COUNT(*) FROM '%IISLogs%\*.log' WHERE sc-status<>200 GROUP BY date, Client"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Average bandwidth per second by half hour &LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TO_LOCALTIME(QUANTIZE(time, 1800)) as HalfHour, ADD(SCKBytesSec, CSKBytesSec) as KBytesSec USING DIV(DIV(MUL(1.0, SUM(sc-bytes)), 1024), 1800) as SCKbytesSec, DIV(DIV(MUL(1.0, SUM(cs-bytes)), 1024), 1800) as CSKBytesSec FROM '%IISLogs%\*.log' GROUP BY HalfHour ORDER BY HalfHour ASC"
:: Below Error Error: Syntax Error: <sqlfunction-expr>: not a valid <field-expr-list>
:: echo Bandwidth usage, with local dates&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TO_DATE(TO_LOCALTIME(TO_TIMESTAMP(date, time))) AS [LocalDate], SUM(cs-bytes) AS [Bytes received], DIV(SUM(cs-bytes), 1024) AS [KBytes received], DIV(DIV(SUM(cs-bytes), 1024), 1024) AS [MBytes received], SUM(sc-bytes) AS [Bytes sent], DIV(SUM(sc-bytes), 1024) AS [KBytes sent], DIV(DIV(SUM(sc-bytes), 1024), 1024) AS [MBytes sent], COUNT() AS Requests FROM '%IISLogs%\*.log' GROUP BY LocalDate ORDER BY LocalDate"
:: Below Error: Syntax Error: <sqlfunction-expr>: not a valid <field-expr-list>
:: LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT c-ip, COUNT() AS [Requests] FROM '%IISLogs%\*.log' WHERE cs-uri-query IS NOT null and STRCntr(TO_LOWERCASE(cs-uri-query), 'http://&#8217;) > 0 GROUP BY c-ip ORDER BY [Requests] DESC"
:: iis6ftp - LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT c-ip, count(sc-status) INTO FTPSuccessfulIPLogins.txt FROM '%IISLogs%\*.log' WHERE sc-status = '230' GROUP BY c-ip ORDER BY count(sc-status), c-ip"
:: Below Error: Syntax Error: <sqlfunction-expr>: not a valid <field-expr-list>
:: LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Pie -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"Status as Percent of Requests %date:~-4%%date:~-7,2%%date:~-10,2% Pie" "SELECT sc-status AS [HTTP Status Code], COUNT() AS Requests INTO %ohtm%\%ComputerName%_HttpStatusCodes.png FROM ex0811.log GROUP BY [HTTP Status Code] ORDER BY Requests DESC"
:: Below Error: Syntax Error: <sqlfunction-expr>: not a valid <field-expr-list>
:: Cookie lengths Returns cookie lengths along with the ip and the number of requests made with that cookie/ip.
:: LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT STRLEN(cs(Cookie)) AS CookieLength, c-ip, COUNT() AS Requests, cs(Cookie) FROM '%IISLogs%\*.log' WHERE cs(cookie) IS NOT null GROUP BY cs(Cookie), c-ip, CookieLength ORDER BY CookieLength DESC"
:: Below Error: Syntax Error: <sqlfunction-expr>: not a valid <field-expr-list>
:: LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT COUNT() AS [Requests], EXTRACT_PATH(cs-uri-stem) AS [Path Requested] INTO PathCounts.txt FROM '%IISLogs%\*.log' GROUP BY [Path Requested] ORDER BY [Requests] DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
dir %systemroot%\System32\inetsrv\AppCmd.exe
:: --- UrlScan queries ----- <-- How does one create these logs? Where do they come from???
:: NOTE: While UrlScan 3.1 might work with IIS 4.0 on Windows NT 4.0 and IIS 5.0 on Windows 2000, these products are no longer supported by Microsoft.
:: ref: https://docs.microsoft.com/en-us/iis/extensions/working-with-urlscan/urlscan-overview
::  Download the x64 version from Microsoft Download Center. https://www.iis.net/downloads/microsoft/urlscan <Old-> https://social.msdn.microsoft.com/Forums/en-US/home?forum=iissecurity
:: Get the clients whose requests have been rejected by UrlScan
:: ?? LogParser -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT ClientIP, COUNT(*) FROM URLSCAN WHERE Comment LIKE 'Url%' GROUP BY ClientIP"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT
'%IISLogs%\*.log'
::--- ETW log queries ----
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -e:1
::
:: --- Security Audit Account Logon events -----
:: Note that failed logins and successful logins are separate records in the event log, but here we want to see the totals for each account on a single line. I accomplished that with these two lines:
:: SUM(CASE EventType WHEN 16 THEN 1 ELSE 0 END) AS Failed,
:: SUM(CASE EventType WHEN 8 THEN 1 ELSE 0 END) AS Success,
echo Excessive Failed LogonsEventID < 541 &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_LOWERCASE(EXTRACT_TOKEN(Strings,0,'|')) AS Account, SUM(CASE EventType WHEN 16 THEN 1 ELSE 0 END) AS Failed, SUM(CASE EventType WHEN 8 THEN 1 ELSE 0 END) AS Success, COUNT(*) AS Total FROM Security WHERE EventID IN (541;4624;4625;4634;4647;4648;4779) AND EventCategory=2 AND AND User<>''  GROUP BY User ORDER BY Total DESC"
echo Audit Account Logon events &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (672;44768;673;4769674;4770;676;672;4768;677;673;4769;678;4774;680;4776;681;4776;682;4778;683;4779)"
echo Get logon failures from the Security Event Log&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT STRCAT(EXTRACT_TOKEN(Strings, 1,'|'), STRCAT('',EXTRACT_TOKEN(Strings, 0,'|'))) AS User, COUNT(*) AS Total FROM Security WHERE EventType = 16 AND EventCategory = 2 GROUP BY User ORDER BY Total DESC"
echo Get logon failure statistics from the Security Event Log&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(EventID) AS TotAllogonFailures, TO_LOWERCASE(EXTRACT_TOKEN(Strings,0,'|')) AS User, TO_LOWERCASE(EXTRACT_TOKEN(Strings,1,'|')) AS Domain, TO_LOWERCASE(EXTRACT_TOKEN(Strings,5,'|')) AS WorkStation, CASE TO_INT(EXTRACT_TOKEN(Strings,2,'|')) WHEN 2 THEN  'Interactive - Intended for users who will be interactively using the machine, such as a user being logged on by a terminal server, remote shell, or similar process.' WHEN 3 THEN  'Network - Intended for high performance servers to authenticate clear text passwords. LogonUser does not cache credentials for this logon type.' WHEN 4 THEN  'Batch - Intended for batch servers, where processes may be executing on behalf of a user without their direct intervention; or for higher performance servers that process many clear-text authentication attempts at a time, such as mail or web servers. LogonUser does not cache credentials for this logon type.' WHEN 5 THEN  'Service - Indicates a service-type logon. The account provided must have the service privilege enabled.' WHEN 6 THEN  'Proxy - Indicates a proxy-type logon.' WHEN 7 THEN  'Unlock - This logon type is intended for GINA DLLs logging on users who will be interactively using the machine. This logon type Allows a unique audit record to be generated that shows when the workstation was unlocked.' WHEN 8 THEN  'NetworkCleartext - Windows 2000; Windows XP and Windows Server 2003 family:  Preserves the name and password in the authentication packages, Allowing the server to make connections to other network servers while impersonating the client. This Allows a server to accept clear text credentials from a client, CAll LogonUser, verify that the user can access the system across the network, and still communicate with other servers.' WHEN 9 THEN  'NewCredentials - Windows 2000; Windows XP and Windows Server 2003 family:  Allows the cAller to clone its current token and specify new credentials for outbound connections. The new logon session has the same local identity, but uses different credentials for other network connections.' WHEN 10 THEN 'RemoteInteractive - Terminal Server session that is both remote and interactive.' WHEN 11 THEN 'CachedInteractive - Attempt cached credentials without accessing the network.' WHEN 12 THEN 'CachedRemoteInteractive - Same as RemoteInteractive. This is used for internal auditing.' WHEN 13 THEN 'CachedUnlock - Workstation logon' ELSE EXTRACT_TOKEN(Strings,2,'|') END AS Type INTO DATAGRID FROM security WHERE EventID IN (529) GROUP BY User,Domain,WorkStation,Type ORDER BY TotAllogonFailures DESC"
:: Get logon successes from the Security Event Log
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT STRCAT(EXTRACT_TOKEN(Strings,1,'|'),STRCAT('',EXTRACT_TOKEN(Strings,0,'|') ) ) AS User, COUNT(*) AS Total FROM Security WHERE EventType = 8 AND EventCategory = 2 GROUP BY User ORDER BY Total DESC"
:: Get the distribution of EventID values for each Source
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, MUL(PROPCOUNT(*) ON (SourceName), 100.0) AS Percent FROM System GROUP BY SourceName, EventID ORDER BY SourceName, Percent DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
To learn more about HTTPERR logging, please refer to: INF: Http.sys Registry
Settings for IIS at http://support.microsoft.com/?id=820129 and INFO: Error
Logging in HTTP API at http://support.microsoft.com/?id=820729
differences with URLScan: https://www.microsoft.com/technet/security/tools/urlscan.mspx?#XSLTsection123121120120

:: More monthly, daily hourly queries....  Last Updated: 19 Jul 2024 06:31 AM
:: This query can be easily modified to show daily or monthly Web usage. For example, the following query calculates the Web site monthly usage: ---Ch01HitsPerMonthChart.sql---   Hits-Per-Hour Chart
:: 1) LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:ColumnStacked -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Hits-Per-Hour" -E:-1 -view:ON "
:: 2) INTO %odl%\Hits-Per-Hour.jpg FROM '%IISLogs%\*.log'
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:ColumnStacked -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Hits-Per-Hour" -E:-1 -view:ON "SELECT TO_STRING(date, 'yyyy-MM') AS Month, COUNT(*) AS Hits INTO %odl%\Hits-Per-Hour.jpg FROM '%IISLogs%\*.log' GROUP BY Month ORDER BY Month ASC
::---Ch02DailyBandwidth.sql---
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:ColumnStacked3d -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Monitoring Bandwidth Usage" -E:-1 -view:ON "SELECT TO_STRING(TO_TIMESTAMP(date, time), 'MM-dd') AS Day, DIV(Sum(cs-bytes),1024) AS Incoming(K), DIV(Sum(sc-bytes),1024) AS Outgoing(K) INTO %odl%\DailyBandwidth.jpg FROM '%IISLogs%\*.log' GROUP BY Day"
:: More Bandwidth Usage Analysis
:: With a few small changes to the existing query, you can monitor hourly or monthly bandwidth usage for a specific range of dates. The key is in the SELECT clause. For example, to obtain hourly bandwidth usage, instead of selecting per day grouping, change it to hourly.
:: ---Ch02HourlyBandwidth.sql---
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:ColumnStacked3D -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% HourlyBandwidth" -E:-1 -view:ON "SELECT QUANTIZE(TO_TIMESTAMP(date, time), 3600) AS Hour, DIV(Sum(cs-bytes),1024) AS Incoming(K), DIV(Sum(sc-bytes),1024) AS Outgoing(K) INTO %odl%\Hits-Per-Hour.jpg FROM '%IISLogs%\*.log' GROUP BY Hour"
:: ---Ch02HourlyBandwidth.sql---
:: The query first quantizes the date and time to the nearest hour, which results in an hourly grouping of the results. Take note that now the log source should be a daily log file, such as ex080104.log To make it more interesting, what if you would like to know the bandwidth usage for a specific date range? The answer:
:: ---Ch02DateBandwidth.sql---
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:ColumnStacked3D -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Hits-Per-Hour" -E:-1 -view:ON "SELECT TO_STRING(TO_TIMESTAMP(date, time), 'MM-dd') AS Day, DIV(Sum(cs-bytes),1024) AS Incoming(K), DIV(Sum(sc-bytes),1024) AS Outgoing(K) INTO %odl%\DateBandwidth.jpg FROM '%IISLogs%\*.log' Where (Day BETWEEN '05-01' AND '08-31') GROUP BY Day"
:: ---Ch02DateBandwidth.sql---
::   Select... INTO %chartname% FROM %source% Where (Day BETWEEN '%from%' AND '%to%')
:: Notice that a WHERE clause is added to apply the date range condition, and two additional variables are used. To run the query, you will enter:
LogParser.exe file:Ch02DateBandwidth.sql?chartname="daterange.gif"+source="<//localhost/msftpsvc/1>" +from="08-01"+to="08-07" -o:chart -chartTitle:"FTP Bandwidth Usage" -view -chartType:ColumnStacked3d
:: This command instructs Log parser to parse default FTP website log Files from August 1st to August 7th. Next, to gather monthly information, simply change it to the following:
:: ---Ch02MonthlyBandwidth.sql---
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:ColumnStacked3D -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% MonthlyBandwidth" -E:-1 -view:ON "SELECT TO_STRING(TO_TIMESTAMP(date, time), 'MMMM') AS Month, DIV(Sum(cs-bytes),1024) AS Incoming(K), DIV(Sum(sc-bytes),1024) AS Outgoing(K) INTO %odl%\MonthlyBandwidth.jpg FROM '%IISLogs%\*.log' GROUP BY Month"
:: ---Ch02MonthlyBandwidth.sql--- As you may have noticed, simple modifications to the SELECT statement and adding a WHERE clause will help you to obtain useful information. This makes Log parser a very powerful and flexible parsing tool.
:: ---Ch02MalformedHttp.sql---80 Chapter 2 • Monitoring IIS Scanning Malformed HTTP Requests : This query focuses on requests with status codes of 400, 403, and 411
:: Need to figure out how the file with MalFormed HTTP was created - HTTPERR Parses the new HTTP Error log Files generated by the Http.sys driver.  Analyse server health status. HTTPERR and URLSCAN log Files provide further details that are not captured in the W3C extended log file.
:: HTTPERR and URLSCAN log Files can assist you in analyzing error requests. IIS 6.0 introduces the HTTP.SYS kernel mode driver.This driver keeps its own log Files and it is an important source for identifying error requests and understanding server health status.The default log path for HTTPERR is %windir%/system32/LogFiles/HTTPERR .Table 2.3 exhibits the available log fields supported in HTTPERR.
cmd /V:ON /K "SET HTTPERR=%windir%\System32\LogFiles\HTTPERR\httperr1.log&&echo %Date% !Time! [RC] cmd /V:ON /K SET HTTPERR= !HTTPERR! RC=%ErrorLevel%"
dir %HTTPERR%
:: .exe file:Ch02MalformedHttp.sql
LogParser –o:NAT –rtp:-1 > %odl%\MalformedHttp.txt "SELECT TO_STRING(TO_TIMESTAMP(date, time), 'MM-dd') AS Day, REVERSEDNS(c-ip) AS ClientIP, cs-method AS ClientMethod, s-ip AS WebServerIP, COUNT(*) AS Total, CASE s-reason WHEN 'BadRequest' THEN 'Bad and Invalid Request.' WHEN 'Verb' THEN 'Invalid HTTP verb.' WHEN 'Hostname' THEN 'Hostname not found.' WHEN 'Header' THEN 'Invalid Header during parsing.' WHEN 'URL' THEN 'Invalid URL detected.' WHEN 'Forbidden' THEN 'Request denied' WHEN 'LengthRequired' THEN 'HTTP PUT length missing.' ELSE STRCAT('Unknown error, Err:',cs-uri) END AS ErrDesc FROM %HTTPERR% WHERE (sc-status IN (400;403;411)) GROUP BY Day, ClientIP, ClientMethod, WebServerIP, ErrDesc ORDER BY Day, Total DESC"
NotePad++  %odl%\MalformedHttp.txt
:: NOTE ;503 has format of. (See page 61-62 LogParser PDF)
#Fields: date time c-ip c-port s-ip s-port cs-version cs-method cs-uri streamid streamid_ex sc-status s-siteid s-reason s-queuename transport fault-code
2024-07-02 08:37:29 10.10.10.185 63640 10.10.10.7 5357 HTTP/1.1 POST /790f4b81-0b1e-4559-8202-3ceadb31828c - - 503 - N/A - TCP -

:: ---Ch02MalformedHttp.sql---
:: LogParser.exe file:Ch03TrendingSystemStartups.sql -i:EVT -o:chart -charttype:column3d -legend off -chartTitle "Number of StartUp Events" –view:on
::--- Ch03TrendingSystemStartups.sql ---
LogParser -i:EVT -stats:On -o:CHART -groupSize:1024x768 -charttype:ColumnStacked3D -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% TrendingSystemStartups" -E:-1 -view:ON  -legend off "SELECT quantize(TimeGenerated, 3600) AS Time, Count(*) AS Number_of_Events INTO '%ohtm%\TrendingSystemStartups.jpg' FROM System WHERE EventID= '6005' GROUP BY Time ORDER BY Number_of_Events"
:: --- Ch03TrendingSystemStartups.sql --
:: Page 63-65
cmd /V:ON /K "SET Root=%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 02\Scripts&&echo %Date% !Time! [RC] cmd /V:ON /K SET Root= !Root! RC=%ErrorLevel%"
dir "%Root%\Ch02ClientErrors.sql"
LogParser file:"%Root%\Ch02AuthAclFailures.sql"?source="<1>" -stats:On -o:DataGrid -E:-1 –rtp:-1
LogParser file:"%Root%\Ch02ServerErrors.sql"?source="<1>" -stats:On -o:DataGrid -E:-1 –rtp:-1
LogParser file:"%Root%\Ch02ClientErrors.sql"?source="<1>" -stats:On -o:DataGrid -E:-1 –rtp:-1
::LogParser file:"%Root%\Ch02ClientErrors.sql"?source="<1>" –o:NAT –rtp:-1 > %odl%\ClientErrors.txt
::NotePad++ %odl%\ClientErrors.txt
:: ---Ch08ContentTypes.sql---
cmd /V:ON /K "SET Root=%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 08\Scripts&&echo %Date% !Time! [RC] cmd /V:ON /K SET Root= !Root! RC=%ErrorLevel%"
LogParser file:"%Root%\Ch02AuthAclFailures.sql"?source="<1>" -stats:On -o:DataGrid -E:-1 –rtp:-1
---Ch08ContentTypes.sql---
:: LogParser file:Ch08ContentTypes.sql?chartname="webcontenttypes.gif" +source="d:\web\." -i:FS -o:chart -chartType:PieExploded3d -chartTitle:"Website Content Types" –values:on -view -groupSize:800x600
LogParser -i:FS -stats:On -o:CHART -groupSize:1024x768 -charttype:PieExploded3d -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% TrendingSystemStartups" -E:-1 -view:ON -legend on "SELECT CASE STRLEN(TO_LOWERCASE(EXTRACT_EXTENSION(name))) WHEN 0 THEN 'No extension' ELSE TO_LOWERCASE(EXTRACT_EXTENSION(name)) END AS [File Type], COUNT(*) AS Total INTO %odl%\ContentTypes.jpg FROM %OneDrive% WHERE (attributes NOT LIKE 'D%') GROUP BY [File Type] ORDER BY Total DESC"
---Ch08ContentTypes.sql
LogParser -i:FS -o:chart -chartType:PieExploded3d -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Website Content Types" –values:on -view -groupSize:1024x768 "SELECT [File Type], Total USING TO_LOWERCASE(EXTRACT_EXTENSION(name)) AS Type, CASE STRLEN(Type) WHEN 0 THEN 'No extension' ELSE Type END AS [File Type], COUNT() AS Total INTO '%ohtm%\Ch08ContentTypes.jpg' FROM 'C:\inetpub' WHERE (attributes NOT LIKE 'D%') GROUP BY [File Type] ORDER BY Total DESC"
---Ch08ContentTypes.sql---
LogParser -i:FS -o:chart -chartType:PieExploded3d -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Folder Content Types" –values:on -view -groupSize:1024x768 "SELECT [File Type], Total USING TO_LOWERCASE(EXTRACT_EXTENSION(name)) AS Type, CASE STRLEN(Type) WHEN 0 THEN 'No extension' ELSE Type END AS [File Type], COUNT() AS Total INTO '%ohtm%\Ch08ContentTypes.jpg' FROM '%OneDrive%' WHERE (attributes NOT LIKE 'D%') GROUP BY [File Type] ORDER BY Total DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Below 9 working examples added - Last Updated: 08 Jun 2022 10:27 AM
:: Get Average Page Load Time Between Time Frames
::# LogParser -i:IISW3C -stats:On -o:DataGrid -E:-1 "SELECT cs-uri-stem, AVG(time-taken) As AvgTime FROM '%IISLogs%\*.log' WHERE TO_TIME(time) BETWEEN TIMESTAMP('00:00:01','hh:mm:ss') AND TIMESTAMP('23:59:59','hh:mm:ss') AND DATE > '2022-01-01' AND date < '2022-12-31' GROUP BY cs-uri-stem ORDER BY AvgTime DESC"
::Get Top 10 Slowest aspx Pages Between Time Frames
LogParser -i:IISW3C -o:DataGrid -E:-1 "SELECT TOP 50 cs-uri-stem, max(time-taken) as MaxTime, avg(time-taken) as AvgTime FROM '%IISLogs%\*.log' WHERE extract_extension(to_lowercase(cs-uri-stem)) = 'aspx' GROUP BY cs-uri-stem ORDER BY MaxTime DESC"
::Get Hit Frequency per Hour Between Time Frames (Chart)
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:ColumnStacked -E:-1 -view:ON "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600)), COUNT(*) AS Hit_Frequency INTO %odl%\hits.jpg FROM '%IISLogs%\*.log' WHERE TO_TIME(time) BETWEEN TIMESTAMP('00:00:01','hh:mm:ss') AND TIMESTAMP('23:59:59','hh:mm:ss') AND DATE > '2022-01-01' AND date < '2022-12-31' GROUP BY TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600)) ORDER BY TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600)) DESC"
:: Get Top 10 Client IP Addresses Between Time Frames (Chart)
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:ColumnStacked -E:-1 -view:ON "SELECT top 10 c-ip AS Unique_IPs,count(c-ip) FROM '%IISLogs%\*.log' TO %odl%\top10IPs.jpg WHERE TO_TIME(time)  BETWEEN TIMESTAMP('00:00:01','hh:mm:ss') AND TIMESTAMP('23:59:59','hh:mm:ss') AND DATE > '2022-01-01' AND date < '2022-12-31' GROUP BY c-ip ORDER BY count(c-ip) DESC"
:: Get Hourly Bandwidth Between Time Frames (Chart)
LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:ColumnStacked -chartTitle:"Bandwidth" -E:-1 -view:ON "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time), 3600)) As Hourly_Bandwidth, Div(Sum(cs-bytes),1048576) As Incoming(MB), Div(Sum(sc-bytes),1048576) As Outgoing(MB) INTO %odl%\bandwidth.jpg FROM '%IISLogs%\*.log' WHERE TO_TIME(time) BETWEEN TIMESTAMP('00:00:01','hh:mm:ss') AND TIMESTAMP('23:59:59','hh:mm:ss') AND DATE > '2022-01-01' AND date < '2022-12-31' GROUP BY TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600)) ORDER BY TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600)) DESC"
:: Get Status Codes Summary Between Time Frames
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT sc-status, sc-substatus, COUNT(*) FROM '%IISLogs%\*.log' WHERE TO_TIME(time) BETWEEN TIMESTAMP('00:00:01','hh:mm:ss') AND TIMESTAMP('23:59:59','hh:mm:ss') AND DATE > '2022-01-01' AND date < '2022-12-31' GROUP BY sc-status, sc-substatus ORDER BY sc-status"
:: Get 400 and 404 Errors with IPs Between Time Frames
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT date, time, sc-status, cs-uri-stem, c-ip FROM '%IISLogs%\*.log' WHERE TO_TIME(time) BETWEEN TIMESTAMP('00:00:01','hh:mm:ss') AND TIMESTAMP('23:59:59','hh:mm:ss') AND DATE > '2022-01-01' AND date < '2022-12-31' AND (sc-status = 400 OR sc-status = 404) ORDER BY sc-status, date, time"
:: Get Content Usage by Bytes Between Time Frames (Chart)
LogParser -i:IISW3C -chartType:PieExploded3d -view:ON "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS PageType, SUM(sc-bytes) AS Bytes INTO %odl%\content.jpg FROM '%IISLogs%\*.log' WHERE TO_TIME(time) BETWEEN TIMESTAMP('00:00:01','hh:mm:ss') AND TIMESTAMP('23:59:59','hh:mm:ss') AND DATE > '2022-01-01' AND date < '2022-12-31' GROUP BY PageType ORDER BY Bytes DESC"
LogParser -i:IISW3C -chartType:ColumnStacked3D -view:ON "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS PageType, SUM(sc-bytes) AS Bytes INTO %odl%\content.jpg FROM '%IISLogs%\*.log' WHERE TO_TIME(time) BETWEEN TIMESTAMP('00:00:01','hh:mm:ss') AND TIMESTAMP('23:59:59','hh:mm:ss') AND DATE > '2022-01-01' AND date < '2022-12-31' GROUP BY PageType ORDER BY Bytes DESC"
:: ERROR: Error: Syntax Error: extra token(s) after query: '\*.log' - LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS Extension, MUL(PROPSUM(sc-bytes),100.0) AS Bytes FROM '%IISLogs%\*.log' GROUP BY Extension ORDER BY Bytes DESC"
LogParser -i:IISW3C -view:ON -o:CHART -groupSize:1024x768 -chartType:PieExploded3d -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date%  distribution of the number of bytes sent by the server for each page type" "SELECT TO_LOWERCASE(EXTRACT_EXTENSION(cs-uri-stem)) AS PageType, MUL(PROPSUM(sc-bytes), 100.0) AS PercentBytes INTO %ohtm%\%ComputerName%_BytesSentChart.gif FROM '%IISLogs%\*.log' GROUP BY PageType HAVING PercentBytes >= 1.0 ORDER BY PercentBytes DESC"
::Image leaching is defined as hot-linking or borrowing images directly from your Web
echo Identify Image Leaching&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT Top 50 TO_LOWERCASE(cs-uri-stem) AS RequestedFile, count(*) AS Hits, STRCAT(TO_STRING(DIV(SUM(sc-bytes),1024)),'k') AS TotalBytesSent, TO_LOWERCASE(EXTRACT_TOKEN(cs(Referer), 0, '?')) AS ReferrerURL FROM '%IISLogs%\*.log' WHERE (EXTRACT_TOKEN(cs(Referer), 2, '/') <> '%domainname%') AND (cs(Referer) IS NOT NULL) AND (EXTRACT_EXTENSION(TO_LOWERCASE(cs-uri-stem)) IN ('gif';'jpg';'bmp')) AND (sc-status IN (200;304)) GROUP BY RequestedFile, ReferrerURL ORDER BY Hits, TotalBytesSent DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +---------------------------------------------------------+
:: | IIS Forensic checks for wierd behaviours in WEB sites   |
:: +---------------------------------------------------------+
:: Note "CPU-Utilization" = 100 pct * Avg(time-taken) * (Requests / second) / (#CPU * 1000).
echo WEB Statistics per hour from IIS logfile&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT date, QUANTIZE(time,3600) as interval, COUNT(*), AVG(time-taken), SUM(time-taken), DIV(TO_REAL(COUNT(*)), 3600) AS Requests/sec FROM '%IISLogs%\*.log' GROUP BY date, interval ORDER BY date, interval"
echo report of All file extensions that exist within your web content&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT TO_STRING(TO_TIMESTAMP(date, time), 'yyyy-MM-dd') AS Day, cs-uri-stem, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status<400 or sc-status>=500) AND (TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' OR TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%') GROUP BY Day, cs-uri-stem ORDER BY cs-uri-stem, Day"
echo  number of hits for each day for each ASP&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT TO_STRING(TO_TIMESTAMP(date, time), 'yyyy-MM-dd') AS Day, cs-uri-stem, COUNT(*) AS Total From '%IISLogs%\*.log' WHERE (sc-status<400 or sc-status>=500) AND (TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' OR TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%') GROUP BY Day, cs-uri-stem ORDER BY cs-uri-stem, Day"
echo number of hits for each day for each ASP and DLL file&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT date, QUANTIZE(time, 3600) AS hour, sc-status, COUNT(*) AS Errors FROM '%IISLogs%\*.log' WHERE sc-status>=400 GROUP BY date, hour, sc-status HAVING Errors>25 ORDER BY Errors DESC"
echo number of errors per hour&LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -chartType:ColumnStacked -E:-1 -view:ON "SELECT date, QUANTIZE(time, 3600) AS hour, sc-status, COUNT(*) AS Errors INTO %ohtm%\%ComputerName%-Hits.gif FROM '%IISLogs%\*.log' WHERE sc-status>=400 GROUP BY date, hour, sc-status HAVING Errors>10 ORDER BY Errors DESC"
:: Above Error: Column hour is not an INTEGER nor a REAL
echo  number of hits for each day for each ASP&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT date, QUANTIZE(time, 3600) AS hour, sc-status, COUNT(*) AS Errors FROM '%IISLogs%\*.log' WHERE sc-status>=400 GROUP BY date, hour, sc-status HAVING Errors>25 ORDER BY Errors DESC"
echo Hacker used two different proxies to conceal IP address:&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT DISTINCT c-ip, cs(User-Agent) FROM '%IISLogs%\*.log' WHERE c-ip='198.54.202.2' or c-ip='62.135.71.223'"
echo unusuAlly high number of hits on a single page from a single IP address&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT DISTINCT date, cs-uri-stem, c-ip, COUNT(*) AS Hits FROM '%IISLogs%\*.log' GROUP BY date, c-ip, cs-uri-stem HAVING Hits>50 ORDER BY date,Hits Desc"
echo view exactly what ASP errors IIS encountered while serving requests&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-query, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE sc-status>=500 GROUP BY cs-uri-query ORDER BY Total DESC"
echo watch for ODBC and ADO errors&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, sc-status, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%' GROUP BY cs-uri-stem, sc-status ORDER BY cs-uri-stem, sc-status"
echo Check errors of interest in Win32 Status codes&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, WIN32_ERROR_DESCRIPTION(sc-win32-status) as Error, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE sc-win32-status>0 and (TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%') GROUP BY cs-uri-stem, Error ORDER BY cs-uri-stem, Error"
echo Check POST issues&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, cs-method, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status<400 or sc-status>=500) AND (TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%') GROUP BY cs-uri-stem, cs-method ORDER BY cs-uri-stem, cs-method"
echo Check for attack involving sending a large amount of information back to the attacker&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, COUNT(*) as Hits, AVG(sc-bytes) AS Avg, Max(sc-bytes) AS Max, Min(sc-bytes) AS Min, Sum(sc-bytes) AS Total FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%' GROUP BY cs-uri-stem ORDER BY cs-uri-stem"
echo Report on bytes sent from the client:&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, COUNT(*) as Hits, AVG(cs-bytes) AS Avg, Max(cs-bytes) AS Max, Min(cs-bytes) AS Min, Sum(cs-bytes) AS Total FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%' GROUP BY cs-uri-stem ORDER BY cs-uri-stem"
echo how much time the server spent processing the request&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, COUNT(*) as Hits, AVG(time-taken) AS Avg, Max(time-taken) AS Max, Min(time-taken) AS Min, Sum(time-taken) AS Total FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%' GROUP BY cs-uri-stem ORDER BY cs-uri-stem"
echo Check for unauthenticated anonymous access&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-username, COUNT(*) AS Hits from '%IISLogs%\*.log' WHERE cs-username IS NOT NULL GROUP BY cs-username ORDER BY Hits Desc"
echo look at the HTTP User-Agent header sent by the client&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT DISTINCT cs(User-Agent) FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs(User-Agent)) NOT LIKE '%mozilla%' AND TO_LOWERCASE(cs(User-Agent)) NOT LIKE '%opera%' ORDER BY cs(User-Agent)"
echo Test Index...&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT COUNT(cs(User-Agent)) AS Client FROM '%IISLogs%\*.log' WHERE STRLEN(cs(User-Agent)) > 100"
echo Examine 400.x codes&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT STRCAT( cs-uri-stem, REPLACE_IF_NOT_NULL(cs-uri-query, STRCAT('?',cs-uri-query))) AS Request, STRCAT( TO_STRING(sc-status), STRCAT( '.',COALESCE(TO_STRING(sc-substatus), '?' ))) AS Status, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status >= 400) GROUP BY Request, Status ORDER BY Total DESC"
echo Chart Hourly Hits through day&LogParser -i:IISW3C -o:CHART -groupSize:1024x768 -view:ON -chartType:ColumnClustered -chartTitle:"Hourly Hits" "SELECT TO_STRING(time, 'HH') AS Hour, COUNT(*) AS Hits INTO hitPerSecond.jpg FROM '%IISLogs%\*.log' GROUP BY Hour ORDER BY Hour ASC"
echo Chart - Hits per Hour&LogParser -i:IISW3C -stats:On -o:CHART -groupSize:1024x768 -view:ON -chartType:ColumnClustered -chartTitle:"Hits per Hour" -Recurse:-1 "SELECT TO_STRING(time, 'HH') AS Hour, DIV(Sum(cs-bytes),1024) AS Incoming(K), DIV(Sum(sc-bytes),1024) AS Outgoing(K) INTO %odl%\HitsPerHour.gif FROM '%IISLogs%\*.log' GROUP BY Hour"
echo Chart - Hits per Hour&LogParser -i:IISW3C -stats:On -o:CHART -groupSize:720X576 -view:ON -chartType:ColumnStacked -chartTitle:"Hits Per Hour" -Recurse:-1 "SELECT QUANTIZE(time, 3600) AS Hour, COUNT(*) AS Hits INTO %odl%\IISHitsPerHour.gif FROM '%IISLogs%\*.log' GROUP BY Hour ORDER BY Hour ASC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo show Total bytes sent&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT SUM(sc-bytes) AS TotalKiloBytesSent, COUNT(*) as TotalHits FROM %IISLogs%\*.log"
echo ASP app errors&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT EXTRACT_TOKEN(FullUri, 0, '|') AS Uri, EXTRACT_TOKEN(cs-uri-query, -1, '|') AS ErrorMsg, EXTRACT_TOKEN(cs-uri-query, 1, '|') AS LineNo, COUNT(*) AS Total USING STRCAT( cs-uri-stem, REPLACE_IF_NOT_NULL(cs-uri-query, STRCAT('?', cs-uri-query))) AS FullUri FROM '%IISLogs%\*.log' WHERE (sc-status = 500) AND (cs-uri-stem LIKE '%.asp') GROUP BY Uri, ErrorMsg, LineNo ORDER BY Total DESC"
echo Total by hour&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT TO_STRING(time, 'HH') AS Hour, COUNT(*) AS Hits FROM '%IISLogs%\*.log' GROUP BY Hour ORDER BY Hour"
echo HTTP Status codes&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus))) AS Status, COUNT(*) AS Total FROM '%IISLogs%\*.log' GROUP BY Status ORDER BY Total DESC"
echo Requests and full status by number of hits&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT STRCAT(cs-uri-stem, REPLACE_IF_NOT_NULL(cs-uri-query, STRCAT('?',cs-uri-query))) AS Request, STRCAT(TO_STRING(sc-status), STRCAT('.',COALESCE(TO_STRING(sc-substatus), '?' ))) AS Status, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status >= 400) GROUP BY Request, Status ORDER BY Total DESC"
echo Hit counts for each extension&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT TO_UPPERCASE(EXTRACT_EXTENSION( cs-uri-stem )) AS Extension, COUNT(*) AS [Total Hits] FROM '%IISLogs%\*.log' GROUP BY Extension ORDER BY [Total Hits] DESC"
echo ASP app errors&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT TO_UPPERCASE(EXTRACT_EXTENSION( cs-uri-stem )) AS Extension, MUL(PROPSUM(sc-bytes),100.0) AS [Total Bytes] FROM '%IISLogs%\*.log' GROUP BY Extension ORDER BY [Total Bytes] DESC"
echo DISTINCT users&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT COUNT(DISTINCT cs-username) AS Users FROM %IISLogs%\*.log"
echo All .htm pages&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT date, cs-uri-stem FROM '%IISLogs%\*.log' WHERE INDEX_OF(cs-uri-stem,'.htm') > -1"
echo All IP Addresses between 10.10.10.0. and 10.10.255.255&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT c-ip, count(c-ip) from '%IISLogs%\*.log' WHERE IPV4_TO_INT(c-ip) BETWEEN IPV4_TO_INT('10.10.10.0') AND IPV4_TO_INT('10.10.255.255') GROUP BY c-ip ORDER BY c-ip"
echo All on port 80 (Large Report)&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT * FROM '%IISLogs%\*.log' WHERE s-port = 80"
echo Select pages and requests count&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem AS UrlWithoutParams, COUNT(*) AS Total FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY Total DESC"
echo Select logs between two TIMESTAMPs&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT date, time, cs-uri-stem FROM '%IISLogs%\*.log' WHERE TO_TIMESTAMP(date, time) BETWEEN TIMESTAMP('2022-01-01 10:00:00', 'yyyy-MM-dd hh:mm:ss') AND TIMESTAMP('2022-12-31 10:03:00', 'yyyy-MM-dd hh:mm:ss') ORDER BY date"
echo Select Urls, Requests count between two dates&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem AS UrlWithoutParams, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE TO_TIMESTAMP(date, time) BETWEEN TIMESTAMP('2022-01-01 10:00:00', 'yyyy-MM-dd hh:mm:ss') AND TIMESTAMP('2022-12-31 10:03:00', 'yyyy-MM-dd hh:mm:ss') GROUP BY cs-uri-stem ORDER BY Total DESC"
echo top 10 urls that spent the most time being rendered:&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT TOP 100 COUNT(*), AVG(time-taken), SUM(time-taken), cs-uri-stem INTO report_sum.txt FROM '%IISLogs%\*.log' WHERE EXTRACT_EXTENSION(cs-uri-stem)='aspx' GROUP BY cs-uri-stem ORDER BY sum(time-taken) DESC"
echo Test Make TIMESTAMP from string&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT TIMESTAMP('2022-01-01 10:00:00', 'yyyy-MM-dd hh:mm:ss') FROM %IISLogs%\*.log"
echo Test Make TIMESTAMP from log date and time&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT TO_TIMESTAMP(date, time) FROM %IISLogs%\*.log"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo List All 200 HTTP status codes.&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT DISTINCT TO_LOWERCASE(cs-uri-stem) AS URL, COUNT(*) AS Hits FROM '%IISLogs%\*.log' WHERE sc-status=200 GROUP BY URL ORDER BY URL"
echo return All valid requests from any IP address that also had a 404&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT c-ip, cs-uri-stem, COUNT(*) as Hits FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) NOT LIKE '%.gif' AND TO_LOWERCASE(cs-uri-stem) NOT LIKE '%.jpg%' AND c-ip IN (SELECT c-ip FROM '%IISLogs%\*.log' WHERE sc-status=404) AND sc-status=200 GROUP BY c-ip, cs-uri-stem"
:: you may want to see if the proxy server sends the client's real IP address through other HTTP headers. Below is example ASP code to log additional proxy headers:
<%
sHeader= Request.ServerVariables("X-Forwarded-For")
If Len(sHeader) Then Response.AppendToLog "|" & sHeader
%>
:: Needs Fixin
::This query will return All valid requests FROM any IP address that also had a 404 error on ToDay: (%%iISLogf%\*%yymmdd%.log)
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT c-ip, cs-uri-stem, COUNT(*) as Hits FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) NOT LIKE '%.gif' AND TO_LOWERCASE(cs-uri-stem) NOT LIKE '%.jpg%' AND c-ip IN (SELECT c-ip FROM '%IISLogs%\*.log' WHERE sc-status=404) AND sc-status=200 GROUP BY c-ip, cs-uri-stem"
:: Error while parsing field sc-status: Value is not a relative integer
:: URL's in 200 HTTP status codes. FROM your log Files directory, execute the following query:
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT DISTINCT TO_LOWERCASE(cs-uri-stem) AS URL, COUNT(*) AS Hits FROM '%IISLogs%\*.log' WHERE sc-status=200 GROUP BY URL ORDER BY URL"
:: Error while parsing field sc-status: Value is not a relative integer
LogParser -i:W3C -q:Off -stats:On -rtp:-1 -o:datagrid -E:-1 "SELECT c-ip, cs-uri-stem, COUNT(*) AS Hits FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) NOT LIKE '%.gif' AND TO_LOWERCASE(cs-uri-stem) NOT LIKE '%.jpg%' AND c-ip IN (SELECT c-ip FROM '%IISLogs%\*.log' WHERE sc-status=404) AND sc-status=200 GROUP BY c-ip, cs-uri-stem"
:: Error while parsing field sc-status: Value is not a relative integer
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT TOP 10 cs-uri-stem, COUNT(*) FROM '%IISLogs%\*.log' WHERE time-taken > 10000 GROUP BY cs-uri-stem ORDER BY COUNT(*) DESC"
:: This command asks Log Parser to filter out entries for pages ending up in ".gif", ".jpg", and ".png", regardless of the capitalization of the URL. It also leaves out requests that generated the HTTP error code "404", that is, "page not found".
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT * FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE (EXTRACT_EXTENSION(cs-uri-stem)) NOT IN ('gif';'jpg';'png') AND sc-status <> 404"

:: The very first time you execute this command, the "MyCheckpoint.lpc" file does not exist, and the IISW3C input format parses all the entries in all the log Files, filtering and uploading the resulting data to the database. After parsing all the logs, the IISW3C input format saves the current size of each log file to the "MyCheckpoint.lpc" file.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 -iCheckpoint:MyCheckpoint.lpc "SELECT * FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE (EXTRACT_EXTENSION(cs-uri-stem)) NOT IN ('gif';'jpg';'png') AND sc-status <> 404"

:: The following command calculates the total number of hits for every hour from IIS log Files, using the CHART output format to create a JPG image containing a chart:
LogParser -i:IISW3C -view:ON -o:CHART -chartType:ColumnClustered -chartTitle:"%Date% Hourly Hits" -groupSize:1024x768 "SELECT TO_STRING(time, 'HH') AS Hour, COUNT(*) AS Hits INTO '%ohtm%\%ComputerName%_HourlyHits.gif' FROM '%IISLogs%\*.log' GROUP BY Hour ORDER BY Hour ASC"
:: Unexpected internal error calling chart object method ExportPicture: Exception occurred.
 -legend:AUTO -values:AUTO -categories:AUTO
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Queries with sc-status >= 400
:: A good indicator for hacking activies or other attacks is the number of errors per hour.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT Date AS Date, QUANTIZE(time, 3600) AS Hour, sc-status AS Status, COUNT(*) AS ErrorCount FROM '%IISLogs%\*.log' WHERE  sc-status >= 400 GROUP BY Date, hour, sc-status HAVING ErrorCount > 25 ORDER BY ErrorCount DESC"
:: Get requests and full status by number of hits Error 404 and URL
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT STRCAT( cs-uri-stem, REPLACE_IF_NOT_NULL(cs-uri-query, STRCAT('?',cs-uri-query))) AS Request, STRCAT( TO_STRING(sc-status), STRCAT( '.',COALESCE(TO_STRING(sc-substatus), '?' ))) AS Status, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status >= 400) GROUP BY Request, Status ORDER BY Total DESC"
echo Examine 400.x codes&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT STRCAT( cs-uri-stem, REPLACE_IF_NOT_NULL(cs-uri-query, STRCAT('?',cs-uri-query))) AS Request, STRCAT( TO_STRING(sc-status), STRCAT( '.',COALESCE(TO_STRING(sc-substatus), '?' ))) AS Status, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status >= 400) GROUP BY Request, Status ORDER BY Total DESC"
echo Requests and full status by number of hits&LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT STRCAT(cs-uri-stem, REPLACE_IF_NOT_NULL(cs-uri-query, STRCAT('?',cs-uri-query))) AS Request, STRCAT(TO_STRING(sc-status), STRCAT('.',COALESCE(TO_STRING(sc-substatus), '?' ))) AS Status, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status >= 400) GROUP BY Request, Status ORDER BY Total DESC"
::	Top bandwidth usage by URL
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT top 50 DISTINCT SUBSTR(TO_LOWERCASE(cs-uri-stem), 0, 55) AS Url, COUNT(*) AS Hits, AVG(sc-bytes) AS AvgBytes, SUM(sc-bytes) as ServedBytes FROM '%IISLogs%\*.log' GROUP BY Url HAVING Hits >= 20 ORDER BY ServedBytes DESC"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT date as Date, QUANTIZE(time, 3600) AS Hour, sc-status as Status, COUNT(*) AS ErrorCount FROM '%IISLogs%\*.log' WHERE sc-status >= 400 GROUP BY date, hour, sc-status HAVING ErrorCount > 25 ORDER BY ErrorCount DESC"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT Date AS Date, QUANTIZE(time, 3600) AS Hour, sc-status AS Status, COUNT(*) AS ErrorCount FROM '%IISLogs%\*.log' WHERE  sc-status >= 400 GROUP BY Date, hour, sc-status HAVING ErrorCount > 25 ORDER BY ErrorCount DESC"
:: A good indicator for hacking activies or other attacks is the number of errors per hour.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT Date AS Date, QUANTIZE(time, 3600) AS Hour, sc-status AS Status, COUNT(*) AS ErrorCount FROM '%IISLogs%\*.log' WHERE  sc-status >= 400 GROUP BY Date, hour, sc-status HAVING ErrorCount > 25 ORDER BY ErrorCount DESC"
::	Top bandwidth usage by URL
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT top 50 DISTINCT SUBSTR(TO_LOWERCASE(cs-uri-stem), 0, 55) AS Url, COUNT(*) AS Hits, AVG(sc-bytes) AS AvgBytes, SUM(sc-bytes) as ServedBytes FROM '%IISLogs%\*.log' GROUP BY Url HAVING Hits >= 20 ORDER BY ServedBytes DESC"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT date as Date, QUANTIZE(time, 3600) AS Hour, sc-status as Status, COUNT(*) AS ErrorCount FROM '%IISLogs%\*.log' WHERE sc-status >= 400 GROUP BY date, hour, sc-status HAVING ErrorCount > 25 ORDER BY ErrorCount DESC"
:: Below Error: detected extra argument "TO_TIMESTAMP(Date,time)," after query
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Application,System,Security WHERE LogParser -o:SYSLOG -severity:$MySeverity -hostName:$MyHostname "SELECT TO_TIMESTAMP(Date,time), CASE sc-status WHEN 500 THEN 'emerg' ELSE 'err' END AS MySeverity, s-computername AS MyHostname, cs-uri-stem FROM Application,System,Security WHERE sc-status >= 400"
 :: Error: detected extra argument "TO_TIMESTAMP(Date,time)," after query
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Count the total number of requests made to the API
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT date, AVG(Time-Taken) as avg_time FROM '%IISLogs%\*.log'  WHERE cs-uri-stem = '/api' AND to_TIMESTAMP(date,time) > TIMESTAMP('2022-01-01 00:00:00', 'yyyy-MM-dd hh:mm:ss') GROUP BY date"
:: Find time in both utc/local time, http status, response time, and the page/uri that was requested
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT top 1000 TO_TIMESTAMP(date, time) AS utc-TIMESTAMP, TO_LOCALTIME(utc-TIMESTAMP) AS local-TIMESTAMP, cs-uri-stem as Uri, sc-status as HttpStatus,  sc-substatus as SubStatus, time-taken as ResTime(ms), DIV(MUL(1.0,time-taken), 1000.0) AS ResponseTime(s) FROM '%IISLogs%\*.log' WHERE (sc-status <> 304 and sc-status <> 500) and time-taken > 4000 AND local-TIMESTAMP between TIMESTAMP('2022-01-01 00:00:00', 'yyyy-MM-dd hh:mm:ss') and TIMESTAMP('2022-12-31 00:00:00', 'yyyy-MM-dd hh:mm:ss') ORDER BY time-taken desc"
:: URI without Parameters
LogParser -i:IISW3C -Recurse -rtp:-1 -o:datagrid -stats:On "SELECT DISTINCT cs-uri-stem AS UrlWithoutParams, COUNT(*) AS Total FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY Total DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::	Top bandwidth usage by URL
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT top 50 DISTINCT SUBSTR(TO_LOWERCASE(cs-uri-stem), 0, 55) AS Url, COUNT(*) AS Hits, AVG(sc-bytes) AS AvgBytes, SUM(sc-bytes) as ServedBytes FROM '%IISLogs%\*.log' GROUP BY Url HAVING Hits >= 20 ORDER BY ServedBytes DESC"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT date as Date, QUANTIZE(time, 3600) AS Hour, sc-status as Status, COUNT(*) AS ErrorCount FROM '%IISLogs%\*.log' WHERE sc-status >= 400 GROUP BY date, hour, sc-status HAVING ErrorCount > 25 ORDER BY ErrorCount DESC"
::	Top hits by URL
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 100 cs-uri-stem as Url, COUNT(cs-uri-stem) AS Hits FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY COUNT(cs-uri-stem) DESC"
::	Top bandwidth and hits by IP / User-Agent
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) as Agent, Sum(sc-bytes) AS TotalBytes, COUNT(*) as Hits FROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent) ORDER BY TotalBytes desc"
::	Top bandwidth by hour by IP / User-Agent
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 TO_STRING(time, 'h') as Hour, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) as Agent, Sum(sc-bytes) AS TotalBytes, COUNT(*) as Hits FROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent), hour ORDER BY sum(sc-bytes) desc"
::	Top hits by hour by IP / User-Agent
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 TO_STRING(time, 'h') as Hour, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) as Agent, COUNT(*) as Hits, Sum(sc-bytes) AS TotalBytes FROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent), hour ORDER BY Hits desc"
:: A good indicator for hacking activies or other attacks is the number of errors per hour.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT Date AS Date, QUANTIZE(time, 3600) AS Hour, sc-status AS Status, COUNT(*) AS ErrorCount FROM '%IISLogs%\*.log' WHERE  sc-status >= 400 GROUP BY Date, hour, sc-status HAVING ErrorCount > 25 ORDER BY ErrorCount DESC"
:: Detect unusuAlly high number of hits on a single URL from one IP address.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT DISTINCT date AS Date, cs-uri-stem AS URL, c-ip AS IPAddress, COUNT(*) AS Hits FROM '%IISLogs%\*.log' GROUP BY date, c-ip, cs-uri-stem HAVING Hits > 500 ORDER BY Hits Desc"
:: Get OS version from users hitting your site
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT DISTINCT cs-username, cs(user-agent) FROM '%IISLogs%\*.log' WHERE cs-username <> NULL GROUP BY cs-username, cs(user-agent)"
:: You may want to look for your longest requests (stems and/or queries), and the ones with most bytes received by the server. I'd also try one that groups by the bytes received and the IP, so that you can see if a particular request format that's likely repeated by one IP.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 cs-uri-stem, cs-uri-query, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) as Agent, cs-bytes, c-ip, FROM '%IISLogs%\*.log' WHERE cs-uri-stem != '/search' ORDER BY LEN(cs-uri-query) desc"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 COUNT(*) AS Hits cs-uri-stem, cs-uri-query, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) as Agent, cs-bytes, c-ip, FROM '%IISLogs%\*.log' GROUP BY c-ip, cs(User-Agent), cs-bytes ORDER BY Hits desc"

LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT top 80 QUANTIZE (TO_TIMESTAMP (date, time), 3600) as Hour, TO_LOWERCASE (STRCAT ('/',EXTRACT_TOKEN (cs-uri-stem,1,'/'))) as URI, COUNT (*) AS RequestsPerHour, SUM (sc-bytes) AS TotBytesSent, AVG (sc-bytes) AS AvgBytesSent, Max (sc-bytes) AS MaxBytesSent, ADD (1,DIV (Avg (time-taken),1000)) AS AvgTime, ADD (1,DIV (MAX (time-taken),1000)) AS MaxTime FROM '%IISLogs%\*.log' GROUP BY Hour, URI Having RequestsPerHour > 10 ORDER BY RequestsPerHour ASC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Count cs-uri-stem&LogParser -i:IISW3C -rtp:-1 -o:datagrid "SELECT DISTINCT cs-uri-stem FROM "%IISLogs%\*.log" WHERE time-taken > 100"
echo Count cs-uri-stem&LogParser -i:IISW3C -rtp:-1 -o:datagrid "SELECT TOP 10 cs-uri-stem, COUNT(*) FROM '%IISLogs%\*.log' WHERE time-taken > 100 GROUP BY cs-uri-stem ORDER BY COUNT(*) DESC"
echo Chart Hits by URI&LogParser -i:IISW3C -chartType:Bar3D -groupSize:640x480 -view:on "SELECT Top 20 cs-uri-stem AS [Request URI], COUNT(*) AS Hits INTO "%odl%\IISW3C-Chart.gif" FROM '%IISLogs%\*.log' Group by cs-uri-stem ORDER BY Hits DESC"
echo GET status and times&LogParser -i:IISW3C -rtp:-1 -o:datagrid "SELECT Top 20 LogRow AS [Line Number], Date AS [Date], time AS [Time], c-ip AS [Client-IP], s-ip AS [Server IP], s-port AS [Server Port], cs-method AS [Request Verb], cs-uri-stem AS [Request URI], sc-bytes AS [Bytes sent], sc-status AS [Status], sc-substatus AS [Sub-status], sc-win32-status AS [Win 32 Status], time-taken AS [Time Taken] FROM '%IISLogs%\*.log' ORDER BY time-taken desc"
LogParser -i:IISW3C -rtp:-1 -o:datagrid "SELECT Top 20 LogRow AS [Line Number], Date AS [Date], time AS [Time], c-ip AS [Client-IP], s-ip AS [Server IP], s-port AS [Server Port], cs-method AS [Request Verb], cs-uri-stem AS [Request URI], sc-bytes AS [Bytes sent], sc-status AS [Status], sc-substatus AS [Sub-status], sc-win32-status AS [Win 32 Status], time-taken AS [Time Taken] FROM '%IISLogs%\*.log' ORDER BY time-taken desc"
::# Error: WHERE clause: Syntax Error: unknown field ''000.000.000.000' - LogParser -i:IISW3C -rtp:-1 -o:datagrid "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(Date, time), 3600)), COUNT(*) AS numberrequests FROM '%IISLogs%\*.log' WHERE c-ip='000.000.000.000 group by TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(Date,time), 3600))"
LogParser -i:IISW3C -rtp:-1 -o:datagrid "SELECT TOP 20 cs-uri-stem, COUNT(*) AS TotalRequest, MAX(time-taken) AS MaxTime, AVG(time-taken) AS AvgTime FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY TotalRequest DESC"
LogParser -i:IISW3C -o:CSV "SELECT TOP 20 cs-uri-stem, COUNT(*) AS TotalRequest, MAX(time-taken) AS MaxTime, AVG(time-taken) AS AvgTime INTO "%odl%\IISW3C-Avg.csv" FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY TotalRequest DESC"
echo BeforeavgProb&LogParser -i:IISW3C -rtp:-1 -o:datagrid "SELECT TOP 25 cs-uri-stem, COUNT(*) AS TotalRequest, MAX(time-taken) AS MaxTime, AVG(time-taken) AS AvgTime FROM '%IISLogs%\*.log' WHERE TO_TIME(time) BETWEEN TIMESTAMP('00:00:00','hh:mm:ss') AND TIMESTAMP('14:00:00','hh:mm:ss') GROUP BY cs-uri-stem ORDER BY TotalRequest DESC"
LogParser -i:IISW3C -rtp:-1 -o:datagrid "SELECT * FROM '%IISLogs%\*.log' WHERE EXTRACT_EXTENSION(cs-uri-stem) = 'cgi'"
LogParser -i:IISW3C -rtp:-1 -o:datagrid "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS Extension, COUNT(*) AS Total FROM '%IISLogs%\*.log' GROUP BY Extension ORDER BY Total DESC"
LogParser -i:IISW3C -rtp:-1 -o:datagrid "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS Extension, sc-status AS StatusCode, COUNT(*) AS Attempts FROM '%IISLogs%\*.log' WHERE Extension = 'cgi' GROUP BY Extension, StatusCode ORDER BY Attempts DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Hits per hour generated by a Specific IP address:
LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time), 3600)), COUNT(*) as numberrequests FROM '%IISLogs%\*.log' where c-ip='000.000.00.000' group by TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date,time), 3600))"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time), 3600)), COUNT(*) as numberrequests FROM '%IISLogs%\*.log' where c-ip='000.000.00.000' group by TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date,time), 3600))"
LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT c-ip, count(c-ip) as requestcount FROM '%IISLogs%\*.log' where cs-uri-stem like '/search.aspx%' group by c-ip ORDER BY count(c-ip) desc"
LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, count(cs-uri-stem) as requestcount FROM '%IISLogs%\*.log' where c-ip = '000.00.00.000' group by cs-uri-stem ORDER BY count(cs-uri-stem) desc"
echo List Top 100 URLs:&LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT TOP 100 cs-uri-stem as Url, COUNT(*) As Hits FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY Hits DESC"
echo Number of requests made by a Specific user:&LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT TOP 100 cs-username As User, COUNT(*) as Hits FROM '%IISLogs%\*.log' WHERE User Is Not Null GROUP BY User"
echo Test escape Char&LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT EXTRACT_TOKEN(cs-uri-stem,1,'/') AS AppPath, COUNT(*) AS ReqCount FROM '%IISLogs%\*.log' WHERE AppPath LIKE '%\_%'" ::Error: Semantic Error: presence of field(s) and aggregate function(s) in the SELECT clause with no GROUP BY clause
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, DIV(TO_REAL(SUM(sc-bytes)),1024) as MB, COUNT(*) AS hits FROM '%IISLogs%\*.log' WHERE sc-bytes >=1 GROUP BY cs-uri-stem ORDER BY MB,cs-uri-stem DESC"
echo Search IIS Logs for Most Download Files&LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT TOP 100 cs-uri-stem, COUNT(*) as Downloads FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY Downloads DESC"
LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT SUM(sc-bytes) FROM %IISLogs%\*.log"
LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT COUNT(*) FROM %IISLogs%\*.log"
LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT COUNT(*) FROM '%IISLogs%\*.log' WHERE EXTRACT_EXTENSION(cs-uri-stem) NOT LIKE 'asp'"
LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, COUNT(*) FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem"
:: Below calculate how many requests have been served for each page type
LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS PageType, COUNT(*) FROM '%IISLogs%\*.log' GROUP BY PageType"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: The following Field Headings are created: ObjectPath, ObjectName, ObjectClass, PropertyName, PropertyValue, PropertyType
LogParser -recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TOP 50 * FROM IIS://LOCALHOST"
                                                         SELECT TOP 50 * FROM C:\inetpub
:: List all folder attributes in iis folder
---Ch08WriteAccess.sql---.exe -- file:Ch08WriteAccess.sql -o:NAT > "%ohtm%\%ComputerName%_WriteAccess.txt"
LogParser -recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT EXTRACT_TOKEN(ObjectPath,1,'LOCALHOST/') AS [Sites or virtual directories], CASE TO_INT(PropertyValue) WHEN 2 THEN 'Write Only' WHEN 3 THEN 'Read|Write' WHEN 18 THEN 'Write|Script Source Access' WHEN 19 THEN 'Read|Write|Script Source Access' WHEN 514 THEN 'Write|Script Only' WHEN 515 THEN 'Read|Write|Script Only' WHEN 518 THEN 'Write|Script and Executables' WHEN 530 THEN 'Write|Script Source Access|Script Only' WHEN 531 THEN 'Read|Write|Script Source Access|Script Only' WHEN 534 THEN 'Write|Script Source Access|Script and Executables' WHEN 535 THEN 'Read|Write|Script Source Access|Script and Executables' ELSE STRCAT('Unknown properties :',PropertyValue) END AS [Access Mode] FROM IIS://LOCALHOST WHERE (PropertyName='AccessFlags') AND ((ObjectPath LIKE '%MSFTPSVC%') OR (ObjectPath LIKE '%W3SVC%')) HAVING ObjectPath IN (SELECT ObjectPath FROM IIS://LOCALHOST WHERE (PropertyName = 'AccessWrite') AND (PropertyValue = '1'))"
---Ch08WriteAccess.sql---
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: View Traffic by the month   INTO E:\Output.txt -o:NAT
LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT yearMonth AS Dato, DIV(SUM(sc-bytes), 1024000) AS TotalSentMB, DIV(SUM(cs-bytes), 1024000) AS TotalReceivedMB USING TO_STRING(date, 'yyyy-MM') as yearMonth  FROM '%IISLogs%\*.log' GROUP BY yearMonth"
LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT cs(User-Agent), COUNT(*) as count FROM %IISLogs%\*.log GROUP BY cs(User-Agent)"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TOP 100 * FROM '%IISLogs%\*.log'"
::  WHERE data LIKE '%EHLO%' GROUP BY IP ORDER BY Hits DESC"
:: LogParser -i:IIS -recurse -rtp:-1 -o:datagrid -stats:On "SELECT EXTRACT_PREFIX(ServerIP,0,':') as IP, REVERSEDNS(EXTRACT_PREFIX(ServerIP,0,':')) as Name, COUNT(*) as Hits FROM '%IISLogs%\*.log' WHERE data LIKE '%EHLO%' GROUP BY IP ORDER BY Hits DESC"
:: Error: WHERE clause: Syntax Error: unknown field 'data'. The closest match for input format 'IIS' is 'Date'.
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Test... LogParser -i:IISW3C -recurse -rtp:-1 -o:datagrid -stats:On "SELECT EXTRACT_PREFIX(remote-endpoint,0,':') as IP,REVERSEDNS(EXTRACT_PREFIX(remote-endpoint,0,':')) as Name, COUNT(*) AS Hits, TO_LOCALTIME(TO_TIMESTAMP(EXTRACT_PREFIX(TO_STRING([#Fields: date-time]),0,'T'), 'yyyy-MM-dd')) AS LogDate from '%IISLogs%\*.log' WHERE data LIKE '%EHLO%' GROUP BY LogDate,IP ORDER BY Hits DESC"
:: Error: SELECT clause: Syntax Error: unknown field 'remote-endpoint'
===================================================================================================
::Example: SELECT EXTRACT_PREFIX(remote-endpoint,0,':') as IP,
Name                         Version Size           Modified                Name                         Version Size           Modified
:: LogParser -i:TSV -iSeparator:space -fixedSep:Off -nSep:2 -iHeaderFile:%OneDrive%\BCBackups\BCHDR.hdr -stats:On -iw:On -nSkipLines:9 -nFields:8 -rtp:-1 -o:datagrid -E:-1 "SELECT DISTINCT EXTRACT_SUFFIX(Modified,0,'=') as Mod2 FROM %odl%\T520_BCMirrorC2F_$Data.tsv" REVERSEDNS(EXTRACT_PREFIX(remote-endpoint,0,':')) as Name, COUNT(*) as Hits FROM *.log WHERE data LIKE '%EHLO%' GROUP BY IP ORDER BY Hits DESC"
:: XTRACT_PREFIX is used here to separate the IP address from the port number of the remote endpoint that is logged by Exchange protocol logging.
:: Below example is for: logged by Exchange protocol logging
:: LogParser -i:IIS -recurse -rtp:-1 -o:datagrid -stats:On "SELECT EXTRACT_PREFIX(remote-endpoint,0,':') as IP, REVERSEDNS(EXTRACT_PREFIX(remote-endpoint,0,':')) as Name, COUNT(*) as Hits FROM '%IISLogs%\*.log' WHERE data LIKE '%EHLO%' GROUP BY IP ORDER BY Hits DESC"
:: Error: SELECT clause: Syntax Error: unknown field 'remote-endpoint' To see valid fields for the IIS input format type: LogParser -h -i:IIS
LogParser -i:IIS -recurse -rtp:-1 -o:datagrid -stats:On "SELECT EXTRACT_PREFIX(remote-endpoint,0,':') as IP, REVERSEDNS(EXTRACT_PREFIX(remote-endpoint,0,':')) as Name, Count(*) as Hits FROM '%IISLogs%\*.log' WHERE data LIKE '%EHLO%' GROUP BY IP ORDER BY Hits DESC"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT c-ip As Machine, REVERSEDNS(c-ip) As Name, COUNT(*) As Hits FROM '%IISLogs%\*.log' GROUP BY Machine ORDER BY Hits DESC"

:: Error: SELECT clause: Syntax Error: unknown field 'remote-endpoint'
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:IIS 	 (Microsoft IIS Log Format)                                   │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  LogFilename (S) LogRow (I)          UserIP (S)          UserName (S)
  Date (T)        Time (T)            ServiceInstance (S) HostName (S)
  ServerIP (S)    TimeTaken (I)       BytesSent (I)       BytesReceived (I)
  StatusCode (I)  Win32StatusCode (I) RequestType (S)     Target (S)
  Parameters (S)
:: Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,FileVersion,CompanyName,FileDescription,OriginalFileName
:: LogParser -i:IIS -------------------------------------------------------------------------------
:: Retrieve All the AccessFlags properties FROM IIS metabase objects:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ObjectPath, PropertyValue FROM IIS://localhost WHERE PropertyName = 'AccessFlags'"
SET "IISlogs=%IISLogs% & Dir /B /O:N /S %IISLogs%"
SET "Root=C:\inetpub\logs\LogFiles\W3SVC1"
:: Find Largest Files in folder (Large Files)
SET "csv=%OneDrive%"
SET "Root=%OneDrive%"
echo Find Specific Large Files in folder&&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:99 "SELECT TOP 30 Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes, LastWriteTime, HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' AND Hash IS NOT NULL AND Size >=1000000 ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 200 Path,Name,Size,CreationTime,HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Size >1 ORDER BY Size DESC"
:: hash - WHERE Size >1 -OR-  WHERE Attributes NOT LIKE 'D%'
LogParser -i:IIS -recurse "SELECT TO_LOCALTIME(QUANTIZE(time, 1800)) as HalfHour, ADD(SCKBytesSec, CSKBytesSec) as KBytesSec USING DIV(DIV(MUL(1.0, SUM(sc-bytes)), 1024), 1800) as SCKbytesSec, DIV(DIV(MUL(1.0, SUM(cs-bytes)), 1024), 1800) as CSKBytesSec FROM '%IISLogs%\*.log' GROUP BY HalfHour ORDER BY HalfHour ASC"
LogParser -c -i:BIN -o:W3C '%IISLogs%\*.log' file2.log "ComputerName IS NOT NULL"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,CreationTime,HASHMD5_FILE(Path) AS Hash FROM C:\$Data\*.* ORDER BY CreationTime DESC"
LogParser -i:FS -stats:On -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,SUB(TO_INT(Size),-1),CreationTime,HASHMD5_FILE(Path) AS Hash,Attributes FROM 'C:\$Data\*.*' WHERE Size =0 AND Attributes NOT LIKE 'D%' ORDER BY CreationTime DESC"
echo List Top 20 Largest Files&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:20 "SELECT TOP 10 Path, Name, Size, Attributes FROM '%OneDrive%\*.*' ORDER BY Size DESC
echo List Top 20 pages that are taking the longest time to serve from IIS&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TOP 20 LogRow as [Line Number], date as Date, time as Time, c-ip as Client-IP, s-ip as [Server IP],  s-port as [Server Port], cs-method as [Request Verb], cs-uri-stem as [Request URI], sc-bytes as [Bytes sent], sc-status as Status, sc-substatus as Sub-status, sc-win32-status as [Win 32 Status], time-taken as [Time Taken] FROM '%IISLogs%\*.log' ORDER BY time-taken desc"
echo Finding the 30 most commonly used pages&LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% - Page Hits" "SELECT Top 30 cs-uri-stem as [Request URI], COUNT(*) AS Hits INTO %ohtm%\%ComputerName%_ReqPageHits.gif FROM '%IISLogs%\*.log' Group by cs-uri-stem ORDER BY Hits DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:IISW3C -stats:On -q:On -rtp:-1 -o:datagrid -E:20 "SELECT
LogParser -i:IISW3C -stats:On -q:On -rtp:-1 -o:datagrid -E:20 "SELECT cs-uri-stem, count(cs-uri-stem) as requestcount from '%IISLogs%\*.log' where c-ip = '000.00.00.000' group by cs-uri-stem ORDER BY count(cs-uri-stem) desc"
LogParser -i:IISW3C -stats:On -q:On -rtp:-1 -o:datagrid -E:20 "SELECT c-ip, count(c-ip) as requestcount from '%IISLogs%\*.log' where cs-uri-stem like '/search.aspx%' group by c-ip ORDER BY count(c-ip) desc"
LogParser -i:IISW3C -stats:On -q:On -rtp:-1 -o:datagrid -E:20 "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time), 3600)), count(*) as numberrequests from '%IISLogs%\*.log' where c-ip='000.000.00.000′ group by TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date,time), 3600))"
LogParser -i:IISW3C -stats:On -q:On -rtp:-1 -o:datagrid -E:20 "SELECT cs-uri-stem, c-ip, count(cs-uri-stem) from '%IISLogs%\*.log' where cs-uri-stem like '%aspx%' or cs-uri-stem like '%ashx%' group by cs-uri-stem, c-ip ORDER BY count(cs-uri-stem) desc"
LogParser -i:IISW3C -stats:On -q:On -rtp:-1 -o:datagrid -E:20 "SELECT c-ip, count(c-ip) as requestcount from '%IISLogs%\*.log' group by c-ip ORDER BY count(c-ip) desc"
LogParser -i:IISW3C -stats:On -q:On -rtp:-1 -o:datagrid -E:20 "SELECT TOP 25 cs-uri-stem as Url, COUNT(*) As Hits FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY Hits DESC"
LogParser -i:IISW3C -stats:On -q:On -rtp:-1 -o:datagrid -E:20 "SELECT TOP 25 cs-username As User, COUNT(*) as Hits FROM '%IISLogs%\*.log' WHERE User Is Not Null GROUP BY User"
LogParser -i:IISW3C -stats:On -q:On -rtp:-1 -o:datagrid -E:20 "SELECT TOP 25 EXTRACT_EXTENSION(cs-uri-stem) As Extension, COUNT(*) As Hits FROM '%IISLogs%\*.log' GROUP BY Extension ORDER BY Hits DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: List all File hashes from Root Folder into CSV to determine Duplicate Files based off file hashes. Import dups into Excel or Access...
LogParser -i:FS -o:CSV -oDQuotes ON -fileMode  0|1|2
SET csv=%OneDrive%\MSExcel\%ComputerName%_FindDupHashes.csv
SET Root=C:\Garmin
SET Root=C:\$Software
START "LPHash" /D "%odl%\" /High /WAIT /B LogParser -i:FS -o:CSV -oDQuotes ON -fileMode:1 -q:off -stats:On -Recurse:-1 "SELECT Path,Name,Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash INTO '%csv%' FROM '%Root%\*.*' ORDER BY LastWrite,Hash ASC"&Notepad++ "%csv%"
echo START Excel %ComputerName%_FindDupHashes.csv&"%ProgramFiles%\Microsoft Office\root\Office16\EXCEL.EXE" "%csv%"
LogParser -recurse:0 -i:FS -o:NAT -rtp:-1 "SELECT Path, Name, Size,HASHMD5_FILE(Path) AS Hash FROM %Root%\*.*"
LogParser -recurse:0 -i:FS -o:NAT -rtp:-1 "SELECT Path, Name FROM %Root%\*.* where attributes NOT LIKE 'D%'"
SET Root=C:\$Data\Bass-Guitar
echo Display 100 Largest Files in folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' ORDER BY Hash,Size DESC"
echo Display to HTML 100 Largest Files in folder&
LogParser -i:FS -Recurse:-1 -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-DiskUsage7.tpl" "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,HASHMD5_FILE(Path) AS Hash INTO '%ohtm%\%ComputerName%_DiskUsageReport.html'  FROM 'C:\$Data\Books-Manuals-Tutorials\*.*' WHERE Attributes NOT LIKE 'D%' ORDER BY Size DESC"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_DiskUsageReport.html"
LogParser -i:FS -Recurse:-1 -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-DiskUsage4.tpl" "SELECT Path,Name,Size,HASHMD5_FILE(Path) AS Hash INTO '%ohtm%\%ComputerName%_DiskUsageReport.html'  FROM 'C:\$Data\Books-Manuals-Tutorials\*.*' WHERE Attributes NOT LIKE 'D%' ORDER BY Size DESC"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_DiskUsageReport.html"
:: Above Added Hash and processing time increased dramatically - bad...

:: hash - WHERE Size >1 -OR-  WHERE Attributes NOT LIKE 'D%'
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 200 Path,Name,Size,CreationTime,HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Size >1 ORDER BY Size DESC"
_________________________________________________________________________________________________________________________________
┌──────────────────────────────────────────────────────────────────────────────┐
│   Find Needle in haystack: -i:TEXTLINE and -i:TSV using EXTRACT_TOKEN(S..)   │
└──────────────────────────────────────────────────────────────────────────────┘
:: Example using LogParser to read a text file skipping first 5 lines and reading data between columns 8 and 56 (Length (48)) Remove blank spaces and .'s then convert Hex to Text
cmd /V:ON /K "SET Root=%LocalAppData%\Microsoft\WindowsApps&&echo %Date% !Time! [RC] cmd /V:ON /K SET Root= !Root! RC=%ErrorLevel%"
fsutil reparsepoint query "%Root%\wt.exe"|LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT SUBSTR(text, 7, 48) AS Data, REPLACE_STR(Data, ' ', '') AS HexData, HEX_TO_ASC(HexData) AS RawData, REPLACE_STR(RawData, '.', '') AS TextData FROM STDIN WHERE Index BETWEEN 6 and 999"
-OR-
fsutil reparsepoint query "%Root%\wt.exe" >%ohtm%\%ComputerName%_ReparsePoint.txt&LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT SUBSTR(text, 7, 48) AS Data, REPLACE_STR(Data, ' ', '') AS HexData, HEX_TO_ASC(HexData) AS RawData, REPLACE_STR(RawData, '.', '') AS TextData FROM '%ohtm%\%ComputerName%_ReparsePoint.txt' WHERE Index BETWEEN 6 and 999"

:: NOTE: Examples below work great!
SET|LogParser -i:TEXTLINE -o:DATAGRID "SELECT EXTRACT_TOKEN(text, 0, ';') AS Path FROM STDIN WHERE Path LIKE '%sysinternalssuite%'"
SET|LogParser -i:TEXTLINE -o:DATAGRID "SELECT *, EXTRACT_TOKEN(text, 0, ';') AS Path FROM STDIN WHERE Path LIKE '%sysinternalssuite%'"
:: Note the differences between using -i:TEXTLINE and -i:TSV when using STDIN
SET|LogParser -i:TEXTLINE -o:DATAGRID "SELECT * FROM STDIN"
SET|LogParser -i:TSV -o:DATAGRID "SELECT * FROM STDIN"
:: Other examples using CMD as input (STDIN) ....
NETSTAT | LogParser -i:TSV -iSeparator:space -nSep:2 -fixedSep:off -nSkipLines:3 -rtp:-1 -o:datagrid "SELECT * FROM STDIN"
IPCONFIG /DISPLAYDNS | LogParser -i:TEXTLINE  -rtp:-1 -o:datagrid "SELECT DISTINCT SUBSTR(text,ADD(INDEX_OF(text,':'),2)) AS [DNS Name] FROM stdin WHERE text like '%record name%' ORDER BY [DNS Name]"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +-----------------------------------------------------------------------+
:: | LogParser example to remove excessive leading spaces from text field  |
:: +-----------------------------------------------------------------------+
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename AS URL, REPLACE_STR(Text, ' ', '') AS CleanedText FROM http://www.microsoft.com WHERE Text LIKE '%href=%' AND Text IS NOT NULL"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌────────────────────────────────────────────────────────────────────────┐
│ -i:FS Analyze and Find Files and Folders changed today or some time    │
│   NOTE: A duplicate Hash indicates a duplicate file                    │
└────────────────────────────────────────────────────────────────────────┘
:: Using ForFiles to list Find Files and Folders changed today
SET Root=%OneDrive%
SET TxT=%ohtm%\%ComputerName%_ChangedFilesToday.csv
echo fdate-ftime,path,fSize >%TxT%
ForFiles /D %date:~-10,2%/%date:~-7,2%/%date:~-4% /S /P %Root% /M *.* /C "cmd /c echo 0x22@fdate @ftime0x220x2C @path0x2C 0x22@fsize0x22" >>%TxT%&Notepad++ %TxT%
LogParser -i:CSV -headerRow:ON -rtp:-1 –o:DATAGRID "SELECT fdate-ftime,path,fSize FROM %TxT% ORDER BY fdate-ftime DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET Root=%LOCALAPPDATA%&SET usr=%USERDOMAIN%\%USERNAME%
echo Fix Access Issues&ICACLS %Root% /INHERITANCE:e /GRANT:r %usr%:(F) /T /C >NUL
echo Fix Access Issues&SubInACL /file '%Root%' /grant=%usr% & SubInACL /subdirectories "%Root%\*.lnk" /grant=%usr%
:: ------- Find Specific Files 'C:\$Data\* - Copy*.*' --------- :
echo Find - Copy Files in ALL folders&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, EXTRACT_EXTENSION(Name) AS Ext, LastWriteTime, Size, HASHMD5_FILE(Path) AS Hash FROM 'C:\$Data\*.*' WHERE Attributes NOT LIKE 'D%' OR Path LIKE '% - Copy%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Path DESC"
echo Find - Copy Files in ALL folders&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, EXTRACT_EXTENSION(Name) AS Ext, LastWriteTime, Size, HASHMD5_FILE(Path) AS Hash FROM 'C:\$Data\* - Copy.*' WHERE Attributes NOT LIKE 'D%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Path DESC"
:: ------- Find Specific Files Docs Excel --------- :
echo Find Excel Word Docs Files in ALL folders&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, EXTRACT_EXTENSION(Name) AS Ext, LastWriteTime, Size, HASHMD5_FILE(Path) AS Hash FROM 'D:\*.*' WHERE Attributes NOT LIKE 'D%' AND Ext LIKE '%xls%' OR Ext LIKE '%doc%' OR Path LIKE '%Marji%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Path DESC"
:: ------- Find Specific Files Docs Excel Out to csv --------- :
echo Find Specific Files in folder&LogParser -i:FS -stats:on -q:off -o:csv -Recurse:-1 -E:10 "SELECT Path, Name, EXTRACT_EXTENSION(Name) AS Ext, LastWriteTime, Size, HASHMD5_FILE(Path) AS Hash INTO '%ohtm%\%ComputerName%_H_FoundFiles.log' FROM 'H:\*.*' WHERE Attributes NOT LIKE 'D%' AND Ext LIKE '%xls%' OR Ext LIKE '%doc%' AND Path LIKE '%Marji%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Path DESC"
Notepad++ "%ohtm%\%ComputerName%_H_FoundFiles.log"
:: LogParser -i:FS -stats:on -q:off -o:csv -Recurse:-1 -E:-1 "SELECT... 2 parse errors occurred during processing (To see details about the parse error(s), execute the command again with a non-zero value for the "-e" argument)
:: ------- Find Specific Files Macrium Reflect --------- :
::'C:\ProgramData\Macrium\Reflect\*.*'  Path LIKE '%.log%' OR Path LIKE '%.xml%' AND
echo Find Specific Files in folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, Size, Attributes, CreationTime, LastAccessTime, LastWriteTime, FileVersion, ProductVersion, InternalName, ProductName, CompanyName, LegalCopyright, LegalTrademarks, PrivateBuild, SpecialBuild, Comments, FileDescription, OriginalFilename, HASHMD5_FILE(Path) AS Hash INTO "%ohtm%\%ComputerName%_MRFiles.log" FROM 'C:\ProgramData\Macrium\Reflect\*.*' WHERE Path LIKE '%.log%' OR Path LIKE '%.xml%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Path DESC"
Notepad++ "%ohtm%\%ComputerName%_MRFiles.log"
echo Find Specific Files in folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, Name, EXTRACT_EXTENSION(Name) AS Ext, CreationTime As CDate, Size, HASHMD5_FILE(Path) AS Hash FROM 'C:\ProgramData\Macrium\Reflect\*.*' WHERE Path LIKE '%.log%' OR Path LIKE '%.xml%' AND Hash IS NOT NULL AND Size >=10 ORDER BY CDate,Pat DESC"
echo Find Specific Files in folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-19 "SELECT EXTRACT_PATH(Path) AS Pat, Name, EXTRACT_EXTENSION(Name) AS Ext, CreationTime As CDate, Size, HASHMD5_FILE(Path) AS Hash FROM 'C:\$Data\*.*' WHERE Path LIKE '%.accdb%' OR  Path LIKE '%dna%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Size ASC"
ORDER BY CDate,Pat DESC"
:: ------- Good example to Find Files Updated Today or Changed ToDay --------- :
echo Find Files Updated Today or Changed ToDay in C:\ Output to :CSV&&LogParser -i:FS -stats:on -q:off -o:CSV -oDQuotes ON -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash INTO %ohtm%\%ComputerName%_FilesChangedToday.csv FROM '%OneDrive%\*.*' WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC" 3>&1 2>&1
Notepad++ %ohtm%\%ComputerName%_FilesChangedToday.csv
echo Find $Data Files Changed ToDay in "%data%" && LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM '%data%\*.*' WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"
echo Find Files Changed ToDay in %OneDrive%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM '%OneDrive%\*.*' WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"
echo Find Log Files Changed ToDay in %WINDIR%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path AS FullName, Size,LastWriteTime FROM '%WINDIR%\*.log' WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Size >=10 ORDER BY LastWriteTime DESC"
echo Find Files Changed ToDay in folder: %UserProfile%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM '%UserProfile%\*.*' WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"

echo Find Files Changed Last week in folder: %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE SUB(TO_INT(CreationTime), TO_INT(SYSTEM_TIMESTAMP())) < -2592000 AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"

SET Root=%OneDrive%
echo Find Files Changed ToDay in folder: %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET Root=%UserProfile%
echo List All Files Changed Today: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:0 "SELECT CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes FROM %Root%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY Hash DESC"
echo List All Files Changed Today: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:0 "SELECT CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes FROM %Root%\*.* WHERE Ext LIKE '%mp3%' AND Ext LIKE '%wma%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY Hash DESC"

echo List All Files Changed Today: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size FROM %Root%\*.mp3,%Root%\*.wav WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay DESC"

::echo List All Files Changed Today: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size FROM %Root%\*.* WHERE Ext = mp3 OR Ext = wav ORDER BY ToDay DESC"

echo List All Files Changed Today: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size FROM %Root%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND WHERE Ext IN ("mp3";"wav";"log") ORDER BY ToDay DESC"
,%Root%\*.log LIKE ('%mp3%';'%wav%';'%log%')"  AND WHERE Ext LIKE '%mp3%'   WHERE Ext IN (mp3;wav;log) ORDER BY ToDay DESC"

echo Files Changed Last 2Days: %USERPROFILE%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, LastWriteTime, Path, Name, Size, Attributes FROM %USERPROFILE%\*.xml WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay DESC"
echo Files Changed Today: %OneDrive%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime As ToDay, LastWriteTime, Path, Name, Size, Attributes FROM %OneDrive%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay DESC"
::Test LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime As ToDay, LastWriteTime, Path, Name, Size, Attributes FROM %Data%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay DESC"
::Test LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime As ToDay, LastWriteTime, Path, Name, Size, Attributes FROM %Data%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:01', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET Root=%UserProfile%\AppData\Local\Audials\Audials 2022

echo Find Files Changed Last 1 Hour/s today in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"

echo Find Files Changed Last 1 Hour/s today in folder %Root%&LogParser -i:FS -stats:ON -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL OR TO_INT(Size) >=10 OR Pat LIKE '%Audials%' ORDER BY Size,Ext DESC"

SET Root=C:\$Data
echo Find Changed Files today&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime, LastWriteTime As Updated, Path, Name, Size, Attributes FROM %Data%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY Updated DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime As ToDay, LastWriteTime, Path, Name, Size, Attributes FROM %Data%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:01', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime, LastWriteTime As ToDay, Path, Name, Size, Attributes FROM %Data%\*.* WHERE TO_DATE(LastWriteTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay DESC"
SET Root=%USERPROFILE%
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: NOTE: Find Specific File - Using ALL fields causes issues if File MetaData does not have the associated field requested...:LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, Size, Attributes, CreationTime, LastAccessTime, LastWriteTime, FileVersion, ProductVersion, InternalName, ProductName, CompanyName, LegalCopyright, LegalTrademarks, PrivateBuild, SpecialBuild, Comments, FileDescription, OriginalFilename, HASHMD5_FILE(Path) AS Hash FROM 'C:\ProgramData\Macrium\Reflect\*.*' WHERE Path LIKE '%.log%' OR Path LIKE '%.xml%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Path DESC"
:: NOTE: To list all available MetaData, run the following Command:
Get-ItemProperty -Path "$ENV:OneDrive\AboutMe_Combined.txt"| Format-List *
Get-FileMetaData -folder (Get-ChildItem -Path 'C:\ProgramData\Macrium\Reflect' -Recurse -Directory).FullName
Get-FileMetaData -folder "C:\ProgramData\Macrium\Reflect"
:: ERROR: Description = Invalid query - WMIC datafile where Name="%OneDrive%\AboutMe_Combined.txt" get * /format:list >> output.txt
:: ERROR: Description = Invalid query - WMIC datafile where Name="C:\Program Files\Notepad++\notepad++.exe" get Version
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
┌───────────────────────────────────────────────────┐
│   LogParser List Newest/Latest Files and others   │
│   LogParser -i:FS                                 │
└───────────────────────────────────────────────────┘
wmic computersystem get name,manufacturer /format:hform > %odl%\%ComputerName%_MBoardOutput.html

:: ---------- Examples Find Files changed today: ---------- : use: LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'
:: 1) SELECT CreationTime As ToDay , ... FROM C:\$Data WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) ORDER BY ToDay DESC
:: 2) SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS Today,
:: 3) SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time), 3600)) AS Today,
:: 4) SELECT date, QUANTIZE(time, 3600) AS hour,
:: 5) SUB(SYSTEM_DATE(), TIMESTAMP('2', 'd')) AS Today
:: 6) EXTRACT_EXTENSION(Name) AS Ext, EXTRACT_FILENAME(Name) AS FNam
:: 7) SELECT SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd hh:mm:ss') ) AS LastDay
:: Get Top x new Files FROM OneDrive -OR- what ever Root Folder you want to look at
:: Most recently modified Files - Extremely Useful query....
SET Root=%UserProfile%
LogParser -i:FS -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-19 "SELECT TOP 1000 Path, Name, Size, CreationTime FROM %Root%\*.* ORDER BY CreationTime DESC"
LogParser -i:FS -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 "SELECT TOP 20 Path, LastWriteTime FROM %Root%\*.* ORDER BY LastWriteTime DESC"
:: Below returns nothing... becaue: Access is denied. --  WHERE ToDay LIKE '%2022%'
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, Size, CreationTime As ToDay FROM 'C:\$Data' WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) ORDER BY ToDay DESC"
:: Chart the File Size
::Select Top 100 largest Files on the C: drive
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -E:-19 "SELECT TOP 100 Path, Name, Size, Attributes FROM 'C:\*.*' ORDER BY Path, Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 * FROM %Root%\*.* ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -e:5 "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,FileVersion FROM "%Root%\**.xml*" ORDER BY CreationTime DESC"
::	echo Fix Access Denied: & SubInACL /subdirectories=directoriesonly %WinDir% grant=%USERDOMAIN%\%Username%=Access
::	echo Fix Access Denied: & SubInACL /subdirectories=Filesonly %WinDir% grant=%USERDOMAIN%\%Username%=Access
SET out=%ohtm%\%ComputerName%_LargeFiles.csv
LogParser -i:FS -rtp:-1 -o:datagrid -q:on -stats:On -Recurse:-1 "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,FileVersion INTO %out% FROM %Root%\*.* ORDER BY Size DESC" | Notepad++ %out%
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT ContentPath, [Days (Old)], FileName, [Creation Date Time] USING creationtime AS [Creation Date Time], TO_DATE([Creation Date Time]) AS Cdate, SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()), Cdate) AS Days, DIV(TO_INT(Days),86400) As [Days (Old)], EXTRACT_PATH(TO_LOWERCASE(path)) AS ContentPath, TO_LOWERCASE(name) AS FileName FROM %source% WHERE (attributes NOT LIKE 'D%') AND ([Days (Old)] >= TO_INT('%day%')) ORDER BY [Creation Date Time] DESC"
Run above query rfom LogParser sql query file...:
SET sql="%OneDrive%\Log Parser 2.2\Queries\FindOneDriveFilesOlderThanX.sql"&echo LogParser Query file: %sql%
LogParser -i:FS -rtp:-1 -o:datagrid -q:on -stats:On -Recurse:-1 -preserveLastAccTime file:%sql%?source="%OneDrive%\*.*"+day="180"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +--------------------------------------------------------------------+
:: | -i:FS Analyze Files and Folders changed today or some time         ¦
:: +--------------------------------------------------------------------+
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Files Changed Today (LastAccessTime): %OneDrive%\*.*&
LogParser -i:FS -Recurse:-1 -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-FilesChangedToday.tpl" "SELECT CreationTime,LastWriteTime,LastAccessTime, Path, Name, Size, Attributes INTO '%ohtm%\%ComputerName%_FilesChangedToday-Report.html' FROM %OneDrive%\*.* WHERE Attributes NOT LIKE 'D%' AND TO_DATE(LastAccessTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) OR TO_DATE(LastWriteTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) OR TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) ORDER BY LastWriteTime DESC"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_FilesChangedToday-Report.html"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET Root=%UserProfile% & echo Find Files Changed Last 1 Hour/s today in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM "%Root%\*.*" WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Files Changed Today (LastAccessTime): %OneDrive%\*.*&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT CreationTime,LastWriteTime,LastAccessTime, Path, Name, Size, Attributes FROM %OneDrive%\*.* WHERE Attributes NOT LIKE 'D%'AND TO_DATE(LastAccessTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) OR TO_DATE(LastWriteTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) OR TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) ORDER BY LastWriteTime DESC"
:: Need to exclude Folders or Directories...  WHERE Attributes NOT LIKE 'D%' AND Size >= 1     AND Size NOT LIKE '%0%' Error: WHERE clause: Semantic Error: LIKE left operand ("Size") is not a STRING
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET Root=E:\$Music&echo Files Changed Today (LastAccessTime): '%Root%'&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT CreationTime,LastWriteTime,LastAccessTime, Path, Name, Size, Attributes FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) OR TO_DATE(LastAccessTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY CreationTime DESC"
:: echo Files Changed Today (LastAccessTime): '%Root%'&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT CreationTime,LastWriteTime,LastAccessTime, Path, Name, Size, Attributes FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY CreationTime DESC"
:: Count File Extensions, (File types) Size and Number of Files
SET "Root=E:\WindowsImageBackup"
echo Count Files in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as ExtCntrs FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%'GROUP BY Extension ORDER BY ExtCntrs DESC"
:: Count Music Files Changed Today
echo Files Changed Today (LastAccessTime): %OneDrive%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT CreationTime,LastWriteTime,LastAccessTime, Path, Name, Size, Attributes FROM %OneDrive%\*.* WHERE Attributes NOT LIKE 'D%' AND TO_DATE(LastAccessTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY LastAccessTime DESC"
::echo List all Files in %OneDrive% Changed Today&ForFiles /D +%date:~-10,2%/%date:~-7,2%/%date:~-4% /S /P %OneDrive% /M *.* /C "cmd /c echo echo @fdate @ftime 0x09@fsize 0x09@path"
echo List all Files in %OneDrive% Changed Today&ForFiles /D +%date:~-10,2%/%date:~-7,2%/%date:~-4% /S /P %OneDrive% /M *.* /C "cmd /c echo @fdate @ftime 0x09@path"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo List All Folders Changed today&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT DISTINCT Path, CreationTime As ToDay FROM "E:\$Music\*.*" WHERE Attributes LIKE 'D%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Path NOT LIKE '%\.%' ORDER BY Path,ToDay DESC"
:: +-------- List all Files Changed Today to Terminal ---------------------------------------------
echo List All Files Changed Today in OneDrive&SET today=%date:~-4%-%date:~-10,2%-%date:~-7,2% &&LogParser -recurse:0 -i:FS -o:NAT -rtp:-1 "SELECT Path,Name,Size,LastAccessTime FROM %OneDrive%\*.* where LastAccessTime<=TO_LOCALTIME(TIMESTAMP('%today%', 'yyyy-MM-dd')) ORDER BY LastAccessTime"
:: Error: Syntax Error: <value>: Invalid TIMESTAMP year digit '%'
ffmod=echo ALL Files Added or Modified Today: %OneDrive%\*.*&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT CreationTime,LastWriteTime,LastAccessTime, Path, Name, Size, Attributes FROM '%OneDrive%\*.*' WHERE Attributes NOT LIKE 'D%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND TO_DATE(LastWriteTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND TO_DATE(LastAccessTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY LastWriteTime DESC"
:: AND Size NOT LIKE '%0%'   WHERE Attributes NOT LIKE 'D%'   0000-01-01 00:00:00   0000-01-01 24:00:00 -- date >= SUB(SYSTEM_DATE(), DURATION('14', 'd'))

echo List All W3C IIS Log Files Changed Today&SET today=%date:~-4%-%date:~-10,2%-%date:~-7,2%&LogParser -recurse:0 -i:FS -rtp:-1 -o:datagrid "SELECT Path,Name,Size,LastAccessTime FROM %IISLogs%\*.log where LastAccessTime<=TO_LOCALTIME(TIMESTAMP('%today%', 'yyyy-MM-dd')) ORDER BY LastAccessTime"
:: echo List All W3C IIS Log Files Changed Today&SET today=%date:~-4%-%date:~-10,2%-%date:~-7,2% & echo %today%&LogParser -i:FS -stats:On -q:on -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,LastAccessTime FROM '%IISLogs%\*.log' where LastAccessTime<=TO_LOCALTIME(TIMESTAMP('%today%', 'yyyy-MM-dd')) ORDER BY LastAccessTime"
:: echo Files Changed Today&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime, LastWriteTime As ToDay, Path, Name, Size, Attributes FROM C:\$Data\*.* WHERE attributes not like 'D%' AND LastWriteTime<=TO_LOCALTIME(TIMESTAMP('%date:~-4%-%date:~-10,2%-%date:~-7,2%', 'yyyy-MM-dd')) ORDER BY ToDay DESC"
echo List All Files Changed Today in $Data&SET today=%date:~-4%-%date:~-10,2%-%date:~-7,2%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,LastAccessTime FROM C:\$Data\*.* where LastAccessTime<=TO_LOCALTIME(TIMESTAMP('%today%', 'yyyy-MM-dd')) ORDER BY LastAccessTime"
echo List All Files Changed Today in OneDrive&SET today=%date:~-4%-%date:~-10,2%-%date:~-7,2%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,LastAccessTime FROM %OneDrive%\*.* where LastAccessTime<=TO_LOCALTIME(TIMESTAMP('%today%', 'yyyy-MM-dd')) ORDER BY LastAccessTime"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
# - - - - - - Check what Files changed today  /D %date:~-10,2%/%date:~-7,2%/%date:~-4%
SET Root=E:\$Music
SET csv="%ohtm%\%ComputerName%_MusicFilesChangedPast30D.txt"
SET myFiles=*.mp3
SET hdr=%ohtm%\%ComputerName%_ForFilesFiles.hdr
echo fdate,ftime,fSize,path >%hdr%
START "AllMP3Files" /D "%odl%" /I /Min /High /Wait ForFiles /D -30 /S /P "%Root%" /M %myFiles% /C "cmd /c echo Changed Today: 0x09 @fdate 0x09 @ftime 0x09 @fSize 0x09 @path" >%csv%&Notepad++ %csv%
:: -1 S/b Yesterday!! ForFiles /P %OneDrive% /M *.* /D -1 /S /C "cmd /c echo @path 0x3b@fsize 0x3b@fdate 0x3b0x22@ftime0x22"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET Root=%OneDrive% & echo Find Files Changed x Time ago in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, LastWriteTime As Date, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM "%Root%\*.*" WHERE TO_DATE(LastWriteTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Path LIKE '%%invoice%' OR Path LIKE '%order%' OR Path LIKE '%license%' AND Ext LIKE '%pdf%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Date,Pat DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET Root=C:\GoPro   F:\DCIM
SET Root=%OneDrive% & echo Find Files Changed 1 Day Ago in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime,LastWriteTime,LastAccessTime, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes, HASHMD5_FILE(Path) AS Hash FROM %Root%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=100 ORDER BY Ext,CreationTime DESC"
::  AND Path LIKE '%%invoice%' OR Path LIKE '%order%' OR Path LIKE '%license%' AND Ext LIKE '%pdf%'
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Find Files changed today in 3 Wats: CreationTime,LastAccessTime,LastWriteTime
SET Root=%OneDrive%
echo Files Changed Today (CreationTime): %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime,LastWriteTime,LastAccessTime, Path, Name, Size, Attributes FROM %Root%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY CreationTime DESC"
echo Files Changed Today (LastAccessTime): %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime,LastWriteTime,LastAccessTime, Path, Name, Size, Attributes FROM %Root%\*.* WHERE Attributes NOT LIKE 'D%' AND TO_DATE(LastAccessTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY LastAccessTime DESC"
echo Files Changed Today (LastWriteTime): %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime,LastWriteTime,LastAccessTime, Path, Name, Size, Attributes FROM %Root%\*.* WHERE Attributes NOT LIKE 'D%' AND TO_DATE(LastWriteTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY LastWriteTime DESC"

echo Files Changed Last 2Days: %USERPROFILE%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, LastWriteTime, Path, Name, Size, Attributes FROM %USERPROFILE%\*.xml WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay DESC"
:: Count Files in folder AND ExtCntrs >=2
echo Count Files in folder %data%\Images&LogParser -i:FS -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as ExtCntrs FROM 'C:\$Data\*.*' WHERE Attributes NOT LIKE 'D%'GROUP BY Extension ORDER BY ExtCntrs DESC"
echo Count Files in folder %data%\Images&LogParser -i:FS -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as ExtCntrs FROM '%data%\Images\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY ExtCntrs DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
 +-------------------------------------------------------+
 ¦ -i:FS Get Folder Files changed today or past x hours  ¦
 +-------------------------------------------------------+
:: Below get All Files created today.
## PS: (Get-ChildItem -File | Where-Object {$_.CreationTime -gt (Get-Date).Date} | Measure-Object).Count
:: Check date format YYDDMM -OR- YYMMDD - '%%date:~-4%-%date:~-10,2%-%date:~-7,2%%'"
echo LogParser Get All Files created today LastWriteTime ('yyyy-mm-dd HH:mm:ss') format today: %date:~-4%-%date:~-7,2%-%date:~-10,2%
SET Root=%LOCALAPPDATA%&LogParser -i:FS -Recurse:-1 -RTP:-1 -O:DATAGRID -Q:OFF -E:-1 "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime AS ToDay FROM %Root% WHERE TO_STRING(ToDay,'yyyy-mm-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'"
:: Below get All Files created past 1 hour - below needs some work!
SET Root=%LOCALAPPDATA% & echo Find Files Changed Last 1Hr in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM "%Root%\*.*" WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"
:: Path LIKE '%Pinnacle%'AND

echo Find All Folders Changed today: %Root%%&LogParser -i:FS -rtp:-1 -o:datagrid -stats:On -q:off -Recurse:-1 -E:-1 "SELECT DISTINCT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Attributes LIKE 'D%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Path NOT LIKE '%\.%' ORDER BY Path ASC"
SET Root=%LOCALAPPDATA%&SET usr=%USERDOMAIN%\%USERNAME%
echo Fix Access Issues&ICACLS %Root% /INHERITANCE:e /GRANT:r %usr%:(F) /T /C >NUL
echo Fix Access Issues&SubInACL /file '%Root%' /grant=%usr%&SubInACL /subdirectories "%Root%\*.lnk" /grant=%usr%

SET Root=%LOCALAPPDATA% & echo Find Files Changed Last 1Hr in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Path LIKE '%Pinnacle%'AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"
SET Root=%LOCALAPPDATA% & echo Find Files Specific Changed Last 2Hr in folder %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT Path, EXTRACT_PATH(Path) AS Pat, EXTRACT_EXTENSION(Name) AS Ext, CreationTime As ToDay, Name, Size, HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Path LIKE '%Pinnacle_Studio%' AND Ext LIKE '%%iso%'AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 02:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=4096 ORDER BY ToDay DESC"
::
SET Root=%UserProfile%ars\AppData\Local\Amazon Music\Data\Offline\Amazon Music\cd
SET Root=E:\$Music
SET Root=%AllUSERSPROFILE%
SET Root=%USERPROFILE%\APPDATA&echo Prosessing folder: %Root%
SET Root=%USERPROFILE%\APPDATA\Local\Packages&echo Prosessing Downloaded MS Apps folder: %Root%
echo Find file Every Changed today in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash  FROM '%Root%\*.*' WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
# PowerShell Compare Files Modified Date and Creation Dates
# Get File item
$file1 = Get-ChildItem -Path $ENV:OneDrive\*.txt
# Get the Specific date
$date1 = (Get-Date).AddDays(-10)
# Compare file modified date with Specific date
$file1.LastWriteTime -gt $date1
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo List [String] in File Name %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, LastWriteTime, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes, HASHMD5_FILE(Path) AS Hash FROM %Root%\*.* WHERE Ext LIKE '%work%'"

echo Find Changed Files today&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime As ToDay, LastWriteTime, Path, Name, Size, Attributes FROM %Root%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay DESC"
:: echo List All MP3 Files %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, LastWriteTime, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes FROM %Root%\*.* WHERE Ext LIKE '%mp3%' AND Hash IS NOT NULL ORDER BY Hash DESC"
:: echo List All MP3 Files Changed Today: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes FROM %Root%\*.* WHERE Name LIKE '%mp3%' OR Name LIKE '%wma%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY Hash DESC"

echo List All File Extensions %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) AS Files FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
echo List All Files Changed Today: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes FROM %Root%\*.* WHERE Ext LIKE '%mp3%' OR Ext LIKE '%wma%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY Hash DESC"
:: Below Test...
echo List All Files Changed Today: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:0 "SELECT CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes FROM %Root%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY Hash DESC"
echo List All Files Changed Today: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:0 "SELECT CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, Attributes FROM %Root%\*.* WHERE Ext LIKE '%mp3%' AND Ext LIKE '%wma%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY Hash DESC"
echo List All Files Changed Today: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size FROM %Root%\*.* WHERE Ext = mp3 OR Ext = wav ORDER BY ToDay DESC"
echo List All Files Changed Today: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Path, Name, EXTRACT_EXTENSION(Name) AS Ext, Size FROM %Root%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND WHERE Ext IN ("mp3";"wav";"log") ORDER BY ToDay DESC"
,%Root%\*.log LIKE ('%mp3%';'%wav%';'%log%')"  AND WHERE Ext LIKE '%mp3%' WHERE Ext IN (mp3;wav;log) ORDER BY ToDay DESC"
echo Files Changed Last 2Days: %USERPROFILE%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT CreationTime As ToDay, LastWriteTime, Path, Name, Size, Attributes FROM %USERPROFILE%\*.xml WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay DESC"
echo Files Changed Today: %OneDrive%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT CreationTime As ToDay, LastWriteTime, Path, Name, Size, Attributes FROM %OneDrive%\*.* WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
 +-------------------------------------------------------+
 ¦ -i:FS Get Folder info changed today or past x days    ¦
 +-------------------------------------------------------+
LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT Path, EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Attributes FROM "%UserProfile%\*.*" WHERE Path LIKE '%\Log Parser Lizard\Sample%' ORDER BY Pat DESC"

SET Root=E:\$Music&echo Find Folders Changed Last 1 day in %Root% &
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, HASHMD5_FILE(Path) AS Hash, Attributes FROM "%OneDrive%\*.*" WHERE Path LIKE '%Data%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay,Pat DESC"

:: Below examples work and return data ---------------------------------------------
LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT Path, EXTRACT_PATH(Path) AS Pat, CreationTime As CTime, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM "%UserProfile%\*.*" WHERE Pat LIKE '%.T520%' ORDER BY CTime,Pat DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM "%OneDrive%\*.*" WHERE Path LIKE '%Data%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"

LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM "%OneDrive%\*.*" WHERE Path LIKE '%Data%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC"

LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as Files FROM %OneDrive%\*.* WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"

echo List All Folder paths in Root Directory
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay FROM %OneDrive%\*.* WHERE Attributes LIKE 'D%' ORDER BY ToDay,Path DESC"

LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Attributes,,CreationTime As ToDay,,LastAccessTime,LastWriteTime FROM %OneDrive%\*.* WHERE Attributes LIKE 'D%' ORDER BY LastWriteTime,Path DESC"

LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Attributes,CreationTime As ToDay,LastAccessTime,LastWriteTime FROM %OneDrive%\*.* WHERE Attributes LIKE 'D%' ORDER BY ToDay,Path DESC"

Below Work but return 0 results --------------------------------------
:: Remove:  AND Attributes NOT LIKE 'D%' to make below work!
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash, TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension FROM %OneDrive%\*.* WHERE Attributes LIKE 'D%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay,Path DESC"

echo List All Folder paths in Root Directory List last 7 days
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Attributes, LastAccessTime, LastWriteTime FROM %OneDrive%\*.* WHERE Attributes LIKE 'D%' AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss'))) ORDER BY ToDay,Pat DESC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
SET W3SVC1=C:\inetpub\logs\LogFiles\W3SVC1
SELECT sc-status As Status,sc-substatus AS SubStatus,COUNT(sc-substatus) As SubStatusCount,CASE sc-substatus
WHEN 1 THEN 'Site Not Found'
WHEN 2 THEN 'ISAPI or CGI restriction'
WHEN 3 THEN 'MIME type restriction'
WHEN 4 THEN 'No handler configured'
WHEN 9 THEN 'File attribute hidden'
WHEN 16 THEN 'DAV request sent to the static file handler'
WHEN 17 THEN ' Dynamic content mapped to the static file handler via a wildcard MIME mapping'
WHEN 20 THEN ' Too Many URL Segments'
--5-19 below are Request Filtering
WHEN 5 THEN 'URL Sequence Denied'
WHEN 6 THEN 'Verb Denied'
WHEN 7 THEN 'File extension denied'
WHEN 8 THEN 'Hidden Namespace'
WHEN 10 THEN 'Request Header Too Long'
WHEN 11 THEN 'URL Double Escaped'
WHEN 12 THEN 'URL Has High Bit Chars'
WHEN 13 THEN 'Content Length Too Large'
WHEN 14 THEN 'URL Too Long'
WHEN 15 THEN 'Query String Too Long'
WHEN 18 THEN 'Query String Sequence Denied'
WHEN 19 THEN 'Denied by Filtering Rule'
END AS SubStatusDescription
FROM #W3SVC1# WHERE sc-status = 404 GROUP BY Status , SubStatus ORDER BY Status
C:\inetpub\logs\LogFiles\W3SVC1
#W3SVC1#
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:IISODBC  (IIS ODBC Log Format)                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  ClientHost (S)  Username (S)       LogTime (T)         Service (S)
  Machine (S)     ServerIP (S)       ProcessingTime (I)  BytesRecvd (I)
  BytesSent (I)   ServiceStatus (I)  Win32Status (I)     Operation (S)
  Target (S)      Parameters (S)
:: LogParser -i:IISODBC ---------------------------------------------------------------------------
:: No Examples Yet
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:BIN 	 (IIS Centralized Binary Log Format)                          │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  LogFilename (S) RecordNumber (I)    ComputerName (S)    SiteID (I)
  DateTime (T)    ClientIpAddress (S) ServerIpAddress (S) ServerPort (I)
  Method (S)      ProtocolVersion (S) ProtocolStatus (I)  SubStatus (I)
  TimeTaken (I)   BytesSent (I)       BytesReceived (I)   Win32Status (I)
  UriStem (S)     UriQuery (S)        UserName (S)
:: LogParser -i:BIN -------------------------------------------------------------------------------
:: No Examples Yet
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:IISMSID  (Microsoft IIS Log Format with MSID Filter fields)        │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  LogFilename (S) LogRow (I)          UserIP (S)          UserName (S)
  Date (T)        Time (T)            ServiceInstance (S) HostName (S)
  ServerIP (S)    TimeTaken (I)       BytesSent (I)       BytesReceived (I)
  StatusCode (I)  Win32StatusCode (I) RequestType (S)     Target (S)
  UserAgent (S)   Referrer (S)        GUID (S)            PassportID (S)
  PartnerID (S)   Parameters (S)
:: LogParser -i:IISMSID ---------------------------------------------------------------------------
:: No Examples Yet
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:HTTPERR  (HTTPError Log Format)                                    │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  LogFilename (S)      LogRow (I)       date (T)          time (T)
  s-computername (S)   c-ip (S)         c-port (I)        s-ip (S)
  s-port (I)           cs-version (S)   cs-method (S)     cs-uri (S)
  cs(User-Agent) (S)   cs(Cookie) (S)   cs(Referer) (S)   cs-host (S)
  sc-status (I)        sc-bytes (I)     cs-bytes (I)      time-taken (I)
  s-siteid (I)         s-reason (S)     s-queuename (S)
:: LogParser -i:HTTPERR ---------------------------------------------------------------------------
:: No Examples Yet
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:URLSCAN  (URLScan Log Format)                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  LogFilename (S)      LogRow (I)            Date (T)      ClientIP (S)
  Comment (S)          SiteInstance (I)      Url (S)
:: LogParser -i:URLSCAN ---------------------------------------------------------------------------
:: No Examples Yet
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌────────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:CSV (CSV Format) Parses text Files containing comma-separated values  │
└────────────────────────────────────────────────────────────────────────────────────────┘
Fields: Field names and types are retrieved at runtime FROM the specified input file(s)
:: LogParser -i:CSV -------------------------------------------------------------------------------
LogParser -i:CSV -rtp:-1 -o:datagrid -dQuotes:ON -iHeaderFile:%OneDrive%\MSExcel\ContactsHeader.csv -fixedFields:OFF -nFields:-1 -dtLines:10id "SELECT * FROM %OneDrive%\MSExcel\Contacts-29Jul2021.CSV WHERE "Last Name" LIKE '%maars%' ORDER BY Date ASC"

:: +------------------------------------------------------------------+
:: |    LogParser csv Files
:: | ref: https://documentation.help/Log-Parser/CSVI_Parameters.htm - https://documentation.help/Log-Parser/CSVI_Fields.htm
:: | When parsing CSV Files that do not contain a header line, the fields of the input records produced by the CSV input format are named "Field1", "Field2", ...
:: | When the "fixedFields" parameter is SET to "ON", this parameter specifies the number of fields in the input CSV data.
:: +------------------------------------------------------------------+
:: Processing .csv Files:
:: LogParser -headerRow:OFF -fixedFields:OFF -nFields:-1 -dtLines:5 -rtp:-1 -o:datagrid -i:CSV "SELECT * FROM %OneDrive%\MSExcel\Citi\WFChecking-pma-16Jul2021.csv"
:: Below is good but does not sort on Date...
LogParser -i:CSV -rtp:-1 -o:datagrid -headerRow:OFF -fixedFields:OFF -nFields:-1 -dtLines:10 "SELECT Field1 AS Action, Field2 AS Date, Field3 AS In, Field4 AS Out, Field5 AS Cost, Field6 AS Info FROM %OneDrive%\MSExcel\Citi\Citi-CC_895_DAA.csv WHERE Out LIKE '%MCDONALD%'"
LogParser -i:CSV -rtp:-1 -o:datagrid -headerRow:OFF -fixedFields:OFF -nFields:-1 -dtLines:10 "SELECT Field1 AS Action, Field2 AS Date, Field3 AS In, Field4 AS Out, Field5 AS Info FROM %OneDrive%\MSExcel\Citi\Citi-CC_895_DAA.csv WHERE Out LIKE '%Spotify%'
LogParser -i:CSV -rtp:-1 -o:datagrid -headerRow:OFF -fixedFields:OFF -nFields:-1 -dtLines:5 "SELECT Field1 AS Date, Field2 AS Amount, Field3 AS x, Field4 AS y, Field5 AS Details FROM %OneDrive%\MSExcel\Citi\WFChecking-pma-16Jul2021.csv WHERE Details LIKE '%%interest%' ORDER BY Date ASC"
LogParser -i:CSV -dQuotes:ON -iHeaderFile:%OneDrive%\MSExcel\ContactsHeader.csv -fixedFields:OFF -nFields:-1 -dtLines:10 -rtp:-1 -o:datagrid "SELECT * FROM %OneDrive%\MSExcel\Contacts-29Jul2021.CSV WHERE "Last Name" LIKE '%maars%' ORDER BY Date ASC"
::------------------------------------------------------------------------------------------------------------------
:: Cost Of Gas History last 25 Years, - Data from MSAccess
:: Need to format Price as n,nn.nnn - TO_STRING(1234567.89, '###,###.00') TO_STRING(PricePerGal, '$###,###.00') - TO_INT(PricePerGal) results whole number
:: TO_STRING(TO_REAL(PricePerGal), '$###,###.00')
LogParser -i:CSV -rtp:-1 -o:datagrid -headerRow:On -fixedFields:OFF -nFields:-1 -dtLines:10 "SELECT Date, PricePerGal FROM %OneDrive%\Temp\PriceOfGas-02May2024.csv ORDER BY Date"
:: LogParser -i:CSV -rtp:-1 -o:datagrid -headerRow:On -fixedFields:OFF -nFields:-1 -dtLines:10 "SELECT Date, TO_STRING(TO_REAL(PricePerGal), '$###,###.00')  FROM %OneDrive%\Temp\PriceOfGas-02May2024.csv ORDER BY Date"  Error: SELECT clause: When used with a non-TIMESTAMP argument, function TO_STRING takes 1 argument
:: Error: SELECT clause: When used with a non-TIMESTAMP argument, function TO_STRING takes 1 argument
:: Using LogParser's TO_REAL Function: Instead of using TO_INT, which is for converting to integers, we can use TO_REAL to convert the numeric string to a real (floating-point) number. '###,###.000' for three decimal places AND '###,###' for no decimal places
:: EXTRACT_TOKEN(Amount, 1, '$') AS [MonetaryValue]   OR   TO_REAL(EXTRACT_TOKEN(Amount, 1, '$')) AS [ConvertedValue]

LogParser -i:CSV -o:CHART -groupSize:720X576 -chartType:Line -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName%  Cost Of Gas History" -view:ON "SELECT Date, TO_INT(PricePerGal) INTO '%ohtm%\%ComputerName%_GasPrices.gif' FROM %OneDrive%\Temp\PriceOfGas-02May2024.csv ORDER BY Date"
LogParser -i:CSV -stats:on -headerRow:On -fixedFields:OFF -nFields:-1 -dtLines:10 -q:off -E:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName%  Cost Of Gas History" "SELECT Date, TO_INT(PricePerGal) INTO '%ohtm%\%ComputerName%_GasPrices.gif' FROM '%OneDrive%\Temp\PriceOfGas-02May2024.csv' ORDER BY Date"
:: Column PricePerGal is not an INTEGER nor a REAL
:: TO_INT(TRIM(PricePerGal)) argument of function TRIM must be a STRING
:: Unexpected internal error calling chart object method ExportPicture:
::------------------------------------------------------------------------------------------------------------------
:: Get a list of All Registry Values with value Like xxx... -o:CSV   INTO "%odl%\IISW3C-Avg.csv"
echo Get All Norton Reg Entries Into CSV&LogParser -i:REG -o:CSV -stats:On "SELECT COMPUTER_NAME() as ThisMchine, Path, ValueName, Value INTO '%ohtm%\%ComputerName%_NortonReg.csv' FROM \HKEY_CLASSES_ROOT\, \HKEY_CURRENT_USER\, \HKEY_LOCAL_MACHINE\, \HKEY_USERS\, \HKEY_CURRENT_CONFIG\ WHERE Path Like '%Norton%' OR ValueName Like '%Norton%' OR Value Like '%Norton%' "
echo Get All Norton Reg Entries&LogParser -i:REG -rtp:-1 -o:datagrid -stats:On "SELECT COMPUTER_NAME() as ThisMchine, Path, ValueName, Value FROM \HKEY_CLASSES_ROOT\, \HKEY_CURRENT_USER\, \HKEY_LOCAL_MACHINE\, \HKEY_USERS\, \HKEY_CURRENT_CONFIG\ WHERE Path Like '%Norton%' OR ValueName Like '%Norton%' OR Value Like '%Norton%' "
::------------------------------------------------------------------------------------------------------------------
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -e:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM '\HKCU\Software\Microsoft\' WHERE Path Like '%VisualStudio%' AND KeyName Like '%Xml%' OR KeyName Like '%Config%' OR KeyName Like '%Max%' ORDER BY ValueName ASC"
::------------------------------------------------------------------------------------------------------------------
:: Create a csv output file of All Security events
LogParser -i:EVT -rtp:-1 -o:CSV -headers:ON "SELECT * INTO %odl%\Security.csv FROM 'c:\windows\System32\winevt\logs\Security.evtx'"
LogParser -o:CSV -q:ON "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Application WHERE TimeGenerated > '2021-06-01 00:00:00' AND EventType IN (1;2) AND Message LIKE '%ApplicationName%' ORDER BY TimeGenerated DESC" >>"%odl%\Events.csv" & Notepad++ "%odl%\Events.csv"
::-i:Other-----------------------------------------------------------------------------------------------------------------
:: +------------------------------------------------------------------+
:: | Using -iTsFormat parameter for reformatting Date stamps
:: | By default, LogParser expects dates to be formatted with the yyyy-MM-dd hh:mm:ss format.
:: |  We can change this expectation setting the :
:: | -iTsFormat parameter to the format of the TIMESTAMP fields contained in the file:
:: |  LogParser file: –h -i:CSV Test_000001.csv –iTsFormat:"MM/dd/yyyy hh:mm:ss.ll"
:: +------------------------------------------------------------------+
LogParser -i:COM -iProgID:MyCompany.MyComPlugin -iCOMParams:TargetMachine=localhost,ExtendedFields=on "SELECT * INTO Report.csv FROM MyFROMEntity"
LogParser -i:CSV -iTsFormat:"MM/dd/yyyy hh:mm:ss.ll" "SELECT QUANTIZE(DateTime, 1) AS Second, SUM(FrameBytes) INTO DATAGRID FROM myCapture.cap GROUP BY Second"
LogParser -i:CSV -iTsFormat:"MM/dd/yyyy hh:mm:ss.ll" "SELECT QUANTIZE([(PDH-CSV 4.0) (Pacific Daylight Time)(420)], 60) AS Minute, AVG([\\GAB1\Processor(_Total)\% Processor Time]) AS AVGProcessor FROM PerfMon_000001.csv GROUP BY Minute"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:CSV "SELECT Date, Open, High, Low FROM https://ichart.finance.yahoo.com/table.csv?s=SPY&d=1&e=1&f=2020"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
-headerRow:OFF -iHeaderFile:"C:\My Folder\header.csv" -fixedFields:OFF -nFields:3 -dtLines:50 -iDQuotes:Ignore -nSkipLines:5 -iTsFormat:"MMM dd, yyyy"
 -nFields:-1 --> e.g. "fixedFields" parameter SET to "ON", this would yield three fields ("Name", "City", and "AreaCode"). Other fields would show header "NULL"
 -fixedFields:OFF and -dtLines:4 would yield >=4 fields

%AMZN% %RCI%  %MCDONALD%
:: Display total network traffic bytes per second:
:: Different Data: cleared,06/21/2021,,"SPECTRUM 855-707-7328 MO",,28.00,,XXXXXXXXXXXX0895,93
:: Outlook Calendar Export to CSV: -iHeaderFile:"%OneDrive%\MSExcel\ContactsHeader.csv"
echo Find Outlook VBA *VbaProject*.otm file&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, CreationTime As Date, HASHMD5_FILE(Path) AS Hash FROM C:\$Data\*VbaProject*.* ORDER BY Size DESC"
copy /V /Y "%OneDrive%\MSOutlook\VbaProject-12Nov2018.OTM" "%appdata%\Microsoft\Outlook\VbaProject.OTM"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::------------------------------------------------------------------------------------------------------------------
:: ------------------------------------------------------------------------------------------------
:: Create Convert Hex FROM Text, create csv file with header and next line words to convert to hex
:: e.g.: ValueName,Value -   Alt+',SomeWords
::NOTE: For Regedit need to remove 0x and 00
:: ------------------------------------------------------------------------------------------------
::------------------------------------------------------------------------------------------------------------------
echo Display Private Keys&LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT COMPUTER_NAME() as ThisMchine, Path, ValueName, Value, STRLEN(Value) as StrLen, TO_HEX(Value) as ToHexValue, HEX_TO_ASC(Value) as HexToAsc, HEX_TO_PRINT(Value) as HexToPrt FROM \HKEY_CURRENT_USER\Software\PrivateKey ORDER BY Value ASC"
echo Pull data FROM Reg&LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT ValueName, Value, TO_HEX(Value) as Hex FROM \HKEY_CURRENT_USER\Software\PrivateKey"
echo Pull data FROM Reg&LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT ValueName, Value, TO_HEX(Value) as Hex FROM \HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\FileHistory"
:: Read a csv file Input ASCII and Output is Hex. Convert the HEX_TO_ASC - notepad++ %odl%\LPHexTest.csv
echo One Header Col&LogParser -i:CSV -rtp:-1 -o:datagrid -headerRow:ON -fixedFields:OFF -nFields:-1 "SELECT Value AS Val, TO_HEX(Val) as Hex, HEX_TO_HEX8(Hex) as RegEdit FROM %odl%\LPHexTest.csv"
echo Multi Headers Cols&LogParser -i:CSV -rtp:-1 -o:datagrid -headerRow:ON -fixedFields:OFF -nFields:-1 "SELECT ValueName, Value AS Val, TO_HEX(Val) as Hex, HEX_TO_HEX8(Hex) as RegEdit FROM %odl%\LPHexTest.csv"
echo Test 1 col&LogParser -i:CSV -rtp:-1 -o:datagrid -headerRow:ON -fixedFields:OFF -nFields:-1 "SELECT ValueName, Value AS Val, TO_HEX(Val) as Hex, HEX_TO_ASC(Hex) as Asc, HEX_TO_HEX8(Hex) as Hex8, HEX_TO_HEX16(Hex) as Hex16, HEX_TO_HEX32(Hex) as Hex32, HEX_TO_INT(Hex) as Int, HEX_TO_PRINT(Hex) as Print, HASHSEQ(Hex) as HashSeq FROM %odl%\LPHexTest.csv"

:: Average Processor Usage per Minute. Parse a PerfMon CSV log file and calculate the average processor usage per minute:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT QUANTIZE([(PDH-CSV 4.0) (Pacific Daylight Time)(420)], 60) AS Minute, AVG([\\GAB1\Processor(_Total)\% Processor Time]) AS AVGProcessor FROM PerfMon_000001.csv GROUP BY Minute" -i:CSV -iTsFormat:"MM/dd/yyyy hh:mm:ss.ll"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT QUANTIZE(DateTime, 1) AS Second, SUM(FrameBytes) INTO DATAGRID FROM myCapture.cap GROUP BY Second"

echo Convert String Chracter to Hex&echo Pull data FROM Reg&LogParser -i:TEXTLINE -o:datagrid -stats:on -q:off -rtp:-1 -iCodepage:0 -splitLongLines:ON "SELECT Index, Text, TO_HEX(Text) as Hex FROM %OneDrive%\Batch\ToHex.txt"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌────────────────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:TSV (TSV Format) Parses text Files containing tab- or space- separated values │
└────────────────────────────────────────────────────────────────────────────────────────────────┘
Fields: LogParser -h -i:TSV myfile.tsv -headerRow:on
 Field names and types are retrieved at runtime FROM the specified input file(s)
:: LogParser -i:TSV -------------------------------------------------------------------------------
::	List the fields extracted FROM a CSV file:
LogParser -h -i:CSV myfile.csv -headerRow:on
::	List the fields extracted FROM a TSV file: -iSeparator:space
::01...+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+....1....+....1....+....2....+...|
:: Below is actual static layout:
::Name                       Version Size  Modified                Name                       Version Size  Modified
LogParser -i:TSV -iSeparator:"|"
echo Name Version Size Modified Name Version Size Modified>"%odl%\BCHDR.hdr"
echo Name                       Version Size  Modified                Name                       Version Size  Modified>"%odl%\BCHDR.hdr"
IF EXIST %odl%\BCHDR.hdr (Echo File: %odl%\BCHDR.hdr Found) ELSE File %odl%\BCHDR.hdr Not Found.
Dir /S /B %odl%\*_BC*.tsv
NotePad++ C:\$Data\OneDrive\Logs\SURF5_BCMirror$DataC2D_$Data.tsv
:: Test LogParser -i:TSV -rtp:-1 -o:datagrid -iSeparator:space -fixedSep:off -nSkipLines:2 "SELECT SUBSTR(text, 0, 10) AS Date, SUBSTR(text, 11, 8) AS Time, SUBSTR(text, 25, 12) AS Size, SUBSTR(text, 39, 999) AS SongName FROM STDIN"
:: Needs work LogParser -i:TSV -rtp:-1 -o:datagrid -iSeparator:space -fixedSep:OFF -stats:On -nSkipLines:7 -headerRow:On -iHeaderFile:"%odl%\BCHDR.hdr" -nSep:2 -iw:On -E:-1 "SELECT SUBSTR(Name, 0, 27) AS Name1, SUBSTR(Version, 26, 8) AS Version1, SUBSTR(Size, 35, 6) AS Size1, SUBSTR(Modified, 41, 24) AS Modified1, SUBSTR(Name, 65, 27) AS Name2, SUBSTR(Version, 93, 8) AS Version2, SUBSTR(Size, 100, 6) AS Size2, SUBSTR(Modified, 106, 24) AS Modified2 FROM '%odl%\*_BC*.tsv' WHERE Size IS NOT NULL ORDER BY Size"
LogParser -i:TSV -iSeparator:space -nSep:2 -fixedSep:OFF -nSep:1 -iHeaderFile:"%odl%\BCHDR.hdr" -stats:On -headerRow:On -iw:On -nSkipLines:7 -rtp:-1 -o:datagrid -E:-1 "SELECT Name,Version,Size,Modified,Name,Version,Size,Modified FROM '%odl%\*_BC*.tsv' WHERE Size IS NOT NULL ORDER BY Size"
:: Example to modify \ Text to ASCII CHARACTER TABULATION, horizontal tabulation (HT) and tab &Tab; using tsv
:: LogParser -i:TEXTLINE -q:on "SELECT replace_str(replace_str(text,'\"',''),'\u0009',',') from <FileName>.txt"
::--------------------------------------------------------------------------------------------------
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EXTRACT_SUFFIX(client-name,0,'=') as User FROM *.log" -nSkipLines:4 -i:CSV
::--------------------------------------------------------------------------------------------------
:: .tsv Files can be read using LogParser -h -i:TSV 			(TSV Format) Parses text Files containing tab- or space- separated values
:: LogParser -h -i:TSV "%ohtm%\%ComputerName%_BCRestoreC2E_SysInternalsSuite.tsv" -headerRow:on
:: LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM https://myusername:mypassword@www.margiestravel.com/MyUrl" -i:TSV
:: LogParser -i:TSV -iSeparator:space -nFields:8 -fixedSep:OFF -nSep:1 -iHeaderFile:%OneDrive%\BCBackups\BCHDR.hdr -stats:On -headerRow:On -iw:On -nSkipLines:7 -iTsFormat:"MMM/dd/yyyy hh:mm:ss" -o:datagrid -E:-1 "SELECT Name,Version,Size,Modified,Name,Version,Size,Modified FROM %ohtm%\%ComputerName%_BCRestoreC2E_SysInternalsSuite.tsv WHERE Size IS NOT NULL ORDER BY Size"
::
:: Attempting to split space seperated values into correct columns. The issue is the FileNames have spaces and that throws off the Columns...
:: LogParser -i:TSV -iSeparator:space -nFields:8 -fixedSep:OFF -nSep:1 -iHeaderFile:%odl%\BCHDR.hdr -stats:On -headerRow:On -iw:On -nSkipLines:7 -iTsFormat:"MMM/dd/yyyy hh:mm:ss" -lineFilter:"-Name -" -o:datagrid -E:-1 "SELECT Name,Version,Size,Modified,Name,Version,Size,Modified FROM %ohtm%\%ComputerName%_BCRestoreC2E_SysInternalsSuite.tsv WHERE Size IS NOT NULL ORDER BY Size"
:: LogParser -i:TSV -iSeparator:spaces -nFields:8 -fixedSep:OFF -nSep:2 -iHeaderFile:%odl%\BCHDR.hdr -stats:On -headerRow:On -iw:On -nSkipLines:7 -iTsFormat:"MMM/dd/yyyy hh:mm:ss" -o:datagrid -E:-1 "SELECT * FROM %ohtm%\%ComputerName%_BCRestoreC2E_SysInternalsSuite.tsv"
:: LogParser -i:TSV -iSeparator:spaces -fixedSep:Off -nSep:2 -iHeaderFile:%odl%\BCHDR.hdr -stats:On -headerRow:On -iw:On -nSkipLines:7 -iTsFormat:"MMM/dd/yyyy hh:mm:ss" -o:datagrid -E:-1 "SELECT * FROM %ohtm%\%ComputerName%_BCRestoreC2E_SysInternalsSuite.tsv"
::
:: -iHeaderFile:%odl%\BCHDR.hdr = Name Version Size Modified Name Version Size Modified [4/17/2022 4:58:33 AM]   OR SIZE >=1
:: SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('00:30:00', 'hh:mm:ss') ) AS Last30m    	-iTsFormat:"MMM/dd/yyyy hh:mm:ss" -lineFilter:"+Version 0-9, +Size 0-9" -lineFilter:"-Version 0-9,-Size 0-9"
::  Name,Version,Size,Modified,Name,Version,Size,Modified WHERE Size IS NOT NULL ORDER BY Size
::--------------------------------------------------------------------------------------------------
:: Read data produced by Beyond CompareLogParser -i:TSV -o:datagrid -stats:On -headerRow:On -iw:On -nSkipLines:7 "SELECT top 15 * FROM %odl%\T520_BCMirrorC2F_$Data.tsv"
LogParser -i:TSV -iSeparator:spaces -fixedSep:Off -nSep:1 -iHeaderFile:%OneDrive%\BCBackups\BCHDR.hdr -stats:On -headerRow:On -iw:On -nSkipLines:7 -iTsFormat:"MMM/dd/yyyy hh:mm:ss" -o:datagrid -E:-1 "SELECT * FROM %odl%\T520_BCMirrorC2F_$Data.tsv"
LogParser -i:TSV -iSeparator:spaces -fixedSep:Off -nSep:2 -iHeaderFile:%OneDrive%\BCBackups\BCHDR.hdr -stats:On -headerRow:On -iw:On -nSkipLines:7 -fixedSep:ON -nFields:8 -iTsFormat:"MMM/dd/yyyy hh:mm:ss" -o:datagrid -E:-1 "SELECT * FROM %odl%\T520_BCMirrorC2F_$Data.tsv"
LogParser -i:TSV -iSeparator:space -fixedSep:Off -nSep:2 -iHeaderFile:%OneDrive%\BCBackups\BCHDR.hdr -stats:On -iw:On -nSkipLines:9 -nFields:8 -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM %odl%\T520_BCMirrorC2F_$Data.tsv"
::_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────────────────────┐
│     Example using NetStat | LogParser -i:TSV and FROM STDIN       │
│         NOTE: NetStat can take awhile to complete                 │
└───────────────────────────────────────────────────────────────────┘
LogParser -h -i:TSV /// -iSeparator:space -nSep:2 -fixedSep:OFF -nSkipLines:2 - AccessMask, AllowMaximum, Description, InstallDate, MaximumAllowed, Name, Path, Status, Type
EXTRACT_TOKEN(Strings,  0, '|') AS User,
WMIC share list | LogParser -stats:On -q:ON -i:TSV -headerRow:ON -nSep:2 -fixedSep:ON -nSkipLines:0 -rtp:-1 -o:datagrid "SELECT * FROM STDIN"
WMIC share list | LogParser -i:TSV -headerRow:On -rtp:-1 -o:datagrid -q:ON "SELECT * FROM STDIN"
-headerRow:OFF -iHeaderFile:"C:\My Folder\header.csv" -fixedFields:OFF -nFields:3 -dtLines:50 -iDQuotes:Ignore
WMIC logicaldisk list brief | LogParser -q:ON -i:TSV -rtp:-1 -o:datagrid "SELECT [DeviceID],[DriveType],[FreeSpace],[ProviderName],[Size],[VolumeName] FROM STDIN"
-iHeaderFile:"%OneDrive%\Data\WMIC_Logicaldisk.hdr"
:: -nFields:6 Field1 AS DeviceID, Field2 AS DriveType, Field3 AS FreeSpace, Field4 AS ProviderName, Field5 AS Size, Field6 AS VolumeName
WMIC logicaldisk list brief | LogParser -q:ON -i:TSV -headerRow:Off -rtp:-1 -o:datagrid "SELECT * FROM STDIN"
WMIC logicaldisk list brief | LogParser -q:ON -i:TSV -headerRow:Off -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT Field1 FROM STDIN"
:: C:        3          1879066603520                1999481335808   X570_C
:: D:        3          582600859648                 2000396742656   X5702Tb_D
:: E:        3          3046954409984                12000119746560  X57012Tb_E
:: F:        3          388105277440                 1000068505600   Samsung1Tb
:: G:        3          23588372480                  128032178176    X570120Gb
:: H:        2          27032711168                  128317657088    Samsung128Gb
WMIC logicaldisk list brief | LogParser -q:ON -i:TSV -headerRow:Off -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT SUBSTR(Field1,0,8) AS DeviceID, SUBSTR(Field1,10,9) AS DriveType, SUBSTR(Field1,21,14) AS FreeSpace, SUBSTR(Field1,36,12) AS ProviderName, SUBSTR(Field1,50,15) AS Size, SUBSTR(Field1,65,15) AS VolumeName FROM STDIN"
:: To-DO:  Using good command below, Calculate The total SUM of all FreeSpace and Size in GB, Subtract FreeSpace from Size to get Space Available..
WMIC logicaldisk list brief | LogParser -q:ON -i:TSV -headerRow:Off -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT SUBSTR(Field1,0,8) AS DeviceID, SUBSTR(Field1,21,14) AS FreeSpace, SUBSTR(Field1,50,15) AS Size, SUBSTR(Field1,65,15) AS VolumeName FROM STDIN"

WMIC MEMORYCHIP list brief | LogParser -q:ON -i:TSV -headerRow:Off -rtp:-1 -o:datagrid "SELECT * FROM STDIN"
WMIC MEMPHYSICAL list brief | LogParser -q:ON -i:TSV -headerRow:Off -rtp:-1 -o:datagrid "SELECT * FROM STDIN"
WMIC MEMPHYSICAL list  | LogParser -q:ON -i:TSV -headerRow:Off -rtp:-1 -o:datagrid "SELECT * FROM STDIN"
WMIC process where "name='system' or name='svchost.exe' or name='lsass.exe' or name='explorer.exe'" get name, workingsetsize
:: See: C:\$Data\OneDrive\Scripts\VBA\Ch09WMIQuery	- WMIC /node:"MyServer" /namespace:"\\root\cimv2" path Win32_Process get Name, ProcessId
WMIC /node:"%ComputerName%" /namespace:"\\root\cimv2" path Win32_Process get Name, ProcessId | LogParser -q:ON -i:TSV -headerRow:Off -rtp:-1 -o:datagrid "SELECT * FROM STDIN"
:: Output example:
Name                                      ProcessId
System Idle Process                       0
System                                    4
Registry                                  204
::
TASKLIST /SVC /fi "memusage gt 50000" | LogParser -i:TSV -headerRow:OFF -nSkipLines:2 -rtp:-1 -o:datagrid -q:Off "SELECT SUBSTR(Field1,0,25) AS ImageName, SUBSTR(Field1,25,8) AS PID, SUBSTR(Field1,35,44) AS Services FROM STDIN WHERE PID NOT LIKE '%==%' ORDER BY PID,ImageName"
:: Example Output:
Image Name                     PID Services
========================= ======== ============================================
dwm.exe                       2164 N/A
:: –i:FS –o:NAT –rtp:20 –rAlign:ON - using logparser How do I align a text field that needs to be converted to number to align on the right
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: To-DO:  Using good command below, Calculate The total SUM of all FreeSpace and Size in GB, Subtract FreeSpace from Size to get Space Available..
echo GoodWMIC logicaldisk list brief | LogParser -q:ON -i:TSV -headerRow:Off -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT SUBSTR(Field1,0,8) AS DeviceID, SUBSTR(Field1,21,14) AS FreeSpace, SUBSTR(Field1,50,15) AS Size, SUBSTR(Field1,65,15) AS VolumeName FROM STDIN"
echo Good&WMIC logicaldisk list brief | LogParser -q:ON -i:TSV -headerRow:Off -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT TO_INT(TRIM(SUBSTR(Field1,21,14))) AS FreeSpace, TO_INT(TRIM(SUBSTR(Field1,50,15))) AS Size FROM STDIN Where FreeSpace IS NOT NULL"
echo Good&WMIC logicaldisk list brief | LogParser -q:ON -i:TSV -headerRow:Off -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT SUBSTR(Field1,21,14) AS FreeSpace, SUBSTR(Field1,50,15) AS Size FROM STDIN"
This is my Data:    TO_INT(TRIM(NumberOfLogons))
1879056875520 	1999481335808
582600859648  	2000396742656
3046954409984 	12000119746560
388105277440  	1000068505600
23588372480   	128032178176
27032711168   	128317657088
echo Good&WMIC logicaldisk list brief | LogParser -q:ON -i:TSV -headerRow:Off -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT SUBSTR(Field1,21,14) AS FreeSpace, SUBSTR(Field1,50,15) AS Size, DIV(TO_INT(Sum(Size)),1048576) AS Size(Mb) FROM STDIN"
:: WMIC logicaldisk list brief | LogParser -q:ON -i:TSV -headerRow:Off -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT DIV(TO_INT(SUM(SUBSTR(Field1,21,14))),1048576) AS FreeSpace(Mb), DIV(TO_INT(Sum(SUBSTR(Field1,50,15))),1048576) AS Size(Mb) FROM STDIN"
:: Error: SELECT clause: Semantic Error: argument of SUM/AVG/PROPSUM function is not an INTEGER nor a REAL: DIV(TO_INT(SUM(SUBSTR(Field1,21,14))),1048576) AS FreeSpace(Mb)
:: Need to Trim Leading and trailing spaces from Field1 SubString...
:: DIV(TO_INT(SUM(EXTRACT_TOKEN(SUBSTR(Field1,21,14), 0, ' '))),1048576) AS FreeSpace(Mb), DIV(TO_INT(SUM(EXTRACT_TOKEN(SUBSTR(Field1,50,15), 0, ' '))),1048576) AS Size(Mb)
:: WMIC logicaldisk list brief | LogParser -q:ON -i:TSV -headerRow:Off -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT DIV(TO_INT(SUM(EXTRACT_TOKEN(SUBSTR(Field1,21,14), 0, ' '))),1048576) AS FreeSpace(Mb), DIV(TO_INT(SUM(EXTRACT_TOKEN(SUBSTR(Field1,50,15), 0, ' '))),1048576) AS Size(Mb) FROM STDIN"
:: Error: SELECT clause: Semantic Error: argument of SUM/AVG/PROPSUM function is not an INTEGER nor a REAL
:: The TO_INT function in LogParser does not work with the SUM function in the way we expected. The SUM function requires its argument to be an integer or real number, but the SUBSTR function returns a string, and TO_INT cannot convert this string to a number within the SUM function.
:: Using LogParser only, How do I capture The only The numerical data and not The spaces because The data is variable length and not fixed as I have it currently coded. hdo change The LogParser to only capture the intiger between start 21 and end 35 as well as start 50 and end 65
::WMIC logicaldisk list brief | LogParser -q:ON -i:TSV -headerRow:Off -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT DIV(TO_INT(TRIM(SUM(EXTRACT_TOKEN(SUBSTR(Field1,21,14), 0, ' ')))),1048576) AS FreeSpace(Mb), DIV(TO_INT(TRIM(SUM(EXTRACT_TOKEN(SUBSTR(Field1,50,15), 0, ' ')))),1048576) AS Size(Mb) FROM STDIN"
:: Error: SELECT clause: Semantic Error: argument of SUM/AVG/PROPSUM function is not an INTEGER nor a REAL
:: 1048576(Mb) 1073741824 (Gb)
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Using <Command> to pull data FROM command line - Parse the output of a "NetStat" command:
NetStat | LogParser -i:TSV -iSeparator:space -nSep:2 -fixedSep:off -nSkipLines:3 -rtp:-1 -o:datagrid "SELECT * FROM STDIN"
NetStat -a | LogParser -i:TSV -iSeparator:space -nSep:2 -fixedSep:off -nSkipLines:3 "SELECT * FROM STDIN"
netstat -a | LogParser -i:TSV -rtp:-1 -o:datagrid -stats:On -iSeparator:space -nSep:2 -fixedSep:OFF -nSkipLines:3 "SELECT Proto,[Local Address] AS Local,[Foreign Address] AS Foreign,State FROM STDIN WHERE State LIKE '%Listening%'"
NetStat -a -o | findstr 80
NetStat -a -o -n | LogParser -i:TSV -rtp:-1 -iSeparator:space -nSep:2 -fixedSep:OFF -nSkipLines:2-o:datagrid "SELECT '10.10.10.0' FROM STDIN WHERE State = 'LISTENING'"
netsh interface ipv4 show excludedportrange protocol=tcp | LogParser -i:TSV -iSeparator:space -nSep:2 -fixedSep:off -nSkipLines:3 -rtp:-1 -o:datagrid "SELECT * FROM STDIN"
LogParser -i:TSV -rtp:-1 -o:datagrid "SELECT * FROM https://account.microsoft.com/rewards/?refd=www.bing.com"
LogParser -i:TSV -rtp:-1 -o:datagrid "SELECT * FROM https://myUsername:mypassword@www.margiestravel.com /MyUrl"
:: Using Ping command and LogParser Charts - You could use any DOS command with LogParser using this similar technique...
SET url=google.com&ping -n 15 Google.com | LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(REPLACE_STR(EXTRACT_VALUE(Text,'time',' '),'ms','')) AS Response INTO %odl%\Ping.gif FROM stdin WHERE Text LIKE '%%Reply%%' GROUP BY Response" -i textline -legend off -chartTitle "Ping Time=.ms - %url%" -view
echo Graphing Ping Results&SET url=google.com&ping -n 15 %url% | LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(REPLACE_STR(EXTRACT_VALUE(Text,'time',' '),'ms','')) AS Response INTO %odl%\Ping.gif FROM stdin WHERE Text LIKE '%Reply%' GROUP BY Response" -i textline -legend off -chartTitle "Ping Time=.ms - %url%" -view
Parse the output of a 'netstat' command:
netstat -a | LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM STDIN" -i:TSV -iSeparator:space -nSep:2 -fixedSep:off -nSkipLines:3
netstat -a | LogParser -i:TSV -rtp:-1 -o:datagrid -stats:On -iSeparator:space -nSep:2 -fixedSep:OFF -nSkipLines:3 "SELECT Proto,[Local Address] AS Local,[Foreign Address] AS Foreign,State FROM STDIN WHERE State LIKE '%Listening%'"
:: Split the IP and Port numbers: LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EXTRACT_SUFFIX(client-name,0,'=') as User FROM *.log" -nSkipLines:4 -i:CSV
netstat -a | LogParser -i:TSV -rtp:-1 -o:datagrid -stats:On -iSeparator:space -nSep:2 -fixedSep:OFF -nSkipLines:3 "SELECT Proto,[Local Address] AS Local,[Foreign Address] AS Foreign,State,EXTRACT_SUFFIX(Local,0,':') as Port FROM STDIN WHERE State LIKE '%Listening%'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Remove a program that won't uninstall
WMIC product get name
WMIC product where name="<AppName>"
:: Convert an MP4 video file to an MP3 audio file
:: https://github.com/GyanD/codexffmpeg   https://www.gyan.dev/ffmpeg/builds/ffmpeg-git-github
:: winget install ffmpeg
choco install ffmpeg-full
https://www.gyan.dev/ffmpeg/builds/packages/ffmpeg-6.0-essentials_build.7z
ffmpeg -i input.mp4 -vn output.mp3
:: Check all currently installed drivers
driverquery
:: Check any website for service or outage issues: ping www.google.com

::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Count number and of who loggedin on this computer - Two fields: Logins, Name
Wmic.exe /locale:ms_409 netlogin GET Name, NumberOfLogons | LogParser -i:tsv -iSeparator:space -nSep:2 -fixedSep:off -nFields:2 -rtp:-1 -o:datagrid "SELECT TO_INT(TRIM(NumberOfLogons)) AS Logins, Name from StdIn where Logins IS NOT NULL ORDER BY Logins DESC "
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: | LogParser -h GRAMMAR  |  LogParser -h FUNCTIONS  | LogParser -h EXAMPLES  |
ipconfig /all | find "IPv4 Address" | Sort /+39| LogParser -i:TSV -rtp:-1 -o:datagrid -stats:On -headerRow:OFF "SELECT * FROM STDIN"
 Text, EXTRACT_SUFFIX(Text,0,':') FROM STDIN WHERE Text LIKE '%Preferred%'"
LogParser -h -i:TSV -iSeparator:space -nSep:2 -fixedSep:OFF -nSkipLines:3
Col 40 Ip and Split on (Preferred)
   IPv4 Address. . . . . . . . . . . : 10.10.10.161(Preferred)
   IPv4 Address. . . . . . . . . . . : 172.20.32.1(Preferred)
   IPv4 Address. . . . . . . . . . . : 172.22.128.1(Preferred)
   IPv4 Address. . . . . . . . . . . : 172.29.80.1(Preferred)
LogParser -i:TEXTLINE  ... SUBSTR(TO_STRING(price),INDEX_OF(TO_STRING(price),'.'),3))
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET icsv=%OneDrive%\MSOutlook\Google-contacts-10Jan2022.csv
LogParser -i:TSV-o:datagrid "SELECT top 15 * FROM %icsv%"
LogParser -i:TSV-o:datagrid "SELECT top 15 'First Name','Middle Name','Last Name','E-mail Address','Home Phone','Mobile Phone' FROM %icsv%"
LogParser -i:TSV -rtp:-1 -o:datagrid "SELECT * FROM https://finance.yahoo.com/quote/NTAP?p=NTAP&.tsrc=fin-srch WHERE Text LIKE '%84.28%'"
LogParser -i:TSV -rtp:-1 -o:datagrid "SELECT * FROM https://www.google.com/finance/quote/NTAP:NASDAQ?authuser=0"
LogParser -i:TSV -rtp:-1 -o:datagrid "SELECT * FROM https://www.google.com/finance/quote/NTAP:NASDAQ?authuser=0 WHERE Text LIKE '%NetApp Inc.%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM https://www.google.com/finance/quote/NTAP:NASDAQ?authuser=0 WHERE Text LIKE '%ntap%'"
https://www.google.com/finance/quote/NTAP:NASDAQ?authuser=0
https://www.google.com/finance/quote/SMAR:NYSE?authuser=0
https://www.google.com/finance/quote/RACE:NYSE?authuser=0
Append: &window=5D  &window=1M   &window=6M   &window=YTD   &window=1Y   &window=5Y   &window=MAX
LogParser -h -i:ETW
:: NOTE: Microsoft Network Monitor (Netmon) is no longer supported or installed on your Windows 11 Professional system.
:: Use either Wireshark a powerful and widely-used network protocol analyzer. OR GlassWire a network monitoring tool that provides detailed information about your network activity and alerts you to potential threats.
:: Question: Does either wireshark or GlassWire have a netmon equivalent command to write trace data into a .cap file
:: Use WireShark: dumpcap -i <interface> -w output.cap
:: GlassWire primarily focuses on visualizing network activity and providing security alerts. It does not have a direct command-line equivalent to save trace data into a .cap file. However, you can use GlassWire's interface to monitor and analyze network traffic. For detailed packet capture and saving capabilities, Wireshark is the more suitable tool.

LogParser -h -i:NETMON -fMode:TCPIP
LogParser -h -i:NETMON -fMode:TCPConn
:: Getting Started with Log Parser's Netmon Format
:: See: Examining Network Traffic and Performance Logs with Log Parser • Chapter 4 127 ---Ch04TCPConn.sql---
:: Below input generated using Netmon connection format (-fmode:TCPConn)
logparser -fmode:TCPConn SELECT SrcIP, DstIP, DstPort, SrcPayload, DstPayload FROM FOO.cap WHERE DstPort = 80 OR SrcPort = 80 AND DstPayload like '%200%'"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:W3C 	 (Generic W3C Log Format)                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
 Field names and types are retrieved at runtime FROM the specified input file(s)
:: LogParser -i:W3C -------------------------------------------------------------------------------
::-i:W3C-----------------------------------------------------------------------------------------------------------------
:: Below: Returns bytes (as well as converted to KB and MB) received and sent, per date, for a Web site, with request date/time converted to local time.
SET IISLog=C:\inetpub\logs\LogFiles\W3SVC1\u_%IISLogs%
SET IISLogf=C:\inetpub\logs\LogFiles\W3SVC1
SET IISLogs=C:\inetpub\logs\LogFiles\W3SVC1\*.log
SET yymmdd=%date:~-2%%date:~-10,2%%date:~-7,2% & echo yymmdd %yymmdd%
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Display comon errors: -i:IISW3C
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT date, to_lowercase(cs-uri-stem) AS URI, SUM([_200]) AS [200s], SUM([_304]) AS [304s], SUM([_302]) AS [302s], SUM([_404]) AS [404s], SUM([_301]) AS [301s], SUM([_500]) AS [500s],SUM([_501]) AS [501s],SUM([_403]) AS [403s],SUM([_206]) AS [206s],SUM([_406]) AS [406s],SUM([_400]) AS [400s], sub(COUNT(*),add([200s],[206s])) AS Failures USING CASE TO_STRING(sc-status) WHEN '200' THEN 1 ELSE 0 END AS [_200], CASE TO_STRING(sc-status) WHEN '304' THEN 1 ELSE 0 END AS [_304], CASE TO_STRING(sc-status) WHEN '302' THEN 1 ELSE 0 END AS [_302], CASE TO_STRING(sc-status) WHEN '404' THEN 1 ELSE 0 END AS [_404], CASE TO_STRING(sc-status) WHEN '301' THEN 1 ELSE 0 END AS [_301], CASE TO_STRING(sc-status) WHEN '500' THEN 1 ELSE 0 END AS [_500], CASE TO_STRING(sc-status) WHEN '501' THEN 1 ELSE 0 END AS [_501], CASE TO_STRING(sc-status) WHEN '403' THEN 1 ELSE 0 END AS [_403], CASE TO_STRING(sc-status) WHEN '206' THEN 1 ELSE 0 END AS [_206], CASE TO_STRING(sc-status) WHEN '406' THEN 1 ELSE 0 END AS [_406], CASE TO_STRING(sc-status) WHEN '400' THEN 1 ELSE 0 END AS [_400] FROM '%IISLogs%\*.log' GROUP BY date, URI ORDER BY Failures DESC"

:: Below Returns a listing of browsers accessing content as a bar chart, based upon the number of requests made
LogParser -i:IISW3C -o:CHART -groupSize:1024x768 -chartType:barstacked -E:-1 "SELECT CASE strCntr(cs(User-agent),'Firefox') when 1 THEN 'Firefox' else case strCntr(cs(User-agent),'netscape') when 1 THEN 'netscape' else case strCntr(cs(User-agent),'AOL') when 1 THEN 'AOL' else case strCntr(cs(User-agent),'Opera') when 1 THEN 'Opera' else case strCntr(cs(User-agent),'Chrome') when 1 THEN 'Chrome' else case strCntr(cs(User-agent),'Mobile') when 1 THEN 'SmartPhone' else case strCntr(cs(User-agent),'Safari') when 1 THEN 'Safari' else case strCntr(cs(User-agent),'MSIE+5') when 1 THEN 'IE 5' else case strCntr(cs(User-agent),'MSIE+6') when 1 THEN 'IE 6' else case strCntr(cs(User-agent),'MSIE+7') when 1 THEN 'IE 7' else case strCntr(cs(User-agent),'MSIE+8') when 1 THEN 'IE 8' else case strCntr(cs(User-agent),'MSIE') when 1 THEN 'IE other' else case strCntr(cs(User-agent),'bot') when 1 THEN 'Bot' else case strCntr(cs(User-agent),'spider') when 1 THEN 'spider' else case strCntr(cs(User-agent),'PutHTTP') when 1 THEN 'PutHTTP' else case strCntr(cs(User-agent),'Mozilla/4.0') when 1 THEN 'Mozilla/4.0 other' ELSE 'Unknown' End End End End End End End End End End End End End End End End as Browser, COUNT(cs(User-Agent)) as Hits INTO %odl%\Browsers.jpg FROM '%IISLogs%\*.log' GROUP BY Browser ORDER BY Hits ASC"&START CHROME "%odl%\Browsers.jpg"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT cs-method, c-ip, cs(User-Agent), COUNT(*) AS [Requests] FROM '%IISLogs%\*.log' WHERE cs-method NOT IN ('GET';'POST') GROUP BY cs-method, c-ip, cs(User-Agent) ORDER BY cs-method, Requests"
::	number of hits for each day for each ASP and DLL file.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TO_STRING(TO_TIMESTAMP(date, time), 'yyyy-MM-dd') AS Day, cs-uri-stem, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status<400 or sc-status>=500) AND (TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' OR TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%') GROUP BY Day, cs-uri-stem ORDER BY cs-uri-stem, Day"

::	number of -i:W3C errors per hour.
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT date, QUANTIZE(time, 3600) AS hour, sc-status, COUNT(*) AS Errors FROM '%IISLogs%\*.log' WHERE sc-status>=400 GROUP BY date, hour, sc-status HAVING Errors>25 ORDER BY Errors DESC"
::	IP address that hit the same page more than 50 times in a single day (sc-status>=50)
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT DISTINCT date, cs-uri-stem, c-ip, COUNT(*) AS Hits FROM '%IISLogs%\*.log' GROUP BY date, c-ip, cs-uri-stem HAVING Hits>1 ORDER BY Hits Desc"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-query, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE sc-status>=1 GROUP BY cs-uri-query ORDER BY Total DESC "
::	detail of what status codes IIS returned for each page, try the following query:
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT date, cs-uri-stem, sc-status, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%' GROUP BY date, cs-uri-stem, sc-status ORDER BY cs-uri-stem, sc-status"
::	Win32 Status codes, which may be attack indicators:
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT date, cs-uri-stem, WIN32_ERROR_DESCRIPTION(sc-win32-status) as Error, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE sc-win32-status>0 and (TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%') GROUP BY date, cs-uri-stem, Error ORDER BY cs-uri-stem, Error"
::	show what HTTP methods were sent to each page:
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, cs-method, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status<400 or sc-status>=500) AND (TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%') GROUP BY cs-uri-stem, cs-method ORDER BY cs-uri-stem, cs-method"
::	report some statistics for the number of bytes sent to the client - Error: unknown field 'sc-bytes' To see valid fields for the W3C input format type: LogParser -h -i:W3C (Field names and types are retrieved at runtime FROM the specified input file(s))
::	LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, COUNT(*) as Hits, AVG(sc-bytes) AS Avg, Max(sc-bytes) AS Max, Min(sc-bytes) AS Min, Sum(sc-bytes) AS Total FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%' GROUP BY cs-uri-stem ORDER BY cs-uri-stem"
:: exploits to take an unusuAlly large amount of time or even timeout completely
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT date, cs-uri-stem, COUNT(*) as Hits, AVG(time-taken) AS Avg, Max(time-taken) AS Max, Min(time-taken) AS Min, Sum(time-taken) AS Total FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%' GROUP BY date, cs-uri-stem ORDER BY cs-uri-stem"
::	unauthenticated anonymous access
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT date, cs-Username, COUNT(*) AS Hits FROM '%IISLogs%\*.log' WHERE cs-Username IS NOT NULL GROUP BY date, cs-Username ORDER BY Hits Desc"
::	identify an attack script by looking at the HTTP User-Agent header - list of non-standard User-Agent strings
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT DISTINCT cs(User-Agent) FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs(User-Agent)) NOT LIKE '%mozilla%' AND TO_LOWERCASE(cs(User-Agent)) NOT LIKE '%opera%' ORDER BY cs(User-Agent)"
 date,    %odl%\W3SVC4\u_ex%yymmdd%.log
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT Date, REVERSEDNS(c-ip) AS Client FROM '%IISLogs%\*.log' WHERE cs-uri-stem LIKE '/storage/storagews.asmx%'"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT ObjectPath, PropertyValue FROM IIS://localhost WHERE PropertyName = 'AccessFlags'"
LogParser -i:W3C -chartType:Column3D -groupSize:1024x768 "SELECT TOP 20 cs-uri-stem, COUNT(*) AS Hits INTO"%odl%\IISW3C-Chart.gif" FROM <www.margiestravel.com> GROUP BY cs-uri-stem ORDER BY Hits DESC"
LogParser -i:W3C -chartType:PieExploded -chartTitle:"Bytes per extension" -categories:off "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS Extension, MUL(PROPSUM(sc-bytes),100.0) AS Bytes INTO Pie.gif FROM '%IISLogs%\*.log' GROUP BY Extension ORDER BY Bytes DESC"
LogParser -i:W3C -o:CHART -groupSize:1024x768 -view:ON -chartType:Line -legend:off -chartTitle:"%Date% %ComputerName% W3SVC1 Counts" "SELECT Date,COUNT(*) AS Counts INTO %ohtm%\%ComputerName%_W3SVC1-CountsByDay.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
LogParser -i:W3C -o:CHART -groupSize:1024x768 -view:ON -chartType:Line -legend:off -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% %ComputerName% W3SVC1 Counts" "SELECT Date,COUNT(*) AS Counts INTO %ohtm%\%ComputerName%_W3SVC1-CountsByDay.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
LogParser -i:W3C -o:CSV "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(Date, time),3600)) AS Hours, COUNT(*) AS Hits INTO ReqPerhour.csv FROM '%IISLogs%\*.log' GROUP BY Hours ORDER BY Hours "
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT cs-method AS Method, COUNT(*) AS Hits FROM '%IISLogs%\*.log' GROUP BY Method"
LogParser -i:W3C -rtp:-1 -o:datagrid -E:-1 "SELECT cs-uri-stem,sc-Status AS FileName FROM '%IISLogs%\*.log' WHERE sc-Status = 500"
:: Create a chart containing the TOP xx URL's in the "village.ddns.me" web site
:: Below Error: ORDER BY clause: Syntax Error: unknown field 'Hits'
IF EXIST %odl%\MyWeb.gif (DEL %odl%\MyWeb.gif)
LogParser -i:W3C -stats:On -o:CHART -groupSize:1024x768 -chartType:Column3D -groupSize:1024x768 -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% %ComputerName% W3C Counts" "SELECT TOP 20 cs-uri-stem, COUNT(*) AS Counts INTO %odl%\MyWeb.gif FROM '%IISLogs%\*.log'  GROUP BY cs-uri-stem ORDER BY Hits DESC"&START CHROME "file:\\%odl%\MyWeb.gif"

LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem AS FileName, time-taken AS Time FROM '%IISLogs%\*.log' WHERE time-taken > 1000"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT Date AS Date, QUANTIZE(time, 3600) AS Hour, sc-status AS Status, COUNT(*) AS ErrorCount FROM '%IISLogs%\*.log' WHERE  sc-status >= 400 GROUP BY Date, hour, sc-status HAVING ErrorCount > 25 ORDER BY ErrorCount DESC"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT Date,COUNT(*) AS Counts FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT DISTINCT Date AS Date, cs-uri-stem AS URL, c-ip AS IPAddress, COUNT(*) AS Hits FROM '%IISLogs%\*.log' GROUP BY Date, c-ip, cs-uri-stem HAVING Hits > 500 ORDER BY Hits Desc"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: ----------------------------------------------------------------------------------------
:: NOTE: Some of the Queries below result in various errors - Still need to be corrected...
:: ----------------------------------------------------------------------------------------
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 COUNT(*) AS Hits cs-uri-stem, cs-uri-query, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) AS Agent, cs-bytes, c-ip, FROM '%IISLogs%\*.log' GROUP BY c-ip, cs(User-Agent), cs-bytes ORDER BY Hits desc"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 COUNT(*) AS Hits cs-uri-stem, cs-uri-query, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) AS Agent, cs-bytes, c-ip,FROM '%IISLogs%\*.log' GROUP BY c-ip, cs(User-Agent), cs-bytes ORDER BY Hits desc"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 cs-uri-stem, cs-uri-query, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) AS Agent, cs-bytes, c-ip FROM '%IISLogs%\*.log' WHERE cs-uri-stem != '/search' ORDER BY LEN(cs-uri-query) desc" :: Error: Syntax Error: <term2>: '!=' is not a valid operator
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 TO_STRING(time, 'h') AS Hour, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) AS Agent, Sum(sc-bytes) AS TotalBytes, COUNT(*) AS Hits FROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent), hour ORDER BY sum(sc-bytes) desc"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 TO_STRING(time, 'h') AS Hour, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) AS Agent, Sum(sc-bytes) AS TotalBytes, COUNT(*) AS HitsFROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent), hour ORDER BY sum(sc-bytes) desc"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 100 cs-uri-stem AS Url, COUNT(cs-uri-stem) AS Hits FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY COUNT(cs-uri-stem) DESC"

LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) AS Agent, cs-uri-stem, LOWER(cs-uri-query) AS q, COUNT(*) AS Hits, SUM(sc-bytes) AS BytesSent, SUM(cs-bytes) AS BytesRecv FROM '%IISLogs%\*.log' WHERE q LIKE '%select%' OR q LIKE '%sys.tables%' OR etc... GROUP BY c-ip, cs(User-Agent) ORDER BY Hits desc"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) AS Agent, cs-uri-stem, LOWER(cs-uri-query) AS q, COUNT(*) AS Hits, SUM(sc-bytes) AS BytesSent, SUM(cs-bytes) AS BytesRecvFROM '%IISLogs%\*.log' WHERE q LIKE '%select%' OR q LIKE '%sys.tables%' OR etc... GROUP BY c-ip, cs(User-Agent) ORDER BY Hits desc"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) AS Agent, Sum(sc-bytes) AS TotalBytes, COUNT(*) AS Hits FROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent) ORDER BY TotalBytes desc"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) AS Agent, Sum(sc-bytes) AS TotalBytes, COUNT(*) AS HitsFROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent) ORDER BY TotalBytes desc"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 TO_STRING(time, 'h') AS Hour, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) AS Agent, COUNT(*) AS Hits, Sum(sc-bytes) AS TotalBytes FROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent), hour ORDER BY Hits desc"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 TO_STRING(time, 'h') AS Hour, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) AS Agent, COUNT(*) AS Hits, Sum(sc-bytes) AS TotalBytesFROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent), hour ORDER BY Hits desc"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT top 50 DISTINCT SUBSTR(TO_LOWERCASE(cs-uri-stem), 0, 55) AS Url, COUNT(*) AS Hits, AVG(sc-bytes) AS AvgBytes, SUM(sc-bytes) AS ServedBytes FROM '%IISLogs%\*.log' GROUP BY Url HAVING Hits >= 20 ORDER BY ServedBytes DESC"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT top 50 DISTINCT SUBSTR(TO_LOWERCASE(cs-uri-stem), 0, 55) AS Url, COUNT(*) AS Hits, AVG(sc-bytes) AS AvgBytes, SUM(sc-bytes) AS ServedBytesFROM '%IISLogs%\*.log' GROUP BY Url HAVING Hits >= 20 ORDER BY ServedBytes DESC"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TO_TIMESTAMP(Date,time), CASE sc-status WHEN 500 THEN
LogParser -i:W3C -view:ON -fileType:GIF -groupSize:800x600 -chartType:Area -categories:ON -values:ON -legend:OFF -config:"%OneDrive%\Log Parser 2.2\LP-ChartCounts.js" "SELECT Date, COUNT(*) AS Counts INTO %ohtm%\%ComputerName%_LP-ChartCounts.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
LogParser -i:W3C -view:ON -fileType:GIF -groupSize:800x600 -chartType:Area -categories:ON -values:ON -legend:OFF -config:"%OneDrive%\Log Parser 2.2\LP-ChartCounts.js" "SELECT Date, COUNT(*) AS Counts INTO %ohtm%\%ComputerName%_LP-ChartCounts.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Bar3D" "SELECT TOP 100 cs-uri-stem, COUNT(*) AS Hits INTO %ohtm%\%ComputerName%_ReqPages.gif FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem  ORDER BY Hits DESC"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% Bar3D" "SELECT TOP 100 cs-uri-stem, COUNT(*) AS Hits INTO %ohtm%\%ComputerName%_ReqPages.gif FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem  ORDER BY Hits DESC"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:BarClustered3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% BarClustered3D" "SELECT cs-method AS Method, COUNT(*) AS Hits INTO %ohtm%\%ComputerName%_BarClustered3D.gif FROM '%IISLogs%\*.log' GROUP BY Method"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:BarClustered3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% BarClustered3D" "SELECT cs-method AS Method, COUNT(*) AS Hits INTO %ohtm%\%ComputerName%_BarClustered3D.gif FROM '%IISLogs%\*.log' GROUP BY Method"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:BarStacked1003D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% BarStacked1003D" "SELECT Date, COUNT(*) AS Counts INTO %ohtm%\%ComputerName%_BarStacked1003D.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:BarStacked1003D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% BarStacked1003D" "SELECT Date, COUNT(*) AS Counts INTO %ohtm%\%ComputerName%_BarStacked1003D.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:BarStacked1003D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% BarStacked1003D" "SELECT Date, COUNT(*) AS Counts INTO %ohtm%\%ComputerName%_BarStacked1003D.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -config:"%OneDrive%\Log Parser 2.2\LP-3D-AreaCharts.js" "SELECT Date, COUNT(*) AS Counts INTO %odl%\LP-3D-AreaCharts.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -config:"%OneDrive%\Log Parser 2.2\LP-3D-AreaCharts.js" "SELECT Date, COUNT(*) AS Counts INTO %odl%\LP-3D-AreaCharts.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -config:"%OneDrive%\Log Parser 2.2\LP-3D-AreaCharts.js" "SELECT Date, COUNT(*) AS Counts INTO %odl%\LP-3D-AreaCharts.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Column3D" "SELECT TO_UPPERCASE(EXTRACT_EXTENSION(cs-uri-stem)) AS PageType, MIN(sc-bytes) AS Minimum, AVG(sc-bytes) AS Average, MAX(sc-bytes) AS Maximum INTO %ohtm%\%ComputerName%_Column3D-BytesChart.gif FROM '%IISLogs%\*.log'  GROUP BY PageType ORDER BY Average ASC"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% Column3D" "SELECT TO_UPPERCASE(EXTRACT_EXTENSION(cs-uri-stem)) AS PageType, MIN(sc-bytes) AS Minimum, AVG(sc-bytes) AS Average, MAX(sc-bytes) AS Maximum INTO %ohtm%\%ComputerName%_Column3D-BytesChart.gif FROM '%IISLogs%\*.log'  GROUP BY PageType ORDER BY Average ASC"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:PieExploded3d -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% PieExploded3d" "SELECT cs-method AS Method, COUNT(*) AS Hits INTO %ohtm%\%ComputerName%_PieExploded3d.gif FROM '%IISLogs%\*.log' GROUP BY Method"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:PieExploded3d -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% PieExploded3d" "SELECT cs-method AS Method, COUNT(*) AS Hits INTO %ohtm%\%ComputerName%_PieExploded3d.gif FROM '%IISLogs%\*.log' GROUP BY Method"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT sc-status, MUL(PROPCOUNT(*), 100.0), COUNT(*) FROM '%IISLogs%\*.log' WHERE "strQuery = strQuery & "SUB(TO_INT(TO_LOCALTIME(SYSTEM_TIMESTAMP()))," strQuery = strQuery & "TO_INT(TO_LOCALTIME(TO_TIMESTAMP(date,time)))) < 300" strQuery = strQuery & " AND (sc-status = 200 OR sc-status = 500) GROUP BY sc-status"
LogParser -providers:"IIS: WWWServer" -fmode:full -o:W3C -encodeDelim:ON "SELECT FileName, COUNT(*) AS Total INTO filenames.w3c FROM iistrace.etl GROUP BY FileName ORDER BY Total DESC"
LogParser -providers:myfile.guid -fmode:full "SELECT EventName, EventTypeName, TIMESTAMP, HASHSEQ(ContextId) AS Id INTO DATAGRID FROM iistrace.etl WHERE ContextId IS NOT NULL ORDER BY Id, TIMESTAMP ASC"
LogParser -rtp:-1 -i:W3C -o:w3c "SELECT c-ip, cs(User-Agent) AS [UserAgent], COUNT(*) AS [Requests], MIN(TO_DATE(TO_LOCALTIME(TO_TIMESTAMP(Date, time)))) AS FirstDate, MAX(TO_DATE(TO_LOCALTIME(TO_TIMESTAMP(Date, time)))) AS LastDate INTO %odl%\Robots.log FROM '%IISLogs%\*.log' WHERE cs-uri-stem = '/robots.txt' GROUP BY c-ip, UserAgent ORDER BY c-ip, UserAgent"&Notepad++ %odl%\Robots.log
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT FileName, COUNT(*) AS Total INTO %odl%\filenames.w3c FROM iistrace.etl GROUP BY FileName ORDER BY Total DESC" -providers:"IIS: WWW Server" -fmode:full -encodeDelim:ON
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT ObjectPath, PropertyValue FROM IIS://localhost WHERE PropertyName = 'AccessFlags'"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Bar3D" "SELECT cs(User-Agent), COUNT(*) as Cntr INTO %ohtm%\%ComputerName%_ReqPages.gif FROM %IISLogs%\u_*.log GROUP BY cs(User-Agent)"

LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Bar3D" "SELECT TOP 100 cs-uri-stem, COUNT(*) As Hits INTO %ohtm%\%ComputerName%_ReqPages.gif FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem  ORDER BY Hits DESC"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:BarClustered3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% BarClustered3D" "SELECT cs-method As Method, COUNT(*) As Hits INTO %ohtm%\%ComputerName%_BarClustered3D.gif FROM '%IISLogs%\*.log' GROUP BY Method"
LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:PieExploded3d -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% PieExploded3d" "SELECT cs-method As Method, COUNT(*) As Hits INTO %ohtm%\%ComputerName%_PieExploded3d.gif FROM '%IISLogs%\*.log' GROUP BY Method"
LogParser -i:W3C -view:ON -fileType:GIF -groupSize:800x600 -chartType:Area -categories:ON -values:ON -legend:OFF -config:"%OneDrive%\Log Parser 2.2\LP-ChartCounts.js" "SELECT Date, COUNT(*) AS Counts INTO %ohtm%\%ComputerName%_LP-ChartCounts.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"
:: --- TEST ---
SET IISLogs=%IISLogs%
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT cs-uri-stem, cs-uri-query, date, sc-status, cs(Referer) FROM '%IISLogs%\*.log' WHERE (sc-status >= 500 AND sc-status < 600) ORDER BY sc-status, date, cs-uri-stem, cs-uri-query"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT cs-Username, c-ip, COUNT(*) INTO FTPUsersLoggedIn.txt FROM '%IISLogs%\*.log' WHERE sc-status = '230' GROUP BY cs-Username, c-ip ORDER BY COUNT(*), cs-Username, c-ip"
:: Below Returns the number of times a particular page (in this case .as* Files) was hit, with the average, minimum, and maximum time taken, along with the standard deviation.
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TO_LOWERCASE(cs-uri-stem) AS csUriStem, COUNT(*) AS Hits, DIV ( MUL(1.0, SUM(time-taken)), Hits ) AS AvgTime, SQRROOT ( SUB ( DIV ( MUL(1.0, SUM(SQR(time-taken)) ), Hits ) , SQR(AvgTime) ) ) AS StDev, Max(time-taken) AS Max, Min(time-taken) AS Min, TO_REAL(STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus)))) AS Status, Min(TO_LOCALTIME(date)) AS LastUpdate INTO TimeTaken.csv FROM '%IISLogs%\*.log' WHERE cs-uri-stem LIKE '%.as%' GROUP BY TO_LOWERCASE(cs-uri-stem), TO_REAL(STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus)))) HAVING COUNT(*) > 2"
:: Error while parsing field sc-status: Value is not a relative integer
:: Below Returns a listing of requests by hour, across All days, by converting the hour to a string.
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On "SELECT TO_STRING(time, 'hh') AS [Hour], COUNT(*) AS [Requests], MUL(PROPCOUNT(*), 100) AS [PercentOfTotal] INTO %odl%\HourlyReport.txt FROM '%IISLogs%\*.log' GROUP BY [Hour] ORDER BY [Hour]"
&notepad++ %odl%\HourlyReport.txt
:: Error: invalid parameter "providers" ( -providers:myfile.guid)
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventName, EventTypeName, TIMESTAMP, HASHSEQ(ContextId) AS Id INTO DATAGRID FROM iistrace.etl WHERE ContextId IS NOT NULL ORDER BY Id, TIMESTAMP ASC" -providers:myfile.guid -fmode:full
::calculate how many requests have been served for each page type
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS PageType, COUNT(*) FROM '%IISLogs%\*.log' GROUP BY PageType"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS PageType, sc-status, COUNT(*) FROM '%IISLogs%\*.log' GROUP BY PageType, sc-status" Error while parsing field sc-status: Value is not a relative integer
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS PageType, COUNT(*) AS PageTypeHits FROM '%IISLogs%\*.log'  GROUP BY PageType ORDER BY PageTypeHits DESC"
LogParser -i:W3C -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT SUBSTR(TO_UPPERCASE(cs-uri-stem), 0, 5), COUNT(*), SUM(sc-bytes) FROM '%IISLogs%\*.log' GROUP BY SUBSTR(TO_UPPERCASE(cs-uri-stem), 0, 5)" To see valid fields for the W3C input format type: LogParser -h -i:W3C
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:XML 	 (XML Format)                                                 │
└─────────────────────────────────────────────────────────────────────────────────────┘
:: LogParser -i:XML--------------------------------------------------------------------------------
-xslLink refers to an Extensible Style Language document, which is an XML-based style sheet similar to CSS.
Command Line Switches for XML-Formatted Output - See PAGE 315 Toolkit
:: Open PDF: "C:\$Data\Desktop\Tools\LogParserV2.2-Toolkit.pdf"
:: Open Ch10CreateXMLOutput.sql
    +-------------------------------+------------------------------------------------------------------------
    | Option                        | Definition
    +-------------------------------+------------------------------------------------------------------------
    | -structure 1|2|3|4            | Type of XML structure [default value=1]
    | -rootName <rootname>          | Name of the ROOT element [default value=ROOT]
    | -rowName <rowname>            | Name of the ROW element [default value=ROW]
    | -fieldName <fieldname>        | Name of the FIELD element [default value=FIELD]
    | -xslLink <xsl_document_path>  | Path of an XSL document to be referenced in the output [default value=NONE]
    | -schemaType 0|1               | Type of schema to be written inline (0=none, 1=DTD) [default value=1]
    | -compact ON|OFF               | Suppress spaces and carriage returns in output [default value=OFF]
    | -noEmptyField ON|OFF          | Suppress empty tags for NULL field values [default value=OFF]
    | -standAlone ON|OFF            | When OFF, does not write any <XML> header nor <ROOT> tags (generates an invalid XML document) [default value=ON]
    | -fileMode 0|1|2               | Action to perform when the file already exists: 0=append, 1=overwrite, 2=ignore [default value=1]
    | -oCodepage <codepage_ID>      | File codepage (special values: 0=system codepage, -1=UNICODE) [defaultvalue=-1]
    +-------------------------------+------------------------------------------------------------------------
Ch10CreateXMLOutput.sql illustrates how an IIS log is formatted when transformed
::-------------------------------------------------------------------------------------------------
Formatting Options for Template Output
    +-------------------------------+------------------------------------------------------------------------
    | Option                        |  Definition
    +-------------------------------+------------------------------------------------------------------------
    | -tpl <template file path>     | Path of the template file [default value=<noneset>]
    | -tplHeader <header file path> | Path of the header file [default value=<none set>]
    | -tplFooter <footer file path> | Path of the footer file [default value=<none set>]
    | -noEmptyFile ON|OFF           | When no row is generated, do not write a file [default value=ON]
    | -fileMode 0|1|2               | Action to perform when the file already exists: 0=append, 1=overwrite, 2=ignore [default value=1]
    | -oCodepage <codepage_ID>      | File codepage (special values: 0=system codepage, - 1=UNICODE) [default value=0]
    +-------------------------------+------------------------------------------------------------------------
 ---Ch10CreateTemplateOutput.sql--
::-------------------------------------------------------------------------------------------------
 Fields: -fMode:Tree -o:tpl -TPL:mytemplate.tpl
 Field names and types are retrieved at runtime FROM the specified input file(s)
::-------------------------------------------------------------------------------------------------
<NOTE: Header results differ slightly FROM log to log...>
(1) creator name InstallPath creationDate originalPath statisticsRefreshInterval scanSpeed lowPriority enableExclusions scanAdware scanSpyware scanApplications scanDialers scanKeyloggers scanFiles scanAllFiles scanProgramsOnly useCustomPrograms customPrograms scanUserDefined scanPacked scanArchives useSmartScan scaneMails scanRootkits scanAllRootkits scanBoot scanMemory scanRegistry quickScan scanCookies shutdownAfter passwordPrompt onlyAllowedActions deepArchiveScan maxArchiveLevel maxArchiveSize infectedAction1 infectedAction2 suspectAction1 suspectAction2 rootkitAction UserDefinedExtensions scanPua computeSha256Hash computeMd5Hash disableIndexer enableCertReport paranoidAction path totalSignatures scannedArchives scannedPacked startTime  duration UserDefinedExtensions2 type scanned infected suspicious disinfected deleted moved moved_reboot delete_reboot renamed hidden type2 objectType path2 threatType threatName action AllActions initialStatus finalStatus failReason itemHash chainHash family rtvrType itemMd5Hash chainMd5Hash Filesize certIssuer certSubject certSerial certTIMESTAMP skipped ioerrors archiveBombs passwordProtected type3 objectType2 path3 threatType2 threatName2 action2 AllActions2 initialStatus2 finalStatus2 failReason2

(2) creator name InstallPath creationDate originalPath statisticsRefreshInterval scanSpeed lowPriority enableExclusions scanAdware scanSpyware scanApplications scanDialers scanKeyloggers scanFiles scanAllFiles scanProgramsOnly useCustomPrograms customPrograms scanUserDefined scanPacked scanArchives useSmartScan scaneMails scanRootkits scanAllRootkits scanBoot scanMemory scanRegistry quickScan scanCookies shutdownAfter passwordPrompt onlyAllowedActions deepArchiveScan maxArchiveLevel maxArchiveSize infectedAction1 infectedAction2 suspectAction1 suspectAction2 rootkitAction UserDefinedExtensions scanPua computeSha256Hash computeMd5Hash disableIndexer enableCertReport paranoidAction path totalSignatures scannedArchives scannedPacked startTime duration UserDefinedExtensions2 type scanned infected suspicious disinfected deleted moved moved_reboot delete_reboot renamed hidden skipped ioerrors archiveBombs passwordProtected
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│  Create One Gigantic LogParser Help File          │
└───────────────────────────────────────────────────┘
:: Using For Loop to go through all Grammer, Functions and Examples to create the Help File...
setlocal enabledelayedexpansion
SET "LPin=%OneDrive%\Batch\TEST-LPForLoop.inp"
IF EXIST "%LPin%" (echo GOOD: File Found: "%LPin%") ELSE echo BAD: File not found: "%LPin%"
SET "LPHelp=%OneDrive%\Batch\LogParser-Comprehensive-Help.txt"
IF EXIST "%LPHelp%" (echo Deleting File: "%LPHelp%"&&DEL /F /S /Q "%LPHelp%"&&echo File Deleted: RC=%ErrorLevel%) ELSE echo Good: File not found: "%LPHelp%"
:: Read each line from the fields.txt file
::FOR /F "eol=; tokens=1,2* delims=, " %i IN ("%LPin%") DO (echo LogParser -h %i %j)
echo Processing Input File: "%LPin%"
::TYPE "%LPin%"
for /f "eol=; tokens=1-2* delims=; " %i in (%LPin%) do (
 echo %Date% !Time! [MSG] Processing: LogParser -h %i %j
 echo %Date% %Time% ============================== LogParser -h %i %j ============================== >>%LPHelp%
 Start "Contig" /D "%OneDrive%\" /High /WAIT /B LogParser -h %i %j >>%LPHelp%
)
NotePad++ %LPHelp%

endlocal
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Created a test Batch file: TEST-LPForLoop.cmd

:: Clean up the temporary file
del temp.txt
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _


FOR /D %i IN (
"GRAMMAR"
"FUNCTIONS"
"FUNCTION ADD"
"FUNCTION BIT_AND"
"FUNCTION BIT_NOT"
"FUNCTION BIT_OR"
"FUNCTION BIT_SHL"
"FUNCTION BIT_SHR"
"FUNCTION BIT_XOR"
"FUNCTION CASE"
"FUNCTION COALESCE"
"FUNCTION COMPUTER_NAME"
"FUNCTION DIV"
"FUNCTION EXP"
"FUNCTION EXP10"
"FUNCTION EXTRACT_EXTENSION"
"FUNCTION EXTRACT_FILENAME"
"FUNCTION EXTRACT_PATH"
"FUNCTION EXTRACT_PREFIX"
"FUNCTION EXTRACT_SUFFIX"
"FUNCTION EXTRACT_TOKEN"
"FUNCTION EXTRACT_VALUE"
"FUNCTION FLOOR"
"FUNCTION HASHMD5_FILE"
"FUNCTION HASHSEQ"
"FUNCTION HEX_TO_ASC"
"FUNCTION HEX_TO_HEX16"
"FUNCTION HEX_TO_HEX32"
"FUNCTION HEX_TO_HEX8"
"FUNCTION HEX_TO_INT"
"FUNCTION HEX_TO_PRINT"
"FUNCTION IN_ROW_NUMBER"
"FUNCTION INDEX_OF"
"FUNCTION INT_TO_IPV4"
"FUNCTION IPV4_TO_INT"
"FUNCTION LAST_INDEX_OF"
"FUNCTION LOG"
"FUNCTION LOG10"
"FUNCTION LTRIM"
"FUNCTION MOD"
"FUNCTION MUL"
"FUNCTION OUT_ROW_NUMBER"
"FUNCTION QNTFLOOR_TO_DIGIT"
"FUNCTION QNTROUND_TO_DIGIT"
"FUNCTION QUANTIZE"
"FUNCTION REPLACE_CHR"
"FUNCTION REPLACE_IF_NOT_NULL"
"FUNCTION REPLACE_STR"
"FUNCTION RESOLVE_SID"
"FUNCTION REVERSEDNS"
"FUNCTION ROT13"
"FUNCTION ROUND"
"FUNCTION RTRIM"
"FUNCTION SEQUENCE"
"FUNCTION SQR"
"FUNCTION SQRROOT"
"FUNCTION STRCAT"
"FUNCTION STRCNT"
"FUNCTION STRLEN"
"FUNCTION STRREPEAT"
"FUNCTION STRREV"
"FUNCTION SUB"
"FUNCTION SUBSTR"
"FUNCTION SYSTEM_DATE"
"FUNCTION SYSTEM_TIME"
"FUNCTION SYSTEM_TIMESTAMP"
"FUNCTION SYSTEM_UTCOFFSET"
"FUNCTION TO_DATE"
"FUNCTION TO_HEX"
"FUNCTION TO_INT"
"FUNCTION TO_LOCALTIME"
"FUNCTION TO_LOWERCASE"
"FUNCTION TO_REAL"
"FUNCTION TO_STRING"
"FUNCTION TO_TIME"
"FUNCTION TO_TIMESTAMP"
"FUNCTION TO_UPPERCASE"
"FUNCTION TO_UTCTIME"
"FUNCTION TRIM"
"FUNCTION URLESCAPE"
"FUNCTION URLUNESCAPE"
"FUNCTION WIN32_ERROR_DESCRIPTION"
"EXAMPLES"
"-i:ADS"
"-i:BIN"
"-i:COM
"-i:CSV"
"-i:ETW"
"-i:EVT"
"-i:FS"
"-i:HTTPERR"
"-i:IIS"
"-i:IISMSID"
"-i:IISODBC"
"-i:IISW3C"
"-i:NCSA"
"-i:NETMON"
"-i:REG"
"-i:TEXTLINE"
"-i:TEXTWORD"
"-i:TSV"
"-i:URLSCAN"
"-i:W3C"
"-i:XML"
) DO (
 echo %Date% !Time! [MSG] Processing: LogParser -h %i
 echo %Date% %Time% ============================== LogParser -h %i ============================== >>%LPHelp%
 Start "Contig" /D "%OneDrive%\" /High /WAIT /B LogParser -h %i >>%LPHelp%
)
NotePad++ %LPHelp%
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

:: |  LogParser -h -i:ADS 			 (Active Directory)
:: |  LogParser -h -i:BIN 			 (IIS Centralized Binary Log Format)
:: |  LogParser -h -i:COM 			 (Custom COM Input Format)
:: |  LogParser -h -i:CSV 			 (CSV Format) Parses text Files containing comma-separated values
:: |  LogParser -h -i:ETW 			 (Event Tracing for Windows) FROM myFile.etl
:: |  LogParser -h -i:EVT 			 (Windows Event Log)
:: |  LogParser -h -i:FS             (Filesystem properties) convert Bytes to Mb - DIV(size,1048576) AS Size(Mb)
:: |  LogParser -h -i:HTTPERR 		 (HTTPError Log Format) Parses HTTP Error log Files in: Dir %SystemRoot%\System32\LogFiles\HTTPERR
:: |  LogParser -h -i:IIS 			 (Microsoft IIS Log Format)     FROM '%IISLogs%\*.log'
:: |  LogParser -h -i:IISMSID 		 (Microsoft IIS Log Format with MSID Filter fields)
:: |  LogParser -h -i:IISODBC 		 (IIS ODBC Log Format)
:: |  LogParser -h -i:IISW3C         (IIS W3C Extended Log Format)  FROM '%IISLogs%\*.log'
:: |  LogParser -h -i:NCSA 			 (NCSA Common Log Format) Parses NCSA Common, Combined, and Extended Log Format log Files
:: |  LogParser -h -i:NETMON 		 (NetMon capture Files)
:: |  LogParser -h -i:REG 			 (Registry properties)
:: |  LogParser -h -i:TEXTLINE 		 (TextLine Format)
:: |  LogParser -h -i:TEXTWORD 		 (TextWord Format)
:: |  LogParser -h -i:TSV            (TSV Format) Parses text Files containing tab- or space- separated values - myfile.tsv -headerRow:on
:: |  LogParser -h -i:URLSCAN 		 (URLScan Log Format)
:: |  LogParser -h -i:W3C 			 (Generic W3C Log Format)
:: |  LogParser -h -i:XML 			 (XML Format)
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│  Extract data from .xml Files using -i:XML        │
└───────────────────────────────────────────────────┘
::-------------- .xml for Wi-Fi - List the fields below -i:XML ------------------------------------
:: Below are some LogParser .xml help
SET fstr=Findstr /I /C:"Recurse"&echo %Date% !Time! [MSG] %fstr%
SET fstr=Find "Recurse"&echo %Date% !Time! [MSG] %fstr%
LogParser -h | %fstr%
LogParser -h GRAMMAR | %fstr%
LogParser -h FUNCTIONS | %fstr%
LogParser -h EXAMPLES | %fstr%
:: Because -I:XML does not have -Recurse option, we need to read each individual .xml file and extract the data we need and append that into a single .CSV file.
:: HOWEVER: I found that this works without recurse: This is exactly what I need... just add additional nodes as needed
SET "Root=%OneDrive%\Batch\Wi-Fi\Wi-Fi*.xml"&&echo %Date% !Time! [MSG] %Root%
Dir /B %Root%
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Tree -E:-1 "SELECT name AS SSID,keyMaterial AS Password,authentication,encryption FROM '%Root%'"
:: Use the above model to create an html output
::   ...   ...
LogParser -i:XML -stats:On -fMode:Tree -E:-1 -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-Wi-Fi-SIDS.tpl" "SELECT name AS SSID,keyMaterial AS Password,authentication,encryption INTO '%ohtm%\%ComputerName%_LP-Wi-Fi-SIDSReport.html' FROM '%OneDrive%\Batch\Wi-Fi\Wi-Fi*.xml'"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LP-Wi-Fi-SIDSReport.html"
:: Below is an APPEND example If I need to append individual Files to output
LogParser "SELECT * FROM (log1.log,log2.log)" -o:CSV -oMode:Append -oFileName:output.csv
LogParser "SELECT * FROM log2.log" -o:CSV -oMode:Append -oFileName:output.csv
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Using XML for Reporting - LogParser file:Ch06ConvertW3CErrorstoXML.sql –i:W3C -xslLink:Ch06table.xsl
:: -o:TPL -tpl:"%OneDrive%\LP-Templates\Ch06Table.xsl
:: --- Ch06ConvertW3CErrorstoXML.sql ---
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT sc-status AS [HTTP Status Code], COUNT(*) AS Requests INTO HttpStatusCodes.txt FROM '%IISLogs%\*.log' GROUP BY [HTTP Status Code] ORDER BY Requests DESC"
SET xml=%odl%\%ComputerName%_ex-Out.xml
IF EXIST %xml% (echo File Found for: %xml%..&&Dir /B /S /A:-d %xml%&&echo Completed Processing for: %xml% : RC=%ErrorLevel%) ELSE echo File %xml% Not Found......

DIR /A:-D /O:D /B /S %IISLogs%\*.log
LogParser –i:W3C "SELECT * INTO '%ohtm%\%ComputerName%_ex-Out.xml' FROM '%IISLogs%\u_ex240403.log' WHERE sc-status >= 400"
NotePad++ %odl%\%ComputerName%_ex-Out.xml
Start CHROME "%odl%\%ComputerName%_ex-Out.xml"
LogParser –i:W3C -xslLink:"%OneDrive%\LP-Templates\Ch06Table.xsl" "SELECT * INTO '%ohtm%\%ComputerName%_ex-Out.xml' FROM '%IISLogs%\u_ex240403.log' WHERE sc-status >= 400"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Test additional methods and ways to get and extract Files and data from .xml...
:: Below is to extract a list of all Files I need to read
SET Root=%OneDrive%\Batch\Wi-Fi\Wi-Fi-Villa Gilda.xml&echo %Date% !Time! [MSG] %Root%
:: Below reads an individual .xml file to extract the fields (Nodes) I'm looking for.
<WLANProfile>
<SSIDConfig><SSID><name>
<MSM><security><sharedKey><keyMaterial>
SET Root=%OneDrive%\Batch\Wi-Fi\Wi-Fi*.xml&echo %Date% !Time! [MSG] Root = %Root%
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Tree -dtNodes:20 -E:-1 "SELECT name AS SSID,hex,authentication,encryption FROM '%Root%'"
:: ,keyMaterial AS Password
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Tree -E:-1 "SELECT name AS SSID,keyMaterial AS Password,authentication,encryption FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Tree -E:-1 "SELECT * FROM '%Root%'"

LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Auto -E:-1 "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Branch -E:-1 "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Node -E:-1 "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Branch -dtNodes:10 -E:-1 "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Tree -dtNodes:20 -E:-1 "SELECT * FROM '%Root%'"

SET Root=%OneDrive%\Batch\Wi-Fi\*.xml&echo %Date% !Time! [MSG] %Root%
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Tree -E:-1 -Recurse:-1 "SELECT * FROM '%Root%'"  Error: invalid parameter "Recurse"

LogParser -i:XML –fmode:Tree "SELECT title, dc:creator FROM http://www.LogParser.com/instantforum33/rssfeed.aspx?id=1&Task=ForumRSS"

LogParser -h -i:TEXTLINE -recurse  (LogFilename (S)             Index (I)             Text (S)) - Parses entire lines out of generic text Files
LogParser -h -i:TEXTWORD -recurse  (LogFilename (S)             Index (I)             Text (S)) - Parses single words out of generic text Files
LogParser -h -i:CSV   <No recurse> (List the fields extracted from a CSV file: LogParser -h -i:CSV myfile.csv -headerRow:on) - Parses text Files containing comma-separated values
LogParser -h -i:TSV   <No recurse> (Field names and types are retrieved at runtime from the specified input file(s)) - Parses text Files containing tab- or space- separated values
LogParser -h -i:XML   <No recurse> (Field names and types are retrieved at runtime from the specified input file(s)) - Parses XML Files

give me a working example for using command: LogParser -i:TEXTLINE
LogParser "SELECT Line AS Text FROM 'C:\Logs\test.log' WHERE Text LIKE '%error%'" -i:TEXTLINE -o:CSV

give me a working example for using command: LogParser -i:TEXTWORD
LogParser -i:TEXTWORD "SELECT Text, COUNT(*) AS Hits FROM '%Root%' GROUP BY Text ORDER BY Hits DESC"

LogParser "SELECT * FROM (log1.log,log2.log)" -o:CSV -oMode:Append -oFileName:output.csv
LogParser "SELECT * FROM log2.log" -o:CSV -oMode:Append -oFileName:output.csv
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌────────────────────────────────────────────────────────────┐
│  Read Windows Reliability Report Stats exported to .XML    │
└────────────────────────────────────────────────────────────┘
LogParser -h -i:XML
-iTsFormat:yyyy-MM-dd?hh:mm:ss:mmm		[default value=yyyy-MM-dd?hh:mm:ss]
-dtNodes:1		OR -1 OR 4
-rootXPath:'%odl%\T450s-RelStats-28Apr2022.XML'

SET Root=%odl%\T450s-RelStats-28Apr2022.XML
IF EXIST %Root% (echo File %Root% Exists) ELSE echo File %Root% Does Not Exist
SET csv=%odl%\T450s-RelStats-28Apr2022.csv
echo Root=%Root%
echo csv=%csv%

SET Root=%OneDrive%\Travel\Canada-Jul2023\Trip to Canada(Whole Map)-Jul2023.kml
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Branch -E:-1 "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Tree -E:-1 "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Node -E:-1 "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Auto -E:-1 "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Branch -dtNodes:10 -E:-1 "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Tree -dtNodes:10 -E:-1 "SELECT * FROM '%Root%'"

SET Root=%OneDrive%\Travel\Canada-Jul2023\Trip to Canada(Whole Map)-Jul2023.kml
LogParser -i:XML -rtp:-1 -o:datagrid -stats:On -fMode:Auto -E:-1 "SELECT name, name2, name3, description, coordinates FROM '%Root%' WHERE (description IS NOT NULL) OR (coordinates IS NOT NULL) OR (name IS NOT NULL) OR (name2 IS NOT NULL) OR (name3 IS NOT NULL)"

:: Error echo Display titles of current channels on MSDN BLogs:&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT title INTO MyOutput.txt FROM https://blogs.msn.com/MainFeed.aspx#/rss/channel/item" -i:XML -fMode:Tree -o:tpl -TPL:mytemplate.tpl
:: Error: Error loading document "http://blogs.msdn.com/MainFeed.aspx": The system cannot locate the object specified.
echo Page23 example&LogParser file: "SELECT title, dc:creator FROM http://www.LogParser .com/instantforum33/rssfeed.aspx?id=1&Task=ForumRSS" -i:XML –fmode:Tree
LogParser -i:XML -o:CSV -fMode:Branch -E:-1 "SELECT Time AS T1,Value,Time2 AS T2,Impact AS I1,Source AS S1,Problem AS P1,Time3 AS T3,Impact2 AS I2,Source2 AS S2,Problem2 AS P2,State INTO %csv% FROM '%Root%'"&Notepad++ %csv%
HEADERS: TimeGenerated,Time,Value,Time2,Impact,Source,Problem,Time3,Impact2,Source2,Problem2,State
echo Header: TimeGenerated - Time AS T1,Value,Time2 AS T2,Impact AS I1,Source AS S1,Problem AS P1,Time3 AS T3,Impact2 AS I2,Source2 AS S2,Problem2 AS P2,State

echo AND OR&LogParser -i:XML -rtp:-1 -fMode:Branch -iTsFormat:yyyy-MM-dd?hh:mm:ss:mmm -E:-1 "SELECT Time,Value,Impact AS I1,Source AS S1,Problem AS P1,Impact AS I2,Source AS S2,Problem AS P2,State FROM %Root% WHERE I1 <> Null OR I2 <> Null AND S1 <> Null OR S2 <> Null AND P1 <> Null OR P2 <> Null "

echo And / OR&LogParser -i:XML -rtp:-1 -fMode:Branch -iTsFormat:yyyy-MM-dd?hh:mm:ss:mmm -E:-1 "SELECT Time,Value,Time2,Impact,Source,Problem,Time AS Time3,Impact2,Source2,Problem2,State FROM %Root% WHERE Time <> Null OR Time2 <> Null AND Time3 <> Null OR Time3 <> Null AND Impact <> Null OR Impact2 <> Null AND Source <> Null OR Source <> Null AND Problem <> Null OR Problem2 <> Null"
echo OR / AND&LogParser -i:XML -rtp:-1 -fMode:Branch -iTsFormat:yyyy-MM-dd?hh:mm:ss:mmm -E:-1 "SELECT Time,Value,Time2,Impact,Source,Problem,Time AS Time3,Impact2,Source2,Problem2,State FROM %Root% WHERE Time <> Null AND Time2 <> Null OR Time3 <> Null AND Time3 <> Null OR Impact <> Null AND Impact2 <> Null OR Source <> Null AND Source <> Null OR Problem <> Null AND Problem2 <> Null"
echo OR&LogParser -i:XML -rtp:-1 -fMode:Branch -iTsFormat:yyyy-MM-dd?hh:mm:ss:mmm -E:-1 "SELECT Time,Value,Time2,Impact,Source,Problem,Time AS Time3,Impact2,Source2,Problem2,State FROM %Root% WHERE Time <> Null OR Time2 <> Null OR Time3 <> Null OR Time3 <> Null OR Impact <> Null OR Impact2 <> Null OR Source <> Null OR Source <> Null OR Problem <> Null OR Problem2 <> Null"

echo AND RETURNS 0 as expected...&LogParser -i:XML -rtp:-1 -fMode:Branch -iTsFormat:yyyy-MM-dd?hh:mm:ss:mmm -E:-1 "SELECT Time,Value,Time2,Impact,Source,Problem,Time AS Time3,Impact2,Source2,Problem2,State FROM %Root% WHERE Time <> Null AND Time2 <> Null AND Time3 <> Null AND Time3 <> Null AND Impact <> Null AND Impact2 <> Null AND Source <> Null AND Source <> Null AND Problem <> Null AND Problem2 <> Null"

LogParser -i:XML -rtp:-1 -fMode:Branch "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Branch -dtNodes:4 -fNames:Compact -iTsFormat:yyyy-MM-dd?hh:mm:ss:mmm -E:-1 "SELECT TimeGenerated,Value,Impact,Source,Problem FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Branch -fNames:XPath -iTsFormat:yyyy-MM-dd?hh:mm:ss:mmm -E:-1 "SELECT * FROM '%Root%'"

LogParser -i:XML -rtp:-1 -fMode:Node "SELECT * FROM '%Root%'"
creator  name   InstallPath    creationDate     originalPath
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌────────────────────────────────────────────────────────────┐
│  Read ATTO Benchmark XML (.bmk) file.                      │
└────────────────────────────────────────────────────────────┘
::  ATTO Disk Benchmark 	https://www.atto.com/disk-benchmark/
SET bmk=%OneDrive%\X57012Tb.bmk
LogParser -rtp:-1 -o:datagrid -i:XML -fMode:Auto "SELECT TOP 1 * FROM %bmk%"
LogParser -rtp:-1 -o:datagrid -i:XML -fMode:Auto "SELECT drive,iosize,writebps,writeiops,readbps,readiops FROM %bmk%"
::-------------------------------------------------------------------------------------------------
SET Root="%OneDrive%\Social Security\SocialSecurityStatementData.xml"
IF EXIST %Root% (echo File Exists) Else echo File does not exist for: %Root%
LogParser -i:XML -rtp:-1 -fMode:Node "SELECT * FROM '%Root%'"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 5 Path, CreationTime FROM %Root% ORDER BY CreationTime DESC"
LogParser -rtp:-1 -o:datagrid -i:XML -fMode:Auto "SELECT * FROM '%Root%'"
::-------------------------------------------------------------------------------------------------
/* -I:FS ---Ch08ContentCreationDate.sql---  See Page 236 */
:: Example: %OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 08\Ch08ContentCreationDate.sql
:: Run: %OneDrive%\BobsTechStuff\Batch\FindOneDriveFilesOlderThanX.sql -  %OneDrive%\Batch\FindOneDriveFilesOlderThanX.sql
SET sql="%OneDrive%\Batch\FindOneDriveFilesOlderThanX.sql"&echo LogParser Query file: %sql%
LogParser file:%sql%?source="%OneDrive%\."+day="180" -i:FS -rtp:-1 -o:datagrid -q:on -stats:On -Recurse:-1 -preserveLastAccTime

SET day=30&SET source='C:\$Data\.'&echo Parameters: '%day%' and %source%
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ContentPath, FileName, [Creation Date Time] USING creationtime AS [Creation Date Time], TO_DATE([Creation Date Time]) AS Cdate, TO_DATE(TO_LOCALTIME(SUB(SYSTEM_TIMESTAMP(), TIMESTAMP('%day%', 'd')))) AS Days, EXTRACT_PATH(TO_LOWERCASE(path)) AS ContentPath, TO_LOWERCASE(name) AS FileName FROM %source% WHERE (attributes NOT LIKE 'D%') AND (Cdate >= Days) ORDER BY [Creation Date Time] DESC" -i:FS -rtp:-1 -o:datagrid -q:off -stats:On -Recurse:-1 -preserveLastAccTime -E:-1
:: Below does a file conversion - No need to Run this unless you have to...
:: You'll use the -o:W3C output switch to create output in the W3C Extended Log File format, which allows you to store detailed and extensive information, including client IP (Internet Protocol) addresses and the amount of data sent and received from your web or proxy server.You can create W3C-formatted output in order to perform further analysis using another utility, or if you have pre-existing log Files that you want to convert to the more extensible W3C format
:: See: LogParser -o:W3C -h
:: ---Ch10 --- Chapter 10 • Formatting, Reporting, and Charting
---Ch10CreatingW3COutput.sql---
LogParser.exe file: Ch10CreatingW3COutput.sql -o:w3c
LogParser -i:W3C -o:W3C "SELECT cs-username AS Source, cs-uri-query AS FileRequested FROM '%IISLogs%\zzzzz.log'"
---Ch10SendingNativeOutputToATextFile.sql---
:: List from an ETW trace all the filepaths accessed by IIS:  Dir /s /b iistrace.etl
LogParser -fmode:full -o:W3C -encodeDelim:ON "SELECT FileName, COUNT(*) AS Total INTO filenames.w3c FROM iistrace.etl GROUP BY FileName ORDER BY Total DESC" -providers:"IIS: WWWServer"
---Ch10CreatingCSVOutput.sql---
Logparser -i:W3C -o:csv –fileMode 1 "SELECT c-ip AS IP, cs-uri-stem AS File INTO '%odl%\%ComputerName%_Ch10CreatingCSVOutput.csv' FROM '%IISLogs%\*.log'"
---Ch10CreatingCSVOutput.sql---
Logparser.exe file: Ch10CreatingCSVOutput.sql -i:W3C -o:csv –fileMode 1
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
LogParser -i:XML -rtp:-1 -fMode:Branch Tree Node Auto
<Below lists every field listed in the header... List (2) broken down to view easier...>
<Get Latest Bdender XML Log file>
SET BdProf=%ProgramData%\Bdender\Desktop\ProFiles
SET BdLogs=%BdProf%\Logs\S-1-5-21-558534884-204672236-1678939191-1001\db7af1a4-db8-4f42-903a-9d200e40d03c
SET BdLog=1607201370_1_03.xml
SET Root=%BdLogs%\%BdLog%
Dir %Root%
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,CreationTime FROM '%Root%'"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, CreationTime FROM %BdProf%\*.* ORDER BY CreationTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 5 Path, CreationTime FROM %BdLogs%\*.xml ORDER BY CreationTime DESC"
<List Every NODE found>  :I'm only interested in: path and threatName but they don't appear in the list...>
<Find Every Tree, Branch and Node in xml>
LogParser -i:XML -fMode:Auto "SELECT TOP 1 * FROM '%Root%'"
LogParser -i:XML -fMode:Auto -o:nat -rtp:1 "SELECT TOP 1 * FROM '%Root%'"
LogParser -i:XML -fMode:Tree -o:tpl -TPL:mytemplate.tpl "SELECT title INTO %odl\%MyOutput.txt FROM https://blogs.msn.com/MainFeed.aspx#/rss/channel/item"
LogParser -i:XML -fMode:Tree -o:tpl-tpl:mytemplate.tpl "SELECT title INTO MyOutput.txt FROM https://blogs.msn.com/MainFeed.aspx#/rss/channel/item"
LogParser -i:XML -rtp:-1 "SELECT path AS NodePath FROM '%Root%'"
LogParser -i:XML -rtp:-1 "SELECT TOP 1 * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT creator,name,InstallPath,creationDate FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT delete_reboot,renamed,hidden,skipped,ioerrors,archiveBombs,passwordProtected FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT enableCertReport,paranoidAction,path,totalSignatures,scannedArchives,scannedPacked,startTime,duration,UserDefinedExtensions2 FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT enableCertReport,paranoidAction,path,totalSignatures,scannedArchives,scannedPacked,startTime,duration,UserDefinedExtensions2 FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT originalPath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT originalPath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT paranoidAction,path,totalSignatures FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT path AS AutoPath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT path,startTime,duration FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT scanKeyloggers,scanFiles,scanAllFiles,scanProgramsOnly,useCustomPrograms,customPrograms,scanUserDefined,scanPacked,scanArchives FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT shutdownAfter,passwordPrompt,onlyAllowedActions,deepArchiveScan,maxArchiveLevel,maxArchiveSize,infectedAction1,infectedAction2 FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT statisticsRefreshInterval,scanSpeed,lowPriority,enableExclusions,scanAdware,scanSpyware,scanApplications,scanDialers FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT suspectAction1,suspectAction2,rootkitAction,UserDefinedExtensions,scanPua,computeSha256Hash,computeMd5Hash,disableIndexer FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT type,scanned,infected,suspicious,disinfected,deleted,moved,moved_reboot FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT useSmartScan,scaneMails,scanRootkits,scanAllRootkits,scanBoot,scanMemory,scanRegistry,quickScan,scanCookies FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto -o:nat -rtp:2 "SELECT batch_id,logMessage,r_cre_time FROM %myXML%"
LogParser -i:XML -rtp:-1 -fMode:Auto -rootXPat"H:ScanSession "SELECT * FROM '%Root%'"    Diaplaye most elements
LogParser -i:XML -rtp:-1 -fMode:Auto -rootXPat"H:ScanSession "SELECT InstallPath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto -rootXPat"H:ScanSettings "SELECT paranoidAction,path,totalSignatures FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Branch "SELECT /ScanDetails/UnresolvedDetails/@path AS myPath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Branch "SELECT creator FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Branch "SELECT path AS BranchPath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Branch "SELECT path,startTime,duration FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Branch "SELECT TOP 1 * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Node "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Node "SELECT creator AS WhoDunnit, name AS ScanType, InstallPath AS iFolder FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Node "SELECT InstallPath AS iPath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Node "SELECT path AS NodePath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Tree "SELECT * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Tree "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM%Root%" - Returns the wrong NODE path....
LogParser -i:XML -rtp:-1 -fMode:Tree "SELECT path,startTime,duration FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:tree "SELECT TOP 1 * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid "SELECT InstallPath FROM '%Root%'"  Good
LogParser -i:XML -rtp:-1 -o:datagrid "SELECT path AS NodePath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid "SELECT threatName FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid "SELECT TOP 1 * FROM '%Root%'"
LogParser -i:XML -rtp:-1 -o:datagrid "SELECT totalSignatures FROM '%Root%'"  Good
LogParser -i:XML -rtp:-1 -o:datagrid "SELECT type FROM '%Root%'"
LogParser -i:XML -rtp:-1 -rootXPat"H:BillRun "SELECT TotalDocuments, PrintshopDocuments, OnDemandDocuments, ErrorDocuments USING SUM(CASE Name WHEN 'Printshop' THEN TotalDocuments2 ELSE 0 END) AS PrintshopDocuments, SUM(CASE Name WHEN 'OnDemand' THEN TotalDocuments2 ELSE 0 END) AS OnDemandDocuments, SUM(CASE Name WHEN 'Error' THEN TotalDocuments2 ELSE 0 END) AS ErrorDocuments FROM %odl%\XML-Test.xml GROUP BY TotalDocuments"
LogParser -i:XML -rtp:-1 -rootXPat"H:EngineSummary "SELECT @totalSignatures FROM '%Root%'"
LogParser -i:XML -rtp:-1 -rootXPat"H:path "SELECT path AS NodePath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -rootXPat"H:path "SELECT path AS NodePath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -rootXPat"H:ScanDetails -fMode:Auto "SELECT path AS myPath FROM '%Root%'"
LogParser -i:XML -rtp:-1 -rootXPat"H:Statistics "SELECT TotalDocuments, PrintshopDocuments, OnDemandDocuments, ErrorDocuments USING SUM(CASE Name WHEN 'Printshop' THEN TotalDocuments2 ELSE 0 END) AS PrintshopDocuments, SUM(CASE Name WHEN 'OnDemand' THEN TotalDocuments2 ELSE 0 END) AS OnDemandDocuments, SUM(CASE Name WHEN 'Error' THEN TotalDocuments2 ELSE 0 END) AS ErrorDocuments FROM %odl%\XML-Test.xml GROUP BY TotalDocuments"
LogParser -i:XML -rtp:-1 -rootXPat"H:Statistics -dtNodes:999 "SELECT TotalDocuments, PrintshopDocuments, OnDemandDocuments, ErrorDocuments USING SUM(CASE Name WHEN 'Printshop' THEN TotalDocuments2 ELSE 0 END) AS PrintshopDocuments, SUM(CASE Name WHEN 'OnDemand' THEN TotalDocuments2 ELSE 0 END) AS OnDemandDocuments, SUM(CASE Name WHEN 'Error' THEN TotalDocuments2 ELSE 0 END) AS ErrorDocuments FROM %odl%\XML-Test.xml GROUP BY TotalDocuments"
::	Display titles of current channels on MSDN BLogs:
:: Error LogParser -i:XML -fMode:Tree -o:tpl -TPL:mytemplate.tpl "SELECT title INTO %odl\%MyOutput.txt FROM https://blogs.msn.com/MainFeed.aspx#/rss/channel/item"
:: Error: Error loading document "http://blogs.msdn.com/MainFeed.aspx": The system cannot locate the object specified.
<Scan XML for Path and threatname>
LogParser -i:XML -rtp:-1 -fMode:Tree "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM%Root%" - Returns the wrong NODE path....
<This is what I'm looking for...>
/ScanSession/ScanDetails/UnresolvedDetails/Item/@path AS Location, /ScanSession/ScanDetails/UnresolvedDetails/Item/@threatName AS ThreatType
...XML NODES...
<ScanSession creator="Bdender Total Security"
	<ScanDetails>
		<UnresolvedDetails>
			<Item type="0"
			      path="E:\Scripts\Test-TESTCRAP1.ps1"                   <--- This path
			      threatName="Heur.BZC.PZQ.Boxter.81.28005C91"           <--- This threatName
       ...... Repeat x times .....
			</Item>
 		</UnresolvedDetails>
	<ScanDetails>
</ScanSession>

FROM
'F:\test.xml#/rss/channel/ctv:channel',
'F:\test.xml#/rss/channel/item';
Data: <Msg time='2010-01-10T17:41:31' type='INFO' attrbute3='value' ... >Log Message</Msg>
 LP:   *.xml#/Log/Msg WHERE type='ERROR'
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,CreationTime FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Branch "SELECT creator FROM '%Root%'"
LogParser -i:XML -rtp:-1 -fMode:Auto "SELECT paranoidAction,path,totalSignatures FROM '%Root%'"
z LogParser -i:XML -rtp:-1 -fMode:Branch "SELECT /ScanDetails/UnresolvedDetails/@path AS myPath FROM '%Root%'"
z LogParser -i:XML -rtp:-1 -rootXPat"H:ScanDetails -fMode:Auto "SELECT path AS myPath FROM '%Root%'"
    <ScanSettings paranoidAction="1">
    <path>E:\</path>
    <EngineSummary totalSignatures="12128604"/>
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<!--XCopy "C:\$Data\Bdender\ondemandal.xml" "<Folder-File>\." /C /F /G /D /I /S /R /H /Y /Z /J -->
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h EVT 	 (Windows Event Log)     -i:EVT                               │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  EventLog (S)              RecordNumber (I)          TimeGenerated (T)
  TimeWritten (T)           EventID (I)               EventType (I)
  EventTypeName (S)         EventCategory (I)         EventCategoryName (S)
  SourceName (S)            Strings (S)               ComputerName (S)
  SID (S)                   Message (S)               Data (S)
::  EventLog, RecordNumber, TimeGenerated, TimeWritten, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, Strings, ComputerName, SID, Message, Data
:: Search: All Headers or partial
:: EventLog, RecordNumber, TimeGenerated, TimeWritten, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, Strings, ComputerName, SID, Message, Data
:: EventLog,TimeGenerated,EventID,SourceName,EventType,EventCategory,SID,Message,Data
:: TimeGenerated, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, Strings, SID, Message
:: LogParser -i:EVT -------------------------------------------------------------------------------
LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 -saveDefaults
LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 -restoreDefaults
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -stats:On -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, Strings, SID, Message FROM System WHERE Strings LIKE '%GeoPhoto%' OR Message LIKE '%GeoPhoto%'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
┌────────────────────────────────────────┐
│  Decode Message into multiple parts    │
└────────────────────────────────────────┘
:: To decode the message part of Event ID 4624 into parts separated by the character "-", you can use LogParser's EXTRACT_TOKEN function. This function helps to extract specific tokens from a string, which can then be used to separate the message into individual parts.
:: EventID 4624 Message Breakdown into Field Parts - Example using splitting message into parts
echo Daily Logon Security check&LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT QUANTIZE(TimeGenerated, 600) AS TimeFrame, TimeGenerated, eventid, eventtype, eventtypename, EXTRACT_TOKEN(Message, 1, ':') AS SecID, EXTRACT_TOKEN(Message, 2, ':') AS AccName, EXTRACT_TOKEN(Message, 3, ':') AS Domain, EXTRACT_TOKEN(Message, 4, ':') AS LogonID, EXTRACT_TOKEN(Message, 5, ':') AS LogonInfo, EXTRACT_TOKEN(Message, 6, ':') AS LogonTypeM, EXTRACT_TOKEN(Message, 7, ':') AS Mode, EXTRACT_TOKEN(Message, 8, ':') AS AccType, EXTRACT_TOKEN(Message, 9, ':') AS Token, EXTRACT_TOKEN(Message, 10, ':') AS ImpLev, EXTRACT_TOKEN(Message, 11, ':') AS NewLogin, EXTRACT_TOKEN(Message, 12, ':') AS SecuID, EXTRACT_TOKEN(Message, 13, ':') AS ActName, EXTRACT_TOKEN(Message, 14, ':') AS AccDom, EXTRACT_TOKEN(Message, 15, ':') AS Logon-ID, EXTRACT_TOKEN(Message, 16, ':') AS LinkedLogIn, EXTRACT_TOKEN(Message, 17, ':') AS NetAcct, EXTRACT_TOKEN(Message, 18, ':') AS NetAcctDom, resolve_sid(sid) AS UserName FROM Security WHERE EventID IN (4624;4672) AND TimeGenerated >= SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 01:00', 'yyyy-MM-dd HH:mm'))"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
┌────────────────────────────────────────┐
│  Decode Strings into multiple parts    │
└────────────────────────────────────────┘
echo Daily Logon Security check&LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT Distinct EventID, Strings FROM Security WHERE EventID IN (4624;4672) AND TimeGenerated >= SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 01:00', 'yyyy-MM-dd HH:mm'))
:: Below is the compressed version:
LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 300)) AS ToDay, EventID, EXTRACT_TOKEN(Strings, 0, '|') AS SecurityID1, EXTRACT_TOKEN(Strings, 1, '|') AS AccountName1, EXTRACT_TOKEN(Strings, 2, '|') AS AccountDomain1, EXTRACT_TOKEN(Strings, 3, '|') AS LogonID1, EXTRACT_TOKEN(Strings, 4, '|') AS SecurityID2, EXTRACT_TOKEN(Strings, 5, '|') AS AccountName2, EXTRACT_TOKEN(Strings, 6, '|') AS AccountDomain2, EXTRACT_TOKEN(Strings, 7, '|') AS LogonID2, EXTRACT_TOKEN(Strings, 8, '|') AS LogonTypeS, EXTRACT_TOKEN(Strings, 9, '|') AS LogonProcess, EXTRACT_TOKEN(Strings, 10, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS TransitedServices, EXTRACT_TOKEN(Strings, 12, '|') AS LogonGUID, EXTRACT_TOKEN(Strings, 13, '|') AS KeyLength, EXTRACT_TOKEN(Strings, 14, '|') AS ProcessID, EXTRACT_TOKEN(Strings, 15, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 16, '|') AS NetworkWorkstationName, EXTRACT_TOKEN(Strings, 17, '|') AS SourceNetworkAddress, EXTRACT_TOKEN(Strings, 18, '|') AS SourcePort, EXTRACT_TOKEN(Strings, 19, '|') AS ImpersonationLevel, EXTRACT_TOKEN(Strings, 20, '|') AS ElevatedToken, EXTRACT_TOKEN(Strings, 21, '|') AS VirtualAccount, EXTRACT_TOKEN(Strings, 22, '|') AS LinkedLogonID, EXTRACT_TOKEN(Strings, 23, '|') AS ElevationType FROM Security WHERE TimeGenerated >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 01:00', 'yyyy-MM-dd HH:mm') ) AND EventID IN (4624;4672)"
:: Below is the LONG version:
LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT
    TO_INT(QUANTIZE(TimeGenerated, 300)) AS ToDay,
    EventID,
    EXTRACT_TOKEN(Strings, 0, '|') AS SecurityID1,
    EXTRACT_TOKEN(Strings, 1, '|') AS AccountName1,
    EXTRACT_TOKEN(Strings, 2, '|') AS AccountDomain1,
    EXTRACT_TOKEN(Strings, 3, '|') AS LogonID1,
    EXTRACT_TOKEN(Strings, 4, '|') AS SecurityID2,
    EXTRACT_TOKEN(Strings, 5, '|') AS AccountName2,
    EXTRACT_TOKEN(Strings, 6, '|') AS AccountDomain2,
    EXTRACT_TOKEN(Strings, 7, '|') AS LogonID2,
    EXTRACT_TOKEN(Strings, 8, '|') AS LogonTypeS,
    EXTRACT_TOKEN(Strings, 9, '|') AS LogonProcess,
    EXTRACT_TOKEN(Strings, 10, '|') AS AuthPackage,
    EXTRACT_TOKEN(Strings, 11, '|') AS TransitedServices,
    EXTRACT_TOKEN(Strings, 12, '|') AS LogonGUID,
    EXTRACT_TOKEN(Strings, 13, '|') AS KeyLength,
    EXTRACT_TOKEN(Strings, 14, '|') AS ProcessID,
    EXTRACT_TOKEN(Strings, 15, '|') AS ProcessName,
    EXTRACT_TOKEN(Strings, 16, '|') AS NetworkWorkstationName,
    EXTRACT_TOKEN(Strings, 17, '|') AS SourceNetworkAddress,
    EXTRACT_TOKEN(Strings, 18, '|') AS SourcePort,
    EXTRACT_TOKEN(Strings, 19, '|') AS ImpersonationLevel,
    EXTRACT_TOKEN(Strings, 20, '|') AS ElevatedToken,
    EXTRACT_TOKEN(Strings, 21, '|') AS VirtualAccount,
    EXTRACT_TOKEN(Strings, 22, '|') AS LinkedLogonID,
    EXTRACT_TOKEN(Strings, 23, '|') AS ElevationType
    FROM Security
    WHERE TimeGenerated >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 01:00', 'yyyy-MM-dd HH:mm') ) AND EventID IN (4624;4672)"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
╔═══════════════════════════════════════════════════╗
║   Search through EVERY Log file for a word:       ║
║      e.g. Microsoft                               ║
╚═══════════════════════════════════════════════════╝
:: Powershell
# Define the search term
$searchTerm = "Microsoft"

# Get all event logs
$eventLogs = Get-EventLog -LogName *

# Search each log for the term
foreach ($log in $eventLogs) {
    $results = Get-EventLog -LogName $log.LogName | Where-Object { $_.Message -like "*$searchTerm*" }
    if ($results) {
        Write-Output "Found '$searchTerm' in $log.LogName:"
        $results | Format-Table -Property TimeGenerated, Source, EventID, Message
    }
}
:: Simple Search through 3 Event Logs to Find string Microsoft in the data
LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 25 TimeGenerated, EventID, EventTypeName, SourceName, Strings, ComputerName, SID, Message FROM Application, Security, System WHERE Message LIKE '%Microsoft%'"

:: Complex Search Expanding Message
LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 25 TimeGenerated, EventID, EventTypeName, SourceName, Strings, ComputerName, SID, EXTRACT_TOKEN(Message, 1, ':') AS SecID, EXTRACT_TOKEN(Message, 2, ':') AS AccName, EXTRACT_TOKEN(Message, 3, ':') AS Domain, EXTRACT_TOKEN(Message, 4, ':') AS LogonID, EXTRACT_TOKEN(Message, 5, ':') AS LogonInfo, EXTRACT_TOKEN(Message, 6, ':') AS LogonTypeM, EXTRACT_TOKEN(Message, 7, ':') AS Mode, EXTRACT_TOKEN(Message, 8, ':') AS AccType, EXTRACT_TOKEN(Message, 9, ':') AS Token, EXTRACT_TOKEN(Message, 10, ':') AS ImpLev, EXTRACT_TOKEN(Message, 11, ':') AS NewLogin, EXTRACT_TOKEN(Message, 12, ':') AS SecuID, EXTRACT_TOKEN(Message, 13, ':') AS ActName, EXTRACT_TOKEN(Message, 14, ':') AS AccDom, EXTRACT_TOKEN(Message, 15, ':') AS Logon-ID, EXTRACT_TOKEN(Message, 16, ':') AS LinkedLogIn, EXTRACT_TOKEN(Message, 17, ':') AS NetAcct, EXTRACT_TOKEN(Message, 18, ':') AS NetAcctDom, resolve_sid(sid) AS UserName FROM Application, Security, System WHERE Message LIKE '%Microsoft%'"

:: Complex Search Expanding Message AND Strings  LogonType is Duplicated
LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 25 TimeGenerated, EventID, EventTypeName, SourceName, ComputerName, SID, EXTRACT_TOKEN(Message, 1, ':') AS SecID, EXTRACT_TOKEN(Message, 2, ':') AS AccName, EXTRACT_TOKEN(Message, 3, ':') AS Domain, EXTRACT_TOKEN(Message, 4, ':') AS LogonID, EXTRACT_TOKEN(Message, 5, ':') AS LogonInfo, EXTRACT_TOKEN(Message, 6, ':') AS LogonTypeM, EXTRACT_TOKEN(Message, 7, ':') AS Mode, EXTRACT_TOKEN(Message, 8, ':') AS AccType, EXTRACT_TOKEN(Message, 9, ':') AS Token, EXTRACT_TOKEN(Message, 10, ':') AS ImpLev, EXTRACT_TOKEN(Message, 11, ':') AS NewLogin, EXTRACT_TOKEN(Message, 12, ':') AS SecuID, EXTRACT_TOKEN(Message, 13, ':') AS ActName, EXTRACT_TOKEN(Message, 14, ':') AS AccDom, EXTRACT_TOKEN(Message, 15, ':') AS Logon-ID, EXTRACT_TOKEN(Message, 16, ':') AS LinkedLogIn, EXTRACT_TOKEN(Message, 17, ':') AS NetAcct, EXTRACT_TOKEN(Message, 18, ':') AS NetAcctDom, resolve_sid(sid) AS UserName, EXTRACT_TOKEN(Strings, 0, '|') AS SecurityID1, EXTRACT_TOKEN(Strings, 1, '|') AS AccountName1, EXTRACT_TOKEN(Strings, 2, '|') AS AccountDomain1, EXTRACT_TOKEN(Strings, 3, '|') AS LogonID1, EXTRACT_TOKEN(Strings, 4, '|') AS SecurityID2, EXTRACT_TOKEN(Strings, 5, '|') AS AccountName2, EXTRACT_TOKEN(Strings, 6, '|') AS AccountDomain2, EXTRACT_TOKEN(Strings, 7, '|') AS LogonID2, EXTRACT_TOKEN(Strings, 8, '|') AS LogonTypeS, EXTRACT_TOKEN(Strings, 9, '|') AS LogonProcess, EXTRACT_TOKEN(Strings, 10, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS TransitedServices, EXTRACT_TOKEN(Strings, 12, '|') AS LogonGUID, EXTRACT_TOKEN(Strings, 13, '|') AS KeyLength, EXTRACT_TOKEN(Strings, 14, '|') AS ProcessID, EXTRACT_TOKEN(Strings, 15, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 16, '|') AS NetworkWorkstationName, EXTRACT_TOKEN(Strings, 17, '|') AS SourceNetworkAddress, EXTRACT_TOKEN(Strings, 18, '|') AS SourcePort, EXTRACT_TOKEN(Strings, 19, '|') AS ImpersonationLevel, EXTRACT_TOKEN(Strings, 20, '|') AS ElevatedToken, EXTRACT_TOKEN(Strings, 21, '|') AS VirtualAccount, EXTRACT_TOKEN(Strings, 22, '|') AS LinkedLogonID, EXTRACT_TOKEN(Strings, 23, '|') AS ElevationType FROM Application, Security, System WHERE Message LIKE '%Microsoft%'"

:: Examine the Log Files created and reported in the EventLogs above:
:: NotePad++ ing / Viewing XML USE: XML Copy Editor
:: LogParser -i:XML -h  -fMode     Branch|Tree|Node|Auto
NotePad++ "C:\Windows\Panther\diagerr.xml"
LogParser -i:XML -fmode:Auto "SELECT FileName, COUNT(*) AS Total FROM 'C:\Windows\Panther\diagerr.xml' GROUP BY FileName ORDER BY Total DESC"
:: Error loading document "C:\Windows\Panther\diagerr.xml": Only one top level element is allowed in an XML document. -  Ensure there is only one root element. A well-formed XML file should look like this:
LogParser -i:XML -fmode:Node "SELECT FileName, COUNT(*) AS Total FROM 'C:\Windows\Panther\diagerr.xml' GROUP BY FileName ORDER BY Total DESC"
:: Error: Error loading document "C:\Windows\Panther\diagerr.xml": Only one top level element is allowed in an XML document.
LogParser -i:XML -fmode:Tree "SELECT FileName, COUNT(*) AS Total FROM 'C:\Windows\Panther\diagerr.xml' GROUP BY FileName ORDER BY Total DESC"
:: Error: Error loading document "C:\Windows\Panther\diagerr.xml": Only one top level element is allowed in an XML document.
LogParser -i:XML -fmode:Branch "SELECT FileName, COUNT(*) AS Total FROM 'C:\Windows\Panther\diagerr.xml' GROUP BY FileName ORDER BY Total DESC"
:: Error: Error loading document "C:\Windows\Panther\diagerr.xml": Only one top level element is allowed in an XML document.
::  <root>
::      <FileName>example.txt</FileName>
::      <FileName>example2.txt</FileName>
::      <!-- Other elements -->
::  </root>
:: Temp NotePad++ "C:\ProgramData\Microsoft\Windows\WER\Temp\WER.3ce4b3ca-d47d-4734-8837-e7e9186d7dfe.tmp.xml"
:: Temp NotePad++ "C:\ProgramData\Microsoft\Windows\WER\Temp\WER.f07e2d3f-04a9-437c-bd54-7bbdd8880c5d.tmp.WERInternalMetadata.xml"

NotePad++ "C:\Windows\Panther\WinSetupMon.log"
NotePad++ "C:\ProgramData\Microsoft\Windows\WER\Temp\WER.714c0e0d-9183-4a7d-81b1-e16a24138434.tmp.txt"
NotePad++ "C:\ProgramData\Microsoft\Windows\WER\Temp\WER.92472a69-27f3-4644-ae66-ddd49c35b1a9.tmp.csv"
NotePad++ "C:\Windows\INF\setupapi.dev.log"
NotePad++ "C:\Windows\INF\setupapi.offline.log"
NotePad++ "C:\Windows\INF\setupapi.setup.log"
NotePad++ "C:\Windows\Panther\setupact.log"
NotePad++ "C:\Windows\Panther\WinSetupMon.log"

::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
╔═══════════════════════════════════════════════════╗
║       Display All Eventlog SourceName data        ║
║          Microsoft Defender Antivirus             ║
╚═══════════════════════════════════════════════════╝
 ::Ref: https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide#windows-defender-av-ids
echo View File Activity events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, SourceName, Message , SID, EventTypeName, Strings FROM Security WHERE EventID IN (4656;4663)"
echo View Microsoft Defender Antivirus event&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID BETWEEN 1000 AND 1120 AND EventID IN (1127;1150;1151)"
echo View Microsoft Defender Antivirus event&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID BETWEEN 2000 AND 2021 AND EventID IN (2030;2031;2040;2041;2042)"
echo View Microsoft Defender Antivirus event&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (3002;3007;5000;5001;5004;5007;5008;5009-13;)"
echo View Microsoft Defender Antivirus event&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID BETWEEN 5100 AND 5101 AND EventID IN (2030;2031;2040;2041;2042)"
:: Ref: https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/appendix-l--events-to-monitor
 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message
echo Monitor Daily: Potential Criticality&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, EventID, EventType, EventTypeName, EventCategory, Message FROM Application,Security,System WHERE EventID IN (4618;4649;4719;612;4765;4766;4794;4897;801;4964;5124;550;1102;517) ORDER BY ToDay,EventID"

:: Last 1 day : SELECT SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd hh:mm:ss') ) AS ToDay
:: Last 1 hour: SELECT SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd hh:mm:ss') ) AS ToDay
:: -i:FS 1 Hr : WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss')))
echo Monitor Daily: Potential Criticality&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 TimeGenerated AS ToDay, EventLog, SourceName, EventID, EventCategory, COUNT(*) AS [Total Errors], Message, Data FROM Application,Security,System WHERE EventID IN (4618;4649;4719;612;4765;4766;4794;4897;801;4964;5124;550;1102;517) AND TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND EventType = 1 OR EventType = 2 GROUP BY EventLog,SourceName,EventID,EventCategory,ToDay, Message, Data ORDER BY SourceName,[Total Errors],ToDay ASC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────────────────────────┐
│  Get the distribution of EventID values for each Source or Provider:  │
│  Run Daily when needed                                                │
└───────────────────────────────────────────────────────────────────────┘
LogParser -i:EVT -stats:ff -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT DISTINCT SourceName AS Provider, COUNT(*) AS Counts FROM System GROUP BY Provider ORDER BY Counts DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventTypeName, SourceName FROM System WHERE ( SourceName = 'Service Control Manager' AND EventID >= 7024)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, MUL(PROPCOUNT(*) ON (SourceName), 100.0) AS Percent FROM System GROUP BY SourceName, EventID ORDER BY SourceName, Percent DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT (DISTINCT SourceName) FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 75 * FROM Application"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 75 * FROM Security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 75 * FROM System"
::Get the distribution of EventID values for each Source: LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, MUL(PROPCOUNT(*) ON (SourceName), 100.0) AS Percent FROM System GROUP BY SourceName, EventID ORDER BY Percent, SourceName DESC"
::LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM system group by EventTypeName HAVING EventTypeName ='Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS Day, COUNT(*) AS [Total Errors] FROM Application WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY Day ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, MUL(PROPCOUNT(*) ON (SourceName), 100.0) AS Percent FROM Security GROUP BY SourceName, EventID ORDER BY SourceName, Percent DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM Application WHERE EventType = 1 OR EventType = 2 GROUP BY ToDay ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM Security WHERE EventType = 1 OR EventType = 2 GROUP BY ToDay ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM System WHERE EventType = 1 OR EventType = 2 GROUP BY ToDay ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 30 SourceName, COUNT(*) as Total FROM System GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, COUNT(*) as Total FROM System GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(DISTINCT SourceName)AS Source FROM System"
:: Below shows All issues 3 logs past 60 minutes...-  FROM Application, Security, System
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 80 EventLog, TimeGenerated AS Time, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 01:00', 'yyyy-MM-dd HH:mm'))) ORDER BY Time, EventID"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 01:00', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (44;43;19;20)"
LogParser -i:EVT -o:NAT "SELECT TimeGenerated, EventTypeName, SourceName FROM System WHERE SourceName = 'Service Control Manager'"
:: Paired parent process with the child process. TypicAlly, Proc2 is the parent and Proc1 is the child.

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') AS Proc1, EXTRACT_TOKEN(strings, 13, '|') as Proc2 FROM Security WHERE EventID = 4688 AND (Proc1 LIKE '%.%' AND Proc2 LIKE '%.%') GROUP BY Proc1, Proc2 ORDER BY Cntr ASC"

echo  A RECON / SUSPICIOUS process&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 AND (Process LIKE '%at.exe' OR Process LIKE '%ceipdata.exe' OR Process LIKE '%ceiprole.exe' OR  Process LIKE '%chcp.exe' OR Process LIKE '%cmd.exe' OR Process LIKE '%compmgmtlauncher.exe' OR Process LIKE '%csvde.exe' OR Process LIKE '%dsget.exe' OR Process LIKE '%dsquery.exe' OR Process LIKE '%esentutl.exe' OR Process LIKE '%find.exe' OR Process LIKE '%fsutil.exe' OR Process LIKE '%hostname.exe' OR Process LIKE '%%ipconfig.exe' OR Process LIKE '%ldifde.exe' OR Process LIKE '%nbtstat.exe' OR Process LIKE '%net.exe' OR Process LIKE '%net1.exe' OR Process LIKE '%netdom.exe' OR Process LIKE '%netsh.exe' OR Process LIKE '%netstat.exe' OR Process LIKE '%nltest.exe' OR Process LIKE '%nslookup.exe' OR Process LIKE '%\\ping.exe' OR Process LIKE '%psexec.exe' OR Process LIKE '%qprocess.exe' OR Process LIKE '%query.exe' OR Process LIKE '%quser.exe' OR Process LIKE '%qwinsta.exe' OR Process LIKE '%reg.exe' OR Process LIKE '%sc.exe' OR Process LIKE '%schtasks.exe' OR Process LIKE '%servermanagercmd.exe' OR Process LIKE '%set.exe' OR Process LIKE '%systeminfo.exe' OR Process LIKE '%TASKLIST.exe' OR Process LIKE '%time.exe' OR Process LIKE '%tracert.exe' OR Process LIKE '%tree.exe' OR Process LIKE '%type.exe' OR Process LIKE '%vds.exe' OR Process LIKE '%vdsldr.exe' OR Process LIKE '%ver.exe' OR Process LIKE '%wevtutil.exe' OR Process LIKE '%whoami.exe' OR Process LIKE '%WinrsHost.exe' OR Process LIKE '%%inver.exe' OR Process LIKE '%wmic.exe' OR Process LIKE '%wusa.exe') AND NOT Process LIKE '%dsregcmd.exe'"

echo  A RECON / SUSPICIOUS process&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 AND (Process LIKE '%\\at.exe' OR Process LIKE '%\\ceipdata.exe' OR Process LIKE '%\\ceiprole.exe' OR  Process LIKE '%\\chcp.exe' OR Process LIKE '%\\cmd.exe' OR Process LIKE '%\\compmgmtlauncher.exe' OR Process LIKE '%\\csvde.exe' OR Process LIKE '%\\dsget.exe' OR Process LIKE '%\\dsquery.exe' OR Process LIKE '%\\esentutl.exe' OR Process LIKE '%\\\\find.exe' OR Process LIKE '%\\fsutil.exe' OR Process LIKE '%\\hostname.exe' OR Process LIKE '%\\ipconfig.exe' OR Process LIKE '%\\ldifde.exe' OR Process LIKE '%\\nbtstat.exe' OR Process LIKE '%\\net.exe' OR Process LIKE '%\\net1.exe' OR Process LIKE '%\\netdom.exe' OR Process LIKE '%\\netsh.exe' OR Process LIKE '%\\netstat.exe' OR Process LIKE '%\\nltest.exe' OR Process LIKE '%\\nslookup.exe' OR Process LIKE '%\\ping.exe' OR Process LIKE '%\\psexec.exe' OR Process LIKE '%\\qprocess.exe' OR Process LIKE '%\\query.exe' OR Process LIKE '%\\quser.exe' OR Process LIKE '%\\qwinsta.exe' OR Process LIKE '%\\reg.exe' OR Process LIKE '%\\sc.exe' OR Process LIKE '%\\schtasks.exe' OR Process LIKE '%\\servermanagercmd.exe' OR Process LIKE '%\\set.exe' OR Process LIKE '%\\systeminfo.exe' OR Process LIKE '%\\TASKLIST.exe' OR Process LIKE '%\\time.exe' OR Process LIKE '%\\tracert.exe' OR Process LIKE '%\\tree.exe' OR Process LIKE '%\\type.exe' OR Process LIKE '%\\vds.exe' OR Process LIKE '%\\vdsldr.exe' OR Process LIKE '%\\ver.exe' OR Process LIKE '%\\wevtutil.exe' OR Process LIKE '%\\whoami.exe' OR Process LIKE '%\\WinrsHost.exe' OR Process LIKE '%\\inver.exe' OR Process LIKE '%\\wmic.exe' OR Process LIKE '%\\wusa.exe') AND NOT Process LIKE '%\\dsregcmd.exe'"
echo  A RECON / SUSPICIOUS process&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE Process LIKE '%LogParser *%' AND Process LIKE '%Netsh*%'"
:: Install Hardware Key Logger Backdoor with PSTools
:: https://github.com/Seabreg/pwdump https://github.com/Seabreg/pwdump/blob/master/PwDump7.exe
:: Download: https://github.com/Seabreg/pwdump/blob/master/PwDump7.exe
Filename: PwDump7.exe
Threat name: PwdumpFull Path: C:\Users\bobmaars\Downloads\PwDump7.exe
Threat type: Security Assessment Tool. Programs that can be used to gather information for unauthorized access to computer systems.
PwDump7.exeThreat name: Pwdump
This file was released 14 years 9 months  ago.
https://github.com/
Downloaded File  from github.com
Infected file: C:\Users\bobmaars\Downloads\PwDump7.exe   Access Denied
File Thumbprint - SHA:
b20f667c2539954744ddcb7f1d673c2a6dc0c4a934df45a3cca15a203a661c88
File Thumbprint - MD5:
d1337b9e8bac0ee285492b89f895cadb
:: Setup Firewall and allow Norton to process file: C:\SysInternalsSuite\PwDump7.exe
IF NOT EXIST "C:\SysInternalsSuite\PwDump7.exe" (echo Creating File:"C:\SysInternalsSuite\f_000066"&&echo Test f_000066 PwDump7.exe>"C:\SysInternalsSuite\f_000066") ELSE echo File Already Exists: "C:\SysInternalsSuite\f_000066"
IF NOT EXIST "C:\SysInternalsSuite\PwDump7.exe" (echo Creating File:"C:\SysInternalsSuite\PwDump7.exe"&&echo Test PwDump7.exe>"C:\SysInternalsSuite\PwDump7.exe") ELSE echo File Already Exists: "C:\SysInternalsSuite\PwDump7.exe"
Type "C:\SysInternalsSuite\PwDump7.exe"
Netsh Advfirewall Firewall ADD Rule Name="Village Allow App PwDump7.exe p In" Dir=IN action=allow program="C:\SysInternalsSuite\PwDump7.exe" Enable=yes&echo RC=%ErrorLevel%
Netsh Advfirewall Firewall ADD Rule Name="Village Allow App PwDump7.exe p In" Dir=IN action=allow program="%UserProfile%\Downloads\PwDump7.exe" Enable=yes&echo RC=%ErrorLevel%
:: Launch Norton: Fix error: Norton Threats resolved: PwDump7.ex is unsafe and has been removed. No further action is required. How do I  allow this app on my Windows 11 Pro system using Norton 360 - Let's make sure PwDump7.exe gets its VIP pass through Norton's velvet ropes.
Open Norton 360:
Locate the Norton 360 icon in your system tray (usually at the bottom-right corner of your screen).
If it's not there, click the upward-facing arrow to reveal hidden icons, and then double-click the Norton 360 icon.
Access Firewall Settings:
Within Norton 360, find the Firewall section. This is where the magic happens!
You might need to navigate through different tabs or menus, but look for anything related to firewall settings.
Allow an App Through Firewall:
Look for an option like "Allow an app through firewall" or similar.
Click it to open the list of allowed apps.
Add PwDump7.exe:
If you see PwDump7.exe in the list (it might be blocked), select it.
If it's not listed, look for an option to add a new app.
Browse to the location where PwDump7.exe is stored (usually where you downloaded it) and select it.
Choose Permissions:
Once you've selected PwDump7.exe, choose the appropriate permissions. You'll likely want to set it to "Allow" or "Full Trust."
Confirm your selection.
Apply and Save:
Click Apply or Save to save your changes.
Norton should now allow PwDump7.exe to operate without interference.
::NOPE: Norton still Blocks this file. May need a re-boot

pwdump7.exe >C:\$Data\OneDrive\Logs\%ComputerName%_PwDump7Hash.txt
psexec \\kraid cmd
psexec \\kraid ipconfig /all
psexec \\kraid -c rootkit.exe
psexec \\kraid -u Administrator -c rootkit.exe

::
:: +------------------------------------------------------------------+
:: |    Scan Eventlogs for Application Checkdisk issues:              |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog,TimeGenerated,EventID,SourceName,EventType,EventCategory,SID,Message,Data FROM Application,Security WHERE EventID IN (2614)"

:: +------------------------------------------------------------------+
:: |    Display Normal and Unexpected Shutdowns                       |
:: +------------------------------------------------------------------+
:: EventID ;6006 is useless...or (EventID=6006)
:: wevtutil qe System /q:"*[System[(EventID=41) or (EventID=1074) or (EventID=6005) or (EventID=6008)]]" /c:100 /f:text /rd:true
:: Get-WinEvent -FilterHashtable @{ LogName = 'System'; Id = 41, 1074, 6006, 6605, 6008; } | Format-List Id, LevelDisplayName, TimeCreated, Message
echo Auditing Planned/UnPlanned Shutdowns. (1074;6008)&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EventID, message AS Message FROM System WHERE EventID IN (1074;6008) ORDER BY EventTime"
echo why your PC shut down for no reason on Windows&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Time, EventID, SourceName, Message FROM System WHERE EventID IN (41;1074;6605;6008) AND Message NOT LIKE '%Planned%'ORDER BY EventID,Time"
echo All Logon, Startup and shutdown Events (4672;41;1074;6006;6008)&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Time, EventID, SourceName, Message FROM System WHERE EventID IN (4672;41;1074;6008) ORDER BY Time"
echo Trending System Startups&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT QUANTIZE(TimeGenerated, 3600) AS Time, COUNT(*) AS Number_of_Events FROM System WHERE EventID= '6005' GROUP BY Time ORDER BY Number_of_Events"
:: Using Above Query, Create A Chart: -charttype:column3d  -chartType:Bar3D
:: Test LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768-groupSize:640x480 -charttype:column3d -view:on -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Bar3D" "SELECT SourceName, COUNT(*) AS [NumEvents] INTO %ohtm%\%ComputerName%_Bar3D.gif FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"

echo Trending System Startups&LogParser -i:EVT -stats:on -q:off -E:-1 -view:ON -o:CHART -groupSize:1024x768 -charttype:column3d -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName%  Startups" "SELECT QUANTIZE(TimeGenerated, 3600) AS Time, COUNT(*) AS Number_of_Events INTO %odl%\%ComputerName%_Startups.gif FROM System WHERE EventID= '6005' GROUP BY Time ORDER BY Number_of_Events"

echo Special Logon Event&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Time, EventID, SourceName, Message FROM System WHERE EventID= '4672' ORDER BY Time"
echo Auditing Unexpected Shutdowns. (6008)&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, message AS Message FROM System WHERE EventID= '6008'"
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Show Last Login Details at Startup&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Time, EventID, SourceName, Message AS UpTime FROM System WHERE EventID IN (6008;6009;6013) AND Message LIKE '%The system uptime%' ORDER BY Time"
echo Show EventUpTime&LogParser -i:EVT -stats:on -q:off -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-EventUptime.tpl" -E:-1 "SELECT TimeGenerated AS Time, EventID, SourceName, Message AS UpTime INTO '%ohtm%\%ComputerName%_EventUpTime.html' FROM System WHERE EventID IN (6008;6009;6013) AND Message LIKE '%The system uptime%' ORDER BY Time"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_EventUpTime.html"
:: echo Show Last Login Details at Startup&LogParser -i:EVT -stats:on -q:off -E:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName%  Up-Time" "SELECT TimeGenerated AS Time, EventID, SourceName, Message AS UpTime INTO '%ohtm%\%ComputerName%_UpTime.gif' FROM System WHERE EventID IN (6008;6009;6013) AND Message LIKE '%The system uptime%' ORDER BY Time" ---ERROR: Column SourceName is not an INTEGER nor a REAL

-i:FS -Recurse:-1 -E:-1
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +------------------------------------------------------------------+
:: |    WAN - Wi-Fi and Wireless Sessions     (WiFi)                  |
:: |    Microsoft-Windows-WLAN-AutoConfig/Operational                 |
:: |    WLAN Event Log - Network Activity/Physical Location           |
:: +------------------------------------------------------------------+
Dir /B /S "C:\Windows\System32\winevt\Logs\*.evtx"|FindStr /I /C:"WLAN"
Diagnostics-Networking: Applications and Services Logs -> Microsoft -> Windows -> find Diagnostics-Networking
WLAN-Autoconfig: Expand Applications and Services Logs -> Microsoft -> Windows -> find WLAN-Autoconfig
SET wlan=C:\Windows\System32\winevt\Logs\Microsoft-Windows-WLAN-AutoConfig%4Operational.evtx
Dir /B /S "%wlan%"
LogParser -i:EVT -stats:ff -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT DISTINCT SourceName AS Provider FROM "%wlan%" WHERE Provider LIKE '%WLAN%' ORDER BY Provider"
LogParser -i:EVT -stats:ff -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT DISTINCT SourceName AS Provider FROM "C:\Windows\System32\winevt\Logs\Microsoft-Windows-WLAN-AutoConfig%4Operational.evtx" WHERE Provider LIKE '%WLAN%' ORDER BY Provider"
echo View Wi-Fi and Wireless Sessions&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Microsoft-Windows-WLAN-AutoConfig WHERE EventID IN (1009;1015;4000;4001;4042;10001;10002;11004;11005;11010)"
CD "C:\Windows\System32\winevt\Logs"
LogParser -i:EVT -stats:ff -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS EventTime, SourceName AS Provider, message AS Message FROM Microsoft-Windows-*.evtx WHERE EventID IN (8001;8003)"
LogParser -i:EVT -stats:ff -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated, SourceName AS Provider FROM System WHERE Provider = 'Service Control Manager' AND EventID = 7024"
:: Windows Network Event ID's to watch
echo View Network Events& LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Application,Security,System WHERE EventID IN (4004;4042;4960;4976;4977;4978;5480;5483;5484;7485;6273;6374;6275;6276;6277;6278;6279;6280;5031;5032;5140;5479;5632;5633)"
echo View WAN successful network connect&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Application WHERE EventID IN (3;4202;4004;4042) OR  EventID BETWEEN 50091 AND 50094"
echo View WAN successful network connect&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Application,Security,System WHERE EventID IN (8001;8003)"
Applications and Services Logs/Microsoft/Windows/NetworkProfile log.  There is a EventId 4004;4042 "Network State Change Event" AND EventId BETWEEN 50091 AND 50094
LogParser" -i:ETW -o:CSV -oTsFormat "HH:mm:ss.ln" "SELECT * FROM 'c:\PerfLogs\ASP\LocalSystem\20140724-000003\Verbose Trace.etl'" > %ohtm%\%ComputerName%_verbose.csv
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET WIFIDevicePath=HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Class\{4d36e972-e325-11ce-bfc1-08002be10318}
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \%WIFIDevicePath%\ WHERE KeyName LIKE '%DriverDesc%'"
SET TargetValueName="Intel(R) Wireless"
SET DevNum=0000
REG QUERY %WIFIDevicePath%\%DevNum% /V DriverDesc | find %TargetValueName%
REG ADD %WIFIDevicePath%%DevNum%\ /V WowlanS5Enabled /T REG_DWORD /d 1 /f
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM 'C:\windows\System32\winevt\logs\Security.evtx' WHERE EventId BETWEEN 50091 AND 50094"
Error: invalid parameter "headers" : -headers:ON  INTO %odl%\Test_Security.csv
Error: Error retrieving Files: Error searching for Files in folder c:\windows\System32\winevt\logs: The system cannot find the path specified. - 'c:\windows\System32\winevt\logs\Security.evtx'
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +-------------------------------------------------------------------------+
:: | LogParser Performing SUM Whole and MOD remainder Calculation example... |
:: | Using CONCAT Insert anything between two strings                        |
:: | Concatenates (Whole Number , . and remainder) CONCAT MUST be a String   |
:: | Example:   STRCAT(TO_STRING(xxxx),STRCAT('.',TO_STRING(yyyy)))          |
:: +-------------------------------------------------------------------------+
These examples take the Sum of the File Sizes and computes from Bytes to Kbytes, Mb and Gb. This example shows how to CONCAT whole , and remainder into 1 field:
Start "LPKb-1024" /D "%odl%" /High /WAIT /B LogParser -i:FS -Stats:On -q:OFF -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT DISTINCT Count(Name) AS NumSongs, SUM(Size) As ByteSize, DIV(ByteSize, 1024) AS KBytes, MOD(ByteSize, 1024) AS Kbr, STRCAT(TO_STRING(KBytes),STRCAT('.',TO_STRING(Kbr))) AS KiloBytes FROM '%Root%\*.mp3' WHERE Attributes NOT LIKE 'D%' HAVING KBytes > 0"
Start "LPMb-1048576)" /D "%odl%" /High /WAIT /B LogParser -i:FS -Stats:On -q:OFF -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT DISTINCT Count(Name) AS NumSongs, SUM(Size) As ByteSize, DIV(ByteSize, 1048576) AS MBytes, MOD(ByteSize, 1048576) AS Mbr, STRCAT(TO_STRING(MBytes),STRCAT('.',TO_STRING(Mbr))) AS MegaBytes FROM '%Root%\*.mp3' WHERE Attributes NOT LIKE 'D%' HAVING MBytes > 0"
Start "LPGb-1073741824" /D "%odl%" /High /WAIT /B LogParser -i:FS -Stats:On -q:OFF -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT DISTINCT Count(Name) AS NumSongs, SUM(Size) As ByteSize, DIV(ByteSize, 1073741824) AS GBytes, MOD(ByteSize, 1073741824) AS Gbr, STRCAT(TO_STRING(GBytes),STRCAT('.',TO_STRING(Gbr))) AS GigaBytes FROM '%Root%\*.mp3' WHERE Attributes NOT LIKE 'D%' HAVING GBytes >= 0"
:: Fun Test using Special Characters ⭐  •  ○  ° :: - Start "LPKb-1024" /D "%odl%" /High /WAIT /B LogParser -i:FS -Stats:On -q:OFF -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT DISTINCT Count(Name) AS NumSongs, SUM(Size) As ByteSize, DIV(ByteSize, 1024) AS KBytes, MOD(ByteSize, 1024) AS Kbr, STRCAT(TO_STRING(KBytes),STRCAT(' (⭐) (⭐) Boobies',TO_STRING(Kbr))) AS KiloBytes, STRCAT(TO_STRING(KBytes),STRCAT(' {.} {.} Old Boobies',TO_STRING(Kbr))) AS Boobies FROM '%Root%\*.mp3' WHERE Attributes NOT LIKE 'D%' HAVING KBytes > 0"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +------------------------------------------------------------------+
:: |     LogParser Performing Math and Calculations example...        |
:: +------------------------------------------------------------------+
:: The MOD function returns the leftover parts or remainder of a division equation. DIV (integer division) and MOD (modulo).
:: MOD( dividend <INTEGER | REAL>, divisor <INTEGER | REAL> ) The MOD function returns the remainder of the quotient of its argument
:: DIV( dividend <INTEGER | REAL>, divisor <INTEGER | REAL> ) The DIV function returns the quotient of the two argument values.
:: Using LogParser Need an example converting file size in Bytes to KB using both DIV and MOD to give Size and remainder as xxx.yyyyKb
:: MUL( multiplicand <INTEGER | REAL>, multiplier <INTEGER | REAL> ) The MUL function returns the multiplication of its arguments
:: NOTE: The MOD function returns the leftover parts or remainder of a division equation.The dividend of the MOD function must be an even multiple of the value used in the QUANTIZE function. In this way the WHERE clause will only keep records where the QUANTIZE value and the dividend are both factors of myTime. 900 is divisible 3 times by 300, so the MOD function in the WHERE clause keeps every third 300 second interval.The casual translation of this query is,"Produce 5 minutes of records from the Security log every fifteen minutes
echo Intervals and Sampling Produce 5 minutes of records from the Security log every fifteen minutes Toolkit p341&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT TimeGenerated USING TO_INT(QUANTIZE(TimeGenerated, 300)) as myTime FROM security WHERE MOD(myTime, 900) = 0"
:: SELECT DISTINCT TimeGenerated USING -- duration of sample TO_INT(QUANTIZE(TimeGenerated, 300)) as myTime FROM security WHERE -- frequency of sample MOD(myTime, 900) = 0"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +------------------------------------------------------------------+
:: |    Enable_Mobile_Hotspot_feature                                 |
:: +------------------------------------------------------------------+
::	Enable_Mobile_Hotspot_feature.reg
::	[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections]
::	"NC_ShowSharedAccessUI"=-
::	Disable_Mobile_Hotspot_feature.reg
::	[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections]
::	"NC_ShowSharedAccessUI"=dword:00000000
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM '\HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections'"  ::  \NC_ShowSharedAccessUI=-
:: Default: HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network Connections	NC_PersonalFirewAllConfig	REG_DWORD	0
Microsoft-Windows-WLAN-Autoconfig/Diagnostic
Microsoft-Windows-WLAN-AutoConfig/Operational
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Microsoft-Windows-WLAN-AutoConfig/Operational"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +------------------------------------------------------------------+
:: |    Disable Bing With the Registry  "Disable Bing Searches.reg."  |
:: +------------------------------------------------------------------+
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM '\HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows'"
REG ADD
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +------------------------------------------------------------------+
:: |    Display total network related events                          |
:: +------------------------------------------------------------------+
echo Display total network related events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, COUNT(*) AS [NumEvents] FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +-----------------------------------------------------------------------------------------------------+
:: |    Login EventID 4624 EventType 8 FROM SID: S-1-5-18 AND S-1-0-0                                    |
:: | https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624#security-monitoring-recommendations
:: +-----------------------------------------------------------------------------------------------------+
SET myeids=21;22;25;98;131;1024;1149;1102;4624;4625;4648
echo Select Last Hour LogIn Events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (%myeids%) AND TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02 01:00', 'yyyy-MM-dd HH:mm') )"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +-----------------------------------------------------------------------------------------------------+
:: |    Below are my user created Events Between 500 and 599 Various ways of examining this data         |
:: |  FROM Application WHERE EventID BETWEEN 500 AND 599 AND Sourcename NOT LIKE '%Microsoft%'           |
:: +-----------------------------------------------------------------------------------------------------+
echo Count Number of events by day&&LogParser -i:EVT "SELECT TOP 5 DISTINCT EventID, COUNT(EventID) AS EvtCt, QUANTIZE(TimeGenerated, 86400), EventType FROM Application WHERE EventID BETWEEN 500 AND 599 GROUP BY EventID,TimeGenerated,EventType"
echo List Todays Events&&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated, SourceName AS Name, EventID AS ID, Message FROM Application WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventID BETWEEN 500 AND 599 ORDER BY TimeGenerated, Message ASC"

echo Count All Events by Hour&&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT to_date(TimeGenerated) AS Date, quantize(to_time(TimeGenerated), 3600) AS Hour, Count(*) AS Number_of_Events FROM Application WHERE EventID BETWEEN 500 AND 599 AND Sourcename NOT LIKE '%Microsoft%' GROUP BY date, hour"
echo Counts All events by Hour&&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT to_date(TimeGenerated) AS Date, quantize(to_time(TimeGenerated), 3600) AS Hour, Count(*) AS Number_of_Events FROM Application WHERE EventID BETWEEN 500 AND 599 AND Sourcename NOT LIKE '%Microsoft%' GROUP BY date, hour ORDER BY date DESC"

echo list Details of Every Event&&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, TimeWritten, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, Strings, ComputerName, SID, Message, Data FROM Application WHERE EventID BETWEEN 500 AND 599 ORDER BY TimeGenerated, Message ASC"
echo List Every Special Events&&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Application WHERE EventID BETWEEN 500 AND 599 AND Sourcename NOT LIKE '%Microsoft%' ORDER BY TimeGenerated ASC"
echo List Every Special Events&&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Application WHERE EventID BETWEEN 500 AND 599"

echo List Events 600 Seconds&&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT QUANTIZE(TimeGenerated, 600) AS TimeFrame, TimeGenerated, eventtype, eventtypename, Message FROM Application WHERE timeframe=(SELECT QUANTIZE(TimeGenerated, 600) FROM System WHERE eventtype=4 ) AND EventID BETWEEN 500 AND 599 ORDER BY TimeGenerated, Message ASC"

echo Searches for Daily in Name&&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated, SourceName AS Name, EventID AS ID, Message FROM Application WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventID BETWEEN 500 AND 599 AND Name LIKE '%Daily%' ORDER BY TimeGenerated DESC"
:: No return LogParser -i:EVT -stats:off -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, TO_INT(QUANTIZE(TimeGenerated, 300)) AS ToDay, EventID, ComputerName, Message FROM Application WHERE TimeGenerated >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 01:00', 'yyyy-MM-dd HH:mm') ) AND EventID BETWEEN 500 AND 599 ORDER BY Today, Message ASC"
:: LogParser -i:EVT "SELECT DISTINCT EventID, COUNT(*) AS EvtCt, QUANTIZE(TimeGenerated, 86400) AS TIME, EventType FROM Application WHERE AND SUB(to_int(TimeGenerated), to_int(system_timestamp())) > -2592000 AND EventID BETWEEN 500 AND 599 GROUP BY EventID,Time,EventType"
:: Error: Syntax Error: <term2>: 'SUB(to_int(TimeGenerated),' is not a valid operator
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +-----------------------------------------------------------------------------------------------------+
:: |    Below Total Errors FROM All Major SourceName logs. This can be improved by Adding , SourceName,  |
:: +-----------------------------------------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application, Security, System group by EventTypeName HAVING EventTypeName ='Error event'"
::SET myeids=IN (4657;1;4616)
SET myeids=BETWEEN 529 AND 547
SET ToDay=%date:~-4%-%date:~-7,2%-%date:~-10,2% & echo %ToDay%...
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID %myeids% AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'"
echo Event Failure Correlation&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT QUANTIZE(TimeGenerated, 600) AS TimeFrame, TimeGenerated, eventtype, eventtypename, message FROM Security WHERE timeframe= ( SELECT QUANTIZE(TimeGenerated, 600) FROM Security  WHERE eventtype<>8 )"
:: Correlating Events Around Failures
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT QUANTIZE(TimeGenerated, 600) AS TimeFrame, TimeGenerated, eventtype, eventtypename, message FROM Security WHERE timeframe=( SELECT QUANTIZE(TimeGenerated, 600) FROM Security WHERE eventtype<>8 )"

:: --- Ch03CorrelatingLogonFailures.sql
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT QUANTIZE(TimeGenerated, 600) AS TimeFrame, TimeGenerated, eventtype, eventtypename, message FROM Security WHERE timeframe=(SELECT QUANTIZE(TimeGenerated, 600) FROM System WHERE eventtype<>8 ) AND EventID IN (529;530;531;532;533;534;535;537;539)"
::  FROM Application WHERE EventID BETWEEN 500 AND 599

:: Adding this to the end resulted in 0 hits... AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'
Application Errors:
echo All Failed Applications Today&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Time, EventTypeName AS Event, SourceName AS Application FROM application WHERE Application LIKE '*' AND event LIKE 'error event' AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 560"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Security WHERE EventType IN (4624;4625;4648;4675;4656;4658;4660;4663;4685) ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE EventID = 4625 ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventType IN (4624;4625;4648;4675;4656;4658;4660;4663;4685)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, EventTypeName, Message, COUNT(*) as Entries FROM System group by EventID, Message, EventTypeName ORDER BY EventTypeName, Entries DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, EventCategoryName, Message FROM Security WHERE EventID = 4624 ORDER BY ToDay ASC"
4624	2023-06-18 00:00:00	NULL	The name for category 12544 in Source "Microsoft-Windows-Security-Auditing" cannot be found. The local computer may not have the necessary registry information or message DLL Files to display messages from a remote computer	An account was successfully logged on. Subject: Security ID: S-1-5-18 Account Name: X570$ Account Domain: VILLAGE Logon ID: 0x3e7 Logon Information: Logon Type: 5 Restricted Admin Mode: - Remote Credential Guard: - Virtual Account: %%1843 Elevated Token: %%1842 Impersonation Level: %%1833 New Logon: Security ID: S-1-5-18 Account Name: SYSTEM Account Domain: NT AUTHORITY Logon ID: 0x3e7 Linked Logon ID: 0x0 Network Account Name: - Network Account Domain: - Logon GUID: {00000000-0000-0000-0000-000000000000} Process Information: Process ID: 0x5d0 Process Name: C:\Windows\System32\services.exe Network Information: Workstation Name: - Source Network Address: - Source Port: - Detailed Authentication Information: Logon Process: Advapi Authentication Package: Negotiate Transited Services: - Package Name (NTLM only): - Key Length: 0 This event is generated when a logon session is created. It is generated on the computer that was accessed. The subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe. The logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network). The New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on. The network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases. The impersonation level field indicates the extent to which a process in the logon session can impersonate. The authentication information fields provide detailed information about this Specific logon request. - Logon GUID is a unique identifier that can be used to correlate this event with a KDC event. - Transited services indicate which intermediate services have participated in this logon request. - Package name indicates which sub-protocol was used among the NTLM protocols. - Key length indicates the length of the generated session key. This will be 0 if no session key was requested.
FIX:
Regedit -> HKEY_LOCAL_MACHINES\System\CurrentControlSet\services\eventlog\Security\Microsoft-Windows-Security-Auditing
Right click Microsoft-Windows-Security-Auditing in the left pane, and then click Permissions….
Click the Add… button in the permission dialog.
In the Enter the object names to select box, type Event Log Readers, and then click the Check Names button. -> Select your %UserName%
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Windows Update. Your device is missing important security and quality fixes.
echo List Windows Update Events 15Mins&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 00:15:00', 'yyyy-MM-dd hh:mm:ss') ) AS Last15m, EventID, SID, SourceName, EventCategoryName, Message FROM System WHERE EventID IN (16;20;21;30;31;33)"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
::
:: +------------------------------------------------------------------+
:: |   Events FROM App, Sec and Sys for past x Mins                   |
:: +------------------------------------------------------------------+
echo Pull Events FROM App, Sec and Sys for past 60 Mins &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('01-02', 'MM-dd'))) ORDER BY EventLog, EventID,TimeGenerated"
echo Pull Events FROM App, Sec and Sys for past 5 Mins &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) ORDER BY EventLog, EventID,TimeGenerated"
echo Pull Events FROM App, Sec and Sys for past 10 Mins &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Messageecho Pull Events FROM App, Sec and Sys for past 5 Mins &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) ORDER BY EventLog, EventID,TimeGenerated"
Application, Security, System WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '10', 'mm' ) ) ) ORDER BY EventLog, EventID,TimeGenerated"
:: Below is same as above except we insert that data INTO SQL backend
echo Pull Events FROM App, Sec and Sys for past 60 Mins &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM System, Application, Security TO tblEvents WHERE TO_STRING(TimeGenerated, 'yyyyMMdd') = TO_STRING(TO_LOCALTIME(SYSTEM_TIMESTAMP()), 'yyyyMMdd') AND TO_INT(TO_STRING(TimeGenerated, 'HH')) = SUB(TO_INT(TO_STRING(TO_LOCALTIME(SYSTEM_TIMESTAMP()), 'HH')),1)" -o:SQL -server:SQLSERVER -driver:"SQL Server" -database:EventLogs -Username:sa -password:XXXXX -createtable:ON
echo get All events for 4656 last 5 minutes &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated FROM Application, Security, System WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) AND EventID = '4656' AND Message LIKE '%sam%'"
:: Below shows All issues 3 logs past 60 minutes...
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 999 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:59', 'yyyy-MM-dd HH:mm')))"
:: Below shows All issues 3 logs past 10 minutes...
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 999 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Warning event'

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Error event'"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Security WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Error event'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +------------------------------------------------------------------+
:: |    Count Events and what they are                                |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 SourceName, COUNT(*) as Total FROM Application GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 SourceName, COUNT(*) as Total FROM Security GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 SourceName, COUNT(*) as Total FROM System GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Security GROUP BY EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID FROM security"

:: Example: Create multiple axes on one Grid
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) as [Application], mul(COUNT(*),2) as [System], mul(COUNT(*),3) as [Securiy] FROM Application, System, Security group by EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*)  as [Application], mul(COUNT(*),2) as [System], mul(COUNT(*),3) as [Securiy] FROM Application, System, Security group by EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*)  as [Application], mul(COUNT(*),2) as [System], mul(COUNT(*),3) as [Securiy] FROM Application, System, Security group by EventTypeName HAVING EventTypeName = 'Warning event'"

::  GROUP BY EventID ORDER BY EventID DESC
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM System GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Security GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Warning event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Information event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 10 SourceName, COUNT(*) as Total FROM System GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 10 SourceName, COUNT(*) as Total FROM System GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, COUNT(*) AS [NumEvents] FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(DISTINCT SourceName) FROM System"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (44;43;19;20)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM Application GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM Security GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM System WHERE EventType = 1 OR EventType = 2 GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Security GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM System GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM OAlerts GROUP BY EventTypeName"

::	Summary of process execution events paired the parent process with the child process.
:: Pair Parent process with the Child process.
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Num, EXTRACT_TOKEN(strings, 13, '|') as ParentProc, EXTRACT_TOKEN(Strings, 5, '|') AS ChildProc FROM Security WHERE EventID = 4688 AND (ChildProc LIKE '%.%' AND ParentProc LIKE '%.%') GROUP BY ParentProc, ChildProc ORDER BY Cntr ASC"
:: INTO %ohtm%\%ComputerName%_ParentChildProcs.txt
:: +------------------------------------------------------------------+
:: |    Daily Logon and NetLogon events to monitor:                   |
:: +------------------------------------------------------------------+
:: Note below 2 checks: If the results are 0 that's a very good sign.. Maybe - check if these are actuAlly being logged...
echo List Windows Daily Critical events last 8 Hours&LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT SourceName, TimeGenerated AS Time, EventID, ComputerName, Message, Data FROM Security WHERE EventType IN (4624;4625;4728;4732;4756;1102;4719;4740;4663) AND Time >SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()),TIMESTAMP('08:00:00','hh:mm:ss')) ORDER BY Time, EventID DESC"

echo Detect intrusions and malicious activity last 8 Hours&LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT SourceName, TimeGenerated AS Time, EventID, ComputerName, Message, Data FROM Security WHERE EventType IN (4688;4670;4672;1125;1007) AND Time >SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()),TIMESTAMP('08:00:00','hh:mm:ss')) ORDER BY Time, EventID DESC"

echo Logon Specific Events Last 60 Mins& LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Time, EventID, SourceName, Message , SID, EventTypeName, Strings FROM Security WHERE EventID IN (4624;4648;4663;4720) AND Time > SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 01:00', 'yyyy-MM-dd HH:mm'))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 200 EventID, * FROM Security WHERE Message LIKE '%logon%' AND 'EventID' NOT LIKE '%4799%' AND 'EventID' NOT LIKE '%4648%' AND 'EventID' NOT LIKE '%5379%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Total FROM Security WHERE Message LIKE '%logon%' GROUP BY SourceName ORDER BY Total DESC"
:: Last 30 mins because the volume is high...
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Time, EventID, SourceName, Message , SID, EventTypeName, Strings FROM Security WHERE EventID = 4648 AND Message LIKE '%A logon was attempted%' AND Time > SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 00:30', 'yyyy-MM-dd HH:mm')) ORDER BY TimeGenerated DESC"

LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Trending NetLogon Failures" "SELECT QUANTIZE(TimeGenerated, 3600) AS Time, COUNT(*) AS number_of_events INTO %ohtm%\%ComputerName%_NetLogonTrends.gif FROM System WHERE SourceName LIKE 'netlogon' AND SUB(TO_INT(TimeGenerated), TO_INT(SYSTEM_TIMESTAMP())) > -2592000 GROUP BY Time"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::----------------- Below Creates an HTML File for Logged on and Logged Off events in HTML Format... --------------------------------------------------------
:: Ref: https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/basic-audit-logon-events
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (552; 528) AND EventCategoryName = 'Logon/Logoff'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (552;528;4624;4625;4634;4647;4648;4779;4800;4801;4802;4803) AND EventCategoryName = 'Logon/Logoff'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID BETWEEN 672 AND 683"
:: Format for HTML needs following header:  "%OneDrive%\LP-Templates\LP-EVT-Logon.tpl" NOTE Browser must browser support inline frames...
<LPHEADER> <HTML> <HEAD><TITLE>Logon/Logoff Report</TITLE></HEAD> <BODY> <H1>Logon/Logoff Report</H1> <TABLE BGCOLOR="#D0D0E0" BORDER="1" CELLPADDING="10"> <TR> <TH>%FIELDNAME_1%</TH> <TH>%FIELDNAME_2%</TH> <TH>%FIELDNAME_3%</TH> </TR> </LPHEADER> <LPBODY> <TR> <TD><TT>%FIELD_1%</TT></TD> <TD><TT>%FIELD_2%</TT></TD> <TD><TT>%FIELD_3%</TT></TD> </TR> </LPBODY> <LPFOOTER> </BODY> </HTML> </LPFOOTER>
:: Notice that the template Files is divided into three sections (a header, a body, and a footer), and that each section uses special "%variables%" that get substituted at run-time with values from the query results.
:: We are now ready to generate our report by using the TPL output format with our previous command:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username INTO '%ohtm%\%ComputerName%_LogOnOff-Report.html' FROM Security WHERE EventID BETWEEN 672 AND 683 AND EventCategoryName = 'Logon/Logoff'" EVT -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-EVT-Logon.tpl"
::----------------- Above Creates an HTML File for Logged on and Logged Off events in HTML Format... --------------------------------------------------------
:: Find Specific User Logon logoff report - Works Well...
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND Username LIKE '%bob%'"
:: Below is a GOOD LopParser HTML Test - Add modern HTML Tags to Template for testing
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP INTO '%ohtm%\%ComputerName%_LogOnOff-Report.html' FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND Username LIKE '%bob%'" EVT -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-EVT-Logon1.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LogOnOff-Report.html"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: NOTE: See Discussion on Writing HTML Template for LogParser
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Format for HTML needs following header:  "%OneDrive%\LP-Templates\LP-EVT-Logon1.tpl" NOTE Browser must browser support inline frames...
<LPHEADER> <!DOCTYPE html> <HTML LANG="en-US"> <HEAD><TITLE>Logon-off Report</TITLE></HEAD> <BODY> <H1>Logon-off Report</H1> <TABLE BGCOLOR="#D0D0E0" BORDER="1" CELLPADDING="10"> <TR> <TH>%FIELDNAME_1%</TH> <TH>%FIELDNAME_2%</TH> <TH>%FIELDNAME_3%</TH> <TH>%FIELDNAME_4%</TH> <TH>%FIELDNAME_5%</TH> <TH>%FIELDNAME_6%</TH> <TH>%FIELDNAME_7%</TH> <TH>%FIELDNAME_8%</TH> </TR> </LPHEADER> <LPBODY> <TR> <TD><TT>%FIELD_1%</TT></TD> <TD><TT>%FIELD_2%</TT></TD> <TD><TT>%FIELD_3%</TT></TD> <TD><TT>%FIELD_4%</TT></TD> <TD><TT>%FIELD_5%</TT></TD> <TD><TT>%FIELD_6%</TT></TD> <TD><TT>%FIELD_7%</TT></TD> <TD><TT>%FIELD_8%</TT></TD> </TR> </LPBODY> <LPFOOTER> </BODY> </HTML> </LPFOOTER>

# EventID 4624 successful logon
:: Write All logs to database... :: LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog,RecordNumber,TimeGenerated,TimeWritten,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message,Data INTO [dbo].[eventlogs] FROM eventlogs\*.evtx" -o:SQL -createTable:ON -server:localhost -database:mydatabase
::filter for system time changes - EventID in (1102,4616,1108)
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY')"
:: echo Find Specific User&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated as Date, EXTRACT_TOKEN(Strings, 0, '|') as User, EXTRACT_TOKEN(Strings, 2, '|') as sourceip FROM System WHERE EventID = 21 AND User LIKE '%Administrator%'"
# group by User
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') as User, COUNT(*) as Cntr FROM System WHERE EventID = 21 GROUP BY User ORDER BY Cntr DESC"

:: Error: The system cannot find the file specified.:: LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS User, COUNT(*) AS Cntr FROM 'Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx' WHERE EventID = 1149 GROUP BY User ORDER BY Cntr DESC"
:: LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 2, '|') AS SourceIP FROM 'Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx' WHERE EventID = 1149"

# Find RDP logons
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND LogonType = '10'"
# Find console logons
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND LogonType = '2'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (4624;4625;4634;4647;4648;4779)"
:: Note to self: Below work on creating groups by hour perhaps to cut down volume...
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (541;542;543;528;552;4624;4625;4634;4647;4648;4779) AND EventCategoryName = 'Logon/Logoff'"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (552;528)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (560;562;563;564;565;567;568;569;570;571;572;772;73;774;775;776;777;778;779;780;781;782;783;784;785;786;787;788;789;790;791;792;793;794;795;796;797;798;799;800;801)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (624;627;628;630;631;632;633;634;635;636;637;638;639;641;642;643;644;645;646;647;648;649;650;651;652;653;645;655;656;657;658;659;660;661;662;663;664;665;666;667;668;684;685)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') AS Username FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 10, '|') AS LogonType,EXTRACT_TOKEN(Strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$' GROUP BY Username, Domain, LogonType, AuthPackage, Workstation, SourceIP ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS Username, COUNT(*) AS Cntr FROM Security WHERE EventID = 4672 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 5, '|') AS Username, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 8, '|') AS LogonType, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY LogonType ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, EXTRACT_TOKEN(Strings,5,'|') AS User, EXTRACT_TOKEN(Strings,8,'|') AS LogonType, EXTRACT_TOKEN(Strings,18,'|') AS SourceIP FROM Application WHERE EventID = 4624"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 10, '|') AS LogonType, EXTRACT_TOKEN(Strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 10, '|') AS LogonType,EXTRACT_TOKEN(Strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND SourceIP = '10.10.10.10'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 10, '|') AS LogonType,EXTRACT_TOKEN(Strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND Username = '%UserName%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 10, '|') AS LogonType,EXTRACT_TOKEN(Strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY')"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS LogonType, EXTRACT_TOKEN(Strings, 10, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND LogonType = '10'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND LogonType = '2'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND SourceIP = '10.10.10.100'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND Username = '%UserName%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND Username = 'Administrator'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY')"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date,EXTRACT_TOKEN(Strings, 0, '|') AS Username, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS Workstation, EXTRACT_TOKEN(Strings, 5, '|') AS SourceIP  FROM Security WHERE EventID = 4778"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date,EXTRACT_TOKEN(Strings, 0, '|') AS Username, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS Workstation, EXTRACT_TOKEN(Strings, 5, '|') AS SourceIP  FROM Security WHERE EventID = 4779"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS LogonDate, EXTRACT_TOKEN(Strings, 0, '|') AS Account FROM Security WHERE EventID NOT IN (541;542;543) AND EventType = 8 AND EventCategory = 2"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS LogonDate, EXTRACT_TOKEN(Strings, 0, '|') AS Account INTO %ohtm%\%ComputerName%_Account.xml FROM Security WHERE EventID NOT IN (541;542;543;4624;4625;4634;4647;4648;4779) AND EventType = 8 AND EventCategory = 2"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS LogonDate, EXTRACT_TOKEN(Strings, 0, '|') AS Account INTO %odl\%ComputerName%_%Report.xml FROM Security WHERE EventID NOT IN (541;542;543) AND EventType = 8 AND EventCategory = 2"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS LogonDate, EXTRACT_TOKEN(Strings, 0, '|') AS Account INTO Report.xml FROM Security WHERE EventID NOT IN (541;542;543) AND EventType = 8 AND EventCategory = 2"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS LogonDate, EXTRACT_TOKEN(Strings, 0, '|') AS Account INTO Report.xml FROM Security WHERE EventID NOT IN (541;542;543;528;552;4624;4625;4634;4647;4648;4779) AND EventType = 8 AND EventCategory = 2"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS LogonDate, EXTRACT_TOKEN(Strings, 0,'|') AS Account INTO Report.xml FROM Security WHERE EventID NOT IN (541;542;543) AND EventType = 8 AND EventCategory = 2"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EXTRACT_TOKEN(Strings,3,'|') AS LogonID, EXTRACT_TOKEN(Strings,5,'|') AS User, EXTRACT_TOKEN(Strings,8,'|') AS LogonTYPE, EXTRACT_TOKEN(Strings,11,'|') AS WorkstationName, EXTRACT_TOKEN(Strings,18,'|') AS Source-IP, EventID FROM Security WHERE EventID=4624 ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EXTRACT_TOKEN(Strings,5,'|') AS User, EXTRACT_TOKEN(Strings,10,'|') AS LogonTYPE, EXTRACT_TOKEN(Strings,13,'|') AS WorkstationName, EXTRACT_TOKEN(Strings,18,'|') AS ProcessName, EXTRACT_TOKEN(Strings,19,'|') AS Source-IP FROM Security WHERE EventID=4625 ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE Message LIKE '%logon%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 EventLog, TimeGenerated AS LogonDate, TimeWritten, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, EXTRACT_TOKEN(Strings, 0, '|') AS Account, ComputerName, SID, Message, Data INTO stdout FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 EventLog, TimeGenerated AS LogonDate, TimeWritten, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, EXTRACT_TOKEN(Strings, 0, '|') AS Account, ComputerName, SID, Message, Data INTO stdout FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 50 EventLog, TimeGenerated AS LogonDate, TimeWritten, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, EXTRACT_TOKEN(Strings, 0, '|') AS Account, ComputerName, SID, Message, Data INTO stdout FROM Application"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 50 EventLog, TimeGenerated AS LogonDate, TimeWritten, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, EXTRACT_TOKEN(Strings, 0, '|') AS Account, ComputerName, SID, Message, Data INTO stdout FROM Security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 50 EventLog, TimeGenerated AS LogonDate, TimeWritten, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, EXTRACT_TOKEN(Strings, 0, '|') AS Account, ComputerName, SID, Message, Data INTO stdout FROM System"
LogParser -o:TPL tpl:%OneDrive%\LoginOffTemplate.txt "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username INTO %OneDrive%\LoginOffReport.html FROM Security WHERE EventID IN (528;552;4624;4625;4634;4647;4648;4779) AND EventCategoryName = 'Logon/Logoff'"
LogParser -q:ON -stats:On-o:datagrid "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS LogonType, EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$' GROUP BY Username, Domain, LogonType, AuthPackage, Workstation, ProcessName, SourceIP ORDER BY Cntr DESC"
LogParser -q:ON -stats:On -rtp:-1 -o:datagrid "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS LogonType, EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$' GROUP BY Username, Domain, LogonType, AuthPackage, Workstation, ProcessName, SourceIP ORDER BY Cntr DESC"
# look at NTLM based logons
# group by NTLM Users
& LogParser -q:ON -stats:On EVT "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType, EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$' GROUP BY Username, Domain, LogonType, AuthPackage, Workstation, ProcessName, SourceIP ORDER BY Cntr DESC"
# group by Users
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 5, '|') as Username, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"
# group by domain
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 6, '|') as Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY Domain ORDER BY Cntr DESC"
# group by LogonType
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 8, '|') as LogonType, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY LogonType ORDER BY Cntr DESC"
# group by workstation name
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 11, '|') as Workstation, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY Workstation ORDER BY Cntr DESC"
# group by process name
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 17, '|') as ProcName, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY ProcName ORDER BY Cntr DESC"
# Event id 4625 - unsuccessful logon
:: Check: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa   DWORD (32-bit) as  LmCompatibilityLevel   Value data as 1.
:: psexec -i -s -d cmd.exe
:: rundll32 keyngr.dll KRShowKeyMgr
:: Also: Event ID 4625 logon type 3, Event ID 4625 logon type 4, or Event ID 4625 logon type 8
:: Disable NTLM logins?? > secpol.msc > Local policies/Security options/Network security: Restrict NTLM: Incoming NTLM traffic
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 10, '|') as LogonType,EXTRACT_TOKEN(Strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY')"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 10, '|') as LogonType,EXTRACT_TOKEN(Strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND Username = 'Administrator'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:EVT -rtp:-1 -o:datagrid -q:Off "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM System, Application, Security WHERE TO_STRING(TimeGenerated, 'yyyyMMdd') = TO_STRING(TO_LOCALTIME(SYSTEM_TIMESTAMP()), 'yyyyMMdd') AND TO_INT(TO_STRING(TimeGenerated, 'HH')) = SUB(TO_INT(TO_STRING(TO_LOCALTIME(SYSTEM_TIMESTAMP()), 'HH')),1)"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +----------------------------------------------------------------------+
:: | Get logs for today: SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay,  |
:: +----------------------------------------------------------------------+
::This query will show number of errors per day in the Application event log:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM Application WHERE EventType = 1 OR EventType = 2 GROUP BY ToDay ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM Security WHERE EventType = 1 OR EventType = 2 GROUP BY ToDay ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM System WHERE EventType = 1 OR EventType = 2 GROUP BY ToDay ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM Application,Security,System WHERE EventType = 1 OR EventType = 2 GROUP BY ToDay ORDER BY ToDay ASC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo List All Errors FROM 3 logs past 1 hour&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TimeGenerated AS ToDay, SourceName, EventCategory, COUNT(EventID) AS [Total Errors], Message, Data FROM Application,Security,System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND EventType = 1 OR EventType = 2 GROUP BY SourceName,EventID,EventCategory,ToDay, Message, Data ORDER BY SourceName,[Total Errors],ToDay ASC"
echo List All Errors FROM 3 logs past 1 hour&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 50 TimeGenerated AS ToDay, EventID, SourceName, EventCategory, COUNT(*) AS [Total Errors], Message, Data FROM Application,Security,System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND EventType = 1 OR EventType = 2 GROUP BY SourceName,EventID,EventCategory,ToDay, Message, Data ORDER BY SourceName,[Total Errors],ToDay ASC"
EventLog,RecordNumber,TimeGenerated,TimeWritten,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message,Data
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Specific LOG SourceName&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventTypeName, SourceName FROM System WHERE ( SourceName = 'Service Control Manager' AND EventID >= 7024)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, TimeGenerated FROM System ORDER BY TimeGenerated"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM system GROUP BY EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM system group by EventTypeName HAVING EventTypeName ='Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SourceName FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 30 SourceName, COUNT(*) as Total FROM System GROUP BY SourceName ORDER BY Total DESC"

:: Create a Chart BarGraph - See LogParser Other Chart working Examples later on...
LogParser -i:EVT -stats:On -resolveSIDs:ON -view:ON -o:CHART -groupSize:1024x768 -chartType:BarStacked1003D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% AllErrorsPastHr" "SELECT EventID, SourceName, TimeGenerated AS ToDay, COUNT(*) AS [Total Errors] INTO %ohtm%\%ComputerName%_AllErrorsPastHr.gif FROM Application,Security,System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND EventType = 1 OR EventType = 2 GROUP BY SourceName,EventID,ToDay ORDER BY SourceName,[Total Errors],ToDay ASC"
:: LogParser -i:EVT -stats:On -resolveSIDs:ON -view:ON -o:CHART -groupSize:1024x768 -chartType:BarStacked1003D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% AllErrorsPastHr" "SELECT EventID, TimeGenerated, COUNT(*) AS TotalErrors INTO %ohtm%\%ComputerName%_AllErrorsPastHr.gif FROM Application,Security,System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 01:00:00', 'yyyy-MM-dd HH:mm:ss'))) AND EventType = 1 OR EventType = 2 GROUP BY EventID ORDER BY TotalErrors ASC" <<-- Error: Semantic Error: SELECT clause field-expression "TimeGenerated" is not an aggregate function and does not contain GROUP BY field-expressions
:: "SELECT SourceName, COUNT(*) AS [NumEvents] INTO %ohtm%\%ComputerName%_Column3D.gif FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE EventType IN (0;1;3;4;5;8;10;11;12;13;14;15;18;19;20;21;24;26;29;30;101;102;103;104;105;106;107;200;201;204;205;1001;1002;2001;2002;2004;3001;3002;4001;4002;5105;5106;5107;5108;5123;95100) AND EventType = 1 OR EventType = 2 ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM System WHERE EventType IN (0;1;3;4;5;8;10;11;12;13;14;15;18;19;20;21;24;26;29;30;101;102;103;104;105;106;107;200;201;204;205;1001;1002;2001;2002;2004;3001;3002;4001;4002;5105;5106;5107;5108;5123;95100) AND  EventType = 1 OR EventType = 2 GROUP BY ToDay ORDER BY ToDay ASC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +------------------------------------------------------------------------------------------+
:: |  LogParser and FirewAll Lookup                                                           |
:: |  Source=" Microsoft-Windows-Security-Auditing" to only display firewall-related events   |
:: +------------------------------------------------------------------------------------------+
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT Text FROM '%odl%\FirewAll\*firewAll.log' WHERE Text='DROP'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo View Microsoft FirewAll EventIDs&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4948;4950;4956;4949;4947)"
echo View Microsoft FirewAll EventIDs&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Application,System,Security WHERE EventID BETWEEN 5024 AND 5037"
echo View Windows Firewall Logs&START "FireWallLog" /D "%OneDrive%\" /High /B Notepad++.exe %WINDIR%\System32\LogFiles\Firewall\pfirewall.log
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS AcctName, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS AcctUsed, EXTRACT_TOKEN(Strings, 6, '|') AS DomainUsed, EXTRACT_TOKEN(Strings, 8, '|') AS TargetServer, EXTRACT_TOKEN(Strings, 9, '|') AS ExtraData, EXTRACT_TOKEN(Strings, 11, '|') AS ProcName, EXTRACT_TOKEN(Strings, 12, '|') AS SourceIP FROM Security WHERE EventID = 4648 ORDER BY Date ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE EventType IN (0;1;3;4;5;8;10;11;12;13;14;15;18;19;20;21;24;26;29;30;101;102;103;104;105;106;107;200;201;204;205;1001;1002;2001;2002;2004;3001;3002;4001;4002;5105;5106;5107;5108;5123;95100)AND EventType = 1 OR EventType = 2 ORDER BY ToDay ASC"
:: Get Total number of errors per day FROM the Application event log:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS Date, COUNT(*) AS [Total Errors] FROM Application WHERE EventType = 1 OR EventType = 2 GROUP BY Date ORDER BY Date ASC"
:: Checkpoint Events
echo Failed Checkpoints [SOURCES=ESENT,VSS,vmicvss]&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security, System WHERE EventID IN (489;8229;2)"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│    RDP LocalSession and RemoteSession Log         │
└───────────────────────────────────────────────────┘
:: +------------------------------------------------------------------+
:: |	 RDP LocalSession Log Local logins                            |
:: |  Event id 21 Successful logon                                    |
:: |  Tracking and Analyzing Remote Desktop Activity Logs in Windows  |
:: +------------------------------------------------------------------+
Get-EventLog security -after (Get-date -hour 0 -minute 0 -second 0) | ?{$_.eventid -eq 4624 -and $_.Message -match 'logon type:\s+(10)\s'} | Out-GridView

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Application, Security, System WHERE EventType IN (25;39;40;41;42;261;1143;1149;4624;4625;4634;4778;4799)"
# LogonType = 10. If the LogonType = 7, it means that a user has reconnected to the existing RDP session.
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated as Date, EXTRACT_TOKEN(Strings, 0, '|') as User, EXTRACT_TOKEN(Strings, 2, '|') as sourceip FROM System WHERE EventID = 21"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +------------------------------------------------------------------+
:: |	 RDP RemoteSession Log    Event ID 1149 Successful logon      |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated as Date, EXTRACT_TOKEN(Strings, 0, '|') as User, EXTRACT_TOKEN(Strings, 2, '|') as sourceip FROM 'Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx' WHERE EventID = 1149"
# group by User
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') as User, COUNT(*) as Cntr FROM 'Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx' WHERE EventID = 1149 GROUP BY User ORDER BY Cntr DESC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +------------------------------------------------------------------+
:: |	Find Specific IP                                              |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 10, '|') as LogonType,EXTRACT_TOKEN(Strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND SourceIP = '10.1.47.151'"
:: +------------------------------------------------------------------+
:: |	check ntlm based attempts                                     |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 10, '|') as LogonType, EXTRACT_TOKEN(Strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$'"
:: +------------------------------------------------------------------+
:: |	 group by ntlm Users                                          |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 10, '|') as LogonType,EXTRACT_TOKEN(Strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$' GROUP BY Username, Domain, LogonType, AuthPackage, Workstation, SourceIP ORDER BY Cntr DESC"
:: +------------------------------------------------------------------+
:: |	group by Username                                             |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') as Username FROM Security WHERE EventID = 4625 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"
:: +------------------------------------------------------------------+
:: |	User logoff     event id 4634                                 |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4634 AND Domain NOT IN ('NT AUTHORITY')"
:: +------------------------------------------------------------------+
:: |	explicit creds was used   Event id 4648                       |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated as date, EXTRACT_TOKEN(Strings, 1, '|') as accountname, EXTRACT_TOKEN(Strings, 2, '|') as domain, EXTRACT_TOKEN(Strings, 5, '|') as usedaccount, EXTRACT_TOKEN(Strings, 6, '|') as useddomain, EXTRACT_TOKEN(Strings, 8, '|') as targetserver, EXTRACT_TOKEN(Strings, 9, '|') as extradata, EXTRACT_TOKEN(Strings, 11, '|') as procname, EXTRACT_TOKEN(Strings, 12, '|') as sourceip FROM Security WHERE EventID = 4648"
# Search by accountname
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated as date, EXTRACT_TOKEN(Strings, 1, '|') as accountname, EXTRACT_TOKEN(Strings, 2, '|') as domain, EXTRACT_TOKEN(Strings, 5, '|') as usedaccount, EXTRACT_TOKEN(Strings, 6, '|') as useddomain, EXTRACT_TOKEN(Strings, 8, '|') as targetserver, EXTRACT_TOKEN(Strings, 9, '|') as extradata, EXTRACT_TOKEN(Strings, 11, '|') as procname, EXTRACT_TOKEN(Strings, 12, '|') as sourceip FROM Security WHERE EventID = 4648 AND accountname = 'Administrator'"
# Search by usedaccount
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated as date, EXTRACT_TOKEN(Strings, 1, '|') as accountname, EXTRACT_TOKEN(Strings, 2, '|') as domain, EXTRACT_TOKEN(Strings, 5, '|') as usedaccount, EXTRACT_TOKEN(Strings, 6, '|') as useddomain, EXTRACT_TOKEN(Strings, 8, '|') as targetserver, EXTRACT_TOKEN(Strings, 9, '|') as extradata, EXTRACT_TOKEN(Strings, 11, '|') as procname, EXTRACT_TOKEN(Strings, 12, '|') as sourceip FROM Security WHERE EventID = 4648 AND usedaccount = 'Administrator'"
# group by accountname
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 1, '|') as accountname FROM Security WHERE EventID = 4648 GROUP BY accountname ORDER BY Cntr DESC"
# group by used account
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 5, '|') as usedaccount FROM Security WHERE EventID = 4648 GROUP BY usedaccount ORDER BY Cntr DESC"
# event id 4657
# A registry value was modified
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4657'"
# event id 4663
# An attempt was made to access an object
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4663'"
# Event id 4672
# Admin logon
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4672 AND Domain NOT IN ('NT AUTHORITY')
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4672 AND Domain NOT IN ('NT AUTHORITY') AND Username = 'Administrator'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS Username, COUNT(*) AS Cntr FROM Security WHERE EventID = 4672 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 2, '|') AS Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4672 AND Domain NOT IN ('NT AUTHORITY') GROUP BY Domain ORDER BY Cntr DESC"
# event id 4688
# new process was created
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688"
# Search by User
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 AND Username = 'Administrator'"
# Search by process name
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 AND Process LIKE '%rundll32.exe%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 1, '|') AS Username FROM Security WHERE EventID = 4688 GROUP BY Username ORDER BY Cntr DESC"
# group by process name
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 GROUP BY Process ORDER BY Cntr DESC"
# event id 4704
# A User right was assigned
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4704'"
# event id 4705
# A User right was removed
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4705'"
# event id 4706
# A new trust was created to a domain
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4706'"
# event id 4720
# A User account was created
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS createdUser, EXTRACT_TOKEN(Strings, 1, '|') AS createddomain, EXTRACT_TOKEN(Strings, 4, '|') as whocreated, EXTRACT_TOKEN(Strings, 5, '|') AS whodomain FROM Security WHERE EventID = '4720'"
# Event id 4722
# User account was enabled
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as User, EXTRACT_TOKEN(Strings, 1, '|') as domain, EXTRACT_TOKEN(Strings, 4, '|') as whichaccount, EXTRACT_TOKEN(Strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4722"
# event id 4723
# attempt to change password for the account - User changed his own password  EVT
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as User, EXTRACT_TOKEN(Strings, 1, '|') as domain, EXTRACT_TOKEN(Strings, 4, '|') as whichaccount, EXTRACT_TOKEN(Strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4723"
# event id 4724
# attempt to reSET User
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as User, EXTRACT_TOKEN(Strings, 1, '|') as domain, EXTRACT_TOKEN(Strings, 4, '|') as whichaccount, EXTRACT_TOKEN(Strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4724"
# event id 4725
# User account was disabled
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as User, EXTRACT_TOKEN(Strings, 1, '|') as domain, EXTRACT_TOKEN(Strings, 4, '|') as whichaccount, EXTRACT_TOKEN(Strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4725"
# event id 4726
# A User account was deleted
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS deletedUser, EXTRACT_TOKEN(Strings, 1, '|') AS deleteddomain, EXTRACT_TOKEN(Strings, 4, '|') as whodeleted, EXTRACT_TOKEN(Strings, 5, '|') AS whodomain FROM Security WHERE EventID = '4726'"
# event id 4727
# A security-enabled global group was created
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT *  FROM Security WHERE EventID = '4727'"
# event id 4728
# A member was added to a security-enabled global group
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as addedUser, EXTRACT_TOKEN(Strings, 2, '|') as togroup, EXTRACT_TOKEN(Strings, 3, '|') as groupdomain, EXTRACT_TOKEN(Strings, 6, '|') as whoadded, EXTRACT_TOKEN(Strings, 7, '|') as whodomain FROM Security WHERE EventID = '4728'"
# event id 4729
# A member was removed FROM a security-enabled global group
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as removedUser, EXTRACT_TOKEN(Strings, 2, '|') as FROMgroup, EXTRACT_TOKEN(Strings, 3, '|') as groupdomain, EXTRACT_TOKEN(Strings, 6, '|') as whoremoved, EXTRACT_TOKEN(Strings, 7, '|') as whodomain FROM Security WHERE EventID = '4729'"
# event id 4730
# A security-enabled global group was deleted
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4730'"
# event id 4731
# A security-enabled local group was created
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as createdgroup, EXTRACT_TOKEN(Strings, 1, '|') as domain, EXTRACT_TOKEN(Strings, 4, '|') as whichaccount, EXTRACT_TOKEN(Strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4731"
# event id 4732
#  A member was added to a security-enabled local group
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as addedUser, EXTRACT_TOKEN(Strings, 2, '|') as togroup, EXTRACT_TOKEN(Strings, 3, '|') as groupdomain, EXTRACT_TOKEN(Strings, 6, '|') as whoadded, EXTRACT_TOKEN(Strings, 7, '|') as whodomain FROM Security WHERE EventID = '4732'"
# event id 4733
# A member was removed FROM a security-enabled local group
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as removedUser, EXTRACT_TOKEN(Strings, 2, '|') as FROMgroup, EXTRACT_TOKEN(Strings, 3, '|') as groupdomain, EXTRACT_TOKEN(Strings, 6, '|') as whoremoved, EXTRACT_TOKEN(Strings, 7, '|') as whodomain FROM Security WHERE EventID = '4733'"
# event id 4734
#  A security-enabled local group was deleted
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS whichgroup, EXTRACT_TOKEN(Strings, 3, '|') AS domaingroup, EXTRACT_TOKEN(Strings, 6, '|') AS who, EXTRACT_TOKEN(Strings, 7, '|') AS workstation FROM Security WHERE EventID = 4734"
# event id 4738
# User account was changed
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') as User, EXTRACT_TOKEN(Strings, 2, '|') as domain, EXTRACT_TOKEN(Strings, 5, '|') as whichaccount, EXTRACT_TOKEN(Strings, 6, '|') as whichdomain FROM Security WHERE EventID = 4738"
# event id 4740
# A User account was locked out
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as User, EXTRACT_TOKEN(Strings, 1, '|') as workstation, EXTRACT_TOKEN(Strings, 4, '|') as wholocked, EXTRACT_TOKEN(Strings, 5, '|') as whodomain FROM Security WHERE EventID = '4740'"
# event id 4742
# computer account was changed
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as User, EXTRACT_TOKEN(Strings, 6, '|') as domain, EXTRACT_TOKEN(Strings, 1, '|') as whichaccount, EXTRACT_TOKEN(Strings, 2, '|') as whichdomain FROM Security WHERE EventID = 4742"
# event id 4754
# A security-enabled universal group was created
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as createdgroup, EXTRACT_TOKEN(Strings, 1, '|') as domain, EXTRACT_TOKEN(Strings, 4, '|') as whichaccount, EXTRACT_TOKEN(Strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4754"
# event id 4756
#  	A member was added to a security-enabled universal group
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as addedUser, EXTRACT_TOKEN(Strings, 2, '|') as togroup, EXTRACT_TOKEN(Strings, 3, '|') as groupdomain, EXTRACT_TOKEN(Strings, 6, '|') as whoadded, EXTRACT_TOKEN(Strings, 7, '|') as whodomain FROM Security WHERE EventID = '4756'"
# event id 4757
# A member was removed FROM a security-enabled universal group
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as removedUser, EXTRACT_TOKEN(Strings, 2, '|') as FROMgroup, EXTRACT_TOKEN(Strings, 3, '|') as groupdomain, EXTRACT_TOKEN(Strings, 6, '|') as whoremoved, EXTRACT_TOKEN(Strings, 7, '|') as whodomain FROM Security WHERE EventID = '4757'"
# event id 4758
#  A security-enabled universal group was deleted
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS whichgroup, EXTRACT_TOKEN(Strings, 3, '|') AS domaingroup, EXTRACT_TOKEN(Strings, 6, '|') AS who, EXTRACT_TOKEN(Strings, 7, '|') AS workstation FROM Security WHERE EventID = 4758"
# event id 4767
# A User account was unlocked
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4767'"
# event id 4768
# Kerberos TGT was requested
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as User, EXTRACT_TOKEN(Strings, 1, '|') as domain, EXTRACT_TOKEN(Strings, 7, '|') as Cipher, EXTRACT_TOKEN(Strings, 9, '|') as sourceip FROM Security WHERE EventID = 4768"
# group by User
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') as User, COUNT(*) AS Cntr FROM Security WHERE EventID = 4768 AND User NOT LIKE '%$' GROUP BY User ORDER BY Cntr DESC"
# group by domain
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') as domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4768 GROUP BY domain ORDER BY Cntr DESC"
# group by Cipher
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 7, '|') as Cipher, COUNT(*) AS Cntr FROM Security WHERE EventID = 4768 GROUP BY Cipher ORDER BY Cntr DESC"
# event id 4769
# Kerberos Service ticket was requested
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as User, EXTRACT_TOKEN(Strings, 1, '|') as domain, EXTRACT_TOKEN(Strings, 2, '|') as Service, EXTRACT_TOKEN(Strings, 5, '|') as Cipher, EXTRACT_TOKEN(Strings, 6, '|') as sourceip FROM Security WHERE EventID = 4769"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') as User, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 AND User NOT LIKE '%$' GROUP BY User ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') as domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 GROUP BY domain ORDER BY Cntr DESC"
# group by Service
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 2, '|') as Service, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 GROUP BY Service ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 5, '|') as Cipher, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 GROUP BY Cipher ORDER BY Cntr DESC"
# event id 4771
# kerberos pre-atuhentication failed
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0 , '|') as User, EXTRACT_TOKEN(Strings, 6 , '|') as sourceip FROM Security WHERE EventID = 4771 AND User NOT LIKE '%$'"
# group by User
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') as User, COUNT(User) AS Cntr FROM Security WHERE EventID = 4771 AND User NOT LIKE '%$' GROUP BY User ORDER BY Cntr DESC"
# event id 4776
# domain/computer attemped to validate User credentials
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4776 AND Domain NOT IN ('NT AUTHORITY') AND Username NOT LIKE '%$'"
# Search by Username
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4776 AND Domain NOT IN ('NT AUTHORITY') AND Username NOT LIKE '%$' AND Username = 'Administrator'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS Username, COUNT(*) AS Cntr FROM Security WHERE EventID = 4776 AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 2, '|') AS Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4776 GROUP BY Domain ORDER BY Cntr DESC"
# event id 4778
# RDP session reconnected
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date,EXTRACT_TOKEN(Strings, 0, '|') AS Username, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS Workstation, EXTRACT_TOKEN(Strings, 5, '|') AS SourceIP  FROM Security WHERE EventID = 4778"
# event id 4779
# RDP session disconnected
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date,EXTRACT_TOKEN(Strings, 0, '|') AS Username, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS Workstation, EXTRACT_TOKEN(Strings, 5, '|') AS SourceIP  FROM Security WHERE EventID = 4779"
# event id 4781
# User account was renamed
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS newname, EXTRACT_TOKEN(Strings, 1, '|') AS oldname, EXTRACT_TOKEN(Strings, 2, '|') AS accdomain, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain FROM Security WHERE EventID = 4781"
# event id 4825
# RDP Access denied
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS Username, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 3, '|') AS SourceIP FROM Security WHERE EventID = 4825"
# event id 4946
# new exception was added to firewAll
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') as rulename FROM Security WHERE EventID = 4946"
# group by rule name
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 2, '|') as rulename FROM Security WHERE EventID = 4946 GROUP BY rulename ORDER BY Cntr DESC"
# event id 4948
# rule was deleted FROM firewAll
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') as rulename FROM Security WHERE EventID = 4948"
# group by rule name
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 2, '|') as rulename FROM Security WHERE EventID = 4948 GROUP BY rulename ORDER BY Cntr DESC"
# event id 5038
# Code integrity determined that the image hash of a file is not valid
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5038'"
# event id 5136
# A directory Service object was modified
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 3, '|') AS Username, EXTRACT_TOKEN(Strings, 4, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS objectdn, EXTRACT_TOKEN(Strings, 10, '|') AS objectclass, EXTRACT_TOKEN(Strings, 11, '|') AS objectattrib, EXTRACT_TOKEN(Strings, 13, '|') AS attribvalue FROM Security WHERE EventID = '5136'"
# group by Username
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 3, '|') AS Username FROM Security WHERE EventID = '5136' GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 4, '|') AS Domain FROM Security WHERE EventID = '5136' GROUP BY Domain ORDER BY Cntr DESC"
# group by objectdn
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 8, '|') AS objectdn FROM Security WHERE EventID = '5136' GROUP BY objectdn ORDER BY Cntr DESC"
# group by objectclass
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 10, '|') AS objectclass FROM Security WHERE EventID = '5136' GROUP BY objectclass ORDER BY Cntr DESC"
# group by objectattrib
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 11, '|') AS objectattrib FROM Security WHERE EventID = '5136' GROUP BY objectattrib ORDER BY Cntr DESC"
# group by attribvalue
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 13, '|') AS attribvalue FROM Security WHERE EventID = '5136' GROUP BY attribvalue ORDER BY Cntr DESC"
# event id 5137
# A directory Service object was created
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5137'"
# event id 5138
# A directory Service object was undeleted
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5138'"
# event id 5139
# A directory Service object was moved
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5139'"
# event id 5141
# A directory Service object was deleted
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5141'"
# event id 5140
# A network share object was accessed
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5140'"
# event id 5142
# A network share object was added
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5142'"
# event id 5143
# A network share object was modified
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5143'"
# event id 5144
# A network share object was deleted
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5144'"
# event id 5145
# A network share object was checked to see whether client can be granted desired access
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5145'"
# event id 5154
# The Windows Filtering Platform has permitted an application or Service to listen on a port for incoming connections
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5154'"
# event id 5155
# The Windows Filtering Platform has blocked an application or Service FROM listening on a port for incoming connections
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5155'"
# event id 5156
# The Windows Filtering Platform has Allowed a connection
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5156'"
# event id 5157
# The Windows Filtering Platform has blocked a connection
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5157'"
# event id 5158
# The Windows Filtering Platform has permitted a bind to a local port
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5158'"
# event id 5159
# The Windows Filtering Platform has blocked a bind to a local port
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5159'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Failed Logins Today&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS UserName, COUNT(*) AS Number_of_Events FROM Security WHERE EventID IN (%myeids%) AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%' GROUP BY UserName HAVING Number_of_Events>2"
echo Ignore Sucessful Logins&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE eventtype<>8 AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'"
::	 logon account names and dates
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, SID, TimeGenerated AS LogonDate, EXTRACT_TOKEN(Strings, 0, '|') AS Account, Message FROM Security WHERE EventID NOT IN (541;542;543) AND EventType = 8 AND EventCategory = 2"
:: LogOff
SET myeids=23;40;4634;4647
echo Select All LogOff Events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (%myeids%)"
echo Select Last Hour LogOff Events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE  EventID IN (%myeids%) AND TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02 01:00', 'yyyy-MM-dd HH:mm') )"
echo LogOff Events %ToDay%&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (%myeids%) AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: Error: Syntax Error: <FROM-clause>: expecting FROM keyword instead of token 'STRCAT(EXTRACT_TOKEN(Strings,' - LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT TimeGenerated STRCAT(EXTRACT_TOKEN(Strings, 1, '|'), STRCAT('\\',EXTRACT_TOKEN(Strings, 0, '|'))) AS User, [ComputerName] AS TgtComp, EXTRACT_TOKEN(Strings,5,'|') AS [Attacking_Machine] FROM Security WHERE EventType = 16 AND EventCategory = 2 AND Attacking_Workstation <> ComputerName"
::LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SUBSTR(text,ADD(INDEX_OF(text,':'),2)) AS [DNS Name] FROM stdin WHERE text LIKE '%record name%' ORDER BY [DNS Name]"    <--WARNING: Input format not specified - using TEXTLINE input format.,System,Security
echo Daily Checks &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) AND EventType IN (4688;4656;4663)"
echo Daily SecChk %T LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE EventType IN (4688;4719;4624;4738;4672)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, TimeGenerated, SID into stdout FROM System"
LogParser -i:EVT -resolveSIDs ON "SELECT DISTINCT SID FROM security"
LogParser -i:EVT -resolveSIDs ON "SELECT SID AS Username, TimeGenerated AS LockoutTime FROM security WHERE EventID = 644 AND Username IN (SELECT SID AS subUserName FROM security WHERE EventID = 642 AND subUserName = Username AND TimeGenerated > LockoutTime)"
LogParser -i:EVT -resolveSIDs ON "SELECT SID FROM security WHERE SID LIKE '%smith%'"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID into stdout FROM System WHERE SourceName = 'Service Control Manager' and SID is not null"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID AS AppEvtID, EventTypeName, TimeGenerated, SID INTO stdout FROM Application"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID AS SecEvtID, EventTypeName, TimeGenerated, SID INTO stdout FROM security"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID AS SysEvtID, EventTypeName, TimeGenerated, SID INTO stdout FROM System"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID, EXTRACT_TOKEN(EventTypeName, 0,  ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID INTO stdout FROM System WHERE SourceName = 'Service Control Manager' and SID is not null"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID, EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID into stdout FROM System WHERE SourceName = 'Service Control Manager'"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID, EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID into stdout FROM System"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventTypeName,  TimeGenerated, SID INTO stdout FROM System"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' '), TO_DATE(TimeGenerated), SID INTO stdout FROM System"
LogParser -i:EVT -resolveSIDs:on -o:sql -server:localhost\sqlsrv2012 -database:AdventureWorks2012 -driver:"sql server" "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent,  TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID INTO ScmEvents FROM System WHERE SourceName = 'Service  Control Manager' and SID is not null"
LogParser -i:EVT -resolveSIDs:on -o:sql -server:localhost\sqlsrv2012 -database:AdventureWorks2012 -driver:"sql server" -clearTable:on "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS  TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID INTO ScmEvents FROM System WHERE SourceName =  'Service Control Manager' and SID is not null"
LogParser -i:EVT -resolveSIDs:on -o:sql -server:localhost\sqlsrv2012 -database:AdventureWorks2012 -driver:"sql server" -clearTable:on -createTable:on file:c:\dataFiles\evtquery.sql
LogParser -i:EVT -resolveSIDs:on -o:sql -server:localhost\sqlsrv2012 -database:AdventureWorks2012 -driver:"sql server" -clearTable:on -ignoreIdCols:on "SELECT EXTRACT_TOKEN(EventTypeName,  0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID INTO ScmEvents FROM System WHERE  SourceName = 'Service Control Manager' and SID is not null"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID BETWEEN 5024 AND 5037"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM '%IISLogs%\*.log' WHERE c-ip IN ('10.10.10.10';'10.10.10.0';'127.0.0.0')"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Application WHERE EventID = '$1'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Application WHERE EventID = '0'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '$1'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4727'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4379'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4660'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4624'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4657'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4663'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4672'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4704'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4705'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4706'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4730'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4767'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4798'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4799'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5038'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5137'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5138'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5139'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5140'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5141'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5142'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5143'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5144'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5145'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5154'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5155'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5156'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5157'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5158'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5159'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 1102"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 1125"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4648"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4656"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4657"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4670"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4776"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4782"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 5158"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 5447"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN '307'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (10000;10001)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1006;1007)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1008;1006;1116;1010;2003;2001;1009;1118;1119;1007;1117;3002;2004;1005;5008)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1009;20;24;25;31;34;35)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security,System WHERE EventID IN (106;140;4702;141;4699;4698;4700;4701)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (106;141;142;200)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1100;104;1102)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (112;1001;1125;1126;1127;1129)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (11;70;90)
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (13;12)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1509;1504)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (194;195;196;197;198;199;706;707;708;709;710;711)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1;2;160;161;192;240;514;523;524;755;769)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1;2;5;8;9)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (2009;2004;2005;2006;2033)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (214;215;216;217;721;722;723;724)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (21;24)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (225;226;227;228;737;738;739;740)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (242;243;244;245;771;772;773;774)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (3001;3002;3003;3004;3010;3023;5038;6281;219)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (3;7;10;11;12;13;146;213;519;522;525;565;568)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (400;410)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4097;4098;4103;4099)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4097;4098;4103;4099;4698;4701)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4624;4625)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4624;4634)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4657;1;4616)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4663;4660;4656;4658)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4672;4648;4624;4776;4624;4572)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4;5;14;513;517;561;724;744;1105;4876;4877;8194;8213)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4;5;8;9;14;17;18;19;20;21;22;49;50;52;100;513;517;518;521;527;528;544;545;546;561;564;612)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (5137;5141;5136;5139;5138;3008;3020)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (513;517;4876;4877;8213;12290;16387)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (5140;5142;5143;5144)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (5148;5149;4650;4651;4652;4653;4655;5451;5452;4654;4978;4979;4980;4981;4982;4983;4984;4963)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (5410;5142)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (5440;5441;5442;5443;5444;5446;5448;5449;5450;5153;5154;5155;5156;5157;5158;5159)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (5447;5152)" --> Very Large output
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (7022;7023;7024;7026;7031;7032;7034)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (800;169;4103;4104;4105;4106)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (8023;8020;8002;8003;8004;8006;8007;4688;4689;8005;865;866;867;868;882)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (80;132;143;166;81)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (903;904;6;1022;1033;7045;907;908;7000;800;2;905;906;19)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (95;4886;4890;4874;4873;4870;4887;4885;4899;4896;1006;1004;1007;1003;1001;1002)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (1936;1937;1938)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (4231;5154;5158)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (4231;5154;5158;861;26022;4625;1004;1960)"    <-- Port issues
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (4672;4624)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (4698;4699;4700;4701;4702)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (4946;4947;4950;4954;4964;5025;5031)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (5152;5153)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (528;4624;538;4634;4647)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (528;4624)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (538;4634;4647)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (538;4649;4624;4634;4647)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (592;4688;4689;4695;4692;9;11;5712;5829)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (6272;6273;6274;6275;6276;6277;6278;6279;6280)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )" >NUL
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID = '$1'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID = '51057'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID IN (0;1;2;3;4;7;1000;1524;1516;1517;7031;8001;8009;8019)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID IN (0;1;2;3;4;8;9;10;11;12) AND EventType = 1 AND EventCategory = 0 HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID IN (0;2;3;4;11;1000;12292;1524;1516;1517;7031;8001;8009;8019)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID IN (12290;16387;8194)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID IN (214;513;517;774;8213)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID NOT IN (1;10010;10028) AND TimeWritten > TO_LOCALTIME( SUB( SYSTEM_TIMESTAMP(), TIMESTAMP('0000-01-07', 'yyyy-MM-dd') ) ) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID NOT IN (1;7;7023;10005;10010;10028) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventType=1"
:: NOTE: TIMESTAMP('1', 'd') = 1 Day and TIMESTAMP('7', 'd') = 7 Days
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * INTO '%ohtm%\%CompuyerName%_dataoutput.txt' FROM System WHERE EventType=1 AND TimeWritten >= TO_LOCALTIME(SUB( SYSTEM_TIMESTAMP(), TIMESTAMP('10', 'd') ) )"&Notepad++ "%odl%\%CompuyerName%_dataoutput.txt"
:: Audit Account Logon events (672;44768;673;4769674;4770;676;672;4768;677;673;4769;678;4774;680;4776;681;4776;682;4778;683;4779)
echo Audit Account Logon events &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (672;44768;673;4769674;4770;676;672;4768;677;673;4769;678;4774;680;4776;681;4776;682;4778;683;4779)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4624;4634;4648;4656;4658;4660;4663;4672;4673;4688;4689;4698;4720;4768;4769;4946;5140;5142;5144;5145;5154;5156;5447;8222)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4714;4713;4769;6273;6275;6274;6272;6278;6277;6279;6276;6280;5140;5145;5142;5144;4706;1024;4897;4719;4716;4779;4778;5632)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE EventID IN (4740;4648;4781;4733;1518;4776;5376;5377;4625;300;4634;4672;4720;4722;4782;4793;4731;4735;4766;4765;4624;1511;4726;4725;4767;4728;4732;4756;4704)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4;5;8;9;14;17;18;19;20;21;22;49;50;52;100;513;517;518;521;527;528;544;545;546;561;564;612;724;744;1000;1105;4876;4877;8194;8213)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EventID FROM Application GROUP BY EventID ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EventID FROM Security GROUP BY EventID ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EventID FROM System GROUP BY EventID ORDER BY EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 0, '|') AS Servicename FROM System WHERE EventID = 7036 GROUP BY Servicename ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 1, '|') AS AcctName FROM Security WHERE EventID = 4648 GROUP BY AcctName ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 2, '|') AS rulename FROM Security WHERE EventID = 4946 GROUP BY rulename ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 2, '|') AS rulename FROM Security WHERE EventID = 4948 GROUP BY rulename ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 3, '|') AS Username FROM Security WHERE EventID = '5136' GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 4, '|') AS Domain FROM Security WHERE EventID = '5136' GROUP BY Domain ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') AS AcctUsed FROM Security WHERE EventID = 4648 GROUP BY AcctUsed ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 8, '|') AS objectdn FROM Security WHERE EventID = '5136' GROUP BY objectdn ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 10, '|') AS objectclass FROM Security WHERE EventID = '5136' GROUP BY objectclass ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 11, '|') AS objectattrib FROM Security WHERE EventID = '5136' GROUP BY objectattrib ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 13, '|') AS attribvalue FROM Security WHERE EventID = '5136' GROUP BY attribvalue ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) FROM System WHERE EventID IN (7;7031) AND EventType = 1 AND EventCategory = 0 GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(DISTINCT SourceName) FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT cs-Username, COUNT(*) AS Hits FROM '%IISLogs%\*.log' WHERE cs-Username IS NOT NULL GROUP BY cs-Username ORDER BY Hits Desc"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, EventTypeName, Message FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SID, RESOLVE_SID(SID) AS Username FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SID, RESOLVE_SID(SID) as Username FROM Security where EventID IN (529;530;531;532;533;534;535;537;539)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SID as Username FROM Security WHERE EventID BETWEEN 529 AND 539
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, ComputerName, COUNT(*) AS Total FROM System, application Group By EventID, ComputerName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, COUNT(*) INTO DATAGRID FROM System GROUP BY EventID ORDER BY EventID ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, message, COUNT(*) AS Total FROM System, application Group By EventID, message ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Warning event'
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('01-02', 'MM-dd')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('01-02', 'MM-dd')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*)  AS [Application], mul(COUNT(*),2) AS [System], mul(COUNT(*),3) AS [Securiy] FROM Application, System, Security group by EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*)  AS [Application], mul(COUNT(*),2) AS [System], mul(COUNT(*),3) AS [Securiy] FROM Application, System, Security group by EventTypeName HAVING EventTypeName = 'Warning event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) AS [Application], mul(COUNT(*),2) AS [System], mul(COUNT(*),3) AS [Securiy] FROM Application, System, Security group by EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Information event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Information event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Success event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Warning event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Warning event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application, Security, System GROUP BY EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM OAlerts GROUP BY EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Security GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Security GROUP BY EventTypeName HAVING EventTypeName = 'Information event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Security GROUP BY EventTypeName HAVING EventTypeName = 'Warning event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Security GROUP BY EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM System GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM System GROUP BY EventTypeName HAVING EventTypeName = 'Information event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM System GROUP BY EventTypeName HAVING EventTypeName = 'Warning event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM System GROUP BY EventTypeName"
:: Event ID 102: This event is logged when the event logging service encounters an error while processing an incoming event from a publisher. It often indicates a problem with the event provider registration2.
:: Event ID 201: This event indicates that a connection to the Windows Metadata and Internet Services (WMIS) could not be established.
:: Event ID 110: This event is logged when Active Directory Certificate Services (AD CS) fails to initialize performance counters.
:: Event ID 200: This event is logged when a connection to the Windows Update service could not be established.
:: Event ID 100: This event indicates that a license installation failed for a specific license type.
:: Event ID 129: This event is logged when a driver fails to load due to an invalid signature.
:: Event ID 2050: This event is logged when the task scheduler successfully finishes an instance of a task
:: For Today- AND date='%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00' GROUP BY date, hour"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, to_date(TimeGenerated) AS Date, Count(*) AS Number_of_Events FROM Application,Security,System WHERE EventID IN (100;101;102;110;119;129;140;200;201;203;2050) GROUP BY EventID,Date ORDER BY Date"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, to_date(TimeGenerated) AS Date, quantize(to_time(TimeGenerated), 3600) AS Hour, Count(*) AS Number_of_Events FROM Application,Security,System WHERE EventID IN (100;101;102;110;119;129;140;200;201;203;2050) GROUP BY date, hour, EventID"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, to_date(TimeGenerated) AS Date, quantize(to_time(TimeGenerated), 3600) AS Hour, Count(*) AS Number_of_Events FROM Application,Security,System WHERE EventID IN (100;101;102;110;119;129;140;200;201;203;2050) GROUP BY date, hour, EventID"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT to_date(TimeGenerated) AS Date, EventID, COUNT(*) AS NumEvents FROM Application,Security,System WHERE EventID IN (100;101;102;110;119;129;140;200;201;203;2050) AND to_date(TimeGenerated) = '%date:~-4%-%date:~-10,2%-%date:~-7,2% 00:00:00' GROUP BY EventID,Date"
:: List All Scheduled task Events in Detail: (100;101;102;110;119;129;140;200;201;203;2050)
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT resolve_sid(sid) AS UserName, eventid, TimeGenerated, message, strings FROM Application,Security,System WHERE EventID IN (100;101;102;110;119;129;140;200;201;203;2050)"
:: Note 'Microsoft-Windows-TaskScheduler%4Operational.evtx' = System
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS taskname, COUNT(*) AS Cntr FROM System WHERE EventID IN (140;141) GROUP BY taskname ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS User, COUNT(*) AS Cntr FROM System WHERE EventID IN (140;141) GROUP BY User ORDER BY Cntr DESC"
:: Note: 'Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx' = System
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, COUNT(*) AS Cntr FROM System,Security WHERE EventID IN (3;21;4624;4678;4768;4769;4776;4771;4762;4768;6005) GROUP BY Domain,EventID ORDER BY Cntr DESC"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS User, COUNT(*) AS Cntr FROM System,Security WHERE EventID IN (21;4768;4769;4776;4771) GROUP BY User ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 2, '|') AS Domain, COUNT(*) AS Cntr FROM System,Security WHERE EventID IN (21;4768;4769;4776;4771) GROUP BY Domain ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS Username, COUNT(*) AS Cntr FROM System,Security WHERE EventID IN (21;4768;4769;4776;4771) GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 2, '|') AS Service, COUNT(*) AS Cntr FROM System,Security WHERE EventID IN (21;4768;4769;4776;4771) GROUP BY Service ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 5, '|') AS Cipher, COUNT(*) AS Cntr FROM System,Security WHERE EventID IN (21;4768;4769;4776;4771) GROUP BY Cipher ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 6, '|') AS Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY Domain ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 7, '|') AS Cipher, COUNT(*) AS Cntr FROM Security WHERE EventID = 4768 GROUP BY Cipher ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 8, '|') AS SrcIp, EXTRACT_TOKEN(Strings,13,'|') AS DstIp, COUNT(*) AS ConCount FROM Security WHERE EventID = 3 group by SrcIp, DstIp ORDER BY ConCount desc"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY AuthPackage ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY Workstation ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 17, '|') AS ProcName, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY ProcName ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT QUANTIZE(TimeGenerated, 3600) AS Time, COUNT(*) AS Number_of_Events INTO Startup.gif FROM System WHERE EventID= '6005' GROUP BY Time ORDER BY Number_of_Events"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT QUANTIZE(TimeGenerated, 600) AS TimeFrame, TimeGenerated, eventtype, eventtypename, message FROM Security WHERE timeframe= ( SELECT QUANTIZE(TimeGenerated, 600) FROM Security  WHERE eventtype<>8 )"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS Date, EventID, message AS Message FROM System WHERE EventID IN (100;102;110;129;140;200;201) ORDER BY Date, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM Application WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM Application, Security, Application, System WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM Security WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM System GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM System WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] INTO results.csv FROM Application WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] INTO results.csv FROM Application WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC" -o:datagrid
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT resolve_sid(sid) AS UserName, EventID, TimeGenerated FROM Security WHERE EventID IN (4624;4634) AND TO_DATE(TimeGenerated)='2004-09-06 00:00:00' AND sid not in (SELECT DISTINCT sid  FROM Security  WHERE EventID IN (4647;4634;4635) AND TO_DATE(TimeGenerated)='2021-06-07 00:00:00' )"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName AS Name, EventID AS ID, COUNT(*) AS number_of_events FROM System WHERE SUB(TO_INT(TimeGenerated), TO_INT(SYSTEM_TIMESTAMP())) > -2592000 AND sourcename not in ('Print';'MRxSmb';'w32time';'TermServDevices') GROUP BY ID, Name HAVING number_of_events > 1 ORDER BY number_of_events desc"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, COUNT(*) AS Cntr FROM Security GROUP BY EventID ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, MUL(PROPCOUNT(*) ON (SourceName), 100.0) AS Percent FROM Security GROUP BY SourceName, EventID ORDER BY SourceName, Percent DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, MUL(PROPCOUNT(*) ON (SourceName), 100.0) AS Percent FROM System GROUP BY SourceName, EventID ORDER BY SourceName, Percent DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, Message INTO "%ohtm%\%ComputerName%_Application.tsv" FROM Application"   <-- Produces tons of data
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, TimeGenerated, EventID FROM System WHERE  TimeGenerated > SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-03 00:00:00', 'yyyy-MM-dd h"H:mm:ss')"       Error: Syntax Error: <function-expr>: cannot find closing parenthesis for function SUB
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SUBSTR(Message, 0, INDEX_OF(Message, ':')) AS Description FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0 , '|') AS User, EXTRACT_TOKEN(Strings, 6 , '|') AS SourceIP FROM Security WHERE EventID = 4771 AND User NOT LIKE '%$'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS addedUser, EXTRACT_TOKEN(Strings, 2, '|') AS togroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoadded, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4728'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS addedUser, EXTRACT_TOKEN(Strings, 2, '|') AS togroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoadded, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4732'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS addedUser, EXTRACT_TOKEN(Strings, 2, '|') AS togroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoadded, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4756'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS createdgroup, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4731"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS createdgroup, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4754"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS createdUser, EXTRACT_TOKEN(Strings, 1, '|') AS createdDomain, EXTRACT_TOKEN(Strings, 4, '|') AS whocreated, EXTRACT_TOKEN(Strings, 5, '|') AS whoDomain FROM Security WHERE EventID = '4720'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS deletedUser, EXTRACT_TOKEN(Strings, 1, '|') AS deletedDomain, EXTRACT_TOKEN(Strings, 4, '|') AS whodeleted, EXTRACT_TOKEN(Strings, 5, '|') AS whoDomain FROM Security WHERE EventID = '4726'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS newname, EXTRACT_TOKEN(Strings, 1, '|') AS oldname, EXTRACT_TOKEN(Strings, 2, '|') AS accDomain, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain FROM Security WHERE EventID = 4781"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS removedUser, EXTRACT_TOKEN(Strings, 2, '|') AS FROMgroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoremoved, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4729'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS removedUser, EXTRACT_TOKEN(Strings, 2, '|') AS FROMgroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoremoved, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4733'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS removedUser, EXTRACT_TOKEN(Strings, 2, '|') AS FROMgroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoremoved, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4757'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS Servicename FROM System WHERE EventID = 7036"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS ServiceName, EXTRACT_TOKEN(Strings, 1, '|') AS ServicePath, EXTRACT_TOKEN(Strings, 4, '|') AS ServiceUser FROM System WHERE EventID = 7045"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS taskname, EXTRACT_TOKEN(Strings, 1, '|') AS User FROM System WHERE EventID = 141"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 2, '|') AS Service, EXTRACT_TOKEN(Strings, 5, '|') AS Cipher, EXTRACT_TOKEN(Strings, 6, '|') AS SourceIP FROM Security WHERE EventID = 4769"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4722"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4723"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4724"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4725"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 7, '|') AS Cipher, EXTRACT_TOKEN(Strings, 9, '|') AS SourceIP FROM Security WHERE EventID = 4768"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS workstation, EXTRACT_TOKEN(Strings, 4, '|') AS wholocked, EXTRACT_TOKEN(Strings, 5, '|') AS whoDomain FROM Security WHERE EventID = '4740'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 2, '|') AS SourceIP FROM System WHERE EventID = 21 AND User LIKE '%Administrator%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 2, '|') AS SourceIP FROM System WHERE EventID = 21"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS Username, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 3, '|') AS SourceIP FROM Security WHERE EventID = 4825"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS AcctName, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS AcctUsed, EXTRACT_TOKEN(Strings, 6, '|') AS DomainUsed, EXTRACT_TOKEN(Strings, 8, '|') AS TargetServer, EXTRACT_TOKEN(Strings, 9, '|') AS ExtraData, EXTRACT_TOKEN(Strings, 11, '|') AS ProcName, EXTRACT_TOKEN(Strings, 12, '|') AS SourceIP FROM Security WHERE EventID = 4648 AND AcctUsed = 'BobMaars'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS AcctName, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS AcctUsed, EXTRACT_TOKEN(Strings, 6, '|') AS DomainUsed, EXTRACT_TOKEN(Strings, 8, '|') AS TargetServer, EXTRACT_TOKEN(Strings, 9, '|') AS ExtraData, EXTRACT_TOKEN(Strings, 11, '|') AS ProcName, EXTRACT_TOKEN(Strings, 12, '|') AS SourceIP FROM Security WHERE EventID = 4648 AND AcctUsed = 'BobMaars'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS AcctName, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS AcctUsed, EXTRACT_TOKEN(Strings, 6, '|') AS DomainUsed, EXTRACT_TOKEN(Strings, 8, '|') AS TargetServer, EXTRACT_TOKEN(Strings, 9, '|') AS ExtraData, EXTRACT_TOKEN(Strings, 11, '|') AS ProcName, EXTRACT_TOKEN(Strings, 12, '|') AS SourceIP FROM Security WHERE EventID = 4648"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS User, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 6, '|') AS whichDomain FROM Security WHERE EventID = 4738"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4634 AND Domain NOT IN ('NT AUTHORITY')"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4672 AND Domain NOT IN ('NT AUTHORITY')
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4672 AND Domain NOT IN ('NT AUTHORITY') AND Username = 'Administrator'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4776 AND Domain NOT IN ('NT AUTHORITY') AND Username NOT LIKE '%$' AND Username = 'BobMaars'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4776 AND Domain NOT IN ('NT AUTHORITY') AND Username NOT LIKE '%$'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 AND Process LIKE '%rundll32.exe%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 AND Username = 'BobMaars'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Workstation FROM Security WHERE EventID = '1102'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS rulename FROM Security WHERE EventID = 4946"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS rulename FROM Security WHERE EventID = 4948"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS whichgroup, EXTRACT_TOKEN(Strings, 3, '|') AS Domaingroup, EXTRACT_TOKEN(Strings, 6, '|') AS who, EXTRACT_TOKEN(Strings, 7, '|') AS workstation FROM Security WHERE EventID = 4734"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS whichgroup, EXTRACT_TOKEN(Strings, 3, '|') AS Domaingroup, EXTRACT_TOKEN(Strings, 6, '|') AS who, EXTRACT_TOKEN(Strings, 7, '|') AS workstation FROM Security WHERE EventID = 4758"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 3, '|') AS Username, EXTRACT_TOKEN(Strings, 4, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS objectdn, EXTRACT_TOKEN(Strings, 10, '|') AS objectclass, EXTRACT_TOKEN(Strings, 11, '|') AS objectattrib, EXTRACT_TOKEN(Strings, 13, '|') AS attribvalue FROM Security WHERE EventID = '5136'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS User, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 1, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 2, '|') AS whichDomain FROM Security WHERE EventID = 4742"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EventID, ComputerName, Message, Data FROM System WHERE EventID IN (4;5;8;9;14;17;18;19;20;21;22;49;50;52;100;513;517;518;521;527;528;544;545;546;561;564;612) ORDER BY EventTime, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EventID, message AS Message FROM System WHERE EventID IN (100;102;110;129;140;200;201) ORDER BY EventTime, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EventID, message AS Message FROM System WHERE EventID IN (4;5;8;9;14;17;18;19;20;21;22;49;50;52;100;513;517;518;521;527;528;544;545;546;561;564;612) ORDER BY EventTime, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE EventID= '4688'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated FROM Security WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) AND ( EventID = '4656' ) AND ( Message LIKE '%%bob%%' )"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated FROM System WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) AND ( EventID = '4656' ) AND ( Message LIKE '%%sam%%' )" > %odl%\EventID-4656.txt & Notepad++ %odl%\EventID-4656.txt
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, message FROM Security WHERE EventID=520"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventTypeName, SourceName FROM System WHERE ( SourceName = 'Service Control Manager' AND EventID >= 7024)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, message, SourceName FROM System WHERE ( SourceName = 'Service Control Manager' AND EventID >= 7024)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID FROM Security WHERE EventID = 4624" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID FROM Security WHERE EventID = 4688" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, EXTRACT_TOKEN(Strings,1,'|') AS Domain, EXTRACT_TOKEN(Strings,0,'|') AS User, EXTRACT_TOKEN(Strings,3,'|') AS SessionName, EXTRACT_TOKEN(Strings,4,'|') AS ClientName, EXTRACT_TOKEN(Strings,5,'|') AS ClientAddress, EventID FROM Security WHERE EventID IN (21;22;24;25;29;40;682;1146;1147;1148;4624;4625;4478;4479) ORDER BY TimeGenerated" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Application WHERE EventID = 999" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Application WHERE EventID IN (4625;4634;4776;4648;4672)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Application WHERE EventID IN (8194;8216;8300;8301;8302)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Security WHERE EventID IN (4624;4625;4776;4720;4732;4728;7030;7040)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Security WHERE EventID IN (4648)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Security WHERE EventID IN (608;4616;4624;4634;4648;4672;4688;4720;4722;4724;4826;5024;5033;5058;5061;6005;6006;6008;6013;1100;1102)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (20001;20003)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (24576;24577;24578;24579)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (4000;4001;4003;6100)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (44;43;19;20)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID, Message FROM Application WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventID IN (520;530;533;539;590;591;592;593;594;598;599) AND Name IN ('XCopy';'RoboCopy') ORDER BY TimeGenerated ASC" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID, Message FROM Security WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventID IN (1125;1102;4670;4672;4648;4624;4776;4624;4572) ORDER BY TimeGenerated ASC" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventID = 528 AND SID LIKE '%UserName%'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventID BETWEEN 4945 AND 5031"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventID BETWEEN 4945 AND 5031" >NUL
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventType IN (528;4624;538;4634;4647) AND SID LIKE '%UserName%'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message INTO report.txt FROM Security WHERE EventID = 528 AND SID LIKE '%UserName%'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM %ComputerName% WHERE TimeGenerated > '2021-05-01 00:00:00' AND EventType IN (1;2) ORDER BY TimeGenerated DESC" -o:CSV -q:ON -stats:On >> %ohtm%\%ComputerName%_Events.csv
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Application WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventType IN (1;2) ORDER BY TimeGenerated DESC" -o:CSV -q:ON -stats:On >> %ohtm%\%ComputerName%_24hrApp-Evts.csv &Notepad++ %ohtm%\%ComputerName%_24hrApp-Evts.csv
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Application WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventType IN (1;2) ORDER BY TimeGenerated DESC" -q:ON -stats:On
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,Message,EventID  FROM System TO %odl%\event.xml WHERE EventID=420 AND TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('11-11', 'MM-dd'))) ORDER BY EventID"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 10 * FROM System ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT top 100 * FROM %lpl% "
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 * FROM Application"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 * FROM Security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 * FROM System"
LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -chartType:Column3D -groupSize:1024x768 "SELECT TOP 100 cs-uri-stem, COUNT(*) AS Hits INTO"%odl%\IISW3C-Chart.gif" FROM  <www.margiestravel.com> GROUP BY cs-uri-stem ORDER BY Hits DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:59', 'yyyy-MM-dd HH:mm')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:59', 'yyyy-MM-dd HH:mm')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 Path, Name, Size, Attributes FROM '%OneDrive%\*.*' ORDER BY Size DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 SourceName, COUNT(*) AS Total FROM Application GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 SourceName, COUNT(*) AS Total FROM Security GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 SourceName, COUNT(*) AS Total FROM System GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 999 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 999 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:59', 'yyyy-MM-dd HH:mm')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_DATE(TimeGenerated) AS DateGenerated, TO_UPPERCASE( EXTRACT_TOKEN(EventTypeName, 0, ' ') ) AS TypeName, SourceName FROM System" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_DATE(TimeGenerated), TO_UPPERCASE( EXTRACT_TOKEN(EventTypeName, 0, ' ') ) AS TypeName, SourceName FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_STRING(TO_TIMESTAMP(EXTRACT_PREFIX(REPLACE_STR([#Fields: Datetime],'T',' '),0,'.'), 'yyyy-MM-dd h"H:mm:ss'),'yyMMdd') AS Day" --> Error: detected extra argument "AS" after query
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT UserName, COUNT(*) AS Total USING EXTRACT_TOKEN( Strings, 0, '|' ) AS UserName, EXTRACT_TOKEN( Strings, 1, '|' ) AS MachineName FROM System WHERE EventID IN (644) GROUP BY UserName ORDER BY Total"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID into stdout FROM System WHERE SourceName = 'Service Control Manager'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID into stdout FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID INTO stdout FROM System WHERE SourceName = 'Service Control Manager' and SID is not null
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Application WHERE EventType = 1 AND EventCategory = 0  AND TimeWritten > TO_LOCALTIME( SUB( SYSTEM_TIMESTAMP(), TIMESTAMP('0000-01-07', 'yyyy-MM-dd') ) ) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4688"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType = 1 AND EventCategory = 0  AND TimeWritten > TO_LOCALTIME( SUB( SYSTEM_TIMESTAMP(), TIMESTAMP('0000-01-07', 'yyyy-MM-dd') ) ) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) HAVING EventID = 4672"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) HAVING EventID = 4688"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID NOT IN (1;7;7023;10005;10010;10028) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventType = 1 AND EventCategory = 0  AND TimeWritten > TO_LOCALTIME( SUB( SYSTEM_TIMESTAMP(), TIMESTAMP('0000-01-07', 'yyyy-MM-dd') ) ) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 1, '|') AS Username FROM Security WHERE EventID = 4688 GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 GROUP BY Process ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT RESOLVE_SID(Sid) AS Account FROM Security WHERE EventID IN (540;528)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, TimeGenerated, SID INTO stdout FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE EventID= '4688'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE EventType IN (4688;4672)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, EventTypeName, SourceName, message AS Message FROM System WHERE ( SourceName = 'Service Control Manager' AND EventID >= 7024)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID BETWEEN 19 AND 25"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (44;43;19;20)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventID IN (528;4624;4625;4634) AND SID LIKE'%BobMaars%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Application WHERE TimeGenerated > '2021-06-07 00:00:00' AND EventType IN (1;2) ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Security WHERE TimeGenerated > '2021-06-07 00:00:00' AND EventType IN (1;2) ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM System WHERE TimeGenerated > '2021-06-07 00:00:00' AND EventType IN (1;2) ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 150 EXTRACT_TOKEN(EventTypeName, 0, ' '), TO_DATE(TimeGenerated), SID INTO stdout FROM System"
LogParser -i:EVT -rtp:-1 -o:datagrid -rtp:-1 -o:datagrid -resolveSIDs:ON "SELECT SourceName, EventID, MUL(PROPCOUNT(*) ON (SourceName),100.0) AS Percent FROM System GROUP BY SourceName, EventID ORDER BY SourceName, Percent DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM Application GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM Security GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM System WHERE EventType = 1 OR EventType = 2 GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SUBSTR(Message, 0, INDEX_OF(Message, ':')) AS Description  FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) AS [Number of events] FROM System group by EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, COUNT(*) AS [NumEvents] FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, EXTRACT_TOKEN(Strings,0,'|') AS User, EXTRACT_TOKEN(Strings,3,'|') AS Type FROM Security WHERE  (EventID = 540) AND (Type LIKE '3') ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventLog, SourceName, ComputerName, SID, EventTypeName, EventID, EventType, EventCategory, Message FROM System WHERE EventID IN (19;20) AND Message LIKE '%KB5005033%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 * FROM application WHERE EventID=1053"
LogParser -i:EVT -rtp:-1 -o:nat "SELECT EventTypeName, TimeGenerated, SID into stdout FROM System"
LogParser -i:EVT -rtp:-1 -resolveSIDs:on-o:datagrid "SELECT * FROM Application WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )"
LogParser -i:EVT -rtp:-1 -resolveSIDs:on-o:datagrid "SELECT * FROM Security WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )"
LogParser -i:EVT -rtp:-1 -resolveSIDs:on-o:datagrid "SELECT * FROM System WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )"
LogParser -i:EVT -rtp:-1 -stats:On -o:NAT "SELECT TimeGenerated, Sourcename FROM Security"
LogParser -i:EVT -stats:On "SELECT TypeName, COUNT(*) AS TotalCount USING TO_UPPERCASE( EXTRACT_TOKEN(EventTypeName, 0, ' ') ) AS TypeName INTO %csv% FROM System WHERE TypeName LIKE '%Service%' GROUP BY TypeName HAVING TotalCount > 5 ORDER BY TotalCount DESC" & Notepad++ %csv%
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,  EventID, EventTypeName, SourceName, message AS Message FROM System WHERE ( SourceName = 'Service Control Manager' AND EventID >= 7024)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Application WHERE LogParser -o:SYSLOG -severity:$MySeverity -hostName:$MyHostname "SELECT TO_TIMESTAMP(Date,time), CASE sc-status WHEN 500 THEN 'emerg' ELSE 'err' END AS MySeverity, s-computername AS MyHostname, cs-uri-stem INTO @myserver FROM '%IISLogs%\*.log' WHERE sc-status >= 400"
TimeGenerated > '2021-06-07 00:00:00' AND EventType IN (1;2) ORDER BY TimeGenerated DESC"
LogParser -objClass:User "SELECT title, MUL(PROPCOUNT(*), 100.0) AS Percentage INTO DATAGRID FROM 'LDAP://BobMaars:Alt+'@Village/CN=Users,DC=myDomain,DC=com' WHERE title IS NOT NULL GROUP BY title ORDER BY Percentage DESC"
LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT * FROM System WHERE EventID IN (41;1074;6006;6008)"
LogParser -objClass:Group "SELECT cn, member into tmpAdGroups.csv FROM LDAP://village.ddns.me"
echo Computer Uptimes $T LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT * FROM System WHERE EventID IN (6008;6009)"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM Application GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM Security GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM System WHERE EventType = 1 OR EventType = 2 GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) AS [Number of events] FROM System group by EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS taskname, COUNT(*) AS Cntr FROM System WHERE EventID = 100 GROUP BY taskname ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS taskaction, COUNT(*) AS Cntr FROM System WHERE EventID = 200 GROUP BY taskaction ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, COUNT(*) AS [NumEvents] FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SUBSTR(Message, 0, INDEX_OF(Message, ':')) AS Description FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS taskname, EXTRACT_TOKEN(Strings, 1, '|') AS User FROM System WHERE EventID = 140"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings,0, '|') AS taskname, EXTRACT_TOKEN(Strings, 1, '|') AS taskaction FROM System WHERE EventID = 200"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings,0, '|') AS taskname, EXTRACT_TOKEN(Strings, 1, '|') AS Username FROM System WHERE EventID = 100"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated FROM Security WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) AND EventID IN (32000;32002;31017;31018) AND Message LIKE '%bob%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, EXTRACT_TOKEN(Strings,0,'|') AS User, EXTRACT_TOKEN(Strings,3,'|') AS Type FROM Security WHERE  (EventID = 540) AND (Type LIKE '3') ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 * FROM application WHERE EventID=1053"
LogParser -rtp:-1 -o:datagrid -stats:On -resolveSIDs:ON "SELECT DISTINCT TimeGenerated, EventLog, SourceName, ComputerName, SID, EventTypeName, EventID, EventType, EventCategory, Message FROM System WHERE EventID IN (19;20)"
LogParser -rtp:-1 -o:datagrid -stats:On -resolveSIDs:ON "SELECT..."
LogParser -TPL:"%OneDrive%\Log Parser 2.2\LP-AppPool.tpl" "SELECT TimeGenerated,EventTypeName,Strings,Message INTO %ohtm%\%ComputerName%_LP-AppPool.html FROM System WHERE SourceName = 'WAS' and Message LIKE '%ApplicationName%'"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM tcpip WHERE EventID = '4199'"
echo WINS &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Wins WHERE EventType IN (4102;4243;4242;4286)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * INTO stdout FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * INTO Trace.csv FROM myFile.etl"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
::-------------------------------------------------------------------------------------------------
:: ------------------------------ LogParser Other Chart working Examples --------------------------
::-------------------------------------------------------------------------------------------------
echo System Errors &LogParser -rtp:-1 -o:datagrid -resolveSIDs:ON EVT "SELECT TimeGenerated, EventLog, EventID, EventType, EventCategory, EventTypeName, SourceName, ComputerName, SID, Message FROM System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Error event'"
echo Chart Security Counts by Day &LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% Daily Security Line" "SELECT TimeGenerated AS Date,COUNT(*) AS Counts INTO %ohtm%\%ComputerName%_SecurityCounts.gif FROM Security GROUP BY Date ORDER BY Date"
echo Chart System Counts by Day &LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% SourceName Column3D" "SELECT SourceName, COUNT(*) AS [NumEvents] INTO %ohtm%\%ComputerName%_Column3D.gif FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
echo Chart System Counts by Day &LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% SourceName Column3D" "SELECT SourceName, COUNT(*) AS [NumEvents] INTO %ohtm%\%ComputerName%_Column3D.gif FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
echo Chart Security Counts by Day &LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% SourceName Column3D" "SELECT SourceName, COUNT(*) AS [NumEvents] INTO %ohtm%\%ComputerName%_Column3D.gif FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
echo Chart Security Counts by Day &LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Security Line" "SELECT TimeGenerated AS Date,COUNT(*) AS Counts INTO %ohtm%\%ComputerName%_SecurityCounts.gif FROM Security GROUP BY Date ORDER BY Date"

:: Error: Syntax Error: <FROM-clause>: expecting FROM keyword instead of token 'STRCAT(EXTRACT_TOKEN(Strings,' - LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT TimeGenerated STRCAT(EXTRACT_TOKEN(Strings, 1, '|'), STRCAT('\\',EXTRACT_TOKEN(Strings, 0, '|'))) AS User, [ComputerName] AS TgtComp, EXTRACT_TOKEN(Strings,5,'|') AS [Attacking_Machine] FROM Security WHERE EventType = 16 AND EventCategory = 2 AND Attacking_Workstation <> ComputerName"
::LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SUBSTR(text,ADD(INDEX_OF(text,':'),2)) AS [DNS Name] FROM stdin WHERE text LIKE '%record name%' ORDER BY [DNS Name]"    <--WARNING: Input format not specified - using TEXTLINE input format.
echo BobM Special Events &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID BETWEEN 528 AND 547"
echo Daily Checks &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) AND EventType IN (4688;4656;4663)"
echo Daily SecChk %T LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE EventType IN (4688;4719;4624;4738;4672)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, TimeGenerated, SID into stdout FROM System"
LogParser -i:EVT -resolveSIDs ON "SELECT DISTINCT SID FROM security"
LogParser -i:EVT -resolveSIDs ON "SELECT SID AS Username, TimeGenerated AS LockoutTime FROM security WHERE EventID = 644 AND Username IN (SELECT SID AS subUserName FROM security WHERE EventID = 642 AND subUserName = Username AND TimeGenerated > LockoutTime)"
LogParser -i:EVT -resolveSIDs ON "SELECT SID FROM security WHERE SID LIKE '%smith%'"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID into stdout FROM System WHERE SourceName = 'Service Control Manager' and SID is not null"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID AS AppEvtID, EventTypeName, TimeGenerated, SID INTO stdout FROM Application"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID AS SecEvtID, EventTypeName, TimeGenerated, SID INTO stdout FROM security"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID AS SysEvtID, EventTypeName, TimeGenerated, SID INTO stdout FROM System"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID, EXTRACT_TOKEN(EventTypeName, 0,  ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID INTO stdout FROM System WHERE SourceName = 'Service Control Manager' and SID is not null"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID, EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID into stdout FROM System WHERE SourceName = 'Service Control Manager'"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventID, EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID into stdout FROM System"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EventTypeName,  TimeGenerated, SID INTO stdout FROM System"
LogParser -i:EVT -resolveSIDs:on-o:datagrid -rtp:50 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' '), TO_DATE(TimeGenerated), SID INTO stdout FROM System"
LogParser -i:EVT -resolveSIDs:on -o:sql -server:localhost\sqlsrv2012 -database:AdventureWorks2012 -driver:"sql server" "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent,  TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID INTO ScmEvents FROM System WHERE SourceName = 'Service  Control Manager' and SID is not null"
LogParser -i:EVT -resolveSIDs:on -o:sql -server:localhost\sqlsrv2012 -database:AdventureWorks2012 -driver:"sql server" -clearTable:on "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS  TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID INTO ScmEvents FROM System WHERE SourceName =  'Service Control Manager' and SID is not null"
LogParser -i:EVT -resolveSIDs:on -o:sql -server:localhost\sqlsrv2012 -database:AdventureWorks2012 -driver:"sql server" -clearTable:on -createTable:on file:c:\dataFiles\evtquery.sql
LogParser -i:EVT -resolveSIDs:on -o:sql -server:localhost\sqlsrv2012 -database:AdventureWorks2012 -driver:"sql server" -clearTable:on -ignoreIdCols:on "SELECT EXTRACT_TOKEN(EventTypeName,  0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID INTO ScmEvents FROM System WHERE  SourceName = 'Service Control Manager' and SID is not null"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID BETWEEN 5024 AND 5037"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM '%IISLogs%\*.log' WHERE c-ip IN ('10.10.10.10';'10.10.10.0';'127.0.0.0')"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Application WHERE EventID = '$1'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Application WHERE EventID = '0'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '$1'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4727'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4379'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4624'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4657'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4663'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4672'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4704'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4705'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4706'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4730'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4767'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4798'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '4799'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5038'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5137'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5138'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5139'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5140'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5141'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5142'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5143'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5144'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5145'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5154'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5155'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5156'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5157'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5158'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5159'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 1102"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 1125"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4648"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4656"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4657"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4670"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4776"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4782"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 5158"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 5447"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN '307'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (10000;10001)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1000;1002;1001)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1006;1007)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1008;1006;1116;1010;2003;2001;1009;1118;1119;1007;1117;3002;2004;1005;5008)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1009;20;24;25;31;34;35)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (106;140;4702;141;4699;4698;4700;4701)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (106;141;142;200)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1100;104;1102)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (112;1001;1125;1126;1127;1129)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (11;70;90)
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (13;12)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1509;1504)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (194;195;196;197;198;199;706;707;708;709;710;711)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1;2;160;161;192;240;514;523;524;755;769)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1;2;5;8;9)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (2009;2004;2005;2006;2033)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (214;215;216;217;721;722;723;724)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (21;24)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (225;226;227;228;737;738;739;740)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (242;243;244;245;771;772;773;774)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (3001;3002;3003;3004;3010;3023;5038;6281;219)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (3;7;10;11;12;13;146;213;519;522;525;565;568)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (400;410)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4097;4098;4103;4099)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4097;4098;4103;4099;4698;4701)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4624;4625)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4624;4634)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4657;1;4616)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4663;4660;4656;4658)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4672;4648;4624;4776;4624;4572)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4;5;14;513;517;561;724;744;1105;4876;4877;8194;8213)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4;5;8;9;14;17;18;19;20;21;22;49;50;52;100;513;517;518;521;527;528;544;545;546;561;564;612)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (5137;5141;5136;5139;5138;3008;3020)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (513;517;4876;4877;8213;12290;16387)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (5140;5142;5143;5144)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (5148;5149;4650;4651;4652;4653;4655;5451;5452;4654;4978;4979;4980;4981;4982;4983;4984;4963)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (5410;5142)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (5440;5441;5442;5443;5444;5446;5448;5449;5450;5153;5154;5155;5156;5157;5158;5159)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (7022;7023;7024;7026;7031;7032;7034)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (800;169;4103;4104;4105;4106)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (8023;8020;8002;8003;8004;8006;8007;4688;4689;8005;865;866;867;868;882)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (80;132;143;166;81)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (903;904;6;1022;1033;7045;907;908;7000;800;2;905;906;19)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (95;4886;4890;4874;4873;4870;4887;4885;4899;4896;1006;1004;1007;1003;1001;1002)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (1936;1937;1938)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (4231;5154;5158)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (4231;5154;5158;861;26022;4625;1004;1960)"    <-- Port issues
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (4672;4624)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (4698;4699;4700;4701;4702)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (4946;4947;4950;4954;4964;5025;5031)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (5152;5153)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (528;4624;538;4634;4647)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (528;4624)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (538;4634;4647)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (538;4649;4624;4634;4647)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (592;4688;4689;4695;4692;9;11;5712;5829)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (6272;6273;6274;6275;6276;6277;6278;6279;6280)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )" >NUL
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID = '$1'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID = '51057'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID IN (0;1;2;3;4;7;1000;1524;1516;1517;7031;8001;8009;8019)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID IN (0;1;2;3;4;8;9;10;11;12) AND EventType = 1 AND EventCategory = 0 HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID IN (0;2;3;4;11;1000;12292;1524;1516;1517;7031;8001;8009;8019)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID IN (12290;16387;8194)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID IN (214;513;517;774;8213)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID NOT IN (1;10010;10028) AND TimeWritten > TO_LOCALTIME( SUB( SYSTEM_TIMESTAMP(), TIMESTAMP('0000-01-07', 'yyyy-MM-dd') ) ) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID NOT IN (1;7;7023;10005;10010;10028) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventType=1"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4624;4634;4648;4656;4658;4660;4663;4672;4673;4688;4689;4698;4720;4768;4769;4946;5140;5142;5144;5145;5154;5156;5447;8222)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4714;4713;4769;6273;6275;6274;6272;6278;6277;6279;6276;6280;5140;5145;5142;5144;4706;1024;4897;4719;4716;4779;4778;5632)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE EventID IN (4740;4648;4781;4733;1518;4776;5376;5377;4625;300;4634;4672;4720;4722;4782;4793;4731;4735;4766;4765;4624;1511;4726;4725;4767;4728;4732;4756;4704)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (4;5;8;9;14;17;18;19;20;21;22;49;50;52;100;513;517;518;521;527;528;544;545;546;561;564;612;724;744;1000;1105;4876;4877;8194;8213)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EventID FROM Application GROUP BY EventID ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EventID FROM Security GROUP BY EventID ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EventID FROM System GROUP BY EventID ORDER BY EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 0, '|') AS Servicename FROM System WHERE EventID = 7036 GROUP BY Servicename ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 1, '|') AS AcctName FROM Security WHERE EventID = 4648 GROUP BY AcctName ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 2, '|') AS rulename FROM Security WHERE EventID = 4946 GROUP BY rulename ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 2, '|') AS rulename FROM Security WHERE EventID = 4948 GROUP BY rulename ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 3, '|') AS Username FROM Security WHERE EventID = '5136' GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 4, '|') AS Domain FROM Security WHERE EventID = '5136' GROUP BY Domain ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') AS AcctUsed FROM Security WHERE EventID = 4648 GROUP BY AcctUsed ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 8, '|') AS objectdn FROM Security WHERE EventID = '5136' GROUP BY objectdn ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 10, '|') AS objectclass FROM Security WHERE EventID = '5136' GROUP BY objectclass ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 11, '|') AS objectattrib FROM Security WHERE EventID = '5136' GROUP BY objectattrib ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 13, '|') AS attribvalue FROM Security WHERE EventID = '5136' GROUP BY attribvalue ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) FROM System WHERE EventID IN (7;7031) AND EventType = 1 AND EventCategory = 0 GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(DISTINCT SourceName) FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT cs-Username, COUNT(*) AS Hits FROM '%IISLogs%\*.log' WHERE cs-Username IS NOT NULL GROUP BY cs-Username ORDER BY Hits Desc"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, EventTypeName, Message FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SID, RESOLVE_SID(SID) AS Username FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SID, RESOLVE_SID(SID) as Username FROM Security where EventID IN (529;530;531;532;533;534;535;537;539)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SID as Username FROM Security where EventID IN (529;530;531;532;533;534;535;537;539)"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, ComputerName, COUNT(*) AS Total FROM System, application Group By EventID, ComputerName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, COUNT(*) INTO DATAGRID FROM System GROUP BY EventID ORDER BY EventID ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, message, COUNT(*) AS Total FROM System, application Group By EventID, message ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Warning event'
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('01-02', 'MM-dd')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('01-02', 'MM-dd')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*)  AS [Application], mul(COUNT(*),2) AS [System], mul(COUNT(*),3) AS [Securiy] FROM Application, System, Security group by EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*)  AS [Application], mul(COUNT(*),2) AS [System], mul(COUNT(*),3) AS [Securiy] FROM Application, System, Security group by EventTypeName HAVING EventTypeName = 'Warning event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) AS [Application], mul(COUNT(*),2) AS [System], mul(COUNT(*),3) AS [Securiy] FROM Application, System, Security group by EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Information event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Information event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Success event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Warning event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName HAVING EventTypeName = 'Warning event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application GROUP BY EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Application, Security, System GROUP BY EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM OAlerts GROUP BY EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Security GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Security GROUP BY EventTypeName HAVING EventTypeName = 'Information event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Security GROUP BY EventTypeName HAVING EventTypeName = 'Warning event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM Security GROUP BY EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM System GROUP BY EventTypeName HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM System GROUP BY EventTypeName HAVING EventTypeName = 'Information event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM System GROUP BY EventTypeName HAVING EventTypeName = 'Warning event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) FROM System GROUP BY EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_EXTENSION(cs-uri-stem) AS Extension,
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS taskname, COUNT(*) AS Cntr FROM System WHERE EventID = 140 GROUP BY taskname ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS taskname, COUNT(*) AS Cntr FROM System WHERE EventID = 141 GROUP BY taskname ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS User, COUNT(*) AS Cntr FROM System WHERE EventID = 21 GROUP BY User ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS User, COUNT(*) AS Cntr FROM Security WHERE EventID = 4768 AND User NOT LIKE '%$' GROUP BY User ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS User, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 AND User NOT LIKE '%$' GROUP BY User ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS User, COUNT(User) AS Cntr FROM Security WHERE EventID = 4771 AND User NOT LIKE '%$' GROUP BY User ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4768 GROUP BY Domain ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 GROUP BY Domain ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS User, COUNT(*) AS Cntr FROM System WHERE EventID = 140 GROUP BY User ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS User, COUNT(*) AS Cntr FROM System WHERE EventID = 141 GROUP BY User ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS Username, COUNT(*) AS Cntr FROM Security WHERE EventID = 4776 AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 2, '|') AS Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4672 AND Domain NOT IN ('NT AUTHORITY') GROUP BY Domain ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 2, '|') AS Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4776 GROUP BY Domain ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 2, '|') AS Service, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 GROUP BY Service ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 5, '|') AS Cipher, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 GROUP BY Cipher ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 6, '|') AS Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY Domain ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 7, '|') AS Cipher, COUNT(*) AS Cntr FROM Security WHERE EventID = 4768 GROUP BY Cipher ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 8, '|') AS SrcIp, EXTRACT_TOKEN(Strings,13,'|') AS DstIp, COUNT(*) AS ConCount FROM Security WHERE EventID = 3 group by SrcIp, DstIp ORDER BY ConCount desc"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY AuthPackage ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY Workstation ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 17, '|') AS ProcName, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY ProcName ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT QUANTIZE(TimeGenerated, 3600) AS Time, COUNT(*) AS Number_of_Events INTO Startup.gif FROM System WHERE EventID= '6005' GROUP BY Time ORDER BY Number_of_Events"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT QUANTIZE(TimeGenerated, 600) AS TimeFrame, TimeGenerated, eventtype, eventtypename, message FROM Security WHERE timeframe= ( SELECT QUANTIZE(TimeGenerated, 600) FROM Security  WHERE eventtype<>8 )"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS Date, EventID, message AS Message FROM System WHERE EventID IN (100;102;110;129;140;200;201) ORDER BY Date, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM Application WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM Application, Security, Application, System WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM Security WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM System GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] FROM System WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] INTO results.csv FROM Application WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, COUNT(*) AS [Total Errors] INTO results.csv FROM Application WHERE EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY ToDay ASC" -o:datagrid
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT resolve_sid(sid) AS UserName, EventID, TimeGenerated FROM Security WHERE EventID IN (4624;4634) AND TO_DATE(TimeGenerated)='2004-09-06 00:00:00' AND sid not in (SELECT DISTINCT sid  FROM Security  WHERE EventID IN (4647;4634;4635) AND TO_DATE(TimeGenerated)='2021-06-07 00:00:00' )"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName AS Name, EventID AS ID, COUNT(*) AS number_of_events FROM System WHERE SUB(TO_INT(TimeGenerated), TO_INT(SYSTEM_TIMESTAMP())) > -2592000 AND sourcename not in ('Print';'MRxSmb';'w32time';'TermServDevices') GROUP BY ID, Name HAVING number_of_events > 1 ORDER BY number_of_events desc"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, COUNT(*) AS Cntr FROM Security GROUP BY EventID ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, MUL(PROPCOUNT(*) ON (SourceName), 100.0) AS Percent FROM Security GROUP BY SourceName, EventID ORDER BY SourceName, Percent DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, MUL(PROPCOUNT(*) ON (SourceName), 100.0) AS Percent FROM System GROUP BY SourceName, EventID ORDER BY SourceName, Percent DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, Message INTO "%ohtm%\%ComputerName%_Application.tsv" FROM Application"   <-- Produces tons of data
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, TimeGenerated, EventID FROM System WHERE  TimeGenerated > SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-03 00:00:00', 'yyyy-MM-dd h"H:mm:ss')"       Error: Syntax Error: <function-expr>: cannot find closing parenthesis for function SUB
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SUBSTR(Message, 0, INDEX_OF(Message, ':')) AS Description FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT Text, COUNT(*) FROM %lpl% GROUP BY Text ORDER BY COUNT(*) DESC" -i:TEXTWORD -rtp:-1   <- Counts every WORD... if that's what you wanted...
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0 , '|') AS User, EXTRACT_TOKEN(Strings, 6 , '|') AS SourceIP FROM Security WHERE EventID = 4771 AND User NOT LIKE '%$'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS addedUser, EXTRACT_TOKEN(Strings, 2, '|') AS togroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoadded, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4728'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS addedUser, EXTRACT_TOKEN(Strings, 2, '|') AS togroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoadded, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4732'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS addedUser, EXTRACT_TOKEN(Strings, 2, '|') AS togroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoadded, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4756'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS createdgroup, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4731"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS createdgroup, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4754"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS createdUser, EXTRACT_TOKEN(Strings, 1, '|') AS createdDomain, EXTRACT_TOKEN(Strings, 4, '|') AS whocreated, EXTRACT_TOKEN(Strings, 5, '|') AS whoDomain FROM Security WHERE EventID = '4720'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS deletedUser, EXTRACT_TOKEN(Strings, 1, '|') AS deletedDomain, EXTRACT_TOKEN(Strings, 4, '|') AS whodeleted, EXTRACT_TOKEN(Strings, 5, '|') AS whoDomain FROM Security WHERE EventID = '4726'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS newname, EXTRACT_TOKEN(Strings, 1, '|') AS oldname, EXTRACT_TOKEN(Strings, 2, '|') AS accDomain, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain FROM Security WHERE EventID = 4781"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS removedUser, EXTRACT_TOKEN(Strings, 2, '|') AS FROMgroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoremoved, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4729'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS removedUser, EXTRACT_TOKEN(Strings, 2, '|') AS FROMgroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoremoved, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4733'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS removedUser, EXTRACT_TOKEN(Strings, 2, '|') AS FROMgroup, EXTRACT_TOKEN(Strings, 3, '|') AS groupDomain, EXTRACT_TOKEN(Strings, 6, '|') AS whoremoved, EXTRACT_TOKEN(Strings, 7, '|') AS whoDomain FROM Security WHERE EventID = '4757'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS Servicename FROM System WHERE EventID = 7036"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS ServiceName, EXTRACT_TOKEN(Strings, 1, '|') AS ServicePath, EXTRACT_TOKEN(Strings, 4, '|') AS ServiceUser FROM System WHERE EventID = 7045"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS taskname, EXTRACT_TOKEN(Strings, 1, '|') AS User FROM System WHERE EventID = 141"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 2, '|') AS Service, EXTRACT_TOKEN(Strings, 5, '|') AS Cipher, EXTRACT_TOKEN(Strings, 6, '|') AS SourceIP FROM Security WHERE EventID = 4769"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4722"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4723"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4724"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 5, '|') AS whichDomain FROM Security WHERE EventID = 4725"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 7, '|') AS Cipher, EXTRACT_TOKEN(Strings, 9, '|') AS SourceIP FROM Security WHERE EventID = 4768"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 1, '|') AS workstation, EXTRACT_TOKEN(Strings, 4, '|') AS wholocked, EXTRACT_TOKEN(Strings, 5, '|') AS whoDomain FROM Security WHERE EventID = '4740'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 2, '|') AS SourceIP FROM System WHERE EventID = 21 AND User LIKE '%Administrator%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS User, EXTRACT_TOKEN(Strings, 2, '|') AS SourceIP FROM System WHERE EventID = 21"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS Username, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 3, '|') AS SourceIP FROM Security WHERE EventID = 4825"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS AcctName, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS AcctUsed, EXTRACT_TOKEN(Strings, 6, '|') AS DomainUsed, EXTRACT_TOKEN(Strings, 8, '|') AS TargetServer, EXTRACT_TOKEN(Strings, 9, '|') AS ExtraData, EXTRACT_TOKEN(Strings, 11, '|') AS ProcName, EXTRACT_TOKEN(Strings, 12, '|') AS SourceIP FROM Security WHERE EventID = 4648 AND AcctUsed = 'BobMaars'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS AcctName, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS AcctUsed, EXTRACT_TOKEN(Strings, 6, '|') AS DomainUsed, EXTRACT_TOKEN(Strings, 8, '|') AS TargetServer, EXTRACT_TOKEN(Strings, 9, '|') AS ExtraData, EXTRACT_TOKEN(Strings, 11, '|') AS ProcName, EXTRACT_TOKEN(Strings, 12, '|') AS SourceIP FROM Security WHERE EventID = 4648 AND AcctUsed = 'BobMaars'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS AcctName, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS AcctUsed, EXTRACT_TOKEN(Strings, 6, '|') AS DomainUsed, EXTRACT_TOKEN(Strings, 8, '|') AS TargetServer, EXTRACT_TOKEN(Strings, 9, '|') AS ExtraData, EXTRACT_TOKEN(Strings, 11, '|') AS ProcName, EXTRACT_TOKEN(Strings, 12, '|') AS SourceIP FROM Security WHERE EventID = 4648"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS User, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 6, '|') AS whichDomain FROM Security WHERE EventID = 4738"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4634 AND Domain NOT IN ('NT AUTHORITY')"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4672 AND Domain NOT IN ('NT AUTHORITY')
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4672 AND Domain NOT IN ('NT AUTHORITY') AND Username = 'Administrator'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4776 AND Domain NOT IN ('NT AUTHORITY') AND Username NOT LIKE '%$' AND Username = 'BobMaars'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4776 AND Domain NOT IN ('NT AUTHORITY') AND Username NOT LIKE '%$'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 AND Process LIKE '%rundll32.exe%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 AND Username = 'BobMaars'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Workstation FROM Security WHERE EventID = '1102'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS rulename FROM Security WHERE EventID = 4946"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS rulename FROM Security WHERE EventID = 4948"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS whichgroup, EXTRACT_TOKEN(Strings, 3, '|') AS Domaingroup, EXTRACT_TOKEN(Strings, 6, '|') AS who, EXTRACT_TOKEN(Strings, 7, '|') AS workstation FROM Security WHERE EventID = 4734"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS whichgroup, EXTRACT_TOKEN(Strings, 3, '|') AS Domaingroup, EXTRACT_TOKEN(Strings, 6, '|') AS who, EXTRACT_TOKEN(Strings, 7, '|') AS workstation FROM Security WHERE EventID = 4758"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 3, '|') AS Username, EXTRACT_TOKEN(Strings, 4, '|') AS Domain, EXTRACT_TOKEN(Strings, 8, '|') AS objectdn, EXTRACT_TOKEN(Strings, 10, '|') AS objectclass, EXTRACT_TOKEN(Strings, 11, '|') AS objectattrib, EXTRACT_TOKEN(Strings, 13, '|') AS attribvalue FROM Security WHERE EventID = '5136'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') AS User, EXTRACT_TOKEN(Strings, 6, '|') AS Domain, EXTRACT_TOKEN(Strings, 1, '|') AS whichaccount, EXTRACT_TOKEN(Strings, 2, '|') AS whichDomain FROM Security WHERE EventID = 4742"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EventID, ComputerName, Message, Data FROM System WHERE EventID IN (4;5;8;9;14;17;18;19;20;21;22;49;50;52;100;513;517;518;521;527;528;544;545;546;561;564;612) ORDER BY EventTime, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EventID, message AS Message FROM System WHERE EventID IN (100;102;110;129;140;200;201) ORDER BY EventTime, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EventID, message AS Message FROM System WHERE EventID IN (4;5;8;9;14;17;18;19;20;21;22;49;50;52;100;513;517;518;521;527;528;544;545;546;561;564;612) ORDER BY EventTime, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE EventID= '4688'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated FROM Security WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) AND ( EventID = '4656' ) AND ( Message LIKE '%%bob%%' )"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated FROM System WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) AND ( EventID = '4656' ) AND ( Message LIKE '%%sam%%' )" > %odl%\EventID-4656.txt & Notepad++ %odl%\EventID-4656.txt
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, message FROM Security WHERE EventID=520"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventTypeName, SourceName FROM System WHERE ( SourceName = 'Service Control Manager' AND EventID >= 7024)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, message, SourceName FROM System WHERE ( SourceName = 'Service Control Manager' AND EventID >= 7024)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID FROM Security WHERE EventID = 4624" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID FROM Security WHERE EventID = 4688" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, EXTRACT_TOKEN(Strings,1,'|') AS Domain, EXTRACT_TOKEN(Strings,0,'|') AS User, EXTRACT_TOKEN(Strings,3,'|') AS SessionName, EXTRACT_TOKEN(Strings,4,'|') AS ClientName, EXTRACT_TOKEN(Strings,5,'|') AS ClientAddress, EventID FROM Security WHERE EventID IN (21;22;24;25;29;40;682;1146;1147;1148;4624;4625;4478;4479) ORDER BY TimeGenerated" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Application WHERE EventID = 999" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Application WHERE EventID IN (4625;4634;4776;4648;4672)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Application WHERE EventID IN (8194;8216;8300;8301;8302)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Security WHERE EventID IN (4624;4625;4776;4720;4732;4728;7030;7040)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Security WHERE EventID IN (4648)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM Security WHERE EventID IN (608;4616;4624;4634;4648;4672;4688;4720;4722;4724;4826;5024;5033;5058;5061;6005;60066008;6013;1100;1102)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (20001;20003)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (24576;24577;24578;24579)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (4000;4001;4003;6100)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (44;43;19;20)" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID, Message FROM Application WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventID IN (520;530;533;539;590;591;592;593;594;598;599) AND Name IN ('XCopy';'RoboCopy') ORDER BY TimeGenerated ASC" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID, Message FROM Security WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventID IN (1125;1102;4670;4672;4648;4624;4776;4624;4572) ORDER BY TimeGenerated ASC" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventID = 528 AND SID LIKE '%UserName%'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventID BETWEEN 4945 AND 5031"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventID BETWEEN 4945 AND 5031" >NUL
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventType IN (528;4624;538;4634;4647) AND SID LIKE '%UserName%'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message INTO report.txt FROM Security WHERE EventID = 528 AND SID LIKE '%UserName%'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM %ComputerName% WHERE TimeGenerated > '2021-05-01 00:00:00' AND EventType IN (1;2) ORDER BY TimeGenerated DESC" -o:CSV -q:ON -stats:On >> %ohtm%\%ComputerName%_Events.csv
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Application WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventType IN (1;2) ORDER BY TimeGenerated DESC" -o:CSV -q:ON -stats:On >> %ohtm%\%ComputerName%_24hrApp-Evts.csv &Notepad++ %ohtm%\%ComputerName%_24hrApp-Evts.csv
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Application WHERE TimeGenerated > TO_TIMESTAMP(SUB(TO_INT(SYSTEM_TIMESTAMP()),86400)) AND EventType IN (1;2) ORDER BY TimeGenerated DESC" -q:ON -stats:On
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,Message,EventID  FROM System TO %odl%\event.xml WHERE EventID=420 AND TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('11-11', 'MM-dd'))) ORDER BY EventID"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 10 * FROM System ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT top 100 * FROM %lpl% "
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 * FROM Application"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 * FROM Security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 * FROM System"
LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON -chartType:Column3D -groupSize:1024x768 "SELECT TOP 100 cs-uri-stem, COUNT(*) AS Hits INTO "%odl%\IISW3C-Chart.gif" FROM  <www.margiestravel.com> GROUP BY cs-uri-stem ORDER BY Hits DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:59', 'yyyy-MM-dd HH:mm')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:59', 'yyyy-MM-dd HH:mm')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 Path, Name, Size, Attributes FROM '%OneDrive%\*.*' ORDER BY Size DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 SourceName, COUNT(*) AS Total FROM Application GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 SourceName, COUNT(*) AS Total FROM Security GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 SourceName, COUNT(*) AS Total FROM System GROUP BY SourceName ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 999 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 999 EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:59', 'yyyy-MM-dd HH:mm')))"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_DATE(TimeGenerated) AS DateGenerated, TO_UPPERCASE( EXTRACT_TOKEN(EventTypeName, 0, ' ') ) AS TypeName, SourceName FROM System" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_DATE(TimeGenerated), TO_UPPERCASE( EXTRACT_TOKEN(EventTypeName, 0, ' ') ) AS TypeName, SourceName FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TO_STRING(TO_TIMESTAMP(EXTRACT_PREFIX(REPLACE_STR([#Fields: Datetime],'T',' '),0,'.'), 'yyyy-MM-dd h"H:mm:ss'),'yyMMdd') AS Day" --> Error: detected extra argument "AS" after query
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT UserName, COUNT(*) AS Total USING EXTRACT_TOKEN( Strings, 0, '|' ) AS UserName, EXTRACT_TOKEN( Strings, 1, '|' ) AS MachineName FROM System WHERE EventID IN (644) GROUP BY UserName ORDER BY Total"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID into stdout FROM System WHERE SourceName = 'Service Control Manager'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID into stdout FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') AS TypeEvent, TO_DATE(TimeGenerated) AS DateGenerated, SID AS SecurityID INTO stdout FROM System WHERE SourceName = 'Service Control Manager' and SID is not null
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Application WHERE EventType = 1 AND EventCategory = 0  AND TimeWritten > TO_LOCALTIME( SUB( SYSTEM_TIMESTAMP(), TIMESTAMP('0000-01-07', 'yyyy-MM-dd') ) ) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = 4688"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType = 1 AND EventCategory = 0  AND TimeWritten > TO_LOCALTIME( SUB( SYSTEM_TIMESTAMP(), TIMESTAMP('0000-01-07', 'yyyy-MM-dd') ) ) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) HAVING EventID = 4672"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) HAVING EventID = 4688"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventID NOT IN (1;7;7023;10005;10010;10028) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE EventType = 1 AND EventCategory = 0  AND TimeWritten > TO_LOCALTIME( SUB( SYSTEM_TIMESTAMP(), TIMESTAMP('0000-01-07', 'yyyy-MM-dd') ) ) HAVING EventTypeName = 'Error event'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM System WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 1, '|') AS Username FROM Security WHERE EventID = 4688 GROUP BY Username ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 GROUP BY Process ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT RESOLVE_SID(Sid) AS Account FROM Security WHERE EventID IN (540;528)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, TimeGenerated, SID INTO stdout FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE EventID= '4688'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Security WHERE EventType IN (4688;4672)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, EventTypeName, SourceName, message AS Message FROM System WHERE ( SourceName = 'Service Control Manager' AND EventID >= 7024)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID BETWEEN 19 AND 25"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SID, SourceName AS Name, EventID AS ID FROM System WHERE EventID IN (44;43;19;20)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventID IN (528;4624;4625;4634) AND SID LIKE'%BobMaars%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Application WHERE TimeGenerated > '2021-06-07 00:00:00' AND EventType IN (1;2) ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Security WHERE TimeGenerated > '2021-06-07 00:00:00' AND EventType IN (1;2) ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM System WHERE TimeGenerated > '2021-06-07 00:00:00' AND EventType IN (1;2) ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 150 EXTRACT_TOKEN(EventTypeName, 0, ' '), TO_DATE(TimeGenerated), SID INTO stdout FROM System"
LogParser -i:EVT -rtp:-1 -o:datagrid -rtp:-1 -o:datagrid -resolveSIDs:ON "SELECT SourceName, EventID, MUL(PROPCOUNT(*) ON (SourceName),100.0) AS Percent FROM System GROUP BY SourceName, EventID ORDER BY SourceName, Percent DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM Application GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM Security GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM System WHERE EventType = 1 OR EventType = 2 GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SUBSTR(Message, 0, INDEX_OF(Message, ':')) AS Description  FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) AS [Number of events] FROM System group by EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, COUNT(*) AS [NumEvents] FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, EXTRACT_TOKEN(Strings,0,'|') AS User, EXTRACT_TOKEN(Strings,3,'|') AS Type FROM Security WHERE  (EventID = 540) AND (Type LIKE '3') ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventLog, SourceName, ComputerName, SID, EventTypeName, EventID, EventType, EventCategory, Message FROM System WHERE EventID IN (19;20) AND Message LIKE '%KB5005033%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 * FROM application WHERE EventID=1053"
LogParser -i:EVT -rtp:-1 -o:nat "SELECT EventTypeName, TimeGenerated, SID into stdout FROM System"
LogParser -i:EVT -rtp:-1 -resolveSIDs:on-o:datagrid "SELECT * FROM Application WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )"
LogParser -i:EVT -rtp:-1 -resolveSIDs:on-o:datagrid "SELECT * FROM Security WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )"
LogParser -i:EVT -rtp:-1 -resolveSIDs:on-o:datagrid "SELECT * FROM System WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )"
LogParser -i:EVT -rtp:-1 -stats:On -o:NAT "SELECT TimeGenerated, Sourcename FROM Security"
LogParser -i:EVT -stats:On "SELECT TypeName, COUNT(*) AS TotalCount USING TO_UPPERCASE( EXTRACT_TOKEN(EventTypeName, 0, ' ') ) AS TypeName INTO %csv% FROM System WHERE TypeName LIKE '%Service%' GROUP BY TypeName HAVING TotalCount > 5 ORDER BY TotalCount DESC" & Notepad++ %csv%
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,  EventID, EventTypeName, SourceName, message AS Message FROM System WHERE ( SourceName = 'Service Control Manager' AND EventID >= 7024)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message FROM Application,System,Security WHERE LogParser -o:SYSLOG -severity:$MySeverity -hostName:$MyHostname "SELECT TO_TIMESTAMP(Date,time), CASE sc-status WHEN 500 THEN 'emerg' ELSE 'err' END AS MySeverity, s-computername AS MyHostname, cs-uri-stem FROM Application,System,Security WHERE sc-status >= 400" :: Error: detected extra argument "TO_TIMESTAMP(Date,time)," after query
TimeGenerated > '2021-06-07 00:00:00' AND EventType IN (1;2) ORDER BY TimeGenerated DESC"
LogParser -objClass:User "SELECT title, MUL(PROPCOUNT(*), 100.0) AS Percentage INTO DATAGRID FROM 'LDAP://BobMaars:Alt+'@Village/CN=Users,DC=myDomain,DC=com' WHERE title IS NOT NULL GROUP BY title ORDER BY Percentage DESC"
LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT * FROM System WHERE EventID IN (41;1074;6006;6008)"

echo Computer Uptimes $T LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT * FROM System WHERE EventID IN (6008;6009)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM Application GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM Security GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, COUNT(*) AS [TotalEvents] FROM System WHERE EventType = 1 OR EventType = 2 GROUP BY EventID ORDER BY TotalEvents DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventTypeName, COUNT(*) AS [Number of events] FROM System group by EventTypeName"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') AS taskname, COUNT(*) AS Cntr FROM System WHERE EventID = 100 GROUP BY taskname ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS taskaction, COUNT(*) AS Cntr FROM System WHERE EventID = 200 GROUP BY taskaction ORDER BY Cntr DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, COUNT(*) AS [NumEvents] FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SUBSTR(Message, 0, INDEX_OF(Message, ':')) AS Description FROM security"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS taskname, EXTRACT_TOKEN(Strings, 1, '|') AS User FROM System WHERE EventID = 140"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings,0, '|') AS taskname, EXTRACT_TOKEN(Strings, 1, '|') AS taskaction FROM System WHERE EventID = 200"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings,0, '|') AS taskname, EXTRACT_TOKEN(Strings, 1, '|') AS Username FROM System WHERE EventID = 100"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated FROM Security WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) AND ( EventID IN (32000;32002;31017;31018) ) AND ( Message LIKE '%%bob%%' )"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, EXTRACT_TOKEN(Strings,0,'|') AS User, EXTRACT_TOKEN(Strings,3,'|') AS Type FROM Security WHERE  (EventID = 540) AND (Type LIKE '3') ORDER BY TimeGenerated DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 100 * FROM application WHERE EventID=1053"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT * Text FROM %FWExp% WHERE Text LIKE 'Enabled:' and TEXT LIKE 'Rule Name:'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, 'Startup-W10', Text FROM %odl%\*Startup-W10.log WHERE Text LIKE '%RC=%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM http://www.microsoft.com WHERE Text LIKE '%href%'"
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %OneDrive%\AboutMe_Combined.txt WHERE Text LIKE '%LogParser %'"
LogParser -rtp:-1 -o:datagrid -stats:On -resolveSIDs:ON "SELECT DISTINCT TimeGenerated, EventLog, SourceName, ComputerName, SID, EventTypeName, EventID, EventType, EventCategory, Message FROM System WHERE EventID IN (19;20)"
LogParser -rtp:-1 -o:datagrid -stats:On -resolveSIDs:ON "SELECT..."
LogParser -TPL:"%OneDrive%\Log Parser 2.2\LP-AppPool.tpl" "SELECT TimeGenerated,EventTypeName,Strings,Message INTO %ohtm%\%ComputerName%_LP-AppPool.html FROM System WHERE SourceName = 'WAS' and Message LIKE '%ApplicationName%'"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM tcpip WHERE EventID = '4199'"
echo WINS &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Wins WHERE EventType IN (4102;4243;4242;4286)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * INTO stdout FROM System"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * INTO Trace.csv FROM myFile.etl"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│    Dos Batch - File Descriptor Redirect           │
└───────────────────────────────────────────────────┘
Note that file descriptors are a way that the operating system keeps track of open Files and I/O streams. By default, file descriptor 0 is standard input (stdin), 1 is standard output (stdout), and 2 is standard error (stderr)
The 0>&1 , 1>&1 , 2>&1  3>&1 are used in command line interfaces (like DOS, Bash, etc.) for redirection. Here's what they mean:
0>&1: This redirects the standard input (file descriptor 0) to wherever the standard output (file descriptor 1) is going
1>&1: This is essentially a no-op. It redirects the standard output (file descriptor 1) to itself
2>&1: This redirects the standard error (file descriptor 2) to wherever the standard output (file descriptor 1) is going
3>&1: This would redirect file descriptor 3 (if it exists) to wherever the standard output (file descriptor 1) is going

3>: This is redirecting output from file descriptor 3.
&1: This is specifying where to redirect the output. The ampersand (&) indicates that what follows is a file descriptor and not a filename. So &1 refers to file descriptor 1.
So, 3>&1 means "redirect the output that would normally go to file descriptor 3 to instead go to file descriptor 1".
File descriptors are a way that the operating system keeps track of open Files and I/O streams. By default, file descriptor 0 is standard input (stdin), 1 is standard output (stdout), and 2 is standard error (stderr).
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│    Audit - Auditing Specific Events               │
└───────────────────────────────────────────────────┘
:: Another version of using variable ToDay within today's DateStamp: Format=yyyy-dd-mm
echo Audit <SKELETON> Events ToDay.&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT <UserStuff> AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'"
SET ToDay=%date:~-4%-%date:~-7,2%-%date:~-10,2% & echo %ToDay%
::SET myeids=4657;1;4616
SET myeids=529;530;531;532;533;534;535;537;539

echo Audit BruteForceAttack Events ToDay.&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings , 0, '|') AS UserName, QUANTIZE(TimeGenerated, 3600) AS TimeFrame, COUNT(*) AS Number_of_Events FROM Security WHERE EventID IN (529;530;531;532;533;534;535;537;539) AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%' GROUP BY UserName, timeframe HAVING Number_of_Events>2"

echo Audit <What> Events ToDay.&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT <Elements> AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'"
::Successful File Access ToDay:
echo Successful File Access ToDay&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EXTRACT_TOKEN(Strings, 8, '|') AS UserName, EXTRACT_TOKEN(Strings, 2, '|') AS File FROM Security WHERE EventID = '560' AND EventTypeName = 'Success Audit event' AND EXTRACT_TOKEN(Strings, 1, '|') LIKE 'File' AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'"
:: Unsuccessful File Access:
echo Unsuccessful File Access ToDay&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EXTRACT_TOKEN(Strings, 8, '|') AS UserName, EXTRACT_TOKEN(Strings, 2, '|') AS File FROM Security WHERE EventID = '560' AND EventTypeName = 'Failure Audit event' AND EXTRACT_TOKEN(Strings, 1, '|') LIKE 'File' AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'"

echo Audit System DrWatson Events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EXTRACT_TOKEN(Strings, 0, '|') AS Program FROM System WHERE sourcename= 'DrWatson' AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'"
echo Audit System Events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, TimeGenerated AS Time, message, EXTRACT_TOKEN(Strings, 0, '|') AS Program FROM System WHERE TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%'"
:: Windows 11 Events Monitor New Software Installation
:: Windows 11 Events Monitor New Device Attachment Policy location: Computer Configuration > Policies > Windows Settings > Security Settings > Advanced Audit Configuration > Detailed Tracking
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Security WHERE EventID = 4688 ORDER BY ToDay ASC"
echo Audit File System &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM System, application, Security WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) AND EventType IN (4656;4658;4660;4663;4664;4985;5051;4670)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, extract token(strings, 8. '|') AS UserName, extract token(strings, 2. '|') AS File FROM Security WHERE EventID = '560' AND EventTypeName = 'Failure Audit event' AND extract token(strings, 1, '|') LIKE File"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EXTRACT_TOKEN(Strings, 8, '|') AS UserName, EXTRACT_TOKEN(Strings, 2, '|') AS File FROM Security WHERE EventID IN (4656;4663) AND EventTypeName = 'Failure Audit event' AND EXTRACT_TOKEN(Strings, 1, '|') LIKE 'File'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, message AS Message FROM Security WHERE EventID= '4688'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, message AS Message FROM System WHERE EventID= '6005'"
:: Audit DPAPI Activity determines whether the operating system generates audit events when encryption or decryption calls are made into the data protection application interface
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID BETWEEN 4692 AND 4695"
WHERE EventType IN (4692;4693;4694;4695)"
:: Audit PNP Activity
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (6416;6419;6420;6421;6422;6423;6424)"
:: Audit IPsec Extended Mode
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventType IN (4978;4979;4980;4981;4982;4983;4984)"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +------------------------------------------------------------------+
:: |   Important Daily scans... Application,Security,System           |
:: |    Check Audit hacker attacks:                                   |
:: |    NOTE: If the results return 0 records, you're in good shape!  |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE EventType IN (104;1102;4719) ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE EventType IN (1;2;1000;1001;1002) ORDER BY ToDay ASC"
::  Pass-the-Hash:         NTLM Type 3
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE EventType IN (4524;4625) ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE EventType IN (4740;4728;4732;4756;4735;4624;4625;4648) ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType, EXTRACT_TOKEN(Strings, 10, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$'"
:: detect intrusions and malicious activity
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, SID, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Application,System,Security WHERE EventType IN (1006;1007;1125;4688;4670;4672;4648;4624;4776)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, SID, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Application,System,Security WHERE EventType IN (4719;7036;7040;1102;1104;4720;4616;7045;4698)"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, SID, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Application,System,Security WHERE EventType IN (4624;4625;4634;4648;4688)"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
4800 – Workstation was LOCKED
4801 – Workstation was UNLOCKED
4802 – Screensaver INVOKED
4803 – Screensaver DISMISSED
4647 – User Initiated LOGOFF
4648 – User LOGON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, SID, SourceName AS Name, EventID AS ID,  EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain FROM Application,Security,System WHERE EventID IN (4800;4801;4802;4803;4647;4648)"
:: Examine Logon and Logoff events for Current User
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date,SID,SYSTEM_UTCOFFSET() as UTC_Offset,EventID,ComputerName, CASE EventID WHEN 4800 THEN SUBSTR(Message,0,26) WHEN 4801 THEN SUBSTR(Message,0,28) WHEN 4802 THEN SUBSTR(Message,0,28) WHEN 4803 THEN SUBSTR(Message,0,30) WHEN 4647 THEN SUBSTR(Message,0,21) WHEN 4648 THEN SUBSTR(Message,0,48) END as EventDesc,Message FROM Security WHERE EventID IN (4800;4801;4802;4803;4647;4648) AND STRCntr(Message,'%USERNAME%')=1"
:: Possible...  WHERE (EventID=4800 or EventID=4801 or EventID=4802 or EventID=4803 or EventID=4648 or EventID=4647)
:: Fix Mixed case to lower case: instead of "AND STRCntr(Message,'%USERNAME%')=1" -change to- "AND STRCntr(TO_LOWERCASE(Message),'%USERNAME%')=1" : Does not work....
:: Daily Event Checks... Event ID 104 Event Log was Cleared and event ID 1102 Audit Log was Cleared Event ID 4719 System audit policy was changed
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (104;1001;4719)"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +------------------------------------------------------------------+
:: |    Windows 11 Events Monitor Windows FirewAll:                   |
:: +------------------------------------------------------------------+
SET myeids=4945;4950;4946;5024;5031
echo Select Last Hour LogIn Events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (%myeids%) AND TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02 06:00', 'yyyy-MM-dd HH:mm') )"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE EventType IN (4946;4950) ORDER BY ToDay ASC"
::Windows 11 Events Monitor Failure to Load Group Policy:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE EventID = 1030 ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE EventID = 4731 ORDER BY ToDay ASC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Application, Security, System WHERE EventType IN (4727;4731;4732;4733;4734;4735;4764;4799) ORDER BY ToDay ASC"
::-----------------------------------------------------------------------------------------------------------------
::--- Example: Audit Daily Specific EventIDs
::	4624		An account was successfully logged on
::	4625		An account failed to log on
::	4648		A logon was attempted using explicit credentials
::	4675		SIDs were filtered
::	4656		A handle to an object was requested
::	4658		The handle to an object was closed
::	4660		An object was deleted
::	4663		An attempt was made to access an object
::	4685		The state of a transaction has changed
::	LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT * FROM Security WHERE EventType IN (4688;1102;4670;4672;1007)"
::	LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT * FROM Security WHERE EventType IN (4624;4625;4648;4634;4647)"
::------------------------------------------------------------------------------------------------------------------
::Windows 11 Audit Security Event Group Management
::	4731	 A security-enabled local group was created.
::	4732	 A member was added to a security-enabled local group.
::	4733	 A member was removed FROM a security-enabled local group.
::	4734	 A security-enabled local group was deleted.
::	4735	 A security-enabled local group was changed.
::	4764	 A group's type was changed.
::	4799	 A security-enabled local group membership was enumerated.
::	4727	 A security-enabled global group was created. See event 4731: A security-enabled local group was created. Event 4727 is the same, but it is generated for a global security group instead of a local security group. All event fields, XML, and recommendations are the same. The type of group is the only difference.
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM sysmon.evtx"
::	1		Process creation
::	2		A process changed a file creation time
::	3		Network connection
::	4		Sysmon Service state changed
::	5		Process terminated
::	6		Driver loaded
::	7		Image loaded
::	8		CreateRemoteThread
::	9		RawAccessRead
::	10		ProcessAccess
::	11		FileCreate
::	12		RegistryEvent (Object create and delete)
::	13		RegistryEvent (Value Set)
::	14		RegistryEvent (Key and Value Rename)
::	15		FileCreateStreamHash
::	255		Error
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::	Note Some Work needs to be done to enable auditing of these particular events: https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc779526(v=ws.10)
::	Audit Logon, Account, DIr Services, Object access, Policy Changes, Priveledge use, Proc Tracking, Sys Events
echo Audit logon events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (528;529;530;531;532;533;534;535;536;537;538;539;540;541;542;543;544;545;546;547;548;549;550;551;552;682;683)"
echo Audit account logon events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (672;673;674;675;676;677;678;681;682;683)"
echo Audit account management events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (624;627;628;630;631;632;633;634;635;636;637;638;639;641;642;643;644;645;646;647;648;649;650;651;652;653;654;655;656;657;658;659;660;661;662;663;664;665;666;667;668;684;685)
echo Audit directory Service access events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (566)"
echo Audit object access events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (560;562;563;564;565;567;568;569;570;571;572;772;773;774;775;776;777;778;779;780;781;782;783;784;785;786;787;788;789;790;791;792;793;794;795;796;797;798;799;800;801)"
echo Audit policy change events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (608;609;610;611;612;613;614;615;616;617;618;620;621;622;623;625;768;769;770;771;805)"
echo Audit privilege use events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (576;577;578)"
echo Audit process tracking events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (592;593;594;595;596;597;598;599;600;601;602)"
echo Audit system events&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ComputerName, TimeGenerated AS LogonTime, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS Username FROM Security WHERE EventID IN (512;513;514;515;516;517;518;519;520)"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:EVT -stats:On -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% Security Line" "SELECT TOP 10 SourceName, COUNT(*) AS Total INTO %ohtm%\%ComputerName%_SecurityCounts.gif FROM System GROUP BY SourceName ORDER BY Total DESC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:ETW 	 (Event Tracing for Windows) FROM myFile.etl                  │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  EventNumber (I)    EventName (S)    EventTypeName (S)    TIMESTAMP (T)   UserData (S)
:: LogParser -i:ETW -------------------------------------------------------------------------------
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:NETMON  (NetMon capture Files)                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  CaptureFilename (S)    Frame (I)      DateTime (T)      FrameBytes (I)
  SrcMAC (S)             SrcIP (S)      SrcPort (I)       DstMAC (S)
  DstIP (S)              DstPort (I)    IPVersion (I)     TTL (I)
  TCPFlags (S)           Seq (I)        Ack (I)           WindowSize (I)
  PayloadBytes (I)       Payload (S)    Connection (I)
:: LogParser -i:NETMON ----------------------------------------------------------------------------
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:REG 	 (Registry properties)                                        │
└─────────────────────────────────────────────────────────────────────────────────────┘
:: LogParser -i:REG -------------------------------------------------------------------------------
Fields:
  ComputerName (S)     Path (S)      KeyName (S)           ValueName (S)
  ValueType (S)        Value (S)     LastWriteTime (T)
:: If the MULTI_SZ type contains arrays of strings, the content of the "Value" can be split using: -multiSZSep:,
:: -binaryFormat:PRINT when parameter is set to "HEX", all data bytes are returned as two-digit hexadecimal values -binaryFormat ASC|PRINT|HEX
:: Registry EventLog Location Queries:
SET Allfields=ComputerName,Path,KeyName,ValueName,ValueType,Value,LastWriteTime,HEX_TO_ASC(Value) as HexValue
Parameters: -recurse -1 -multiSZSep value='|' -binaryFormat ASC|PRINT|HEX  |  INTO RecentSoftware.csv
Display the distribution of registry value types:
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT ValueType, COUNT(*) INTO DATAGRID FROM \HKLM GROUP BY ValueType"
SET fields=Path,KeyName,ValueName,ValueType,Value,HEX_TO_ASC(Value) as HexValue,LastWriteTime
LogParser -i:EVT -rtp:-1 "SELECT TOP 100 SourceName, COUNT(*) as Total FROM Application GROUP BY SourceName ORDER BY Total DESC"
REG QUERY "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog" /V "ImagePath"
REG QUERY "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Application"
REG QUERY "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Security"
REG QUERY "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\System"
REG QUERY "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Application\Beyond Compare 4"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Get Specific Notepad++ Reg Entries&LogParser -i:REG -rtp:-1 -o:datagrid -stats:On "SELECT COMPUTER_NAME() as ThisMchine, Path, ValueName, Value FROM  \HKEY_CLASSES_ROOT\Directory\shell\NotePad++\, \HKEY_CLASSES_ROOT\Directory\shell\NotePad++\command\, \HKEY_CLASSES_ROOT\*\shell\NotePad++\,  \HKEY_CLASSES_ROOT\*\shell\NotePad++\command\, \HKEY_CLASSES_ROOT\Drive\shell\runas\, \HKEY_CLASSES_ROOT\Drive\shell\runas\command\ WHERE Path Like '%Notepad%' OR ValueName Like '%Notepad%' OR Value Like '%Notepad%' "
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /V Registered*
echo Get Windows Registered values&LogParser -i:REG -rtp:-1 -o:datagrid -stats:On -E:5 "SELECT KeyName,ValueName,ValueType,Value FROM '\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion' WHERE ValueName Like '%Registered%' ORDER BY KeyName"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Below verifies that the correct values are in the REG Environmentals
echo Dump All Environmentals&LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,ValueName,Value,LastWriteTime FROM '\HKEY_CURRENT_USER\Environment','\HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment' ORDER BY Path,ValueName"
echo Dump Specific Environmentals&LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,ValueName,Value,LastWriteTime FROM '\HKEY_CURRENT_USER\Environment','\HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment' WHERE ValueName LIKE '%Notepad%'ORDER BY Path,ValueName"
echo Dump Specific Environmentals&LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM '\HKEY_CURRENT_USER\Environment','\HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment' WHERE ValueName LIKE '%SysInternals%' OR ValueName LIKE '%ProgramFiles%' OR ValueName LIKE '%odl%' OR ValueName LIKE '%logs%' OR ValueName LIKE '%%ilog%' OR ValueName LIKE '%%iodl%'"
:: Display Environmental Variables
REG QUERY "HKEY_CURRENT_USER\Environment" /V path
REG QUERY "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V path
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value FROM '\HKEY_CURRENT_USER\Environment' WHERE ValueName LIKE '%Path%'"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value FROM '\HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment' WHERE ValueName LIKE '%Path%'"

LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -e:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM '\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\ProFiles'"
REG QUERY "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\ProFiles"

LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \HKLM\HARDWARE\DESCRIPTION\System ORDER BY Path"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \HKLM\HARDWARE\DESCRIPTION\System"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT ValueType, COUNT(*) FROM \HKLM\HARDWARE\DESCRIPTION\System GROUP BY ValueType"

LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT * FROM \HKLM\HARDWARE\DESCRIPTION\System"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT ValueType, COUNT(*) INTO DATAGRID FROM \HKLM\HARDWARE\DESCRIPTION\System GROUP BY ValueType"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * INTO MyTable FROM \HKLM\HARDWARE\DESCRIPTION\System" -i:REG -o:SQL -server:%ComputerName% -database:MyDatabase -driver:"SQL Server" -Username:TestSQLUser -password:TestSQLPassword -createTable:ON
LogParser -Username:TestSQLUser -password:TestSQLPassword -createTable:ON "SELECT * INTO MyTable FROM \HKLM" -i:REG -o:SQL -server:MyServer -database:MyDatabase -driver:"SQL Server"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::	Finding MRU traces:
LogParser -i:REG -stats:On -o:CSV "SELECT Path, ValueName, Value, HEX_TO_ASC(Value) as HexValue INTO %odl%\MRU-Lists.csv FROM \HKCU WHERE Path LIKE '%MRU%' OR Path LIKE '%recent%' OR Path LIKE '%Used%' OR Path LIKE '%Usage%' OR Path LIKE '%Time%' OR Path LIKE '%Date%' OR Path LIKE '%Last%' OR Path LIKE '%Updated%' OR Path LIKE '%History%' OR valueName LIKE '%MRU%' OR ValueName LIKE '%recent%' OR ValueName LIKE '%Used%' OR ValueName LIKE '%Usage%' OR ValueName LIKE '%Time%' OR ValueName LIKE '%Date%' OR ValueName LIKE '%Last%' OR ValueName LIKE '%Updated%' OR ValueName LIKE '%History%' ORDER BY Path, ValueName" & Notepad++ %odl%\MRU-Lists.csv
:: --OR--
:: Remove this to get DataGrid: -o:CSV INTO %odl%\MRU-Lists.csv & Notepad++ %odl%\MRU-Lists.csv
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path, ValueName, Value, HEX_TO_ASC(Value) as HexValue FROM \HKCU WHERE Path LIKE '%MRU%' OR Path LIKE '%recent%' OR Path LIKE '%Used%' OR Path LIKE '%Usage%' OR Path LIKE '%Time%' OR Path LIKE '%Date%' OR Path LIKE '%Last%' OR Path LIKE '%Updated%' OR Path LIKE '%History%' OR valueName LIKE '%MRU%' OR ValueName LIKE '%recent%' OR ValueName LIKE '%Used%' OR ValueName LIKE '%Usage%' OR ValueName LIKE '%Time%' OR ValueName LIKE '%Date%' OR ValueName LIKE '%Last%' OR ValueName LIKE '%Updated%' OR ValueName LIKE '%History%' ORDER BY Path, ValueName" Error: detected extra argument "Path," after query
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Finding MRU traces: -o:CSV INTO MRU-Lists.csv ORDER BY Path, ValueName
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path, ValueName, Value, HEX_TO_ASC(Value) as Value2 FROM \HKCU WHERE Path LIKE '%MRU%' OR Path LIKE '%recent%' OR Path LIKE '%Used%' OR Path LIKE '%Usage%' OR Path LIKE '%Time%' OR Path LIKE '%Date%' OR Path LIKE '%Last%' OR Path LIKE '%Updated%' OR Path LIKE '%History%' OR valueName LIKE '%MRU%' OR ValueName LIKE '%recent%' OR ValueName LIKE '%Used%' OR ValueName LIKE '%Usage%' OR ValueName LIKE '%Time%' OR ValueName LIKE '%Date%' OR ValueName LIKE '%Last%' OR ValueName LIKE '%Updated%' OR ValueName LIKE '%History%'"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -E:-1 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM '\HKEY_CLASSES_ROOT\' WHERE KeyName LIKE '%Open with%'OR ValueName LIKE '%Open with%' OR Value LIKE '%Open with%'"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -E:-1 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM '\HKEY_CURRENT_USER\' WHERE KeyName LIKE '%Open with%'OR ValueName LIKE '%Open with%' OR Value LIKE '%Open with%'"
:: Error opening key "HKEY_CURRENT_USER\System\CurrentControlSet\Control\DeviceContainers\{00000000-0000-1000-8000-f4813906c77a}\Properties": Access is denied.
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -E:-1 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM '\\HKEY_LOCAL_MACHINE\' WHERE KeyName LIKE '%Open with%'OR ValueName LIKE '%Open with%' OR Value LIKE '%Open with%'"
:: Error: Error connecting to registry root 'HKCR' on remote machine HKEY_LOCAL_MACHINE: The network path was not found.
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -E:-1 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM '\HKEY_USERS\' WHERE KeyName LIKE '%Open with%'OR ValueName LIKE '%Open with%' OR Value LIKE '%Open with%'"
:: Error opening key "HKEY_USERS\.DEFAULT\Software\Microsoft\SystemCertificates\Root\ProtectedRoots": Access is denied.
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -E:-1 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM '\HKEY_CURRENT_CONFIG\' WHERE KeyName LIKE '%Open with%'OR ValueName LIKE '%Open with%' OR Value LIKE '%Open with%'"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:ADS 	 (Active Directory)                                           │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  ObjectPath (S)     ObjectName (S)    ObjectClass (S)  PropertyName (S)
  PropertyValue (S)  PropertyType (S)
:: LogParser -i:ADS -------------------------------------------------------------------------------
:: No Examples Yet
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:TEXTLINE (TextLine Format)                                         │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  LogFilename (S)             Index (I)             Text (S)
::LogParser -i:TEXTLINE ---------------------------------------------------------------------------
:: Great command using -i:TEXTLINE to scan cbs.log for Successful or Failed issues on a given day:
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, 'Startup-W10', Text FROM %systemroot%\Logs\CBS\CBS.log WHERE Text LIKE '%2023-04-13%' AND Text LIKE '%success%' OR Text LIKE '%failed%'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
┌───────────────────────────────────────────────────────────────────────┐
│  LogParser -i:TEXTLINE - SUBSTR(Text,StartCol(-1),Length)             │
└───────────────────────────────────────────────────────────────────────┘
:: Example code LogParser -i:TEXTLINE to read a file between lines 22 and 150 -OR- From Specific Line > 22
:: Read a file from a Specific Line to another line: WHERE Index > 23 AND Index < 135 -OR- BETWEEN Index 22 and 150
SET Root=%OneDrive%\Travel\2023 Italy\Italy Destinations for Maps.txt&echo %Date% !Time! [MSG] Root: %Root%
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT Text FROM '%Root%' WHERE Index > 23 AND Index < 135"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT SUBSTR(Text,2,6) AS Date, SUBSTR(Text,21,66) AS Destination, SUBSTR(Text,89,7) AS TripNum,SUBSTR(Text,100,1) AS Yes, SUBSTR(Text,104,40) AS GPS FROM '%Root%' WHERE Index > 23 AND Index < 135 AND Yes = 'Y'"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
+--------------------------------------------------------------------------------------------------+
¦ Search recursively through All Files in folder and search for Specific data string's...          ¦
+--------------------------------------------------------------------------------------------------+
SET Root="%ohtm%\%ComputerName%_BCSyncGarminC2D.log"
FindStr /I /C:"Load comparison:" /C:"Successfully copied" %Root%
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %Root% WHERE Text LIKE '%Load comparison%' OR Text LIKE '%Successfully copied%'"
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Parse the data FROM BC*.txt Files looking for String that begins like: #  START "StarBC"
SET Root=%OneDrive%\Batch\BC*.txt
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT SUBSTR(text, 0, 2) AS Comment, SUBSTR(text, 3, 5) AS Start, SUBSTR(text, 9, 9) AS Sbc, SUBSTR(text, 3, 999) AS Data FROM %Root% WHERE START LIKE '%Start%' AND Sbc LIKE '%StarBC%' OR Sbc LIKE '%StartBC%' ORDER BY Data ASC"
:----- Parse the following ---------------------
1...5....1....5....2....5....30   <- Note SUBSTR counts FROM 0 and not 1
SET Root=Null&SET Root=%OneDrive%\BCBackups\*.txt
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT SUBSTR(text, 101, 9) AS Fold, SUBSTR(text, 3, 200) AS Command from '%OneDrive%\BCBackups\*.txt' WHERE Fold LIKE '%BCBackups%' ORDER BY Command ASC"
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT SUBSTR(text, 3, 15) AS Start, SUBSTR(text, 3, 200) AS Command from %OneDrive%\BCBackups\*.txt WHERE START LIKE '%StartBC%' ORDER BY Command ASC"
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT SUBSTR(text, 3, 5) AS Start, SUBSTR(text, 3, 200) AS Command from %OneDrive%\BCBackups\*.txt WHERE START LIKE '%Start%' ORDER BY Command ASC"
#  START "StartBC" /D "%odl%" /High /B "C:\Program Files\Beyond Compare 4\BCompare.exe" @"%OneDrive%\BCBackups\......txt"
0....5....1....5....2....5....3....5....4....5....5....5....6....5....7....5....8....5....9....5....1....5....1....5....2
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT SUBSTR(text, 4, 5) AS Start, SUBSTR(text, 4, 200) AS Command from %OneDrive%\BCBackups\*.txt WHERE START LIKE '%Start%' ORDER BY Command ASC"
#  START "EditLog" /D "%OneDrive%\" /NORMAL Notepad++.exe "%ohtm%\%ComputerName%_BCSyncC2E.log"
#  START "StarBC"
First char 0>2 is Comment
Next  char 3,5 is Start
Next  char 3,9999 Rest of the data
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid "SELECT SUBSTR(text, 0, 1) AS RowName, SUBSTR(text, 1, 3) AS ErrorNumber, SUBSTR(text, 4, 3) AS UserId, SUBSTR(text, 7, 10) AS UserName, SUBSTR(text, 17, 4) AS SystemName FROM %odl%\temp.txt
1022303Name00    WXP3
1022303Name 1    WXP3
1022303Name 2    WXP4
:----- Parse the following ---------------------
First digit 1 is row name
Next three digit 022 is errorNumber
next three digit 303 is UserID
next ten char Name is UserName
next 4 char WXP3 is SystemName
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT * FROM '%Scripts%\book.log'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT * FROM '%Scripts%\book.log'" -i:COM -iProgID:Generic.LogParser .Scriptlet
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT id AS ID, TO_DATE(publish_Date) AS Date, author AS Author, SUBSTR(title,0,20) AS Title, STRCAT(TO_STRING(TO_INT(FLOOR(price))),SUBSTR(TO_STRING(price),INDEX_OF(TO_STRING(price),'.'),3)) AS Price FROM '%Scripts%\book.log'" -i:COM -iProgID:Generic.LogParser .Scriptlet
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT id, TO_DATE(publish_Date) AS Date, author AS Author, SUBSTR(title,0,20) AS Title, STRCAT(TO_STRING(TO_INT(FLOOR(price))),SUBSTR(TO_STRING(price),INDEX_OF(TO_STRING(price),'.'),3)) AS Price FROM '%Scripts%\book.log'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT * Text FROM %FWExp% WHERE Text LIKE 'Enabled:' and TEXT LIKE 'Rule Name:'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, 'Startup-W10', Text FROM %odl%\*Startup-W10.log WHERE Text LIKE '%RC=%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM http://www.microsoft.com WHERE Text LIKE '%href%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %OneDrive%\AboutMe_Combined.txt WHERE Text LIKE '%LogParser %'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %lpl% WHERE Text LIKE '%**DEBUG**%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %lpl% WHERE Text LIKE '%Access Denied%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, Index, Text FROM %odl%\*.log where Text like '%Access Denied%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %lpl% WHERE Text LIKE '%RC=%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %lpl% WHERE Text LIKE '%Unable to create directory%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT * FROM '%Scripts%\book.log'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT * FROM '%Scripts%\book.log'" -i:COM -iProgID:Generic.LogParser .Scriptlet
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT id AS ID, TO_DATE(publish_Date) AS Date, author AS Author, SUBSTR(title,0,20) AS Title, STRCAT(TO_STRING(TO_INT(FLOOR(price))),SUBSTR(TO_STRING(price),INDEX_OF(TO_STRING(price),'.'),3)) AS Price FROM '%Scripts%\book.log'" -i:COM -iProgID:Generic.LogParser .Scriptlet
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT id, TO_DATE(publish_Date) AS Date, author AS Author, SUBSTR(title,0,20) AS Title, STRCAT(TO_STRING(TO_INT(FLOOR(price))),SUBSTR(TO_STRING(price),INDEX_OF(TO_STRING(price),'.'),3)) AS Price FROM '%Scripts%\book.log'"

LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT Date, QUANTIZE(time, 3600) AS hour, sc-status, COUNT(*) AS Errors FROM '%IISLogs%\*.log' WHERE sc-status>=400 GROUP BY Date, hour, sc-status HAVING Errors>25 ORDER BY Errors DESC"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT DISTINCT Date, cs-uri-stem, c-ip, COUNT(*) AS Hits FROM '%IISLogs%\*.log' GROUP BY Date, c-ip, cs-uri-stem HAVING Hits>50 ORDER BY Hits Desc"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT TO_STRING(TO_TIMESTAMP(Date, time), 'yyyy-MM-dd') AS Day, cs-uri-stem, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status<400 or sc-status>=500) AND (TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' OR TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%') GROUP BY Day, cs-uri-stem ORDER BY cs-uri-stem, Day"
:: Below: 8/10/2022 5:13:17 PM  >> # SET the comparison criteria. - criteria attrib:sh TIMESTAMP:30sec;IgnoreDST rules-based timezone:left+6
LogParser -i:TEXTLINE -RTP:-1 "SELECT TOP 1 EXTRACT_SUFFIX(text,0,'TIMESTAMP') from '%odl%\*.log' where text like '%TIMESTAMP%'"
:: Need to SET the correct Time Format... below returns "-" FIX: EXTRACT_SUFFIX has a leading space. Use TRIM() on the TO_TIMESTAMP cAll. – Gabriele Giuseppini
LogParser -i:TEXTLINE -RTP:-1 "SELECT TOP 1 TO_TIMESTAMP(EXTRACT_SUFFIX(text,0,'TIMESTAMP'),'MM/dd/yyyy') from '%odl%\*.log' where text like '%TIMESTAMP%'"
LogParser -i:TEXTLINE -RTP:-1 "SELECT TOP 1 TO_DATE(TO_TIMESTAMP(EXTRACT_SUFFIX(text,0,'TIMESTAMP'),'M/d/yyyy')) from '%odl%\*.log' where text like '%TIMESTAMP%'"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:TEXTWORD (TextWord Format)                                         │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  LogFilename (S)             Index (I)             Text (S)
:: LogParser -i:TEXTWORD --------------------------------------------------------------------------
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:COM 	 (Custom COM Input Format)                                    │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
 Field names and types are retrieved at runtime FROM the specified input format plugin
:: LogParser -i:COM ------------------------------------------------------------------------------
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  LogParser -h -i:FS 	 (Filesystem properties)                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
Fields:
  Path (S)                   Name (S)                  Size (I)
  Attributes (S)             CreationTime (T)          LastAccessTime (T)
  LastWriteTime (T)          FileVersion (S)           ProductVersion (S)
  InternalName (S)           ProductName (S)           CompanyName (S)
  LegalCopyright (S)         LegalTrademarks (S)       PrivateBuild (S)
  SpecialBuild (S)           Comments (S)              FileDescription (S)  OriginalFilename (S)
CSV: Path,Name,Size,Created,LastAccess,LastWrite,FName,Ext,Attributes,Hash
:: LogParser -i:FS --------------------------------------------------------------------------------
:: NOTE: For better performance use FROM <Folder>\*.* and WHERE Name LIKE '%<xxx>%' (Also FROM <Folder>\*fn.ext)
:: SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM
:: Use case statement if looking for Files today and last 31 days:
:: SELECT CASE
::    WHEN LastWriteTime=0 THEN 'Within Day'
::    WHEN LastWriteTime BETWEEN 1 AND 31 THEN 'Within Month'
::    ...
:: END AS Last_Written
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: This instructs Log parser to output the results in NATIVE format with All rows at once, and redirect it to HttpVerbs.txt
:: Navigate to the directory where you Installed the query samples, and enter the following [should execute the LogParser sql file]
cd "%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 02\Scripts"
LogParser file:Ch02HttpVerbs.sql –o:NAT –rtp:-1 > HttpVerbs.txt
LogParser file:Ch02HttpVerbs.sql -i:TEXTLINE -q:Off >>%odl%\LogParser SQL-File%.log  2>&1
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo List all Files in Folder listing all File Hashes&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size as Bytes,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash INTO '%ohtm%\DuplicateHashes.csv' FROM 'J:\*.*' ORDER BY Hash DESC"&Notepad++ "%odl%\DuplicateHashes.csv"

echo report of All file extensions that exist within your web content&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as Files from c:\inetpub\wwwroot\*.*, c:\inetpub\scripts\*.* WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
:: Example below Lists All file extensions in given Root Folder, then based on the number of the extension you want to examine now list All file hashes to fild duplicate File hashes. This is NOT the same as looking for aHash, pHash or dHash. But it's start...
SET Root=%OneDrive%
SET Root=C:\GalaxyS8+\DCIM\Camera
SET Root=Garmin
SET csv=%ohtm%\%ComputerName%_FindDupHashes_%Root%.csv
SET csv=%OneDrive%\MSExcel\%Root%FindDupHashes.csv
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size as Bytes,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash INTO '%csv%' FROM 'C:\%Root%\*.*' ORDER BY Hash DESC"
&Notepad++ "%csv%"
:: Imported data into Access then did a duplicate query then export back to csv... -nFields:-1 -dtLines:100
LogParser -i:CSV -rtp:-1 -o:datagrid -headerRow:On -iDQuotes:Auto -fixedFields:OFF "SELECT Hash, Bytes, Path FROM %OneDrive%\MSExcel\FindDupHashes.csv WHERE Path LIKE '%Backup%'

:: Count File Extensions, Size and Number of Files -rtp:-1 -o:datagrid
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as Files, SUM(Size) as Bytes FROM "C:\%Root%\*.*" WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
:: Get a list of All Image .jpg Files in folder: Check for duplicate Hashes -
echo Find Duplicate File Hashes
echo RowHeader: Path,Name,Bytes,Created,LastAccess,LastWrite,FName,Ext,Attributes,Hash
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size as Bytes,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM C:\%Root%\*.* ORDER BY Hash DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size as Bytes,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash INTO '%csv%' FROM 'C:\%Root%\*.*' ORDER BY Hash DESC"&Notepad++ "%csv%"
echo RowHeader: Hash,Path,Name,Bytes,Created,LastWrite,Attributes
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash,Path,Name,Size as Bytes,CreationTime AS Created,LastWriteTime AS LastWrite,Attributes FROM '%Root%\*.jpg' ORDER BY Hash"
echo Output data to CSV:
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -o:CSV "SELECT HASHMD5_FILE(Path) AS Hash,Path,Name,Size as Bytes,CreationTime AS Created,LastWriteTime AS LastWrite,Attributes INTO '%csv%' FROM '%Root%\*.jpg' ORDER BY Hash"&Notepad++ %csv%

SET Root=C:&echo Root: %Root% & echo Find All Specific Folders: %Root%%
:: Below encloses output fields with double quotes:
LogParser -i:FS -o:CSV -oDQuotes ON -stats:On -q:off -Recurse:-1 -E:-19 "SELECT DISTINCT EXTRACT_PATH(Path) AS Pat INTO '%ohtm%\%ComputerName%_SpecificFolders_C.csv' FROM '%Root%\*.*' WHERE Attributes LIKE 'D%' AND Pat LIKE '%Google%' AND Pat NOT LIKE '%\.%' ORDER BY Pat ASC" 2>&1 >>%log%&Notepad++ "%ohtm%\%ComputerName%_SpecificFolders_C.csv"
LogParser -i:FS -rtp:-1 -o:datagrid -stats:On -q:off -Recurse:-1 -E:-1 "SELECT DISTINCT EXTRACT_PATH(Path) AS Pat FROM '%Root%\*.*' WHERE Attributes LIKE 'D%' AND Pat LIKE '%Google%' AND Pat NOT LIKE '%\.%' ORDER BY Pat ASC" 2>&1 >>%log%&Notepad++ "%ohtm%\%ComputerName%_SpecificFolders_C.csv"

:: DIV(TO_REAL(SUM(Size)),1024) as MB     GROUP BY MB
::	Error: Semantic Error: presence of field(s) and aggregate function(s) in the SELECT clause with no GROUP BY clause
::	Error: GROUP BY clause: Semantic Error: GROUP BY clause contains aggregate functions
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +--------------------------------------------------------------------+
:: | Find Specific Files Using Path Folder, File Name and Extension     |
:: ¦ -i:FS Find Specific File - Find File Name and Ext                  ¦
:: ¦ -AND- Fix possible Access Denied issue on file                     ¦
:: +--------------------------------------------------------------------+
echo Find Specific MP4 Files in folder&LogParser -i:FS -stats:On -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\*.mp4" WHERE Hash IS NOT NULL AND Size >=10000 ORDER BY Created,Path DESC"
echo Find Specific Files in folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "%OneDrive%\*.*" WHERE FName LIKE '%statement%' AND Ext LIKE '%pdf%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
echo Find Specific Files in folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\inetpub\*.*" WHERE Ext LIKE '%pdf%' AND Hash IS NOT NULL AND Size >=10 ORDER BY FName ASC"
echo Find Specific Files Windows Terminal&LogParser -i:FS -rtp:-1 -o:datagrid -q:on -stats:On -Recurse:-1 -E:-19 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM C:\wt.exe"
echo Find Specific Files Windows Terminal&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\*.*" WHERE FName LIKE '%wt%' AND Ext LIKE '%exe%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
echo Find Specific PDF Files&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -E:-1 "SELECT Path,Name,Size,HASHMD5_FILE(Path) AS Hash,CreationTime,LastAccessTime,LastWriteTime FROM '%OneDrive%\*.pdf' WHERE Name NOT LIKE '%documentation%' ORDER BY Path,Name ASC"
echo Find Specific IIS PDF Files&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -E:-1 "SELECT Path,Name,Size,HASHMD5_FILE(Path) AS Hash,CreationTime,LastAccessTime,LastWriteTime FROM 'C:\inetpub\wwwroot\*.pdf' WHERE Name LIKE '%documentation%' ORDER BY Path,Name ASC"
echo Find Specific IIS PDF Paths&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -E:-1 "SELECT Path FROM 'C:\inetpub\wwwroot\*.pdf' WHERE Path LIKE '%documentation%' ORDER BY Path ASC"
echo List EVERY Folder in Root&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Attributes,CreationTime,LastAccessTime,LastWriteTime FROM 'C:\inetpub\wwwroot\*.*' WHERE Attributes LIKE 'D%' ORDER BY LastWriteTime,Path DESC"
echo List Only Folders in Root&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:0 "SELECT Path FROM 'C:\inetpub\wwwroot\*.*' WHERE Attributes LIKE 'D%' ORDER BY Path ASC"
echo List Only Root Folders in Root&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:0 "SELECT Path,Attributes,LastAccessTime,LastWriteTime FROM 'C:\inetpub\wwwroot\*.*' WHERE Attributes LIKE 'D%' ORDER BY Path ASC"
echo Find Specific Folder Path&LogParser -i:FS -stats:On -q:on -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size FROM "C:\*.*" WHERE Path LIKE '%Ubuntu%' AND Size >=1 ORDER BY Path DESC"
echo Find Specific Folder string&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "%Root%\*.*" WHERE Path LIKE '%Help%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
echo Find Packages/Installations&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,HASHMD5_FILE(Path) AS Hash FROM "%LOCALAPPDATA%\*.*" WHERE Path LIKE '%Packages%' AND Ext LIKE '%log%' OR Ext LIKE '%exe%' OR Ext LIKE '%msi%' OR Ext LIKE '%%iso%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
:: NOTE: This is NOT Between:... 1 hr ago = 0000-01-02 01:00:00 - 1 Day ago = 0000-01-02 00:00:00 - 1 Week ago = 0000-01-07 00:00:00
:: All Fields: Path,Name,Size,Attributes,CreationTime,LastWriteTime,FileVersion,ProductVersion,InternalName,ProductName,CompanyName,LegalCopyright,LegalTrademarks,PrivateBuild,Comments,FileDescription,OriginalFilename
echo Find All Dot-Underscore Files 4k&echo Find Specific Files in folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\$Data\*.*" WHERE FName LIKE '%._%' AND Hash IS NOT NULL AND Size <=40 ORDER BY Created,Path DESC"
:: AND Ext LIKE '%pdf%'
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Find all Hyper-V Virtual Disks in folder.
Dir /S D:\Hyper-V\*.avhdx
Dir /S D:\Hyper-V\*.vhdx
Dir /S D:\Hyper-V\*.vmcx
echo Find Specific Files in folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM 'D:\Hyper-V\*.*x' WHERE Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Find Specific DISTINCT Folders
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT DISTINCT Path As Folder, CreationTime As Created, LastAccessTime AS LastAccess, LastWriteTime AS LastWrite, Attributes FROM "%OneDrive%\*.*" WHERE Folder LIKE '%4MB014597%' AND Attributes LIKE 'D%' ORDER BY LastWrite,Folder DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::echo Find Specific Files in Garmin folders&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,EXTRACT_FILENAME(Name) AS FName, TO_INT(DIV(size,1048576)) AS Size(Mb), LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\Garmin\*.txt" WHERE Hash IS NOT NULL AND Size >=10 ORDER BY Size(Mb) DESC"
echo Find All Garmin Backup Files&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,EXTRACT_FILENAME(Name) AS FName, size AS Size(Bytes), LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\Garmin\*.Backup" WHERE Hash IS NOT NULL AND Size >=10 ORDER BY LastWrite DESC"

echo Find Garmin Backups BobM2022 Files folders&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,EXTRACT_FILENAME(Name) AS FName, size AS Size(Bytes), LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\Garmin\Backups\BobM2022\*.Backup" WHERE Hash IS NOT NULL AND Size >=10 ORDER BY LastWrite DESC"
echo Find Specific Files in Garmin folders&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,EXTRACT_FILENAME(Name) AS FName, size AS Size(Bytes), LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\Garmin\*.txt" WHERE Hash IS NOT NULL AND Size >=10 ORDER BY LastWrite DESC"
echo Find Specific Files in Garmin folders&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,EXTRACT_FILENAME(Name) AS FName, size AS Size(Bytes), LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\Garmin\*.gma" WHERE Hash IS NOT NULL AND Size >=10 ORDER BY Path DESC"
echo Find Specific Files in Garmin folders&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,EXTRACT_FILENAME(Name) AS FName, size AS Size(Bytes), LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\$Data\*.txt" WHERE Hash IS NOT NULL AND Size >=10 ORDER BY LastWrite DESC"
echo Find Specific ost or pst Files in folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM '%Data%\*.*' WHERE Ext LIKE '%ost%' OR Ext LIKE '%pst%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
  %Data%    \\X570\C$   E:\$Data Ext LIKE '%txt%' AND
echo Find Specific Garmin Files in folders&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,EXTRACT_FILENAME(Name) AS FName,TO_INT(Size) AS Size,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\$Data\*.txt" WHERE FName LIKE '%garmin%' OR FName LIKE '%base%'  AND Hash IS NOT NULL AND Size >=10 ORDER BY LastWrite DESC"
echo Find Specific Files in Garmin folders&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,EXTRACT_FILENAME(Name) AS FName,TO_INT(Size) AS Size,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "H:\Garmin\*.txt" WHERE FName NOT LIKE '%Owner%' AND FName NOT LIKE '%%id%' AND Hash IS NOT NULL AND Size >=10 ORDER BY LastWrite DESC"
, TO_INT(Size) AS Size   DIV(size,1048576) AS Size(Mb)   ORDER BY DIV(Size, 1048576) DESC
Del /S /Q "%odl%\Text\*.*"&XCopy "H:\Garmin\*.txt" "%odl%\Text\." /I /D /S /H /C /Y /X /COMPRESS

echo Find Specific Files in Garmin folders&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,EXTRACT_FILENAME(Name) AS FName, size, LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "C:\Garmin\*.txt" WHERE Hash IS NOT NULL AND Size >=10 ORDER BY size DESC"
Notepad++ "C:\Garmin\Garmin-Test\Software\OpenStreetMap mkgmap\mkgmap-r4255\examples\known-hgt.txt"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Find Specific File Name and ext&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime FROM '"C:\Program Files\Norton Security"\*.exe' ORDER BY CreationTime DESC"
SET Root=C:\Program Files\Norton Security\{16EF3814-3CDE-4495-9EF4-ACE994E26895}\Engine\22.22.4.11\uiStub.exe
echo Fix OneDrive File/Folder Sync Issue & SubInACL /file "%Root%" /grant=%USERDOMAIN%\%USERNAME% & SubInACL /subdirectories "%Root%" /grant=%usr%
Ren "%Root" uiStub.exe.old
echo Find Specific Office Files&LogParser -i:FS -Recurse:0 -rtp:-1 -o:datagrid -q:off "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime FROM "%appdata%\Microsoft\Templates\*.*","%appdata%\Microsoft\Spelling\en-US\default.*" ORDER BY CreationTime DESC"
SET Root=NULL&SET Root=%OneDrive%\*.*&echo Find Files in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "%Root%" WHERE Path LIKE '%Microsoft%' AND FName LIKE '%Default%' OR FName LIKE '%Normal%' OR Ext LIKE '%dic%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Find Specific File by name or extension...
SET Root=NULL&SET Root=F:\$Software\*.*&echo Find Files in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM '%Root%' WHERE Path LIKE '%Adobe Premiere%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
SET Root=NULL&SET Root=%OneDrive%\*.*&echo Find Files in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name, TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM '%Root%' WHERE Path LIKE '%Normal%' AND Ext LIKE '%dotm%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
SET Root=NULL&SET Root=$Data\*.*&echo Find Files in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM '%Root%' WHERE  Ext LIKE '%dotm%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
SET Root=NULL&SET Root=C:\$Data\*.*&echo Find Files in folder %Root%
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM 'C:\$Data\*.*' WHERE Path LIKE '%Normal%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM 'C:\$Data\*.*' WHERE Ext LIKE '%pdf%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"

echo Find Specific File: %OneDrive%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash, CreationTime, LastWriteTime, Path, Name, Size, Attributes, EXTRACT_EXTENSION(Name) AS Ext FROM %OneDrive%\Queries.xml ORDER BY Hash DESC"
echo Fin Specificd File: %AppData%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash, CreationTime, LastWriteTime, Path, Name, Size, Attributes, EXTRACT_EXTENSION(Name) AS Ext FROM %AppData%\rasphone.pbk ORDER BY Hash DESC"
echo Find Specific File: C:\$Software&LogParser -i:FS -stats:On -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash, CreationTime, LastWriteTime, Path, Name, Size, Attributes, EXTRACT_EXTENSION(Name) AS Ext FROM C:\$Software\*(2).* ORDER BY Hash DESC"
echo Find Specific File Path: C:\$Software&LogParser -i:FS -stats:On -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT Path, HASHMD5_FILE(Path) AS Hash FROM C:\$Software\*(2).* ORDER BY Path DESC"

LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT TOP 50 Path, CreationTime, Size FROM C:\$Data\rasphone.pbk ORDER BY CreationTime DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: List All Files in a Specific folder %OneDrive%\Desktop
echo List All Files in folder %OneDrive%\Desktop&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash,LastWriteTime FROM '%OneDrive%\Desktop\*.*' ORDER BY Size,Path DESC"
,EXTRACT_FILENAME(Name) AS FName,CreationTime AS Created,LastAccessTime AS LastAccess  AS LastWrite WHERE Attributes LIKE 'D%' AND Size >=1 AND Ext <> NULL AND Hash IS NOT NULL AND Path NOT LIKE '%\.%'
::Get a list of All Files with (zero) 0 bytes [Attributes LIKE 'D%'] - Folder---> AND Path NOT LIKE '%\.%' ORDER BY Path ASC
SET Root=F:\$Music
SET Root=E:\$Data
SET Root=C:\$Data
:: Does Not Work - echo List All Files with (zero) 0 bytes in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -stats:On "SELECT Path,Name,Size,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite FROM '%Root%\*.*' WHERE Size =0 AND Ext <> NULL AND Attributes LIKE 'D%' AND Path NOT LIKE '%\.%' AND Hash IS NOT NULL ORDER BY Path DESC"
:: Test   DIV(TO_REAL(SUM(Size)),1024) as MB
:: Does Not Work - echo List All Files with (zero) 0 bytes in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -stats:On "SELECT Path,Name,Size,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite FROM '%Root%\*.*' WHERE Size =0 AND Attributes LIKE 'D%' AND Ext <> NULL AND Hash IS NOT NULL ORDER BY Path DESC"
 AND Path NOT LIKE '%\.%'
echo List All Files with (zero) 0 bytes in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -stats:On "SELECT Path,Name,Size,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite FROM '%Root%\*.*' WHERE Size =0 AND Attributes LIKE 'D%' AND Path NOT LIKE '%\.%' AND Hash IS NOT NULL ORDER BY Path DESC"
 AND Ext <> NULL
:: End Test
echo List All Folders %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -stats:On "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Size =0 AND Attributes LIKE 'D%' ORDER BY Pat DESC"
SET Allfields=ComputerName,EXTRACT_PATH(Path) AS Folder,EXTRACT_FILENAME(Path) AS Filename,KeyName,ValueName,ValueType,Value,LastWriteTime,Value,HEX_TO_ASC(Value) as HexValue,LastWriteTime
::  echo List 100 largest Files over 1 year old on the C: drive&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -stats:On "SELECT TOP 100 EXTRACT_PATH(Path) AS Folder, EXTRACT_FILENAME(Path) AS Filename, DIV(TO_REAL(SUM(Size)),1024) as MB , LastWriteTime, HASHMD5_FILE(Path) AS Hash FROM C:\*.* WHERE LastWriteTime < SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0001', 'yyyy')) ORDER BY DIV(Size, 1048576) DESC"

:: Below are Development tests --------------------------------------
, Attributes, HASHMD5_FILE(Path) AS Hash
, EXTRACT_PATH(Path) AS Pat
 Path LIKE '%$Music%' AND
 Path LIKE '%Data%' AND
 Path LIKE '%Normal%' AND
 AND Hash IS NOT NULL AND Size >=10 ORDER BY ToDay,Pat DESC
 AND TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss')))
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌────────────────────────────────────────┐
│  Outlook related queries               │
└────────────────────────────────────────┘
:: Dir "%UserProfile%ars\AppData\Local\Microsoft\Outlook\*.ost"
:: echo XCopy MSOutlook C E&START "Backup Outlook" /D "%odl%" /High /B XCopy "%LOCALAPPDATA%\Microsoft\Outlook\*.*" "C:\$Data\MSOutlook\." /C /F /G /D /I /S /R /H /Y /Z /J

LogParser -i:FS -rtp:-1 -o:datagrid -q:on -stats:On -Recurse:-1 "SELECT Path, Name, Size, Attributes FROM '%UserProfile%\*.ost' ORDER BY Size DESC"
LogParser -i:FS -rtp:-1 -o:datagrid -q:on -stats:On -Recurse:-1 "SELECT TOP 100 Path, Name, Size, Attributes FROM '%OneDrive%\MSOutlook\*.*' ORDER BY Size DESC"
LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \HKCU\SOFTWARE\Microsoft\Office\16.0\Outlook ORDER BY Path"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, SID, SourceName, Message FROM Application, Security, System HAVING SourceName = 'Outlook'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, SID, SourceName, Message FROM Application WHERE EventID IN (25;27;29;30;32;36;45;55) HAVING SourceName = 'Outlook'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, SID, SourceName, Message FROM Application HAVING SourceName = 'Outlook'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING SourceName = 'Outlook'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, SID, SourceName, Message FROM Application, Security, System HAVING SourceName = 'Outlook'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, SID, SourceName, Message FROM Application WHERE EventID IN (25;27;29;30;32;36;45;55) HAVING SourceName = 'Outlook'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, EventID, SID, SourceName, Message FROM Application HAVING SourceName = 'Outlook'" -resolveSIDs:ON
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventLog, RecordNumber, TimeGenerated, EventID, EventType, EventTypeName, EventCategory, SourceName, ComputerName, Message FROM Application, Security, System WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 00:10', 'yyyy-MM-dd HH:mm'))) HAVING SourceName = 'Outlook'"

Get-EventLog -LogName Application -Source Outlook | Where-Object {$_.EventID -eq 63} Select-Object -Property Source, EventID, InstanceId, Message
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│         Find All Files in Garmin Folders          │
└───────────────────────────────────────────────────┘
Error: Garmin Express Fails to Complete the "Downloading Files" Stage or Error Installing Message - https://support.garmin.com/en-US/?faq=GuclsqmdI02dC0ULxHR2T6
echo List All Files Nuvi 16Gb SD card H:\&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash,LastWriteTime FROM 'H:\*.*' ORDER BY Size DESC"
:: Garmin Folders... Find maps and data

echo Find Garmin Maps on PC&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 50  Path,Name,Size as Bytes,HASHMD5_FILE(Path) AS Hash,CreationTime AS Created,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext, Attributes FROM 'C:\ProgramData\Garmin\Maps\*.*' WHERE Hash IS NOT NULL AND Bytes >=1 ORDER BY LastWrite,Bytes DESC"
:: Garmin Look for data in GPX file
echo Find All Database .gdb Files&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size as Bytes,HASHMD5_FILE(Path) AS Hash,CreationTime AS Created,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext, Attributes FROM 'C:\Garmin\*.*' WHERE Hash IS NOT NULL AND Bytes >=1 AND Ext LIKE '%gdb%' ORDER BY LastWrite,Bytes DESC"
echo Find All Map Unlock .ucx Files&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size as Bytes,HASHMD5_FILE(Path) AS Hash,CreationTime AS Created,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext, Attributes FROM 'C:\Garmin\*.*' WHERE Hash IS NOT NULL AND Bytes >=1 AND Ext LIKE '%ucx%' ORDER BY LastWrite,Bytes DESC"
:: C:\Garmin\GPX\CurrentTrackLog.gpx
SET Root=C:\Garmin&echo List All File Extensions %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) AS Files FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' AND Extension IS NOT NULL AND Extension NOT LIKE '%htm%' GROUP BY Extension ORDER BY Files DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,HASHMD5_FILE(Path) AS Hash FROM C:\Garmin\*ArizonaTrip*.* ORDER BY Size DESC"
:: Find All Garmin Backups      Date,Size,CreationTime,LastAccessTime,LastWriteTime,
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path AS Location, EXTRACT_PATH(Path) AS Part, Name AS FileName, EXTRACT_EXTENSION(Name) AS Ext, Size, LastWriteTime, HASHMD5_FILE(Path) AS Hash FROM C:\Garmin\*.Backup ORDER BY LastWriteTime DESC"
:: Slower that above... LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path AS Location, EXTRACT_PATH(Path) AS Part, Name AS FileName, EXTRACT_EXTENSION(Name) AS Ext, Size, LastWriteTime, HASHMD5_FILE(Path) AS Hash FROM C:\Garmin\*.* WHERE Ext LIKE '%Backup%' ORDER BY LastWriteTime DESC"
::
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100  EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM C:\Garmin\*.dbf ORDER BY Size DESC"
echo Find top 50 GPX Files&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 50  Path,Name,Size as Bytes,HASHMD5_FILE(Path) AS Hash,CreationTime AS Created,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext, Attributes FROM 'C:\Garmin\GPX\*.*' WHERE Hash IS NOT NULL AND Bytes >=1 AND Ext LIKE '%gpx%' ORDER BY LastWrite,Bytes DESC"
:: Find Garmin Specific Files -  Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash Pat LIKE '%BaseCamp%' AND
SET Root=C:\Garmin\*.*&echo Find Files in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As Created, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM "%Root%" WHERE Pat LIKE '%BaseCamp%' AND Ext LIKE '%Backup%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM C:\Garmin\*.Backup ORDER BY Size DESC"
SET Root=C:\Garmin\*.*&echo Find Files in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As Created, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM "%Root%" WHERE  Ext LIKE '%Backup%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created DESC"
SET Root=C:\Garmin\*.backup&echo Find Files in folder %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As Created, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM "%Root%" WHERE Hash IS NOT NULL AND Size >=10 ORDER BY Created DESC"
C:\Program Files\Beyond Compare 4    %AppData%   %UserProfile%ars\AppData   C:\Program Files\Norton Security
SET Root=C:\Windows
echo Find file in multiple drives&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM "E:\*.*,F:\*.*,G:\*.*,H:\*.*,N:\*.*" WHERE Name LIKE '%24%' AND Ext LIKE '%%iso%' AND Hash IS NOT NULL AND Size >=4096 ORDER BY CreationTime,Pat DESC"

echo Find file in multiple drives Output to CSV&LogParser -i:FS -q:off -Recurse:-1 -o:CSV -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, Name, EXTRACT_EXTENSION(Name) AS Ext, CreationTime As ToDay, Size, HASHMD5_FILE(Path) AS Hash INTO %odl%\All-ISO.csv FROM "E:\*.*,F:\*.*,G:\*.*,H:\*.*,N:\*.*" WHERE Ext LIKE '%%iso%' AND Hash IS NOT NULL AND Size >=4096 ORDER BY CreationTime,Pat DESC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
#--------------------------------------------------------------------------------------------------
#                Use LogParser to analyse Specific folder
#             Count the File Extensions to see what we have...
#--------------------------------------------------------------------------------------------------
SET Root=C:\Garmin
echo Display File Ext and counts&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:2 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS FileExt, COUNT(*) as FileCount FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY FileExt ORDER BY FileCount DESC"
echo Find Specific File Name and ext&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime FROM '%Root%\*.htm' ORDER BY CreationTime DESC"
LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:2 "SELECT DISTINCT Path, EXTRACT_PATH(Path) AS Pat, CreationTime As Created, DIV(TO_REAL(SUM(Size)),1024) as Mb, HASHMD5_FILE(Path) AS Hash, Attributes FROM '%Root%\*.*' WHERE Path LIKE '%Help%' GROUP By Path ORDER BY Hash DESC"
echo List DISTINCT Folders and Date Created&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:2 "SELECT DISTINCT EXTRACT_PATH(Path) AS Pat, CreationTime As Created, Attributes FROM '%Root%\*.*' WHERE Pat LIKE '%Help%' AND Attributes LIKE '%D----C---%' ORDER BY Pat DESC"
echo List DISTINCT Folders Only&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:2 "SELECT DISTINCT EXTRACT_PATH(Path) AS Pat, Attributes FROM '%Root%\*.*' WHERE Pat LIKE '%Help%' AND Attributes LIKE '%D----C---%' ORDER BY Pat DESC"
:: To remove unwanted folders use: RMDIR /S /Q "G:\Garmin\zūmo595\zūmo595\Help\Ukrainian"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET FindFile=*_clause.htm
SET Root=C:\inetpub\wwwroot\LogParser Documentation
SET Root=E:\$Data
echo Find Specific File: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash, CreationTime, LastWriteTime, Path, Name, Size, Attributes FROM %Root%\%FindFile% ORDER BY Hash DESC"

"%Root%\Queries*.xml" -  %USERPROFILE%
SET Root=%OneDrive%
echo Find Specific File: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash, CreationTime, LastWriteTime, Path, Name, Size, Attributes FROM %Root%\Italy*.xlsx ORDER BY Hash DESC"
SET Root=E:\$Data
echo Find Specific File: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:on -Stats:On -Recurse:-1 -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash, CreationTime, LastWriteTime, Path, Name, Size, Attributes FROM %Root%\AutoStartx64*.*ahk* ORDER BY LastWriteTime DESC"

:: dir "%LOCALAPPDATA%\Microsoft\WindowsApps\wt.exe"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,FileVersion,CompanyName,FileDescription,OriginalFileName FROM %Root%\*.* ORDER BY CreationTime DESC"    :: WHERE Size >= 0
rmdir /S /Q "%UserProfile%ars\AppData\Local\Packages\."
SET Root=C:\wt.ex
SET Root=C:\Garmin\*.srf
echo Find File Specific Name and ext&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime FROM %Root% ORDER BY CreationTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime FROM C:\wt.exe"
"%LOCALAPPDATA%\Microsoft\WindowsApps\wt.exe"
:: Find Specific word, Text String, Needle in Haystack,in a number of log Files...
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT Text as LineFROMFile FROM %log%\*.log WHERE Text LIKE '%Access Denied%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT Text as LineFROMFile FROM %log%\*.log WHERE Text LIKE '%:Func-XCopy%'"
:: Below search recursively through folder for Specific filename.ext: .. TOP 100
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, Size, Attributes FROM 'C:\*.msi' ORDER BY Path, Size DESC"
Find top 90 Files:
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 90 Path, CreationTime, Name, Size, Attributes FROM %OneDrive%\*.* ORDER BY CreationTime DESC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
SET Root=E:\$Archive-(DoNotDelete)&echo Find FileName or Ext in folder: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT Path,Name,CreationTime,Size,EXTRACT_EXTENSION(Name) AS Ext,HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Name LIKE '%EditHostsFile%'"
SET Root=C:\&echo Find FileName or Ext in folder: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:-1 "SELECT Path,Name,CreationTime,Size,EXTRACT_EXTENSION(Name) AS Ext,HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Name LIKE '%Whitewater%' OR Name LIKE '%Pengwin%'"
SET Root=%OneDrive% & echo Find FileName or Ext in folder: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:5 "SELECT Path, Name, EXTRACT_EXTENSION(Name) AS Ext, CreationTime, Size, HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Name LIKE '%Ch%' AND Ext LIKE '%hta%'"
SET Root=%ProgramFiles% & echo Find FileName or Ext in folder: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:5 "SELECT Path, Name, EXTRACT_EXTENSION(Name) AS Ext, CreationTime, Size, HASHMD5_FILE(Path) AS Hash FROM '%Root%\*.*' WHERE Name LIKE '%GWSL_vcxsrv%' OR Name LIKE '%pulseaudio%' AND Ext LIKE '%exe%'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Below Test...Find duplicate hash values in the system folder:
echo Find duplicate hash values: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -e:0 "SELECT HASHMD5_FILE(Path) AS Hash, COUNT(*) AS NumberOfCopies FROM C:\Windows\System32\*.exe GROUP BY Hash HAVING NumberOfCopies > 1"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│   Software Install/UnInstall EventID              │
└───────────────────────────────────────────────────┘
:: https://learn.microsoft.com/en-US/windows/deployment/update/windows-update-logs
:: see:
:: Notepad++ %windir%\Windowsupdate.log   <-- Windows Update logs are now generated using ETW (Event Tracing for Windows).
:: Notepad++ C:\ProgramData\USOShared\Logs\NotificationUxBroker.etl
:: Notepad++ C:\ProgramData\USOShared\Logs\UpdateSessionOrchestration.etl
Notepad++ %systemroot%\Logs\CBS\CBS.log
2023-04-13
:: Software Installs (1033;11707) -AND- Software UnInstalls (1034;11724) - SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02 01:00', 'yyyy-MM-dd HH:mm') ) AND
:: Below audits and evaluates 4697(S): A service was installed in the system. plus if software was installed or uninstalled
LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT TimeGenerated AS EventTime, resolve_sid(sid) AS UserName, EventID, ComputerName, Message, Data FROM Application, Security WHERE EventID IN (1033;1034;4697;11707;11724) AND Message Like '%Product:%'"
echo Check Processes and Object access&LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT TimeGenerated AS EventTime, resolve_sid(sid) AS UserName, EventID, ComputerName, Message, Data FROM Application, Security WHERE EventID IN (4688;4663;4799;4698;4656;1102;4672;5140) AND Message Like '%Product:%'"
LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT TimeGenerated AS EventTime, resolve_sid(sid) AS UserName, EventID, ComputerName, Message, Data FROM Application WHERE EventID IN (1034;11724) AND Message Like '%Duplicate%'"

echo Software Installations Today && LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT TimeGenerated, resolve_sid(sid) AS UserName, SourceName, EventCategoryName, message AS Message FROM Application WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) AND EventType IN (1033;11707;1034;11724)"

echo Software Installations && LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT * FROM Application WHERE EventID IN (1033;11707;1034;11724)"
LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT * FROM Application WHERE EventID IN (903;904;6;1022;1033;7045;907;908;7000;800;2;905;906;19)"
LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT * FROM Application WHERE EventID IN (101;102;103;104;105;106;107;108;109;110;201;202;203;204;301;302;303;304;305;306;307;308;592;1033;1034;11707;11724)"

Office Something went wrong Sorry, we ran into a problem. Error Code: 30015-11 (2147942405)
Fix?: https://support.microsoft.com/en-us/office/fix-office-Installation-errors-d5df89a9-0507-4b4c-92f9-22f457e630aa?ns=ocsac2rInstall&version=16&syslcid=1033&uilcid=1033&appver=cin160&helpid=%222147942405-11-30015%22&ui=en-us&rs=en-us&ad=us
Remember a one-time purchase version of Office is licensed for one Install only.
:: Identify and count file extensions of Every file in path:
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as Files FROM %OneDrive%\*.* WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
SET Root=E:\LogParser Documentation
SET Root=S:\$Archive-(DoNOTEelete)\$Data\$QData
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as Files FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
echo List All Folder paths in Root Directory
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Attributes,CreationTime,LastAccessTime,LastWriteTime FROM %OneDrive%\*.* WHERE Attributes LIKE 'D%' ORDER BY LastWriteTime,Path DESC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────────────────────┐
│ -i:TEXTLINE - FROM command                                        │
│    Read a Text Log/File and look for a Specific string...         │
│    Find Specific data string...                                   │
└───────────────────────────────────────────────────────────────────┘
::-i: textline--------------------------------------------------------------------------------------
REM Set the root directory
SET "Root=C:\$Data\Drivers"
REM Display the current date and time, and the root directory
echo %DATE% %TIME% [RC !ERRORLEVEL!] Root=%Root%
REM Run LogParser to find the specific text "mouse" within .ini and .inf files
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename AS Ext, Text FROM '%Root%\*' WHERE (Ext LIKE '%.ini' OR Ext LIKE '%.inf') AND Text LIKE '%mouse%'"

LogParser -i:TEXTLINE -h      AND   LogParser -i:TEXTLINE -h EXAMPLES
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM E:\$Data\*.* WHERE Text LIKE '%SET yyyy%'"
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %OneDrive%\AboutMe_Combined.txt WHERE Text LIKE '%LogParser %'"
:: Find Specific Data or Text string in log Files:
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid -Recurse:-1 "SELECT LogFilename, Text as LineFROMFile FROM %log%\*.log WHERE Text LIKE '%:Func-XCopy%'"

LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM "%odl%\T520-PROPRE_vlc-3.0.16-msi.log" WHERE Text LIKE '%Executing op:%'"
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM "%odl%\T520-PROPRE_vlc-3.0.16-msi.log" WHERE Text LIKE '%feature%'"
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM "%odl%\T520-PROPRE_vlc-3.0.16-msi.log" WHERE Text LIKE '%MSI%'"
===================================================================================================
:: Pulled the Header info FROM spam emails, and scan for Specific data:...
SET Inp=%OneDrive%\Spam\SpamFROMFucktrumpAsshole.txt
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %%inp% WHERE Text LIKE '%Return-Path:%'"
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %%inp% WHERE Text LIKE '%Received: FROM%'"
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %%inp% WHERE Text LIKE '%FROM: %'"
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %%inp% WHERE Text LIKE '%@bounce%'"
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %%inp% WHERE Text LIKE '%List-Unsubscribe-Post:%'"
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %%inp% WHERE Text LIKE '%Complaints:%'"
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %%inp% WHERE Text LIKE '%d=%'"
LogParser -i:TEXTLINE -q:Off -rtp:-1 -o:datagrid "SELECT LogFilename, Text FROM %%inp% WHERE Text LIKE '%%i=%'"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────────────────────┐
│ -i:ETW (Event Tracing for Windows)                                │
└───────────────────────────────────────────────────────────────────┘
::-:ETW----------------------------------------------------------------------------------------------------------------
LogParser -h Examples -i:ETW
::  the IIS events FROM an ETW trace, grouped together by request:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventName, EventTypeName, TIMESTAMP, HASHSEQ(ContextId) AS Id INTO DATAGRID FROM iistrace.etl WHERE ContextId IS NOT NULL ORDER BY Id, TIMESTAMP ASC" -providers:myfile.guid -fmode:full
:: List FROM an ETW trace All the filepaths accessed by IIS:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT FileName, COUNT(*) AS Total INTO filenames.w3c FROM iistrace.etl GROUP BY FileName ORDER BY Total DESC" -providers:"IIS: WWW Server" -fmode:full -o:W3C -encodeDelim:ON
:: Powershell - Get-ChildItem %Root% -Recurse -File | Get-FileHash
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────────────────────┐
│ -i:FS File System                                                 │
└───────────────────────────────────────────────────────────────────┘
::-:FS-----------------------------------------------------------------------------------------------------------------
SET fields=HASHMD5_FILE(Path) AS Hash,Path,Name,Size,Attributes,CreationTime,LastWriteTime,FileVersion,ProductVersion,InternalName,ProductName,CompanyName,LegalCopyright,LegalTrademarks,PrivateBuild,Comments,FileDescription,OriginalFilename
echo List every Field on Files&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT %fields% FROM '%Root%' ORDER BY Hash"
echo Find Duplicate File Hashes&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -rtp:-1 "SELECT HASHMD5_FILE(Path) AS Hash,Path,Name,Size,CreationTime,LastWriteTime,Attributes FROM '%Root%\*.%%i' ORDER BY Hash"
:: List the Specific file details:
echo File hosts details&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT * FROM  C:\Windows\System32\Drivers\etc\hosts"
echo File Default IIS file details&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT * FROM  C:\inetpub\wwwroot\iisstart.htm"

LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 50 Path, Name, Size, LastWriteTime, Attributes FROM 'C:\$Data\*.*' ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 25 Path, Name, Size, LastWriteTime, Attributes FROM '%OneDrive%\*.*' ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 25 * FROM '%OneDrive%\*.*' ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 10 Path, Name, Size, Attributes FROM 'C:\Program Files\Microsoft Office\*.*' ORDER BY Size DESC"
::	Return a hash of All .exe Files in the Selected folder:
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, HASHMD5_FILE(Path) AS Hash FROM C:\Windows\System32\*.exe  ORDER BY Hash"
::	Return a Specific file extension hashes in the Selected folder, check for duplicate hash values in the system folder:
SET Root=C:\$Software\$Microsoft\Windows 10 Upgrade\*.exe
SET fields=Path,Name,Size,Attributes,CreationTime,LastWriteTime,FileVersion,ProductVersion,InternalName,ProductName,CompanyName,LegalCopyright,LegalTrademarks,PrivateBuild,Comments,FileDescription,OriginalFilename
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash,%fields% FROM '%Root%'  ORDER BY Hash"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, HASHMD5_FILE(Path) AS Hash FROM '%Root%'  ORDER BY Hash"
:: Find out if there are identical copies of the same file on the HDD drive:
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash,path,Name,Size,LastWriteTime FROM %OneDrive%\*.* WHERE Size >=1024 ORDER BY path,size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash, COUNT(*) AS NumberOfCopies FROM %OneDrive%\*.* GROUP BY Hash HAVING NumberOfCopies > 1"
:: Get Top 20 new Files FROM OneDrive -OR- what ever Root Folder you want to look at
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, CreationTime FROM %OneDrive%\*.* ORDER BY CreationTime DESC"
:: 20 most recently modified Files - Extremely Useful query....
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, LastWriteTime FROM %OneDrive%\*.* ORDER BY LastWriteTime DESC"
::Select Top 100 largest Files on the C: drive
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 * FROM C:\*.* ORDER BY Size DESC"
:: FS AvailableElements: Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,FileVersion,CompanyName,FileDescription,OriginalFileName

:: Below search recursively through folder for Specific filename:  TOP 20..
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, Size, Attributes FROM 'C:\*log4j*.*' ORDER BY Path, Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, Name, Size, Attributes FROM '%OneDrive%\*.*' ORDER BY Path, Size DESC"
::	Get logs for today:
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, (and) WHERE TO_DATE(TimeGenerated) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-01 12:00', 'yyyy-MM-dd HH:mm'))) HAVING EventTypeName = 'Error event'" ERROR: Error: Syntax Error: <FROM-clause>: expecting FROM keyword instead of token 'WHERE'
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Name, Size FROM C:\$Data\*.* ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,FileVersion,CompanyName,FileDescription,OriginalFileName FROM %odl%\*.* ORDER BY CreationTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 10 * FROM C:\*.* ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 10 Path, Name, Size, Attributes FROM 'C:\Program Files\Microsoft Office\*.*' ORDER BY Size DESC" -q:off -Recurse:-1
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 * FROM C:\*.* ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, CreationTime FROM %BdProf%\*.* ORDER BY CreationTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, CreationTime FROM %OneDrive%\*.* ORDER BY CreationTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, CreationTime FROM %OneDrive%\*.* ORDER BY CreationTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, CreationTime FROM %OneDrive%\Scripts\*.* ORDER BY CreationTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, CreationTime FROM c:\inetpub\wwwroot\*.* ORDER BY CreationTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, LastWriteTime FROM %OneDrive%\*.* ORDER BY LastWriteTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, LastWriteTime FROM %OneDrive%\*.* ORDER BY LastWriteTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, LastWriteTime FROM %OneDrive%\*.* ORDER BY LastWriteTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, LastWriteTime FROM %OneDrive%\Scripts\*.* ORDER BY LastWriteTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, LastWriteTime FROM c:\inetpub\wwwroot\*.* ORDER BY LastWriteTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 5 Path, CreationTime FROM %BdLogs%\*.xml ORDER BY CreationTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,''), STRLEN(Name))) AS Folder, COUNT(*) AS Folders FROM "%MusSrc%\*.*" WHERE Attributes LIKE 'D%' GROUP BY Folder ORDER BY Files DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) AS Files FROM "%MusSrc%\*.*" WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) AS Files FROM %OneDrive%\*.*, %OneDrive%\Scripts\*.* WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) AS Files FROM c:\inetpub\wwwroot\*.*, c:\inetpub\scripts\*.* WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
::	lists the 20 newest Files on the web site:
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, CreationTime FROM c:\inetpub\wwwroot\*.* ORDER BY CreationTime DESC"
::	lists the 20 most recently modified Files:
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 20 Path, LastWriteTime FROM c:\inetpub\wwwroot\*.* ORDER BY LastWriteTime DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 * FROM C:\*.* ORDER BY Size DESC"
::	report of All file extensions that exist within your web content
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as Files FROM c:\inetpub\wwwroot\*.*, %Root% WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime FROM $1\*.* ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 Name, COUNT(*) AS Cntr FROM $1\* GROUP BY Name ORDER BY Cntr DESC"
LogParser -i:FS file:%odl%\Top10Files.sql -q:off -Recurse:-1SET lpl=%ohtm%\%ComputerName%_Startup-W10.log
LogParser -i:FS -o:SQL -dsn:LPtest "SELECT Name AS FName, Size, Attributes FROM c:\winnt\System32\*.* TO Files"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +----------------------------------------------------------------------------------------------+
:: | LogParser Find data, find string, find piece, find part, find needle, find text in file      |
:: +----------------------------------------------------------------------------------------------+
SET Root=Null&SET Root=C:\inetpub\wwwroot\LogParser Documentation\*.*
LogParser -E:-1 -i:TEXTLINE -Recurse:-1 -rtp:-1 -o:datagrid -stats:On -q:On "SELECT LogFilename, Text FROM %Root% WHERE Text LIKE '%Split IP%' ORDER BY Text ASC"
SET Root=Null&SET Root=%odl%\X570_BCRestoreMultiple.log
LogParser -i:TEXTLINE -o:datagrid -stats:On -q:off -rtp:-1 "SELECT LogFilename, Text FROM %Root% WHERE Text LIKE '%Unable to copy%' ORDER BY Text ASC"
FindStr /I /C:"Unable to copy" %Root%

:: Garmin Folders... Find data in file
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 50  Path,Name,Size as Bytes,HASHMD5_FILE(Path) AS Hash,CreationTime AS Created,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext, Attributes FROM 'C:\Garmin\GPX\*.*' WHERE Hash IS NOT NULL AND Bytes >=1 AND Ext LIKE '%gpx' ORDER BY LastWrite,Bytes DESC"
:: C:\Garmin\GPX\CurrentTrackLog.gpx

SET Root=C:\Garmin&echo List All File Extensions %Root%&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) AS Files FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' AND Extension IS NOT NULL AND Extension NOT LIKE '%htm%' GROUP BY Extension ORDER BY Files DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,HASHMD5_FILE(Path) AS Hash FROM C:\Garmin\*ArizonaTrip*.* ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,HASHMD5_FILE(Path) AS Hash FROM C:\Garmin\*.Backup ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,HASHMD5_FILE(Path) AS Hash FROM C:\Garmin\*.* ORDER BY Size DESC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +------------------------------------------------+
:: |    Analyze Files in InetPub wwwroot system     |
:: +------------------------------------------------+
Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,FileVersion,CompanyName,FileDescription,OriginalFileName
SET Root=C:\inetpub\wwwroot\VSDCDocumentation
:: Count File Extensions, Size and Number of Files
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, SUM(Size) as Bytes, COUNT(*) as Files FROM "%Root%\*.*" WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
:: List largest TOP .html File Extensions
echo Counts All .html File Extensions %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -stats:On -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) AS Files FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%' AND Extension IS NOT NULL AND Extension LIKE '%.html%' GROUP BY Extension ORDER BY Files DESC"
echo Counts All .html File Extensions %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -stats:On -E:-1 "SELECT TOP 100 Path, Name, Size, CreationTime as Created, LastWriteTime as LastWritten, EXTRACT_EXTENSION(Name) AS Ext, HASHMD5_FILE(Path) AS Hash, Attributes FROM %Root% WHERE Size >=1 AND Ext LIKE '%html' ORDER BY Size DESC"
echo List largest TOP .html File Extensions %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -stats:On -E:-1 "SELECT TOP 30 Path, Name, Size, CreationTime as Created, LastWriteTime as LastWritten, EXTRACT_EXTENSION(Name) AS Ext, HASHMD5_FILE(Path) AS Hash, Attributes FROM '%Root%' WHERE Hash IS NOT NULL AND Size >=1 AND Ext LIKE '%html' ORDER BY Size DESC"

SET Root=C:\inetpub\wwwroot\VSDCDocumentation\*.html
echo List All Specific FileTypes of: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -stats:On -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash, CreationTime, LastWriteTime, Path, Name, Size, Attributes FROM %Root% ORDER BY Hash DESC"
echo List TOP 100 Specific FileTypes of: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -stats:On -E:-1 "SELECT TOP 100 Path, Name, Size, HASHMD5_FILE(Path) AS Hash, Attributes FROM '%Root%' ORDER BY Size DESC"
START CHROME "C:\inetpub\wwwroot\VSDCDocumentation\VSDC\www.videosoftdev.com\49-products-spec\video-solutions\video-editor\documentation\how-to22f6.html"

:: Count number of Files under the Root folder
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as Files FROM "%Root%\*.*" WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
:: Display the Largest Files
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 120 Path,Name,Size,LastWriteTime FROM "%Root%\*.*" ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,Size,LastWriteTime FROM "%Root%\*.*" ORDER BY CreationTime DESC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +--------------------------------------------+
:: |    Find GML (XML) data in Garmin Files     |
:: +--------------------------------------------+
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 30 Path, Name, Size, CreationTime as Created, LastWriteTime as LastWritten, EXTRACT_EXTENSION(Name) AS Ext, HASHMD5_FILE(Path) AS Hash, Attributes FROM 'C:\Garmin\GPX\*.*' WHERE Hash IS NOT NULL AND Size >=1 AND Ext LIKE '%gpx' ORDER BY LastWritten,Size DESC"
'C:\Garmin\GPX\CurrentTrackLog.gpx'
SET Root=''&SET Root='C:\Garmin\GPX\CurrentTrackLog.gpx'
&echo %Root%
IF EXIST %Root% (echo %Root% Found) ELSE echo %Root% missing
&Notepad++ %Root%
LogParser -rtp:-1 -o:datagrid -i:XML -fMode:Auto "SELECT TOP 10 * FROM '%Root%'"

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) AS Files FROM "%UserProfile%\*.*" WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────────────────────┐
│ -i:REG File System                                                │
└───────────────────────────────────────────────────────────────────┘
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
┌───────────────────────────────────────────────────┐
│    NetMon Trace .cap analysis                     │
└───────────────────────────────────────────────────┘
/* <- %cap% change filename and path to your capture file */
SELECT 	QUANTIZE(DateTime,60) AS Minute, SUM(FrameBytes) as [Total Bytes], DIV(SUM(FrameBytes), 1024) AS [Total KB],  DIV( DIV( SUM(FrameBytes) , 1024) , 1024) AS [Total MB] FROM '%cap%' GROUP BY Minute
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
┌───────────────────────────────────────────────────┐
│    Splunk   https://www.splunk.com/               │
└───────────────────────────────────────────────────┘
 Splunk serID = BobMaars Alt+3 - Local account is BobMaars Alt+'
  http://10.10.10.10:8000    BobMaars -AND- Alt+'
Documentation: http://docs.splunk.com
Download http://docs.splunk.com/images/Tutorial/tutorialdata.zip the tutorialdata.zip file. Do not uncompress the file.
Download http://docs.splunk.com/images/d/db/Prices.csv.zip the Prices.csv.zip file. Do not uncompress the file at this time.
Use the Add Data wizard
If there is a Welcome window displayed, close that window.
Click Settings > Add Data.
Search shows: source="tutorialdata.zip:*" host="P775-Ent"
              source="Prices.csv.zip:*" host="P775-Ent"
EXAMPLE: eventcreate /l Application /so W10START /T information /id 520 /d "START   : %Title%
id Application
source=WinEventLog:Application ([| search source=WinEventLog:Application earliest=-6h latest=-1m | table EventCode]) | stats count by EventCode
source=WinEventLog:Application ([| search source=WinEventLog:Application earliest=-6h latest=-1m | table EventCode])  EventCode=590
 | eval EventCode="590,591,592,593,594,595,596,597,598,599" |
eventtype=xcopy error earliest=@w0
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
https://docs.splunk.com/Documentation/Splunk/8.1.0/Admin/ListofconfigurationFiles
<Splunk Search Commands>
1) mkDir "$SPLUNK_HOME/etc/System/local"
2) Notepad++ "$SPLUNK_HOME/etc/System/local/inputs.conf"
altering $SPLUNK_HOME/etc/System/local  inputs.conf to read:
    [monitor://$WINDIR\WindowsUpdate.log]
    disabled = 0
        sourcetype=WindowsUpdateLog "REPORT EVENT:" "Content Install" | chart latest(status) by host,signature_id
sc query type= Service
sc query eventlog
sourcetype="wineventlog:security"EventCode=4688
| stats count, values(Creator_Process_Name) as Creator_Process_Name by New_Process_Name
| table New_Process_Name, count, Creator_Process_Name
| sort count
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
                                    End of Working LogParser commands....
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Not a good e.g. LogParser -q:ON -stats:On-o:datagrid "SELECT DISTINCT TimeGenerated, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS User, X570 As TargComp, , EXTRACT_TOKEN(Strings, 5, '|') As [AttWkStation] FROM  Security WHERE EventType = 16 AND EventCategory = 2 AND Attacking_Workstation <> X570"
LogParser -q:ON -stats:On-o:datagrid "SELECT TimeGenerated, STRCAT(STRCAT(EXTRACT_TOKEN (Strings, 1, '|'), '\\'), EXTRACT_TOKEN(Strings, 0, '|')) AS User, EXTRACT_TOKEN(Strings, 5, '|') FROM  Security WHERE EventType = 16 AND EventCategory = 2"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│       LogParser Powershell                        │
└───────────────────────────────────────────────────┘
# Find All source names and event log they are registered for:
Get-WmiObject -Class Win32_NTEventLOgFile | Select-Object FileName, Sources
::<--------------------------------------------------------------------------------------------->::
# find All registered sources
$Sources = Get-WmiObject -Class Win32_NTEventLOgFile |
  Select-Object FileName, Sources |
  ForEach-Object -Begin { $hash = @{}} -Process { $hash[$_.FileName] = $_.Sources } -end { $Hash }

# list sources for application log
$Sources["Application"]
# list sources for Security log
$Sources["Security"]
# list sources for system log
$Sources["System"]
::<--------------------------------------------------------------------------------------------->::
$Begin = Get-Date -Date '1/07/2022 00:00:00'
$End = Get-Date -Date '1/07/2022 23:59:59'
Get-EventLog -LogName System -EntryType Error -After $Begin -Before $End
::<--------------------------------------------------------------------------------------------->::
Below are a SET of PowerShell commands to Create/View/Delete Event Source/Event Log Name:
1. New-EventLog -LogName {your own log name} -Source {your own source name}
2. Get-EventLog -List
3. Remove-EventLog -Source {your own source name}
4. Remove-EventLog -LogName {your own log name}
::<--------------------------------------------------------------------------------------------->::
:: Powershell List All Event Sources:# Get-EventLog -LogName Application |Select-Object Source -Unique
Get-EventLog -LogName * |ForEach-Object {$LogName = $_.Log;Get-EventLog -LogName $LogName -ErrorAction SilentlyContinue |Select-Object @{Name= "Log Name";Expression = {$LogName}}, Source -Unique}
Get-EventLog -List
# Get All error events FROM the System event log
Get-EventLog -LogName System -EntryType Error

#	List All Event Provider log Files. Use with FROM
LogParser -i:EVT -stats:ff -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT DISTINCT SourceName AS Provider FROM System ORDER BY Provider"

(Get-WinEvent -ListLog Application).ProviderNames
Get-WinEvent -ListProvider *Microsoft-Windows-File* | Select Name
#Get-WinEvent -ListLog * | Select RecordCount, LogName WHERE LogName LIKE 'Microsoft-Windows-FileHistory'

#	Get Event Ids that the event provider generates
#	Below lists All EventIDs associated with Event Provider log file
(Get-WinEvent -ListProvider Microsoft-Windows-GroupPolicy).Events | Format-Table Id, Description
#	Get log information FROM event object properties
$Event = Get-WinEvent -LogName 'Windows PowerShell'
$Event.Count
$Event | Group-Object -Property Id -NoElement | Sort-Object -Property Count -Descending
$Event | Group-Object -Property LevelDisplayName -NoElement
#	Get error events that have a specified string in their name
Get-WinEvent -LogName *PowerShell*, Microsoft-Windows-Kernel-WHEA* |
  Group-Object -Property LevelDisplayName, LogName -NoElement |
    Format-Table -AutoSize

$log = Get-WinEvent -ListLog Security
$log.MaximumSizeInBytes = 1gb
try{
   $log.SaveChanges()
   Get-WinEvent -ListLog Security | Format-List -Property *
}catch [System.UnauthorizedAccessException]{
   $ErrMsg  = 'You do not have permission to configure this log!'
   $ErrMsg += ' Try running this script with administrator privileges. '
   $ErrMsg += $_.Exception.Message
   Write-Error $ErrMsg
}

#	Get events FROM an archived event log
Get-WinEvent -Path 'C:\Windows\System32\winevt\Logs\Microsoft-Windows-FileHistory-Engine%4BackupLog.evtx'
Get-WinEvent -Path 'C:\Windows\System32\winevt\Logs\Microsoft-Windows-FileHistory-Engine%4BackupLog.evtx' -MaxEvents 100

::
# Using the Where-Object cmdlet:
$Yesterday = (Get-Date) - (New-TimeSpan -Day 1)
Get-WinEvent -LogName 'Windows PowerShell' | Where-Object { $_.TimeCreated -ge $Yesterday }

# Using the FilterHashtable parameter:
$Yesterday = (Get-Date) - (New-TimeSpan -Day 1)
Get-WinEvent -FilterHashtable @{ LogName='Windows PowerShell';Level=3;StartTime=$Yesterday }

#	# Using the FilterXML parameter:
#	$xmlQuery = @'
#	<QueryList>
#	  <Query Id="0" Path="Windows PowerShell">
#	    <Select Path="System">*[System[(Level=3) and
#	        TimeCreated[timediff(@SystemTime) <= 86400000]]]</Select>
#	  </Query>
#	</QueryList>
#	'@
#	Get-WinEvent -FilterXML $xmlQuery

#	# Using the FilterXPath parameter:
#	$XPath = '*[System[Level=3 and TimeCreated[timediff(@SystemTime) <= 86400000]]]'
#	Get-WinEvent -LogName 'Windows PowerShell' -FilterXPath $XPath

::
$StartTime = (Get-Date).AddDays(-7)
Get-WinEvent -FilterHashtable @{
  Logname='Application'
  ProviderName='Application Error'
  Data='audials.exe'
  StartTime=$StartTime
}

:: Windows 11 Events Monitor Powershell User Login/Authentication Events
Get-EventLog -list | Out-GridView
Get-EventLog application -newest 1 | Get-Member
Get-WinEvent -ListLog * | WHERE {$_.RecordCount -gt 100} | Sort-Object -Property RecordCount -Descending | Out-GridView

$Events = Get-EventLog -LogName System -Newest 150
$Events | Group-Object -Property Source -NoElement | Sort-Object -Property Count -Descending

Get-EventLog System -ComputerName $ENV:ComputerName -After (Get-Date).AddHours(-12) | WHERE {($_.EntryType -Match "Error") -or ($_.EntryType -Match "Warning")} | Out-GridView
Get-EventLog application -ComputerName $ENV:ComputerName -After (Get-Date).AddHours(-12) | WHERE {($_.EntryType -Match "Error") -or ($_.EntryType -Match "Warning")} | Out-GridView
Get-EventLog System -after (get-Date).AddDays(-1) | WHERE {$_.InstanceId -eq 7001} | Out-GridView
$today = get-Date -Hour 0 -Minute 0;
Get-EventLog System -after $today | sort -Descending | select -First 1 | Out-GridView

$logs = get-eventlog System -ComputerName $ENV:ComputerName -source Microsoft-Windows-Winlogon -After (Get-Date).AddDays(-7);
$res = @();ForEach ($log in $logs) {if($log.instanceid -eq 7001) {$type = "Logon"} Elseif ($log.instanceid -eq 7002){$type="Logoff"} Else {Continue} $res += New-Object PSObject -Property @{Time = $log.TimeWritten;"Event" = $type;User = (New-Object System.Security.Principal.SecurityIdentifier $Log.ReplacementStrings[1]).Translate([System.Security.Principal.NTAccount])}};
$res | Out-GridView
<#
|	Explore command line process auditing - Test: Enable Audit Process Creation events and ensure the Advance Audit Policy configuration is not overwritten
|	Create a script that will generate some events of interest and execute the script. Observe the events. The script used to generate the event in the lesson looked LIKE this:
|	echo :: Test 1 Before enabling Audit Process Creation events
|	mkdir %odl%\CmdCtrl\Audit\Zone
|	copy \\10.10.10.15\c$\hidden %odl%\CmdCtrl\Audit\hidden\Zone
|	START %odl%\CmdCtrl\Audit\hidden\Zone\ntUserrights.vbs
|	del %odl%\CmdCtrl\Audit\*.* /Q
|	echo :: Test 2 After enabling Audit Process Creation events
|	Enable the command line process auditing
|	Execute the same script as before and observe the events
#>

:: Specialized other vendor Events-
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM asus, AsusCertService, AsusFanControlService, AsusROGLSLService, AsusUpdateCheck"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM MacriumImageGuardian"

# Opens the Event Log Window:
Show-EventLog

Get-EventLog -LogName System -UserName NT* | Group-Object -Property UserName -NoElement Select-Object -Property Count, Name

Get-EventLog -LogName System -InstanceId 10016 -Source DCOM
Get-EventLog -LogName System -Message *description*
$A = Get-EventLog -LogName System -Newest 1
$A | Select-Object -Property *
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
# LogParser Ref: https://gist.github.com/exp0se/1bae653b790cf5571d20/


###############
# Security Log
###############

# Find Event id
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID = '5038'"

# Show what EventIDs in event log sorted by count
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Cntr, EventID FROM Security GROUP BY EventID ORDER BY Cntr DESC"


# EventID 1102
# Eventlog was cleared
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') as Username, EXTRACT_TOKEN(Strings, 2, '|') AS Workstation FROM Security WHERE EventID = '1102'"

# Find Specific IP
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND SourceIP = '10.10.10.*'"

# group by authpackage
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 9, '|') as AuthPackage, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY AuthPackage ORDER BY Cntr DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo get All events for last 5 minutes &LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated As Time, EventID, SourceName, Message, SID FROM Application, Security, System WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) AND Message LIKE '%chromoting%' ORDER BY Time"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated As Time, EventID, SourceName, Message, SID FROM Application, Security, System WHERE TimeGenerated >= TO_LOCALTIME( SUB ( SYSTEM_TIMESTAMP(), TIMESTAMP( '05', 'mm' ) ) ) ORDER BY Time"
___________________________________________________________________________________________________
# Below are PS examples to list All error log names... and other info
Get-WinEvent -ListLog * | Out-GridView
Get-WinEvent -ListLog Setup | Format-List -Property *
(Get-WinEvent -ListLog Application).ProviderNames
Get-WinEvent -ListLog * -ComputerName localhost | Where-Object { $_.RecordCount }
Get-WinEvent -ListProvider *Policy*
$Event = Get-WinEvent -LogName 'Windows PowerShell'
$Event.Count
$Event | Group-Object -Property Id -NoElement | Sort-Object -Property Count -Descending
$Event | Group-Object -Property LevelDisplayName -NoElement

Get-WinEvent -LogName *PowerShell*, Microsoft-Windows-Kernel-WHEA* |
  Group-Object -Property LevelDisplayName, LogName -NoElement |
    Format-Table -AutoSize

# Checking Windows Search Service last 30 mdays...
$Date = (Get-Date).AddDays(-30)
Get-WinEvent -FilterHashtable @{ LogName='Application';StartTime=$Date;Id='1003' }
------------------------------------
$StartTime = (Get-Date).AddDays(-30)
$Apps='Droid Transfer.exe','bad_module_info','OpenConsole.exe','ams_setup.exe','WindowsTerminal.exe','Explorer.EXE'
$Logs='Application Management','Application Hang','Application Error','Application'
foreach ($App in $Apps) {
  foreach ($Log in $Logs) {
	Get-WinEvent -FilterHashtable @{
	Logname='Application'
	Data=$App;
	ProviderName=$Log;
    StartTime=$StartTime
	Write-Host "Processing: "
  }
 }
}
------------------------------------
$Date = (Get-Date).AddDays(-2)
$filter = @{
  LogName='Application'
  StartTime=$Date
  SuppressHashFilter=@{Level=4}
}
Get-WinEvent -FilterHashtable $filter | Out-GridView
------------------------------------
<#  Filter event log results #>
# Using the Where-Object cmdlet:
$Yesterday = (Get-Date) - (New-TimeSpan -Day 1)
$LogName='Windows PowerShell'
# Here we could loop through every Log using:  (Get-WinEvent -ListLog Application).ProviderNames
Get-WinEvent -LogName $LogName | Where-Object { $_.TimeCreated -ge $Yesterday }
- - - - - - - - - - - - - - - - - - -
#	# Using the FilterHashtable parameter:
#	$Yesterday = (Get-Date) - (New-TimeSpan -Day 1)
#	Get-WinEvent -FilterHashtable @{ LogName='Windows PowerShell';Level=3;StartTime=$Yesterday }
#
#	# Using the FilterXML parameter:
#	$xmlQuery = @'
#	<QueryList>
#	  <Query Id="0" Path="Windows PowerShell">
#	    <Select Path="System">*[System[(Level=3) and
#	        TimeCreated[timediff(@SystemTime) <= 86400000]]]</Select>
#	  </Query>
#	</QueryList>
#	'@
#	Get-WinEvent -FilterXML $xmlQuery
#	# Using the FilterXPath parameter:
#	$XPath = '*[System[Level=3 and TimeCreated[timediff(@SystemTime) <= 86400000]]]'
#	Get-WinEvent -LogName 'Windows PowerShell' -FilterXPath $XPath
------------------------------------
$S = 'P775-ENT', 'Giga-Pro', 'T430DC1', 'T520-ProPre'
ForEach ($Server in $S) {
  Get-WinEvent -ListLog Application -ComputerName $Server |
    Select-Object LogMode, MaximumSizeInBytes, RecordCount, LogName,
      @{name='ComputerName';expression={$Server}} |
    Format-Table -AutoSize
}
#Error: To access the 'Application' log START PowerShell with elevated user rights.  Error: Attempted to perform an unauthorized operation.

#############
# System Log
#############
# EventID 7045
# New Service was Installed in System
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS ServiceName, EXTRACT_TOKEN(Strings, 1, '|') AS ServicePath, EXTRACT_TOKEN(Strings, 4, '|') AS ServiceUser FROM System WHERE EventID = 7045"
# EventID 7036
# Service actions
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as Servicename FROM System WHERE EventID = 7036"
# group by Service name
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 0, '|') as Servicename FROM System WHERE EventID = 7036 GROUP BY Servicename ORDER BY Cntr DESC"

#####################
# Task Scheduler Log
#####################
:: LogName 'Microsoft-Windows-TaskScheduler/Operational'
:: IISW3C All Fields: EventLog,RecordNumber,TimeGenerated AS ToDay,TimeWritten,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,Strings,ComputerName,SID,Message,Data
:: FROM Application, Security, Setup, System, ForwardedEvents
:: Last 1 day: SELECT SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd hh:mm:ss') ) AS ToDay
:: 24 Hours ===: 0000-01-02 00:00:00
:: OR- SELECT TimeGenerated AS Today, ... where..  AND Today >SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()),TIMESTAMP('23:59:59','hh:mm:ss'))
:: test  AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%' ORDER BY UserName, timeframe
:: NOTE: Using -resolveSIDs:ON  with LogParser below results in 0 records....
:: No Results---echo Audit Scheduled Task Events ToDay.&LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT EventID, SUB(TO_LOCALTIME(SYSTEM_TIMESTAMP()),TIMESTAMP('0000-01-02 00:00:00','yyyy-MM-dd hh:mm:ss')) AS ToDay, SID, SourceName, EventCategoryName, Message FROM System WHERE EventID IN (100;102;106;107;110;129;140;141;200;201;602;4702;4699;4698;4700;4701) AND TO_STRING(TimeGenerated,'yyyy-MM-dd HH:mm:ss') LIKE '%%date:~-4%-%date:~-7,2%-%date:~-10,2%%' ORDER BY ToDay ASC"
LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT TimeGenerated AS ToDay,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,SID,Message,Data FROM Application, Security, System WHERE EventID IN (100;102;106;107;110;129;140;141;200;201;602;4702;4699;4698;4700;4701) ORDER BY ToDay ASC"
echo Audit Scheduled Task Events ToDay.&LogParser -i:EVT -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT TimeGenerated AS ToDay,EventID,EventType,EventTypeName,EventCategory,EventCategoryName,SourceName,SID,Message,Data FROM Application, Security, System WHERE SourceName LIKE '%TaskScheduler%' ORDER BY ToDay ASC"

# EventID 100 # Task was run
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings,0, '|') as taskname, EXTRACT_TOKEN(Strings, 1, '|') as Username FROM System WHERE EventID = 100"
# group by taskname
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') as taskname, COUNT(*) as Cntr FROM System WHERE EventID = 100 GROUP BY taskname ORDER BY Cntr DESC"
# EventID 140 # User updated a task
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated as Date, EXTRACT_TOKEN(Strings, 0, '|') as taskname, EXTRACT_TOKEN(Strings, 1, '|') as User FROM System WHERE EventID = 140"
# EventID 200 # action was executed
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings,0, '|') as taskname, EXTRACT_TOKEN(Strings, 1, '|') as taskaction FROM System WHERE EventID = 200"
# group by action
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') as taskaction, COUNT(*) as Cntr FROM System WHERE EventID = 200 GROUP BY taskaction ORDER BY Cntr DESC"
# EventID 140 # User updated a task group by User
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') as User, COUNT(*) as Cntr FROM System WHERE EventID = 140 GROUP BY User ORDER BY Cntr DESC"
# EventID 140 # User updated a task group by taskname
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') as taskname, COUNT(*) as Cntr FROM System WHERE EventID = 140 GROUP BY taskname ORDER BY Cntr DESC"
# event id 141 # User deleted a task
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated as Date, EXTRACT_TOKEN(Strings, 0, '|') as taskname, EXTRACT_TOKEN(Strings, 1, '|') as User FROM System WHERE EventID = 141"
# EventID 141 # User updated a task group by User
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') as User, COUNT(*) as Cntr FROM System WHERE EventID = 141 GROUP BY User ORDER BY Cntr DESC"
# EventID 141 # User updated a task group by taskname
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(Strings, 0, '|') as taskname, COUNT(*) as Cntr FROM System WHERE EventID = 141 GROUP BY taskname ORDER BY Cntr DESC"

#######################
# Windows FirewAll Log
#######################
# EventID 2004
# New exception rule was added
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') as rulename, EXTRACT_TOKEN(Strings, 3, '|') as apppath, EXTRACT_TOKEN(Strings, 22, '|') as changedapp FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2004"
# group by apppath
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 3, '|') as apppath FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2004 GROUP BY apppath ORDER BY Cntr DESC"
# event id 2005
# rule was changed
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') as rulename, EXTRACT_TOKEN(Strings, 3, '|') AS apppath, EXTRACT_TOKEN(Strings, 4, '|') AS Servicename, EXTRACT_TOKEN(Strings, 7, '|') AS localport, EXTRACT_TOKEN(Strings, 22, '|') as modifyingapp  FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005"
# group by apppath
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 3, '|') as apppath FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005 GROUP BY apppath ORDER BY Cntr DESC"
# group by rulename
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 1, '|') as rulename FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005 GROUP BY rulename ORDER BY Cntr DESC"
# group by Servicename
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 4, '|') as Servicename FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005 GROUP BY Servicename ORDER BY Cntr DESC"
# group by local port
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 7, '|') as localport FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005 GROUP BY localport ORDER BY Cntr DESC"
# group by modifyingapp
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 22, '|') as modifyingapp FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005 GROUP BY modifyingapp ORDER BY Cntr DESC"
# event id 2006
# rule was deleted
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') as rulename, EXTRACT_TOKEN(Strings, 3, '|') as changedapp FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2006"
# group by rulename
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 1, '|') as rulename FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2006 GROUP BY rulename ORDER BY Cntr DESC"
# group by changedapp
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 3, '|') as changedapp FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2006 GROUP BY changedapp ORDER BY Cntr DESC"
# EventID 2011
# FirewAll blocked inbound connections to the application, but did not notify the User
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated as date, EXTRACT_TOKEN(Strings, 1, '|') as file, EXTRACT_TOKEN(Strings, 4, '|') as port FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2011"
# group by application
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(Strings, 1, '|') as file FROM'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2011 GROUP BY file ORDER BY Cntr DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Get-EventLog -LogName Security -after (Get-date -hour 0 -minute 0 -second 0)| ?{(4624,4778) -contains $_.EventID -and $_.Message -match 'logon type:\s+(10)\s'}| %{
(new-object -Type PSObject -Property @{
TimeGenerated = $_.TimeGenerated
ClientIP = $_.Message -replace '(?smi).*Source Network Address:\s+([^\s]+)\s+.*','$1'
UserName = $_.Message -replace '(?smi).*Account Name:\s+([^\s]+)\s+.*','$1'
UserDomain = $_.Message -replace '(?smi).*Account Domain:\s+([^\s]+)\s+.*','$1'
LogonType = $_.Message -replace '(?smi).*Logon Type:\s+([^\s]+)\s+.*','$1'
})
} | sort TimeGenerated -Descending | Select TimeGenerated, ClientIP '
, @{N='Username';E={'{0}\{1}' -f $_.UserDomain,$_.UserName}} '
, @{N='LogType';E={
switch ($_.LogonType) {
2 {'Interactive - local logon'}
3 {'Network connection to shared folder)'}
4 {'Batch'}
5 {'Service'}
7 {'Unlock (after screensaver)'}
8 {'NetworkCleartext'}
9 {'NewCredentials (local impersonation process under existing connection)'}
10 {'RDP'}
11 {'CachedInteractive'}
default {"LogType Not Recognised: $($_.LogonType)"}
}
}}
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +----------------------------------------------------------------------------------------------+
:: |         Discussion on Writing HTML to Template for LogParser                                 |
:: +----------------------------------------------------------------------------------------------+
:: |         Example Using DOS command to write .tpl to File.
:: +----------------------------------------------------------------------------------------------+
:: Helping search engines index your Web site
<META name="keywords" content="LogParser,Template,...">
<META name="description" content="LogParser HTML Template">
<LINK rel="start" type="text/html" href="LP-....html" title="LogParser HTML Template">
:: In the following example a robot should neither index this document, nor analyze it for links. The list of terms in the content is ALL, INDEX, NOFOLLOW, NOINDEX.
<META name="ROBOTS" content="NOINDEX, NOFOLLOW">
:: LogParser Templates - Place holder
$lph='<LPHEADER> <!DOCTYPE html> <HTML LANG="en-US"> <HEAD><!-- Bob Maarschalkerweerd +1 919-444-4529 bobmaars@gmail.com - Last Updated: 05 Aug 2022 02:40 PM --><TITLE>Logon-off Report</TITLE><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes"><style>.h-100px, .back-top, ul.toc li.heading:hover{background:#17c06a;} </style></HEAD> <BODY> <H1>Logon-off Report</H1><TABLE BGCOLOR="#D0D0E0" BORDER="1" CELLPADDING="10"><TR><TH>%FIELDNAME_1%</TH> <TH>%FIELDNAME_2%</TH> <TH>%FIELDNAME_3%</TH><TH>%FIELDNAME_4%</TH><TH>%FIELDNAME_5%</TH> <TH>%FIELDNAME_6%</TH> <TH>%FIELDNAME_7%</TH> <TH>%FIELDNAME_8%</TH></TR> </LPHEADER> <LPBODY> <TR> <TD><TT>%FIELD_1%</TT></TD> <TD><TT>%FIELD_2%</TT></TD> <TD><TT>%FIELD_3%</TT></TD> <TD><TT>%FIELD_4%</TT></TD> <TD><TT>%FIELD_5%</TT></TD><TD><TT>%FIELD_6%</TT></TD> <TD><TT>%FIELD_7%</TT></TD> <TD><TT>%FIELD_8%</TT></TD></TR></LPBODY> <LPFOOTER><HR><div class="back-top"><i class="fal fa-angle-up position-absolute top-50 start-50 translate-middle"></i></div><HR></BODY></HTML></LPFOOTER>'
$lph | Out-File -FilePath $ENV:OneDrive\Batch\LP-TemplateTest.tpl
Get-Content -Path $ENV:OneDrive\Batch\LP-TemplateTest.tpl -Raw
:: TEST new template ... Logon Logoff Report Original Template: LP-EVT-Logon1.tpl
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(Strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP INTO '%ohtm%\%ComputerName%_LogOnOff-Report.html' FROM Security WHERE EventID = 4624 AND Username NOT IN ('System';'ANONYMOUS LOGON';'LOCAL Service';'NETWORK Service') AND Domain NOT IN ('NT AUTHORITY') AND Username LIKE '%bob%'" EVT -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-TemplateTest.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LogOnOff-Report.html"

<p>DISPLAY HTML file: "%OneDrive%\Logs\X570_LogOnOff-Report.html"<p><iframe src="%OneDrive%\Logs\X570_LogOnOff-Report.html" width="100%" height="500px"></iframe>
:: ------------------------------------------------------------------------------------------------
SET lph="<LPHEADER> <!DOCTYPE html> <HTML LANG="en-US"> <HEAD><TITLE>Logon-off Report</TITLE></HEAD> <BODY> <H1>Logon-off Report</H1> <TABLE BGCOLOR="#D0D0E0" BORDER="1" CELLPADDING="10"> <TR> <TH>%FIELDNAME_1%</TH> <TH>%FIELDNAME_2%</TH> <TH>%FIELDNAME_3%</TH> <TH>%FIELDNAME_4%</TH> <TH>%FIELDNAME_5%</TH> <TH>%FIELDNAME_6%</TH> <TH>%FIELDNAME_7%</TH> <TH>%FIELDNAME_8%</TH> </TR> </LPHEADER> <LPBODY> <TR> <TD><TT>%FIELD_1%</TT></TD> <TD><TT>%FIELD_2%</TT></TD> <TD><TT>%FIELD_3%</TT></TD> <TD><TT>%FIELD_4%</TT></TD> <TD><TT>%FIELD_5%</TT></TD> <TD><TT>%FIELD_6%</TT></TD> <TD><TT>%FIELD_7%</TT></TD> <TD><TT>%FIELD_8%</TT></TD> </TR> </LPBODY> <LPFOOTER> </BODY> </HTML> </LPFOOTER>"
echo %lph% >"%OneDrive%\LP-Templates\LP-TemplateTest.tpl"
TYPE "%OneDrive%\LP-Templates\LP-TemplateTest.tpl"
:: +--------------------------------------------------------------------------------------------------+
:: |         Example Using Powershell command to write to File.                                       |
:: |   Below powershell works great as it does not include leading and trailing quotes...             |
:: | NOTE: Rather use Powershell to "Trim leading and end chars" as DOS is very clumsy and not great! |
:: +--------------------------------------------------------------------------------------------------+
::  Trim()      : Trims (Removes) All the leading and trailing white space characters from the current string object.
::  Trim(Char[]): It removes All the leading and trailing characters from the current string object.
::  TrimeSTART  : It removes All occurrences of a character from the beginning of the current string object.
::  TrimEnd     : It removes All occurrences of a character from the end of the current string object.
:: Meta and Link References: https://www.w3.org/TR/html4/appendix/notes.html#h-B.4
:: +----------------------------------------------------------------------------------------------+
#--------------------------------------------------------------------------------------------------
::  $lph='<LPHEADER> <!DOCTYPE html> <HTML LANG="en-US"> <HEAD><TITLE>Logon-off Report</TITLE></HEAD> <BODY> <H1>Logon-off Report</H1> <TABLE BGCOLOR="#D0D0E0" BORDER="1" CELLPADDING="10"> <TR> <TH>%FIELDNAME_1%</TH> <TH>%FIELDNAME_2%</TH> <TH>%FIELDNAME_3%</TH> <TH>%FIELDNAME_4%</TH> <TH>%FIELDNAME_5%</TH> <TH>%FIELDNAME_6%</TH> <TH>%FIELDNAME_7%</TH> <TH>%FIELDNAME_8%</TH> </TR> </LPHEADER> <LPBODY> <TR> <TD><TT>%FIELD_1%</TT></TD> <TD><TT>%FIELD_2%</TT></TD> <TD><TT>%FIELD_3%</TT></TD> <TD><TT>%FIELD_4%</TT></TD> <TD><TT>%FIELD_5%</TT></TD> <TD><TT>%FIELD_6%</TT></TD> <TD><TT>%FIELD_7%</TT></TD> <TD><TT>%FIELD_8%</TT></TD> </TR> </LPBODY> <LPFOOTER> </BODY> </HTML> </LPFOOTER>'
::  $lph.Trim([char]0x0027) | Out-GridView
::  ($lph).Trim("'"," ") | Out-GridView
::  Get-Content -Path $Path -Raw
:: ------------------------------ Examples and References ------------------------------------------
:: Strip special characters: https://en.wikipedia.org/wiki/List_of_Unicode_characters
:: U+0022	"	34	042	Quotation mark
:: U+0023	#	35	043	Number sign, Hash, Octothorpe, Sharp
:: U+0024	$	36	044	Dollar sign
:: U+0025	%	37	045	Percent sign
:: U+0026	&	38	046	Ampersand
:: U+0027	'	39	047	Apostrophe
:: U+0028	(	40	050	Left parenthesis
:: U+0029	)	41	051	Right parenthesis
:: U+002A	*	42	052	Asterisk
:: U+002B	+	43	053	Plus sign
:: U+002C	,	44	054	Comma
:: U+002D	-	45	055	Hyphen-minus
:: U+002E	.	46	056	Full stop
:: U+002F	/	47	057	Slash (Solidus)
:: U+0061	a	97	0141	Latin SmAll Letter A
:: $lph.Trim() | Out-GridView
:: $lph.Trim([char]0x0061) | Out-GridView
:: ($lph).Trim() | Out-GridView
:: ($lph).Trim("(",")") | Out-GridView
:: ------------------------------ Examples and References ------------------------------------------
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│         LogParser - Testing some stuff...         │
└───────────────────────────────────────────────────┘
echo List of recent Files FROM Documents and Settings:
LogParser -i:fs -recurse -o:CSV "SELECT LastWriteTime, CreationTime, Path INTO %odl%\Files_FROM_Docs.csv FROM 'c:\documents and settings\*.*' WHERE Path LIKE '%recent%' AND Path NOT LIKE '%.' ORDER BY LastWriteTime DESC"

echo Search for logons of a Specific User on a Specific server among the events in the Windows Event Log:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventID = 528 AND SID LIKE '%UserName%'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Active Directory LDAP...
EventID 2887 Log file in: 'Microsoft-Windows-ActiveDirectory_DomainService' or 'Microsoft-Windows-LDAPlient'
KB314980 - HKEY_LOCAL_MACHINE\Application\CurrentControlSet\Services\NTDS\Diagnostics
REG QUERY "HKLM\Application\CurrentControlSet\Services\NTDS\Diagnostics"
EventID 2887
Enable:  REG ADD HKLM\Application\CurrentControlSet\Services\NTDS\Diagnostics /V 16 LDAP Interface Events /T REG_DWORD /d 2 [OR 3]
Disable: REG ADD HKLM\Application\CurrentControlSet\Services\NTDS\Diagnostics /V 16 LDAP Interface Events /T REG_DWORD /d 0
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::	Display Users' job title breakdown FROM Active Directory:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT title, MUL(PROPCOUNT(*), 100.0) AS Percentage INTO DATAGRID FROM 'LDAP://myUsername:mypassword@mydomain/CN=Users,DC=mydomain,DC =com' WHERE title IS NOT NULL GROUP BY title ORDER BY Percentage DESC" -objClass:User
Display titles of current channels on MSDN BLogs:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT title INTO MSDNBlogs.txt FROM https://blogs.msn.com/MainFeed.aspx#/rss/channel/item" -i:XML -fMode:Tree
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Event ID 1220 - LDAP over SSL
Event ID 2886 — LDAP signing is logged one each time the domain controller is started;if you do not have signing required enabled on your domain controller.
Event ID 2887 - If signing required is not enabled;this event keeps a count of how many unsigned binds occurred in the previous 24 hours. The event is logged every 24 hours.
Event ID 2888 - If signing required is enabled;then this even keeps a count of how many unsigned LDAP binds occurred in the previous 24 hours. Since LDAP signing is required;the binds would be rejected. This is a notice to Administrators to investigate the client computers that are trying to bind without signing.
Event ID 2889- Administrators can enable this event to to help identify client computers that are attempting to bind without signing. This event is logged with the IP address and the bind identity of the client each time an unsigned bind is performed or attempted.
LDAP Signing URL: http://technet.microsoft.com/en-us/library/dd941832(v=ws.10).aspx
EventID: 2886 2887 2888 2889 Source: ActiveDirectory_DomainService
(1) A SASL (Negotiate Kerberos NTLM or Digest) LDAP bind that did not request signing (integrity validation) or
(2) A LDAP simple bind that was performed on a cleartext (non-SSL/TLS-encrypted) connection
Number of simple binds performed without SSL/TLs 31
Number of Negotiate/Kerberosn#TLM/Digest binds performed without signing: 0
See: http://technet.microsoft.com/en-us/library/dd941829(v=ws.10).aspx
To reject unsigned LDAP communications;see article 823659 in the Microsoft Knowledge Base (http://go.microsoft.com/?linkid=145022).
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
WMIC /namespace:\\root\microsoftdfs path dfsrmachineconfig SET debuglogfilepath="%windir%\debug\dfsrlogs"
WMIC /namespace:\\root\microsoftdfs path dfsrmachineconfig SET enabledebuglog=true
WMIC /namespace:\\root\microsoftdfs path dfsrmachineconfig SET debuglogseverity=5
WMIC /namespace:\\root\microsoftdfs path dfsrmachineconfig SET maxdebuglogmessages=400000
WMIC /namespace:\\root\microsoftdfs path dfsrmachineconfig SET maxdebuglogFiles=200
You can check your configuration with the tool DFSRDIAG:
dfsrdiag DumpMachineCfg /Mem: DFSRMember1
:: Reg Settings:
REG QUERY "HKLM\SYSTEM\CurrentControlSet\Services\Dfsr\Parameters"
REG ADD "HKLM\SYSTEM\CurrentControlSet\Services\Dfsr\Parameters" /V "Enable Verbose Event Logging" /T REG_DWORD /d 1 /f
How to determine if you have a DFSR staging area problem:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM DFSR WHERE EventType IN (4202;4204;4206;4208;4212)"
Event ID: 4202 Severity: Warning
Event ID: 4204 Severity: Informational
Event ID: 4206 Severity: Warning
Event ID: 4208 Severity: Warning
Event ID: 4212 Severity: Error
NTFRS Event ID 1030 and 1058
dcdiag /fix
netdiag /fix
Force NTFRS Replication: ntfrsutl.exe forcerepl %ComputerName% /r \\%ComputerName%\SysVol /P %USERDNSDOMAIN%
repadmin /replsummary and/or repadmin /showrepl
dcdiag /test:CheckSecurityError /ReplSource:$dm-dc013
dfsrdiag syncnow /rgname:domain System volume /partner:$dm-dc013 /time:1 /verbose
dfsrdiag backlog /rgname:domain System volume /rfname:sysvol share /smem:$dm-dc013 /rmem:$dm-dc012
dfsrdiag backlog /rgname:<Server> /rfname:sysvol_dfsr - bad
ntfrsutl poll [/quickly[=[N]]] [/slowly[=[N]]] [/now] [computer]
ntfrsutl poll /now %ComputerName%
ntfrsutl sets %ComputerName%
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────────────────────┐
│          LizardLabs LogParser Lizard Repositories                 │
└───────────────────────────────────────────────────────────────────┘
Current: Dir /s "%OneDrive%\Log Parser Lizard\QueriesCombined.xml"
All    : Dir /s "%OneDrive%\*Queries*.xml"
:: LogParser Lizard: :: NOTE: Create Variable for  #IISW3C# = '%IISLogs%\*.log'
Custom :
SET Root=C:\$Data
echo Find Specific File Name and File extension: %Root%&LogParser -i:FS -rtp:-1 -o:datagrid -q:off -Recurse:-1 -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash, CreationTime, LastWriteTime, Path, Name, Size, Attributes FROM "%Root%\*Queries*.xml" ORDER BY Name ASC"
:: Read "%OneDrive%\Log Parser Lizard\QueriesCombined.xml" data
SET Root=%OneDrive%\Log Parser Lizard\Queries.xml
SET Root=%OneDrive%\Log Parser Lizard\QueriesCombined.xml
LogParser -i:XML -rtp:-1 -fMode:Branch -dtNodes:4 -fNames:Compact -iTsFormat:yyyy-MM-dd?hh:mm:ss:mmm -E:-1 "SELECT QueryGroupGUID,QueryGroupName FROM '%Root%'"
:: LogParser -i:XML -rtp:-1 -fMode:Branch -E:-1 "SELECT * FROM '%Root%'"
:: LogParser -i:XML -rtp:-1 -fMode:Branch -E:-1 "SELECT * FROM '%Root%'"
:: LogParser -i:XML -rtp:-1 -fMode:Tree -E:-1 "SELECT * FROM '%Root%'"
:: LogParser -i:XML -rtp:-1 -fMode:Node "SELECT * FROM '%Root%'" :: Error: Root node(s) has no attributes nor value
:: LogParser -i:XML -rtp:-1 -fMode:Auto -E:-1 "SELECT * FROM '%Root%'"
:: LogParser -i:XML -rtp:-1 -fMode:Branch -fNames:XPath -iTsFormat:yyyy-MM-dd?hh:mm:ss:mmm -E:-1 "SELECT * FROM '%Root%'"
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────────────────────┐
│          LizardLabs Examples Samples Folder                       │
└───────────────────────────────────────────────────────────────────┘
System.IO.Path.Combine(System.Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments),"Log Parser Lizard\Samples\Summer Olympic medAllists 1896 to 2008 - All MEDALISTS.tsv")
Located in %OneDrive%\
echo Find Specific file in Folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT EXTRACT_PATH(Path) AS Pat, CreationTime As ToDay, Name, EXTRACT_EXTENSION(Name) AS Ext, Size, HASHMD5_FILE(Path) AS Hash FROM "%OneDrive%\*.*" WHERE Ext LIKE '%tsv%' AND Hash IS NOT NULL ORDER BY CreationTime,Pat DESC"
"Log Parser Lizard.EXE" -file="E:\My Documents\My Desktop\LPLTESTOUT\Log Parser Lizard Batch.lplbat" --SaveToPDF --AppendDateToFileName --CloseApplicationOnFinish --run
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────────────────────┐
│          LizardLabs LogParser Lizard Examples                     │
│    %OneDrive%\Log Parser Lizard\Samples                 │
└───────────────────────────────────────────────────────────────────┘
-- This is a simple "Windows Event Log Enhanced reader" query to show you the basics of LogParser SQL like filtering and grouping of Windows Events.
-- TABLE NAME: Events Count
SELECT
    EventTypeName, EventId,
    COUNT(*) as [Number of events],
    TO_INT(MUL(PROPCOUNT(*), 100.0)) AS Percent
FROM
    System
WHERE
    TimeCreated >= TO_LOCALTIME(SUB(SYSTEM_TIMESTAMP(), TIMESTAMP('3','d'))) -- Retrieve events generated in the past 3 days
GROUP BY
    EventId,EventTypeName
ORDER BY
    [Number of events] DESC
GO
-- TABLE NAME: System Events
SELECT TOP 100 * FROM System WHERE TimeCreated >= TO_LOCALTIME(SUB(SYSTEM_TIMESTAMP(), TIMESTAMP('3','d'))) AND EventTypeName <> 'Information' -- filter information events
GO
-- TABLE NAME: System Log Names
SELECT * FROM lognames WHERE RecordCount > 0
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
--PROPERTIES: -scriptmode=separated
/*
Sample 1: Olympic Medals Sample 1
This sample loads a large "Tab-separated" data file (about 30.000 records of Olympic Games medalists), filters some
countries and display results in data grid. Note that in these samples after the FROM keyword LPL uses inline
Microsoft Visual Basic .Net code to get samples file path. In real use it can be simply a path with wildcards like 'c:\Logs\*.tsv' for instance.
*/

SELECT DISTINCT
strcat(strcat(to_string(Edition), ' '), City) AS Edition,
CountryCode,
Sport,
Discipline,
Event,
Event_gender,
Medal
FROM <% return "'" & System.IO.Path.Combine(System.Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments),"Log Parser Lizard\Samples\Summer Olympic medAllists 1896 to 2008 - All MEDALISTS.tsv") &"'" %>
WHERE CountryCode = 'GBR'
ORDER BY strcat(strcat(to_string(Edition), ' '), City) Desc
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
--PROPERTIES: -scriptmode=separated
/*
Sample 2: Olympic Medals Sample 2
This sample loads a large "Tab-separated" data file (about 30.000 records of Olympic Games medalists),
filters the top 15 gold medal winers countries and display results in data grid and charts.
Note that in these samples after the FROM keyword LPL uses inline Microsoft Visual Basic .Net code to get
samples file path. In real use it can be simply a path with wildcards like 'c:\Logs\*.tsv' for instance.
*/

SELECT top 15 CountryCode, Medal, COUNT(*) AS NumberOfMedals
FROM <% return ("'" & System.IO.Path.Combine(System.Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments),"Log Parser Lizard\Samples\Summer Olympic medAllists 1896 to 2008 - All MEDALISTS.tsv") & "'") %>
WHERE Medal = 'Gold'
GROUP BY CountryCode, Medal
ORDER BY NumberOfMedals Desc
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
--PROPERTIES: -scriptmode=combined
/*
Sample 3: Olympic Medals Sample 3
This is a sample loading a large "Tab-separated" data file (about 30.000 records of Olympic Games medalists) and filters some countries.
Then LPL will join the data with another data SET from "Comma Separated" file (list of countries with country codes, latitude and longitude)
on the column(s) with the same name (which in this sample is CountryCode). This will Allow us to display results in a dashboard map view. Since this
is a sample, result are also shown in Data Grid (table) and chart. This sample and its Files are located in "My Documents\Log Parser Lizard\Sample" folder. You can also open
the Report file located there to preview new WYSIWIG reporting features. To see results you will have to Run query from the toolbar. Please note that
the sample is created to show some of the new features of Log Parser Lizard and that the data may not be completely accurate, but may be used as guidance.
NOTE: first line of the script SET the script mode to "combined". In "separated" script mode, each script is execurted separately and result is appended to the query.
In combined script mode, entire query is combiled as one script, StringBuilder property named "output" is used to append query lines lines (therefore output.Append() is used to add lines).
This mode can be useful for complex queries and global variables. By default, "separated" mode is SET in application settings.
Have fun and enjoy using Log Parser Lizard :)
Lizard Labs
www.lizard-labs.com
*/

SELECT DISTINCT
strcat(strcat(to_string(Edition), ' '), City) AS Edition,
CountryCode,
Sport,
Discipline,
Event,
Event_gender,
Medal
FROM <% output.Append ("'" & System.IO.Path.Combine(System.Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments),"Log Parser Lizard\Samples\Summer Olympic medAllists 1896 to 2008 - All MEDALISTS.tsv") &"'") %>
WHERE CountryCode in ('USA';'GBR';'CAN';'NOR';'AUT')

JOIN_ON_SAME_COLUMNS
/* the above keyword joins the tables on the columns with same names and data type (in memory join). This is a new feature in version 5.0.
Other available keywords are:
	GO - create a dataSET (no relation between tables). This is useful in dashboard and reports.
	MERGE – merge tables in one
    LPL_UNION – same as MERGE
    LPL_INTERSECT - intersection of two tables
    LPL_PRODUCT - product of two tables
    RELATION_ON_FIRST_COLUMN - create a dataSET with a relation on first column on each table (must be of same data type). This is useful in dashboard and reports.
    RELATION_ON_SAME_COLUMNS - create a dataSET with a relation on All columns with same name and data type.
	JOIN_ON_FIRST_COLUMN - combine rows from two tables, based on common values in the first column.
    JOIN_ON_SAME_COLUMNS - combine rows from two tables, based on common values in the first columns with the same name and data type
*/

-- LPL PROPS: -i:CSV
-- When LPL finds "-- LPL PROPS:" as a comment in the first line of each query, it will try to parse the line to load the query properties (ignoring the other ones SET in the UI).
-- This is useful in many cases including the one for running multiple queries of different types in a single query.
-- For more info please read the online help.
-- The list of countries is Comma Separated fle

select
[Alpha-3 code] AS CountryCode,
[Latitude (average)] AS Latitude,
[Longitude (average)] AS Longitude,
Country
FROM <% output.Append("'" & System.IO.Path.Combine(System.Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments),"Log Parser Lizard\Samples\Countries.csv") &"'") %>
WHERE CountryCode in ('USA';'GBR';'CAN';'NOR';'AUT')
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/*
Sample 4: Sample Query 4
This is a sample of running several queries of different datasources demonstrating using of with --LPL PROPS:, --TABLE NAME:, --DEFINE: and GO keywords.
Each query is separated with GO keyword and on some the resulting table name is changed with "-- TABLE NAME:" command.
Also, when LPL finds "-- LPL PROPS:" as a comment in the first line of each query, it will try to parse the line to load the query properties (ignoring the other ones SET in the UI).
Another interesting feature is when you right click on a grid cell that contains a valid file path, it will show a context menu with additional windows file commands (try it on the file system queries)
Other useful keywords in Log Parser Lizard are:
	GO - create a dataSET (no relation between tables). This is useful in dashboard and reports.
	MERGE – merge tables in one
	LPL_UNION – same as MERGE
	LPL_INTERSECT - intersection of two tables
	LPL_PRODUCT - product of two tables
	RELATION_ON_SAME_COLUMNS - create a dataSET with a relation on All columns with the same name and data type.
	JOIN_ON_FIRST_COLUMN - combine rows from two tables, based on common values in the first column.
	JOIN_ON_SAME_COLUMNS - combine rows from two tables, based on common values in the first columns with the same name and data type
	(commented) LPL PROPS: or LPL_PROPS: - SET query properties
	(commented) TABLE NAME: or TABLE_NAME: - change default table name in resulting dataset. Ex. -- TABLE NAME: System Events
	(commented) DEFINE: CONSTNAME VALUE - define value of local constant that can be used in the query (also look at the global constants in the toolbar)
Have fun and enjoy using Log Parser Lizard :)
Lizard Labs Software:
https://www.lizard-labs.com
Github:
https://github.com/lizardlabs
Twitter:
https://twitter.com/lizardlabs
*/

-- You can define a constant here that can be used in All queries
-- DEFINE: DATE_FROM = 2018-11-05

-- This is "File System" query. In the following lines you can see samples for properties, local constants and table name.
-- LPL PROPS: -i:FS
-- DEFINE: TNAME RootDir
-- TABLE NAME: #TNAME#
SELECT TOP 100 Path, Name, Size, HASHMD5_FILE(Path) AS Hash FROM C:\$Data*.* WHERE Hash IS NOT NULL AND Size >=1

GO

-- This is event log query
-- LPL PROPS: EVT -direction:BW
-- TABLE_NAME: My System Events
SELECT TOP 100 * FROM System

GO

-- This is Dates Table query
-- LPL PROPS: -i:UltimateDatesTable -DateFrom:"05.11.2018 00:00:00" -DateTo:"05.11.2019 00:00:00" -Extended:ON
-- DEFINE: DATE_TO = 2020-11-05
SELECT TOP 100 * FROM #DATE_FROM#,#DATE_TO#

GO
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
Track Daily Events - As a security-conscious administrator, you want to keep an eye on a number of events such as:
: Successful or failed login attempts to the Windows network, domain controller or member servers.  :: 4776
: Successful or failed login attempts outside business hours. (Look out for NTLM Logon Type 3)		:: 4624;4625
: Adding, deleting or modifying local or domain user accounts or groups.:: 4726;4732;4734;4738
: Successful or failed attempts of remote desktop sessions.   		:: 21;40;1024;4625;4776;4779
: Password lockouts after repeated login attempts.					:: 4740;4625;4771
: Adding users to privileged local or active directory groups.		:: 4728;4729;4732;4738
: Clearing event logs in domain controllers or member servers.		:: 1102;4618;4649;4719;4727;4738;6008;
: Changing local audit policies and group policies.					:: 612;4719;4739;6144
: Changing or disabling Windows firewAll or firewAll rules. 		:: 853;4950;4727;4946;4950;
: Adding new services, stopping or deleting existing services.		:: 4697;6008;4618;4649;4719
: Changing registry settings. 										:: 4656;4657;4658;4727
: Changing critical Files or directories. 							:: 4663
: Daily High Potential Criticality  :: 4618;4649;4719;612;4765;4766;4794;4897;801;4964;5124;550;1102;517
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│   EVT Windows Security Log Events                 │
└───────────────────────────────────────────────────┘
::	   1	Sysmon	Process creation
::	   2	Sysmon	A process changed a file creation time
::	   3	Sysmon	Network connection
::	   4	Sysmon	Sysmon service state changed
::	   5	Sysmon	Process terminated
::	   6	Sysmon	Driver loaded
::	   7	Sysmon	Image loaded
::	   8	Sysmon	CreateRemoteThread
::	   9	Sysmon	RawAccessRead
::	  10	Sysmon	ProcessAccess
::	  11	Sysmon	FileCreate
::	  12	Sysmon	RegistryEvent (Object create and delete)
::	  13	Sysmon	RegistryEvent (Value Set)
::	  14	Sysmon	RegistryEvent (Key and Value Rename)
::	  15	Sysmon	FileCreateStreamHash
::	  16	Sysmon	Sysmon config state changed
::	  17	Sysmon	Pipe created
::	  18	Sysmon	Pipe connected
::	  19	Sysmon	WmiEventFilter activity detected
::	  20	Sysmon	WmiEventConsumer activity detected
::	  21	Sysmon	WmiEventConsumerToFilter activity detected
::	  22	Sysmon	DNSEvent
::	  23	Sysmon	FileDelete
::	  24	Sysmon	ClipboardChange
::	 225	Sysmon	Error
::	 100	A scheduled task started
::	 102	A scheduled task was completed
::	 110	A scheduled task Triggered bu user
::	 129	A scheduled task was updated
::	 200	A scheduled task action started
::	 201	A scheduled task Action Completed
::   602	A Scheduled Task was created
::	 512	Windows NT is starting up
::	 513	Windows is shutting down
::	 514	An authentication package has been loaded by the Local Security Authority
::	 515	A trusted logon process has registered with the Local Security Authority
::	 516	Internal resources Allocated for the queuing of audit messages have been exhausted, leading to the loss of some audits
::	 517	The audit log was cleared
::	 518	A notification package has been loaded by the Security Account Manager
::	 519	A process is using an invalid local procedure cAll (LPC) port
::	 520	The system time was changed
::	 521	Unable to log events to security log
::	 528	Successful Logon
::	 529	Logon Failure - Unknown user name or bad password
::	 530	Logon Failure - Account logon time restriction violation
::	 531	Logon Failure - Account currently disabled
::	 532	Logon Failure - The specified user account has expired
::	 533	Logon Failure - User not Allowed to logon at this computer
::	 534	Logon Failure - The user has not been granted the requested logon type at this machine
::	 535	Logon Failure - The specified account's password has expired
::	 536	Logon Failure - The NetLogon component is not active
::	 537	Logon failure - The logon attempt failed for other reasons.
::	 538	User Logoff
::	 539	Logon Failure - Account locked out
::	 540	Successful Network Logon
::	 551	User initiated logoff
::	 552	Logon attempt using explicit credentials
::	 560	Object Open
::	 561	Handle Allocated
::	 562	Handle Closed
::	 563	Object Open for Delete
::	 564	Object Deleted
::	 565	Object Open (Active Directory)
::	 566	Object Operation (W3 Active Directory)
::	 567	Object Access Attempt
::	 576	Special privileges assigned to new logon
::	 577	Privileged Service CAlled
::	 578	Privileged object operation
::	 592	A new process has been created
::	 593	A process has exited
::	 594	A handle to an object has been duplicated
::	 595	Indirect access to an object has been obtained
::	 596	Backup of data protection master key
::	 600	A process was assigned a primary token
::	 601	Attempt to Install service
::	 602	Scheduled Task created
::	 608	User Right Assigned
::	 609	User Right Removed
::	 610	New Trusted Domain
::	 611	Removing Trusted Domain
::	 612	Audit Policy Change
::	 613	IPSec policy agent started
::	 614	IPSec policy agent disabled
::	 615	IPSEC PolicyAgent Service
::	 616	IPSec policy agent encountered a potentiAlly serious failure.
::	 617	Kerberos Policy Changed
::	 618	Encrypted Data Recovery Policy Changed
::	 619	Quality of Service Policy Changed
::	 620	Trusted Domain Information Modified
::	 621	System Security Access Granted
::	 622	System Security Access Removed
::	 623	Per User Audit Policy was refreshed
::	 624	User Account Created
::	 625	User Account Type Changed
::	 626	User Account Enabled
::	 627	Change Password Attempt
::	 628	User Account password set
::	 629	User Account Disabled
::	 630	User Account Deleted
::	 631	Security Enabled Global Group Created
::	 632	Security Enabled Global Group Member Added
::	 633	Security Enabled Global Group Member Removed
::	 634	Security Enabled Global Group Deleted
::	 635	Security Enabled Local Group Created
::	 636	Security Enabled Local Group Member Added
::	 637	Security Enabled Local Group Member Removed
::	 638	Security Enabled Local Group Deleted
::	 639	Security Enabled Local Group Changed
::	 640	General Account Database Change
::	 641	Security Enabled Global Group Changed
::	 642	User Account Changed
::	 643	Domain Policy Changed
::	 644	User Account Locked Out
::	 645	Computer Account Created
::	 646	Computer Account Changed
::	 647	Computer Account Deleted
::	 648	Security Disabled Local Group Created
::	 649	Security Disabled Local Group Changed
::	 650	Security Disabled Local Group Member Added
::	 651	Security Disabled Local Group Member Removed
::	 652	Security Disabled Local Group Deleted
::	 653	Security Disabled Global Group Created
::	 654	Security Disabled Global Group Changed
::	 655	Security Disabled Global Group Member Added
::	 656	Security Disabled Global Group Member Removed
::	 657	Security Disabled Global Group Deleted
::	 658	Security Enabled Universal Group Created
::	 659	Security Enabled Universal Group Changed
::	 660	Security Enabled Universal Group Member Added
::	 661	Security Enabled Universal Group Member Removed
::	 662	Security Enabled Universal Group Deleted
::	 663	Security Disabled Universal Group Created
::	 664	Security Disabled Universal Group Changed
::	 665	Security Disabled Universal Group Member Added
::	 666	Security Disabled Universal Group Member Removed
::	 667	Security Disabled Universal Group Deleted
::	 668	Group Type Changed
::	 669	Add SID History
::	 670	Add SID History
::	 671	User Account Unlocked
::	 672	Authentication Ticket Granted
::	 673	Service Ticket Granted
::	 674	Ticket Granted Renewed
::	 675	Pre-authentication failed
::	 676	Authentication Ticket Request Failed
::	 677	Service Ticket Request Failed
::	 678	Account Mapped for Logon by
::	 679	The name: %2 could not be mapped for logon by: %1
::	 680	Account Used for Logon by
::	 681	The logon to account: %2 by: %1 FROM workstation: %3 failed.
::	 682	Session reconnected to winstation
::	 683	Session disconnected FROM winstation
::	 684	SET ACLs of members in administrators groups
::	 685	Account Name Changed
::	 686	Password of the following user accessed
::	 687	Basic Application Group Created
::	 688	Basic Application Group Changed
::	 689	Basic Application Group Member Added
::	 690	Basic Application Group Member Removed
::	 691	Basic Application Group Non-Member Added
::	 692	Basic Application Group Non-Member Removed
::	 693	Basic Application Group Deleted
::	 694	LDAP Query Group Created
::	 695	LDAP Query Group Changed
::	 696	LDAP Query Group Deleted
::	 697	Password Policy Checking API is cAlled
::	 806	Per User Audit Policy was refreshed
::	 807	Per user auditing policy SET for user
::	 808	A security event source has attempted to register
::	 809	A security event source has attempted to unregister
::	 848	The following policy was active when the Windows FirewAll started
::	 849	An application was listed as an exception when the Windows FirewAll started
::	 850	A port was listed as an exception when the Windows FirewAll started
::	 851	A change has been made to the Windows FirewAll application exception list
::	 852	A change has been made to the Windows FirewAll port exception list
::	 853	The Windows FirewAll operational mode has changed
::	 854	The Windows FirewAll logging settings have changed
::	 855	A Windows FirewAll ICMP setting has changed
::	 856	The Windows FirewAll setting to Allow unicast responses to multicast/broadcast traffic has changed
::	 857	The Windows FirewAll setting to Allow remote administration, Allowing port TCP 135 and DCOM/RPC, has changed
::	 858	Windows FirewAll group policy settings have been applied
::	 859	The Windows FirewAll group policy settings have been removed
::	 860	The Windows FirewAll has switched the active policy profile
::	 861	The Windows FirewAll has detected an application listening for incoming traffic
::	1100	The event logging service has shut down
::	1101	Audit events have been dropped by the transport.
::	1102	The audit log was cleared
::	1104	The security Log is now full
::	1105	Event log automatic backup
::	1108	The event logging service encountered an error
::	4608	Windows is starting up
::	4609	Windows is shutting down
::	4610	An authentication package has been loaded by the Local Security Authority
::	4611	A trusted logon process has been registered with the Local Security Authority
::	4612	Internal resources Allocated for the queuing of audit messages have been exhausted, leading to the loss of some audits.
::	4614	A notification package has been loaded by the Security Account Manager.
::	4615	Invalid use of LPC port
::	4616	The system time was changed.
::	4618	A monitored security event pattern has occurred
::	4621	Administrator recovered system FROM CrashOnAuditFail
::	4622	A security package has been loaded by the Local Security Authority.
::	4624	An account was successfully logged on
::	4625	An account failed to log on
::	4626	User/Device claims information
::	4627	Group membership information.
::	4634	An account was logged off
::	4646	IKE DoS-prevention mode started
::	4647	User initiated logoff
::	4648	A logon was attempted using explicit credentials
::	4649	A replay attack was detected
::	4650	An IPsec Main Mode security association was established
::	4651	An IPsec Main Mode security association was established
::	4652	An IPsec Main Mode negotiation failed
::	4653	An IPsec Main Mode negotiation failed
::	4654	An IPsec Quick Mode negotiation failed
::	4655	An IPsec Main Mode security association ended
::	4656	A handle to an object was requested
::	4657	A registry value was modified
::	4658	The handle to an object was closed
::	4659	A handle to an object was requested with intent to delete
::	4660	An object was deleted
::	4661	A handle to an object was requested
::	4662	An operation was performed on an object
::	4663	An attempt was made to access an object
::	4664	An attempt was made to create a hard link
::	4665	An attempt was made to create an application client context.
::	4666	An application attempted an operation
::	4667	An application client context was deleted
::	4668	An application was initialized
::	4670	Permissions on an object were changed
::	4671	An application attempted to access a blocked ordinal through the TBS
::	4672	Special privileges assigned to new logon
::	4673	A privileged service was cAlled
::	4674	An operation was attempted on a privileged object
::	4675	SIDs were filtered
::	4688	A new process has been created
::	4689	A process has exited
::	4690	An attempt was made to duplicate a handle to an object
::	4691	Indirect access to an object was requested
::	4692	Backup of data protection master key was attempted
::	4693	Recovery of data protection master key was attempted
::	4694	Protection of auditable protected data was attempted
::	4695	Unprotection of auditable protected data was attempted
::	4696	A primary token was assigned to process
::	4697	A service was Installed in the system
::	4698	A scheduled task was created
::	4699	A scheduled task was deleted
::	4700	A scheduled task was enabled
::	4701	A scheduled task was disabled
::	4702	A scheduled task was updated
::	4703	A token right was adjusted
::	4704	A user right was assigned
::	4705	A user right was removed
::	4706	A new trust was created to a domain
::	4707	A trust to a domain was removed
::	4709	IPsec Services was started
::	4710	IPsec Services was disabled
::	4711	PAStore Engine (1%)
::	4712	IPsec Services encountered a potentiAlly serious failure
::	4713	Kerberos policy was changed
::	4714	Encrypted data recovery policy was changed
::	4715	The audit policy (SACL) on an object was changed
::	4716	Trusted domain information was modified
::	4717	System security access was granted to an account
::	4718	System security access was removed FROM an account
::	4719	System audit policy was changed
::	4720	A user account was created
::	4722	A user account was enabled
::	4723	An attempt was made to change an account's password
::	4724	An attempt was made to reSET an accounts password
::	4725	A user account was disabled
::	4726	A user account was deleted
::	4727	A security-enabled global group was created
::	4728	A member was added to a security-enabled global group
::	4729	A member was removed FROM a security-enabled global group
::	4730	A security-enabled global group was deleted
::	4731	A security-enabled local group was created
::	4732	A member was added to a security-enabled local group
::	4733	A member was removed FROM a security-enabled local group
::	4734	A security-enabled local group was deleted
::	4735	A security-enabled local group was changed
::	4737	A security-enabled global group was changed
::	4738	A user account was changed
::	4739	Domain Policy was changed
::	4740	A user account was locked out
::	4741	A computer account was created
::	4742	A computer account was changed
::	4743	A computer account was deleted
::	4744	A security-disabled local group was created
::	4745	A security-disabled local group was changed
::	4746	A member was added to a security-disabled local group
::	4747	A member was removed FROM a security-disabled local group
::	4748	A security-disabled local group was deleted
::	4749	A security-disabled global group was created
::	4750	A security-disabled global group was changed
::	4751	A member was added to a security-disabled global group
::	4752	A member was removed FROM a security-disabled global group
::	4753	A security-disabled global group was deleted
::	4754	A security-enabled universal group was created
::	4755	A security-enabled universal group was changed
::	4756	A member was added to a security-enabled universal group
::	4757	A member was removed FROM a security-enabled universal group
::	4758	A security-enabled universal group was deleted
::	4759	A security-disabled universal group was created
::	4760	A security-disabled universal group was changed
::	4761	A member was added to a security-disabled universal group
::	4762	A member was removed FROM a security-disabled universal group
::	4763	A security-disabled universal group was deleted
::	4764	A groups type was changed
::	4765	SID History was added to an account
::	4766	An attempt to add SID History to an account failed
::	4767	A user account was unlocked
::	4768	A Kerberos authentication ticket (TGT) was requested
::	4769	A Kerberos service ticket was requested
::	4770	A Kerberos service ticket was renewed
::	4771	Kerberos pre-authentication failed
::	4772	A Kerberos authentication ticket request failed
::	4773	A Kerberos service ticket request failed
::	4774	An account was mapped for logon
::	4775	An account could not be mapped for logon
::	4776	The domain controller attempted to validate the credentials for an account
::	4777	The domain controller failed to validate the credentials for an account
::	4778	A session was reconnected to a Window Station
::	4779	A session was disconnected FROM a Window Station
::	4780	The ACL was SET on accounts which are members of administrators groups
::	4781	The name of an account was changed
::	4782	The password hash an account was accessed
::	4783	A basic application group was created
::	4784	A basic application group was changed
::	4785	A member was added to a basic application group
::	4786	A member was removed FROM a basic application group
::	4787	A non-member was added to a basic application group
::	4788	A non-member was removed FROM a basic application group..
::	4789	A basic application group was deleted
::	4790	An LDAP query group was created
::	4791	A basic application group was changed
::	4792	An LDAP query group was deleted
::	4793	The Password Policy Checking API was cAlled
::	4794	An attempt was made to SET the Directory Services Restore Mode administrator password
::	4797	An attempt was made to query the existence of a blank password for an account
::	4798	A user's local group membership was enumerated.
::	4799	A security-enabled local group membership was enumerated
::	4800	The workstation was locked
::	4801	The workstation was unlocked
::	4802	The screen saver was invoked
::	4803	The screen saver was dismissed
::	4816	RPC detected an integrity violation while decrypting an incoming message
::	4817	Auditing settings on object were changed.
::	4818	Proposed Central Access Policy does not grant the same access permissions as the current Central Access Policy
::	4819	Central Access Policies on the machine have been changed
::	4820	A Kerberos Ticket-granting-ticket (TGT) was denied because the device does not meet the access control restrictions
::	4821	A Kerberos service ticket was denied because the user, device, or both does not meet the access control restrictions
::	4822	NTLM authentication failed because the account was a member of the Protected User group
::	4823	NTLM authentication failed because access control restrictions are required
::	4824	Kerberos preauthentication by using DES or RC4 failed because the account was a member of the Protected User group
::	4825	A user was denied the access to Remote Desktop. By default, users are Allowed to connect only if they are members of the Remote Desktop Users group or Administrators group
::	4826	Boot Configuration Data loaded
::	4830	SID History was removed FROM an account
::	4864	A namespace collision was detected
::	4865	A trusted forest information entry was added
::	4866	A trusted forest information entry was removed
::	4867	A trusted forest information entry was modified
::	4868	The certificate manager denied a pending certificate request
::	4869	Certificate Services received a resubmitted certificate request
::	4870	Certificate Services revoked a certificate
::	4871	Certificate Services received a request to publish the certificate revocation list (CRL)
::	4872	Certificate Services published the certificate revocation list (CRL)
::	4873	A certificate request extension changed
::	4874	One or more certificate request attributes changed.
::	4875	Certificate Services received a request to shut down
::	4876	Certificate Services backup started
::	4877	Certificate Services backup completed
::	4878	Certificate Services restore started
::	4879	Certificate Services restore completed
::	4880	Certificate Services started
::	4881	Certificate Services stopped
::	4882	The security permissions for Certificate Services changed
::	4883	Certificate Services retrieved an archived key
::	4884	Certificate Services imported a certificate into its database
::	4885	The audit filter for Certificate Services changed
::	4886	Certificate Services received a certificate request
::	4887	Certificate Services approved a certificate request and issued a certificate
::	4888	Certificate Services denied a certificate request
::	4889	Certificate Services SET the status of a certificate request to pending
::	4890	The certificate manager settings for Certificate Services changed.
::	4891	A configuration entry changed in Certificate Services
::	4892	A property of Certificate Services changed
::	4893	Certificate Services archived a key
::	4894	Certificate Services imported and archived a key
::	4895	Certificate Services published the CA certificate to Active Directory Domain Services
::	4896	One or more rows have been deleted FROM the certificate database
::	4897	Role separation enabled
::	4898	Certificate Services loaded a template
::	4899	A Certificate Services template was updated
::	4900	Certificate Services template security was updated
::	4902	The Per-user audit policy table was created
::	4904	An attempt was made to register a security event source
::	4905	An attempt was made to unregister a security event source
::	4906	The CrashOnAuditFail value has changed
::	4907	Auditing settings on object were changed
::	4908	Special Groups Logon table modified
::	4909	The local policy settings for the TBS were changed
::	4910	The group policy settings for the TBS were changed
::	4911	Resource attributes of the object were changed
::	4912	Per User Audit Policy was changed
::	4913	Central Access Policy on the object was changed
::	4928	An Active Directory replica source naming context was established
::	4929	An Active Directory replica source naming context was removed
::	4930	An Active Directory replica source naming context was modified
::	4931	An Active Directory replica destination naming context was modified
::	4932	Synchronization of a replica of an Active Directory naming context has begun
::	4933	Synchronization of a replica of an Active Directory naming context has ended
::	4934	Attributes of an Active Directory object were replicated
::	4935	Replication failure begins
::	4936	Replication failure ends
::	4937	A lingering object was removed FROM a replica
::	4944	The following policy was active when the Windows FirewAll started
::	4945	A rule was listed when the Windows FirewAll started
::	4946	A change has been made to Windows FirewAll exception list. A rule was added
::	4947	A change has been made to Windows FirewAll exception list. A rule was modified
::	4948	A change has been made to Windows FirewAll exception list. A rule was deleted
::	4949	Windows FirewAll settings were restored to the default values
::	4950	A Windows FirewAll setting has changed
::	4951	A rule has been ignored because its major version number was not recognized by Windows FirewAll
::	4952	Parts of a rule have been ignored because its minor version number was not recognized by Windows FirewAll
::	4953	A rule has been ignored by Windows FirewAll because it could not parse the rule
::	4954	Windows FirewAll Group Policy settings has changed. The new settings have been applied
::	4956	Windows FirewAll has changed the active profile
::	4957	Windows FirewAll did not apply the following rule
::	4958	Windows FirewAll did not apply the following rule because the rule referred to items not configured on this computer
::	4960	IPsec dropped an inbound packet that failed an integrity check
::	4961	IPsec dropped an inbound packet that failed a replay check
::	4962	IPsec dropped an inbound packet that failed a replay check
::	4963	IPsec dropped an inbound clear text packet that should have been secured
::	4964	Special groups have been assigned to a new logon
::	4965	IPsec received a packet FROM a remote computer with an incorrect Security Parameter Index (SPI).
::	4976	During Main Mode negotiation, IPsec received an invalid negotiation packet.
::	4977	During Quick Mode negotiation, IPsec received an invalid negotiation packet.
::	4978	During Extended Mode negotiation, IPsec received an invalid negotiation packet.
::	4979	IPsec Main Mode and Extended Mode security associations were established.
::	4980	IPsec Main Mode and Extended Mode security associations were established
::	4981	IPsec Main Mode and Extended Mode security associations were established
::	4982	IPsec Main Mode and Extended Mode security associations were established
::	4983	An IPsec Extended Mode negotiation failed
::	4984	An IPsec Extended Mode negotiation failed
::	4985	The state of a transaction has changed
::	5024	The Windows FirewAll Service has started successfully
::	5025	The Windows FirewAll Service has been stopped
::	5027	The Windows FirewAll Service was unable to retrieve the security policy FROM the local storage
::	5028	The Windows FirewAll Service was unable to parse the new security policy.
::	5029	The Windows FirewAll Service failed to initialize the driver
::	5030	The Windows FirewAll Service failed to start
::	5031	The Windows FirewAll Service blocked an application FROM accepting incoming connections on the network.
::	5032	Windows FirewAll was unable to notify the user that it blocked an application FROM accepting incoming connections on the network
::	5033	The Windows FirewAll Driver has started successfully
::	5034	The Windows FirewAll Driver has been stopped
::	5035	The Windows FirewAll Driver failed to start
::	5037	The Windows FirewAll Driver detected critical runtime error. Terminating
::	5038	Code integrity determined that the image hash of a file is not valid
::	5039	A registry key was virtualized.
::	5040	A change has been made to IPsec settings. An Authentication SET was added.
::	5041	A change has been made to IPsec settings. An Authentication SET was modified
::	5042	A change has been made to IPsec settings. An Authentication SET was deleted
::	5043	A change has been made to IPsec settings. A Connection Security Rule was added
::	5044	A change has been made to IPsec settings. A Connection Security Rule was modified
::	5045	A change has been made to IPsec settings. A Connection Security Rule was deleted
::	5046	A change has been made to IPsec settings. A Crypto SET was added
::	5047	A change has been made to IPsec settings. A Crypto SET was modified
::	5048	A change has been made to IPsec settings. A Crypto SET was deleted
::	5049	An IPsec Security Association was deleted
::	5050	An attempt to programmaticAlly disable the Windows FirewAll using a cAll to INetFwProfile.FirewAllEnabled(FALSE
::	5051	A file was virtualized
::	5056	A cryptographic self test was performed
::	5057	A cryptographic primitive operation failed
::	5058	Key file operation
::	5059	Key migration operation
::	5060	Verification operation failed
::	5061	Cryptographic operation
::	5062	A kernel-mode cryptographic self test was performed
::	5063	A cryptographic provider operation was attempted
::	5064	A cryptographic context operation was attempted
::	5065	A cryptographic context modification was attempted
::	5066	A cryptographic function operation was attempted
::	5067	A cryptographic function modification was attempted
::	5068	A cryptographic function provider operation was attempted
::	5069	A cryptographic function property operation was attempted
::	5070	A cryptographic function property operation was attempted
::	5071	Key access denied by Microsoft key distribution service
::	5120	OCSP Responder Service Started
::	5121	OCSP Responder Service Stopped
::	5122	A Configuration entry changed in the OCSP Responder Service
::	5123	A configuration entry changed in the OCSP Responder Service
::	5124	A security setting was updated on OCSP Responder Service
::	5125	A request was submitted to OCSP Responder Service
::	5126	Signing Certificate was automaticAlly updated by the OCSP Responder Service
::	5127	The OCSP Revocation Provider successfully updated the revocation information
::	5136	A directory service object was modified
::	5137	A directory service object was created
::	5138	A directory service object was undeleted
::	5139	A directory service object was moved
::	5140	A network share object was accessed
::	5141	A directory service object was deleted
::	5142	A network share object was added.
::	5143	A network share object was modified
::	5144	A network share object was deleted.
::	5145	A network share object was checked to see whether client can be granted desired access
::	5146	The Windows Filtering Platform has blocked a packet
::	5147	A more restrictive Windows Filtering Platform filter has blocked a packet
::	5148	The Windows Filtering Platform has detected a DoS attack and entered a defensive mode;packets associated with this attack will be discarded.
::	5149	The DoS attack has subsided and normal processing is being resumed.
::	5150	The Windows Filtering Platform has blocked a packet.
::	5151	A more restrictive Windows Filtering Platform filter has blocked a packet.
::	5152	The Windows Filtering Platform blocked a packet
::	5153	A more restrictive Windows Filtering Platform filter has blocked a packet
::	5154	The Windows Filtering Platform has permitted an application or service to listen on a port for incoming connections
::	5155	The Windows Filtering Platform has blocked an application or service FROM listening on a port for incoming connections
::	5156	The Windows Filtering Platform has Allowed a connection
::	5157	The Windows Filtering Platform has blocked a connection
::	5158	The Windows Filtering Platform has permitted a bind to a local port
::	5159	The Windows Filtering Platform has blocked a bind to a local port
::	5168	Spn check for SMB/SMB2 fails.
::	5169	A directory service object was modified
::	5170	A directory service object was modified during a background cleanup task
::	5376	Credential Manager credentials were backed up
::	5377	Credential Manager credentials were restored FROM a backup
::	5378	The requested credentials delegation was disAllowed by policy
::	5379	Credential Manager credentials were read
::	5380	Vault Find Credential
::	5381	Vault credentials were read
::	5382	Vault credentials were read
::	5440	The following cAllout was present when the Windows Filtering Platform Base Filtering Engine started
::	5441	The following filter was present when the Windows Filtering Platform Base Filtering Engine started
::	5442	The following provider was present when the Windows Filtering Platform Base Filtering Engine started
::	5443	The following provider context was present when the Windows Filtering Platform Base Filtering Engine started
::	5444	The following sub-layer was present when the Windows Filtering Platform Base Filtering Engine started
::	5446	A Windows Filtering Platform cAllout has been changed
::	5447	A Windows Filtering Platform filter has been changed
::	5448	A Windows Filtering Platform provider has been changed
::	5449	A Windows Filtering Platform provider context has been changed
::	5450	A Windows Filtering Platform sub-layer has been changed
::	5451	An IPsec Quick Mode security association was established
::	5452	An IPsec Quick Mode security association ended
::	5453	An IPsec negotiation with a remote computer failed because the IKE and AuthIP IPsec Keying Modules (IKEEXT) service is not started
::	5456	PAStore Engine applied Active Directory storage IPsec policy on the computer
::	5457	PAStore Engine failed to apply Active Directory storage IPsec policy on the computer
::	5458	PAStore Engine applied locAlly cached copy of Active Directory storage IPsec policy on the computer
::	5459	PAStore Engine failed to apply locAlly cached copy of Active Directory storage IPsec policy on the computer
::	5460	PAStore Engine applied local registry storage IPsec policy on the computer
::	5461	PAStore Engine failed to apply local registry storage IPsec policy on the computer
::	5462	PAStore Engine failed to apply some rules of the active IPsec policy on the computer
::	5463	PAStore Engine polled for changes to the active IPsec policy and detected no changes
::	5464	PAStore Engine polled for changes to the active IPsec policy, detected changes, and applied them to IPsec Services
::	5465	PAStore Engine received a control for forced reloading of IPsec policy and processed the control successfully
::	5466	PAStore Engine polled for changes to the Active Directory IPsec policy, determined that Active Directory cannot be reached, and will use the cached copy of the Active Directory IPsec policy instead
::	5467	PAStore Engine polled for changes to the Active Directory IPsec policy, determined that Active Directory can be reached, and found no changes to the policy
::	5468	PAStore Engine polled for changes to the Active Directory IPsec policy, determined that Active Directory can be reached, found changes to the policy, and applied those changes
::	5471	PAStore Engine loaded local storage IPsec policy on the computer
::	5472	PAStore Engine failed to load local storage IPsec policy on the computer
::	5473	PAStore Engine loaded directory storage IPsec policy on the computer
::	5474	PAStore Engine failed to load directory storage IPsec policy on the computer
::	5477	PAStore Engine failed to add quick mode filter
::	5478	IPsec Services has started successfully
::	5479	IPsec Services has been shut down successfully
::	5480	IPsec Services failed to get the complete list of network interfaces on the computer
::	5483	IPsec Services failed to initialize RPC server. IPsec Services could not be started
::	5484	IPsec Services has experienced a critical failure and has been shut down
::	5485	IPsec Services failed to process some IPsec filters on a plug-and-play event for network interfaces
::	5632	A request was made to authenticate to a wireless network
::	5633	A request was made to authenticate to a wired network
::	5712	A Remote Procedure CAll (RPC) was attempted
::	5888	An object in the COM+ Catalog was modified
::	5889	An object was deleted FROM the COM+ Catalog
::	5890	An object was added to the COM+ Catalog
::	6144	Security policy in the group policy objects has been applied successfully
::	6145	One or more errors occured while processing security policy in the group policy objects
::	6272	Network Policy Server granted access to a user
::	6273	Network Policy Server denied access to a user
::	6274	Network Policy Server discarded the request for a user
::	6275	Network Policy Server discarded the accounting request for a user
::	6276	Network Policy Server quarantined a user
::	6277	Network Policy Server granted access to a user but put it on probation because the host did not meet the defined health policy
::	6278	Network Policy Server granted full access to a user because the host met the defined health policy
::	6279	Network Policy Server locked the user account due to repeated failed authentication attempts
::	6280	Network Policy Server unlocked the user account
::	6281	Code Integrity determined that the page hashes of an image file are not valid...
::	6400	BranchCache: Received an incorrectly formatted response while discovering availability of content.
::	6401	BranchCache: Received invalid data FROM a peer. Data discarded.
::	6402	BranchCache: The message to the hosted cache offering it data is incorrectly formatted.
::	6403	BranchCache: The hosted cache sent an incorrectly formatted response to the client's message to offer it data.
::	6404	BranchCache: Hosted cache could not be authenticated using the provisioned SSL certificate.
::	6405	BranchCache: %2 instance(s) of event id %1 occurred.
::	6406	%1 registered to Windows FirewAll to control filtering for the following:
::	6407	%1
::	6408	Registered product %1 failed and Windows FirewAll is now controlling the filtering for %2.
::	6409	BranchCache: A service connection point object could not be parsed
::	6410	Code integrity determined that a file does not meet the security requirements to load into a process. This could be due to the use of shared sections or other issues
::	6416	A new external device was recognized by the system.
::	6417	The FIPS mode crypto selftests succeeded
::	6418	The FIPS mode crypto selftests failed
::	6419	A request was made to disable a device
::	6420	A device was disabled
::	6421	A request was made to enable a device
::	6422	A device was enabled
::	6423	The Installation of this device is forbidden by system policy
::	6424	The Installation of this device was Allowed, after having previously been forbidden by policy
::	8191	Highest System-Defined Audit Message Value
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::	Troubleshooting Active Directory Replication Problems URL: http://technet.microsoft.com/en-us/library/cc949120%28v=ws.10%29.aspx
::	Fixing Replication Lingering Object Problems (Event IDs 1388;1988;2042)
::	Fixing Replication Security Problems
::	Fixing Replication DNS Lookup Problems (Event IDs 1925;2087;2088)
::	Fixing Replication Connectivity Problems (Event ID 1925)
::	Fixing Replication Topology Problems (Event ID 1311)
::	Verify DNS Functionality to Support Directory Replication
::	Replication error
::	4738 A user account was changed
::	4624 An account was successfully logged on
::	4634 An account was logged off
::	4647 User initiated logoff
::	8614 The Active Directory cannot replicate with this server because the time since the last replication with this server has exceeded the tombstone lifetime
::	8524 The DSA operation is unable to proceed because of a DNS lookup failure
::	8456 or 8457 The source | destination server is currently rejecting replication requests
::	8453 Replication access was denied
::	8452 The naming context is in the process of being removed or is not replicated FROM the specified server
::	5 Access is denied
::	1753 There are no more endpoints available FROM the endpoint mapper
::	1722 The RPC server is unavailable
::	1396 Logon Failure The target account name is incorrect
::	1256 The remote System is not available
::	1127 While accessing the hard disk;a disk operation failed even after retries
::	8451 The replication operation encountered a database error
::	8606 Insufficient attributes were given to create an object
::	13552 and 13559 on DFS Replica Members or Domain Controllers That Are Hosting a SYSVOL Replica Set
::	19050;32022;32032;32056;32315;32546 and 33680 are logged when Hyper-V replication is in progress
::	1083 Is Logged During Active Directory Replication
::	Inbound Replication Fails on Domain Controllers with Event ID: 1699;Error 8451 or jet error -1601
::	4114 and Event ID 4008 are logged in the DFS Replication log in Windows Server 2008 R2
::	Fixing Replication Lingering Object Problems (Event IDs 1388;1988;2042)
::	1388 or 1988: A lingering object is detected URL: http://technet.microsoft.com/en-us/library/cc949134%28v=ws.10%29.aspx
::	-2146893022 The target principal name is incorrect
::
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: Below example illustrates the use of Between two events and scanning all Logs for USB activity. May not get results due to GPO not enabled.
Event 6416 S: A new external device was recognized by the System.
Event 6419 S: A request was made to disable a device.
Event 6420 S: A device was disabled.
Event 6421 S: A request was made to enable a device.
Event 6422 S: A device was enabled.
Event 6423 S: The installation of this device is forbidden by system policy.
Event 6424 S: The installation of this device was allowed, after having previously been forbidden by policy.
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EventID, ComputerName, Message, Data FROM Application, Security, System WHERE EventID BETWEEN 6416 AND 6424 ORDER BY EventTime, EventID DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (1102;4719;4704;4717;4738;4798;4705;4674;4732;4697;4625;4648;4723;4946;4950;6416;6424)"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Using Tasklist and some Headings the command produces for use with LogParser... Note: /nh = No Header if you don't need it...
Image Name                     PID Services
========================= ======== ============================================
echo Display Sorted TaskList&Tasklist /svc /fi "PID ge 1" /fo table /nh|Sort /+1|LogParser -i:TEXTLINE -Stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT SUBSTR(text,0,25) AS [Image Name], SUBSTR(text,26,8) AS PID, SUBSTR(text,34,44) AS Services FROM Stdin WHERE PID IS NOT NULL"
tasklist /V /fi "PID ge 1" /fo table /nh|Sort /+1|LogParser -i:TEXTLINE -Stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT SUBSTR(text,0,26) AS [Image Name], SUBSTR(text,26,8) AS PID, SUBSTR(text,35,16) AS [Session Name], SUBSTR(text,52,11) AS [Session#], SUBSTR(text,64,12) AS [Mem Usage], SUBSTR(text,77,15) AS [Status], SUBSTR(text,93,50) AS [User Name], SUBSTR(text,144,84) AS [CPU Time], SUBSTR(text,157,72) AS [Window Title] FROM Stdin  WHERE [Image Name] IS NOT NULL"
Image Name                     PID Session Name        Session#    Mem Usage Status          User Name                                          CPU Time     Window Title
1,26                     26,8     35,16            52,11       64,12        77,15           93,50                                              144,84       157,72
========================= ======== ================ =========== ============ =============== ================================================== ============ ========================================================================
TASKLIST /svc | find "svchost.exe"
Below are the services which were running in SVCHOST#17. We will have to isolate them in separate containers and capture the same SET of logs once again during the issue.
svchost.exe  17448 hidserv, NcbService, StorSvc, UmRdpService, wudfsvc
To isolate these in separate containers use below commands for each service. Once done reboot machine and START monitoring, Once machine comes up fire TASKLIST /svc and ensure these  services are running in separate svchost containers.
Sc config ServiceName type= own
Example:-
Sc config hidserv type= own
Sc config NcbService type= own
Sc config StorSvc type= own
Sc config UmRdpService type= own
Sc config wudfsvc type= own
Now we have separated them to their own containers so that we can have a clear picture of what is causing the high resource usages on the machine. We need to START PerfMon log collection again and stop it as soon as issue reproduces. We need to debug Specific process further based to find root cause.
Windows Performance RecORDER and Windows Performance Toolkit:
https://docs.microsoft.com/en-us/windows-hardware/test/wpt/windows-performance-recORDER
https://docs.microsoft.com/en-us/windows-hardware/test/wpt/
Windows Performance Step-by-Step Guides:
https://docs.microsoft.com/en-us/windows-hardware/test/wpt/windows-performance-step-by-step-guides
Windows Performance Analyzer:
https://docs.microsoft.com/en-us/windows-hardware/test/wpt/windows-performance-analyzer
Windows Performance Deep Dive Troubleshooting:
https://channel9.msdn.com/Events/TechEd/NorthAmerica/2014/WIN-B413
Random ASCII – tech blog of Bruce Dawson:
https://randomascii.wordpress.com/
Windows Performance Monitor Overview:
https://techcommunity.microsoft.com/t5/ask-the-performance-team/windows-performance-monitor-overview/ba-p/375481
ExPerfAnalyzer:
https://github.com/microsoft/ExPerfAnalyzer
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
ref: https://techcommunity.microsoft.com/t5/ask-the-performance-team/two-minute-drill-logman-exe/ba-p/373061
LogMan Creates and manages Event Trace Session and Performance logs and supports many functions of Performance Monitor FROM the command line.
https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/logman
https://docs.microsoft.com/en-us/dynamics-nav/how-to--use-logman-to-collect-event-trace-data
LogMan [create|query|start|stop|delete|update|import|export] [options]
:: For telemetry trace events:
logman create trace MyTelemetryTraceData -p Microsoft-DynamicsNAV-Common -o c:\perflogs\MyTelemetryTraceData.etl
:: For server trace events:
logman create trace MyServerTraceData -p Microsoft-DynamicsNAV-Server -o c:\perflogs\MyServerTraceData.etl
:: These commands will create event log Files named MyTelemetryTraceData.etl and MyServerTraceData.etl in the c:\perflogs folder of your computer.
:: To START the trace session, run one of the following commands.
:: For telemetry trace events:
logman START MyTelemetryTraceData
:: For server trace events:
logman START MyServerTraceData
:: To stop the trace session, run one of the following commands.
:: For telemetry trace events:
logman stop MyTelemetryTraceData
:: For server trace events:
logman stop MyServerTraceData
:: Note: The data is now stored in an .elt file.

LogMan Create Counters -?
LogMan START perf_log
LogMan update perf_log -si 10 -f csv -v mmddhhmm
LogMan create counter perf_log -c "\Processor(_Total)\% Processor Time"
LogMan create counter perf_log -c "\Processor(_Total)\% Processor Time" -max 10 -rf 01:00
LogMan create trace trace_log -nb 16 256 -bs 64 -o c:\logfile
LogMan create alert new_alert -th "\Processor(_Total)\% Processor Time>50"
LogMan create cfg cfg_log -reg "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\\"
LogMan create cfg cfg_log -mgt "root\cimv2:SELECT * FROM Win32_OperatingSystem"
LogMan query providers
LogMan query providers Microsoft-Windows-Diagnostics-Networking
LogMan START process_trace -p Microsoft-Windows-Kernel-Process 0x10 win:Informational -ets
LogMan START usermode_trace -p "Service Control Manager Trace" -ul -ets
LogMan query usermode_trace -p "Service Control Manager Trace" -ul -ets
LogMan stop usermode_trace -p "Service Control Manager Trace" -ul -ets
LogMan START process_trace -p Microsoft-Windows-Kernel-Process -mode newfile -max 1 -o output%d.etl -ets
LogMan START "NT Kernel Logger" -o log.etl -ets
LogMan START "NT Kernel Logger" -p "Windows Kernel Trace" (process,thread) -ets
:: Below FROM Ch04CreateLog.cmd - See Page 143
LogMan create counter perf_log -cf perf_log -rf 00:00:02 -o %odl%\LogMan -si 00:00:01 -f csv --v
:: e.g. View trace event data
:: For telemetry trace events:
logman START MyTelemetryTraceData
:: For server trace events:
logman START MyServerTraceData
:: To stop the trace session, run one of the following commands.
:: For telemetry trace events:
logman stop MyTelemetryTraceData
:: For server trace events:
logman stop MyServerTraceData
SET PLog=c:\perflogs
SET PFol=c:\perflogs
SET PFil=MyTelemetryTraceData
SET PFN=%PLog%\%PFol%\%PFil%
DIR /S "%PFN%*.*"
IF EXIST %PFN% (echo File %PFN% Exists) ELSE echo File %PFN% Does Not Exist
tracerpt \_000001.etl -o c:\perflogs\MyTelemetry-dmp.xml -of XML -summary c:\perflogs\MyTelemetry-summary.txt -report c:\perflogs\MyTelemetry-rpt.xml

:: Below creates .etl Files for analysis - Microsoft Windows Performance RecORDER Version 10.0.19041 (CoreSystem)
wpr -log {enabled|disabled|remove}  + WPR.exe -START /? +  WPR.exe -status
"WPR.exe -START Network" and "WPR.exe -stop %ohtm%\%ComputerName%_WPR-NetTrace.etl",
C:\Program Files (x86)\Windows Kits\10\Windows Performance Toolkit\Catalog\AppLaunch.wpaprofile

LogParser -i:ETW -o:CSV -oTsFormat "HH:mm:ss.ln" "SELECT * FROM '%OneDrive%\*.etl'"> "%odl%\ETL-Out.csv" & Notepad++ "%odl%\ETL-Out.csv"
::NOTE: .etl" has been created on a OS version (10.0) that is not compatible with the current OS version
Cannot open <FROM-entity>: Trace file "%OneDrive%\log.etl" has been created on a OS version (10.0) that is not compatible with the current OS version

Del /s %Onedrive%\*.etl

logman create counter BASELINE -f bincirc -max 500 -si 2 --v -o "e:\perflogs\SERVERBASELINE" –cf "\\<FilesERVER>\Baseline\Baseline.config"
.CONFIG file enumerates the counters that we want to capture, one per line.  An example is shown below:
"\Memory\Available MBytes"
"\Memory\Pool Nonpaged Bytes"
"\Memory\Pool Paged Bytes"
"\PhysicalDisk(*)\Current Disk Queue Length"
"\PhysicalDisk(*)\Disk Reads/sec"
"\PhysicalDisk(*)\Disk Read Bytes/sec"
"\PhysicalDisk(*)\Disk Writes/sec"
"\PhysicalDisk(*)\Disk Write Bytes/sec"
"\Process(*)\% Processor Time"
"\Process(*)\Private Bytes"
"\Process(*)\Virtual Bytes"
LOGMAN.EXE START BASELINE

High CPU Issue
logman.exe create counter High-CPU-Perf-Log -f bincirc -v mmddhhmm -max 250 -c "\LogicalDisk(*)\*" "\Memory\*" "\Network Interface(*)\*" "\Paging File(*)\*" "\PhysicalDisk(*)\*" "\Process(*)\*" "\Redirector\*" "\Server\*" "\System\*" "\Thread(*)\*" -si 00:00:05

Generic Performance Monitor Logging
logman.exe create counter Perf-Counter-Log -f bincirc -v mmddhhmm -max 250 -c "\LogicalDisk(*)\*" "\Memory\*" "\Network Interface(*)\*" "\Paging File(*)\*" "\PhysicalDisk(*)\*" "\Process(*)\*" "\Redirector\*" "\Server\*" "\System\*" -si 00:05:00

Windows Performance Monitor (PerfMon) tool can be used to diagnose common Windows server performance problems like:
–High Memory Utilization
–High CPU Utilization
–Poor Disk Performance

Steps to collect Windows Performance Logs:
1. Create PerfMon Counter Data Collector using below command, we are running two command for same counters to collect performance log samples at different intervals. First one collects samples at every 2 minutes and second one at 1 seconds interval respectively.

Logman.exe create counter PerfLog-Long -o "c:\perflogs\PerfLog-Short.blg" -f bincirc -v mmddhhmm -max 1024 -c "\LogicalDisk()*" "\Memory*" ".NET CLR Memory()*" "\Cache*" "\Network Interface()*" "\Paging File()*" "\PhysicalDisk()*" "\Processor()*" "\Processor Information()*" "\Process()*" "\Thread()*" "\Redirector*" "\Server*" "\System*" "\Server Work Queues()*" "\Terminal Services*" -si 00:02:00

Logman.exe create counter PerfLog-Short -o "c:\perflogs\PerfLog-Long.blg" -f bincirc -v mmddhhmm -max 1024 -c "\LogicalDisk(*)\*" "\Memory\*" "\.NET CLR Memory(*)\*" "\Cache\*" "\Network Interface(*)\*" "\Paging File(*)\*" "\PhysicalDisk(*)\*" "\Processor(*)\*" "\Processor Information(*)\*" "\Process(*)\*" "\Thread(*)\*" "\Redirector\*" "\Server\*" "\System\*" "\Server Work Queues(*)\*" "\Terminal Services\*" -si 00:00:01

2. Now run below command to START both of the above data collectors and wait for the performance issue to happen.
Logman.exe START PerfLog-Long
Logman.exe START PerfLog-Short
3. Stop
Logman.exe stop PerfLog-Long
Logman.exe stop PerfLog-Short
4. Performance Log Files will be available under "c:\perflogs" on the machine, once you have the logs collected you can START analyzing it using Windows Performance Monitor tool.

*** View trace event data ***
Windows Performance Analyzer
https://docs.microsoft.com/en-us/windows-hardware/test/wpt/windows-performance-analyzer
Included in the Windows Assessment and Deployment Kit (Windows ADK): https://go.microsoft.com/fwlink/p/?LinkId=526740
https://docs.microsoft.com/en-us/windows-hardware/test/wpt/windows-performance-toolkit-technical-reference
https://docs.microsoft.com/en-us/windows-hardware/test/wpt/optimizing-performance-and-responsiveness
tracerpt c:\perflogs\MyTelemetryTraceData_000001.etl -o c:\perflogs\MyTelemetry-dmp.xml -of XML -summary c:\perflogs\MyTelemetry-summary.txt -report c:\perflogs\MyTelemetry-rpt.xml

WPR Command-Line Options
https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-8.1-and-8/hh448229(v=win.10)

:: Display detailed information about a profile
wpr -proFiles
wpr -help proFiles
wpr -profiledetails
wpr -exportprofile
wpr -profiledetails profile1+profile2..+profilen [-filemode] -onoffscenario <OnOff Transition Type>
wpr -profiledetails CPU -filemode -onoffscenario <OnOff Transition Type>
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +------------------------------------------------------------------+
:: |	         |
:: +------------------------------------------------------------------+
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│               │
└───────────────────────────────────────────────────┘
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
LogParser -i:EVT -stats:on -rtp:-1 -o:datagrid -resolveSIDs:ON -E:5 "SELECT TimeGenerated, SourceName, EventCategoryName, Message FROM Security WHERE EventID = 528 AND SID LIKE '%BobM%'"
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2%(Line)" "SELECT EventTypeName, COUNT(*) as [Application], mul(COUNT(*),2) as [System], mul(COUNT(*),3) as [Securiy] INTO %ohtm%\%ComputerName%_%%%i.gif FROM Application, System, Security group by EventTypeName"
LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Column3D" "SELECT SourceName, COUNT(*) AS [NumEvents] INTO %ohtm%\%ComputerName%_Column3D.gif FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"

:: Test LogParser Charts with File System
1) When you use "SELECT *", the first two fields are LogFilename and LogRow. The CHART output format thinks LogFilename is the X-Axis and All the subsequent fields are value series, so it complains that date (which is actuAlly the third field in your query) is not a plottable type. Change your SELECT to "SELECT date, user1, user2, ....";
2) The TIMESTAMP format in your query is actuAlly "M-d-y h:m:s", since there's no leading zeros.
3) If the column is of the NULL type, you'll need to add a TO_INT on top of it

Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,FileVersion,CompanyName,FileDescription,OriginalFileName
Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,FileVersion

SET Root=%OneDrive%
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 Path,Name,Size,CreationTime FROM %Root%\*.* WHERE Size >= 1024 ORDER BY Size DESC"
:: Below Error: Semantic Error: presence of field expression(s) in the ORDER BY clause not existing in the SELECT clause
LogParser -i:FS -Recurse:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% (Column3D)" "SELECT TOP 100 Path,Name,TO_INT(Size),CreationTime INTO %ohtm%\%ComputerName%_Column3D.gif FROM %Root%\*.* WHERE Size >= 1024 ORDER BY Size DESC"
:: Below Error: Column Name is not an INTEGER nor a REAL
LogParser -i:FS -Recurse:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% (Column3D)" "SELECT TOP 100 Path,Name,SUB(TO_INT(Size),-1),CreationTime INTO %ohtm%\%ComputerName%_Column3D.gif FROM %Root%\*.*"
LogParser -i:FS -Recurse:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% (Line)" "SELECT Path,Name,Size,CreationTime INTO %ohtm%\%ComputerName%_Line.gif FROM %Root%\*.*"
:: Below is GOOD:
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 Path,Name,Size,CreationTime INTO %ohtm%\%ComputerName%_Line.gif FROM %Root%\*.* WHERE Size >= 1024 ORDER BY Size DESC"
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 100 Path,Name,TO_INT(Size),CreationTime INTO %ohtm%\%ComputerName%_Line.gif FROM %Root%\*.* WHERE Size >= 1024 ORDER BY Size DESC"
::       ,SUB(TO_INT(Size),-1),
::Error: TO_INT(Size) --> Semantic Error: presence of field expression(s) in the ORDER BY clause not existing in the SELECT clause
::Error: TO_INT(TO_STRING(Size, '00000000')) --> Column Name is not an INTEGER nor a REAL
::Error: SUB(TO_INT(Size),NULL) --> Column Name is not an INTEGER nor a REAL
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Cryptographic hash SHA1 - compare-by-hash is completely reasonable - compare two Files using the File Hash:
Probability of just two hashes accidentAlly colliding is 1/2128 which is 1 in 340 undecillion 282 decillion 366 nonillion 920 octillion 938 septillion 463 sextillion 463 quintillion 374 quadrillion 607 trillion 431 billion 768 million 211 thousand 456.
We conclude that it is certainly fine to use a 160-bit hash function like SHA1 or RIPEMD-160 with compare-by-hash. The chances of an accidental collision is about 2-160. This is unimaginably smAll. You are roughly 290 times more likely to win a U.S. state lottery and be struck by lightning simultaneously than you are to encounter this type of error in your file system.
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________

:: +------------------------------------------------------------------+
:: |    LogParser Perfmon and Other interesting uses                  |
:: +------------------------------------------------------------------+
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ValueType, COUNT(*) INTO DATAGRID FROM \HKLM GROUP BY ValueType"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│       LogParser Charts                            │
└───────────────────────────────────────────────────┘
:: +---------------------------------------------------------------------------+
:: | LogParser Microsoft Office 2003 Add-in Office Web Components COM Test Chart... Uses both vb and js.
:: | ref: hhttp://www.geekybob.com/post/Advanced-Log-Parser-Charts-Part-3-Missing-Office-Web-Components-for-Charting
:: | --- Advanced Log Parser Charts Part 3 - Missing Office Web Components for Charting -------------
:: | Requirements: Office 2003 Add-in: Office Web Components
:: | Add Date to chart (.js) --> chart.Title.Caption = (formatDate(new Date())) + " - Counts";
:: | chart.Title.Caption = new Date().toString().slice(4, 16) + " - Counts";   //(0, 10)=Day Month
:: | chart.Title.Caption = new Date().toLocaleDateString('en-US', {year: 'numeric', month: '2-digit', day: '2-digit'}) + " - Counts";
:: | Need to Open the chart after creating... Append:  & %Onedrive%\%ComputerName%_xxxx.gif
:: | http://www.microsoft.com/en-us/download/details.aspx?id=22276
:: | To View chart use: -view:ON -AND-  INTO %ohtm%\%ComputerName%_xxx.gif
:: +---------------------------------------------------------------------------+
:: | Install:                                                                  |
:: +---------------------------------------------------------------------------+
SET cmd=START "InstOffice2003 " /D "%OneDrive%" /High /B /Wait "N:\$Software\$Microsoft\Microsoft Office 2003 Add-in Office Web Components\owc11.exe"
%cmd% & echo %Date% !Time! --[ %cmd% ### RC=%ErrorLevel% ]--
:: +---------------------------------------------------------------------------+
:: |	Query with Chart                                                       |
:: |	-chartType:Bar3D -groupSize:640x480 -view:on                           |
:: |     Query without Chart -view:OFF                                         |
:: +---------------------------------------------------------------------------+
LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"Line- %Date:~-4%%Date:~-7,2%%Date:~-10,2%" "SELECT EventTypeName, COUNT(*) as [Application], mul(COUNT(*),2) as [System], mul(COUNT(*),3) as [Securiy] INTO %ohtm%\%ComputerName%_%%%i.gif FROM Application, System, Security group by EventTypeName"

LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Security Line" "SELECT TimeGenerated as Date,COUNT(*) AS Counts INTO %ohtm%\%ComputerName%_SecurityCounts.gif FROM Security GROUP BY Date ORDER BY Date"
LogParser -i:EVT -o:CHART -groupSize:1024x768 -view:ON -chartType:Column3D -config:"%OneDrive%\Log Parser 2.2\LP-3D-AreaCharts.js" "SELECT SourceName, COUNT(*) AS [Number of Events] INTO %ohtm%\%ComputerName%_Events.gif FROM System GROUP BY SourceName ORDER BY [Number of Events] DESC"

:: The examples below demonstrate different chart types using both a -config:x.js file -or- -ChartType: (See LogParser -h -o:CHART)
LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Line" "SELECT SourceName, COUNT(*) AS [NumEvents] INTO %ohtm%\%ComputerName%_Line.gif FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Column3D" "SELECT SourceName, COUNT(*) AS [NumEvents] INTO %ohtm%\%ComputerName%_Column3D.gif FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
LogParser -i:EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -groupSize:640x480 -view:on -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Bar3D" "SELECT SourceName, COUNT(*) AS [NumEvents] INTO %ohtm%\%ComputerName%_Bar3D.gif FROM System GROUP BY SourceName ORDER BY [NumEvents] DESC"
LogParser -o:CHART -groupSize:1024x768 -view:ON -chartType:Column3D-config:"%OneDrive%\Log Parser 2.2\LP-3D-AreaCharts.js" "SELECT SourceName, COUNT(*) AS [Number of Events] INTO %ohtm%\%ComputerName%_Events.gif FROM System GROUP BY SourceName ORDER BY [Number of Events] DESC"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: +---------------------------------------------------------------------------+
:: | NOTE: Instead of using .js as demonstrated below,
:: |  USE: -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Bar3D"
:: |  If you get Error creating output format "CHART": This output format requires a licensed Microsoft Office Chart Web Component to be Installed on the local machine
:: |  FIX: Install Office 2003 Add-in: Office Web Components
:: |  Install: "N:\$Software\$Microsoft\Microsoft Office 2003 Add-in Office Web Components\owc11.exe"
:: | VBS COM TESTS - NOTE: The queries are built INTO the VB Script.
:: | https://download.cnet.com/Office-2003-Add-in-Office-Web-Components/3001-2070_4-10742090.html
:: +---------------------------------------------------------------------------+
"%OneDrive%\Log Parser 2.2\LP-TestChart01.vbs"
"%OneDrive%\Log Parser 2.2\LP-COM-Interface.vbs"
"%OneDrive%\Log Parser 2.2\LP-CountsByDay.vbs"
"%OneDrive%\Log Parser 2.2\LP-3D-AreaCharts.vbs"
"%OneDrive%\Log Parser 2.2\LP-TestChart01.vbs"
"%OneDrive%\Log Parser 2.2\LP-TestChart02.vbs"
:: SET Today's Date in the chart using java script...
// Todays Date:   chart.Title.Caption = "Counts " + yyyy
var yyyy = today. getFullYear();today = mm + '/' + dd + '/' + yyyy;document. write(today);
:: .js Chart examples: -config:"%OneDrive%\Log Parser 2.2\LP-ChartCounts.js"
LP-ChartCounts.js
LP-ChartGradient.js
LP-ChartGradientColors.js
LP-ChartGradientColors1.js
LP-ChartGradientPreset.js
LP-COM-Interface..js
LP-3D-AreaCharts.js
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT LogFilename, Text FROM %lpl% WHERE Text LIKE '%**DEBUG**%'" -i:TEXTLINE -q:Off
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT LogFilename, Text FROM %lpl% WHERE Text LIKE '%Access Denied%'" -i:TEXTLINE -q:Off
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT LogFilename, Text FROM %lpl% WHERE Text LIKE '%RC=%'" -i:TEXTLINE -q:Off
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT LogFilename, Text FROM %lpl% WHERE Text LIKE '%Unable to create directory%'" -i:TEXTLINE -q:Off
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT Text, COUNT(*) FROM %lpl% GROUP BY Text ORDER BY COUNT(*) DESC" -i:TEXTWORD -rtp:-1   <- Counts every WORD... if that's what you wanted...

SELECT * FROM System WHERE TimeWritten >= SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02', 'yyyy-MM-dd') )
SELECT TimeGenerated, EventTypeName, SourceName FROM System WHERE ( SourceName = 'Service Control Manager' AND EventID >= 7024) OR ( SourceName = 'W32Time')
SELECT * FROM Security WHERE Message LIKE '%logon%'
WHERE EventID IN (547;541;540;528)
WHERE EventID BETWEEN 528 AND 547
LogParser -h -i:NETMON -fMode:TCPIP
LogParser -h -i:NETMON -fMode:TCPConn
LogParser -i:EVT -fullText:OFF -o:CSV -tabs:OFF
 -i:TEXTLINE -iCheckPoint:myCheckPoint.lpc

 LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT COUNT(*) AS Total FROM MyLogs\*.*" -i:TEXTLINE -iCheckPoint:myCheckPoint.lpc
 COUNT(DISTINCT SourceName)

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message, SID FROM Security WHERE EventID = 528 AND SID LIKE '%BobMaars%'"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EventID, TO_INT(QUANTIZE(TimeGenerated, 86400)) AS ToDay, SID, SourceName, EventCategoryName, Message FROM Security WHERE EventID = 4624 ORDER BY ToDay ASC"
 INTO %odl%\LPreport.txt

LogParser -i:EVT -o:NAT "SELECT * FROM System"
LogParser -i:EVT -o:NAT "SELECT * INTO STDOUT FROM System"
LogParser -i:EVT -o:NAT "SELECT TimeGenerated, EventTypeName, SourceName FROM System"
LogParser -i:EVT -o:NAT "SELECT TO_DATE(TimeGenerated), TO_UPPERCASE( EXTRACT_TOKEN(EventTypeName, 0, ' ') ), SourceName FROM System"

LogParser -i:EVT -o:NAT "SELECT 'Contains \' a quote', 'Contains \\ a backslash', SourceName FROM SYSTEM"
LogParser -i:EVT -o:NAT "SELECT TO_DATE(TimeGenerated) AS DateGenerated, TO_UPPERCASE( EXTRACT_TOKEN(EventTypeName, 0, ' ') ) AS TypeName, SourceName FROM System"
LogParser -i:FS -o:NAT "SELECT Path, Size FROM %odl%\*.* ORDER BY Size"
LogParser -i:FS -o:NAT "SELECT Path, Size FROM %odl%\*.* ORDER BY Size DESC"
LogParser -i:FS -o:NAT "SELECT Name, Size, CreationTime FROM %odl%\*.* ORDER BY Size, CreationTime"
LogParser -i:FS -o:NAT "SELECT COUNT(*) FROM %OneDrive%\AboutMe_Combined.txt"

SELECT EXTRACT_EXTENSION(cs-uri-stem) AS PageType, COUNT(*) FROM ex040528.log GROUP BY PageType
SELECT EXTRACT_EXTENSION(cs-uri-stem) AS PageType, sc-status, COUNT(*) FROM ex040528.log GROUP BY PageType, sc-status
SELECT QUANTIZE(time, 20) AS Interval, EXTRACT_EXTENSION(cs-uri-stem) AS PageType, sc-status, MUL( PROPCOUNT(*) ON (Interval, PageType), 100.0) AS Hits1, MUL( PROPCOUNT(*) ON (Interval), 100.0) AS Hits2, MUL( PROPCOUNT(*), 100.0) AS Hits3 FROM ex040528.log GROUP BY Interval, PageType, sc-status ORDER BY Interval, PageType, sc-status

LogParser -i:EVT -o:NAT "SELECT DISTINCT RESOLVE_SID(Sid) AS Account FROM Security WHERE EventID IN (540;528)"
LogParser -i:EVT -o:NAT "SELECT EXTRACT_TOKEN( TO_LOWERCASE( RESOLVE_SID(Sid) ), 1, '\\') AS Username FROM Security WHERE EventID IN (540;528) AND EXTRACT_TOKEN( TO_LOWERCASE( RESOLVE_SID(Sid) ), 0, '\\') = '%domainname%'"

:: Error: Error sending packet: The request is not supported. - LogParser -o:SYSLOG -facility:$MyFacility -severity:$MySeverity -hostName:$ComputerName "SELECT TimeGenerated, CASE SourceName WHEN 'EventLog' THEN 'mark' WHEN 'Service Control Manager' THEN 'daemon' WHEN 'Print' THEN 'lpr' WHEN 'Kerberos' THEN 'auth' WHEN 'NETLOGON' THEN 'logaudit' WHEN 'Application Popup' THEN 'local7' ELSE 'local0' END AS MyFacility, CASE EventTypeName WHEN 'Error event' THEN 'err' WHEN 'Warning event' THEN 'warning' WHEN 'Information event' THEN 'info' ELSE 'info' END AS MySeverity, ComputerName, STRCAT(SourceName, ':'), Message INTO %ohtm%\%ComputerName%-Test,Log.txt FROM System"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
 +-------------------------------------------------------+
 ¦ Attempt to Scrape Data FROM Web Page using LogParser  ¦
 +-------------------------------------------------------+
LogParser -i:TSV "SELECT * FROM 'https://Google.com'"
LogParser -i:TSV "SELECT * FROM 'https://rewards.bing.com'"

SET url=rewards.bing.com
SET url=https://rewards.bing.com

LogParser -i:TSV -rtp:-1 -o:datagrid "SELECT * FROM 'https://rewards.bing.com' WHERE Text LIKE '%userStatus%' AND Text LIKE '%Available Points%' AND Text LIKE '%Streak count%' AND Text LIKE '%Points earned%' AND Text LIKE '%lifetime points%' AND Text LIKE '[%ve earned%]'"

ping -n 5 www.Google.com | LogParser -i:TSV -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TO_INT(REPLACE_STR(EXTRACT_VALUE(Text,'time',' '),'ms','')) AS Response FROM stdin WHERE Text LIKE '%Reply%' GROUP BY Response"


echo Graphing Ping Results & ping -n 15 %url% | LogParser -i:TSV -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TO_INT(REPLACE_STR(EXTRACT_VALUE(Text,'time',' '),'ms','')) AS Response INTO %odl%\Ping.gif FROM stdin WHERE Text LIKE '%%Reply%%' GROUP BY Response" -i textline -legend off -chartTitle "Ping Time=.ms - %url%" -view
LogParser -i:TSV -rtp:-1 -o:datagrid "SELECT * FROM %url% WHERE Text LIKE '%userStatus%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT Text FROM %url% WHERE Text LIKE '%href%'"
 var dashboard = ......":[]}};

netstat | LogParser -i:TSV -rtp:-1 -o:datagrid -iSeparator:space -nSep:2 -fixedSep:off -nSkipLines:3 "SELECT * FROM STDIN"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/*  Last Updated: 14 Apr 2022 09:16 PM
Ref: https://github.com/JamesHabben/sysmon-queries/commit/446142dcf113ae2269355c6fd9c98c0718a870a5
file-create-time.txt
*/
Select RecordNumber,TimeGenerated,EventID,SourceName,ComputerName,SID,
	EXTRACT_TOKEN(strings,0,'|') AS UtcTime,
	EXTRACT_TOKEN(strings,1,'|') AS ProcGuid,
	EXTRACT_TOKEN(strings,2,'|') AS ProcId,
	EXTRACT_TOKEN(strings,3,'|') AS ImagePath,
	EXTRACT_TOKEN(strings,4,'|') AS TargetPath,
	EXTRACT_TOKEN(strings,5,'|') AS NewCreateUtc,
	EXTRACT_TOKEN(strings,6,'|') AS PrevCreateUtc
FROM f:\Microsoft-Windows-Sysmon%4Operational.evtx
where EventID = 2
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/*  Last Updated: 14 Apr 2022 09:16 PM
Ref: https://github.com/JamesHabben/sysmon-queries/commit/446142dcf113ae2269355c6fd9c98c0718a870a5
image-load.txt
*/
Select RecordNumber,TimeGenerated,EventID,SourceName,ComputerName,SID,
	EXTRACT_TOKEN(strings,0,'|') AS UtcTime,
	EXTRACT_TOKEN(strings,1,'|') AS ProcGuid,
	EXTRACT_TOKEN(strings,2,'|') AS ProcId,
	EXTRACT_TOKEN(strings,3,'|') AS ImagePath,
	EXTRACT_TOKEN(strings,4,'|') AS ImageLoaded,
	EXTRACT_TOKEN(strings,5,'|') AS HashType,
	EXTRACT_TOKEN(strings,6,'|') AS Hash,
	EXTRACT_TOKEN(strings,7,'|') AS Signed,
	EXTRACT_TOKEN(strings,8,'|') AS Signature
FROM f:\Microsoft-Windows-Sysmon%4Operational.evtx
where EventID = 7
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/*  Last Updated: 14 Apr 2022 09:16 PM
Ref: https://github.com/JamesHabben/sysmon-queries/commit/446142dcf113ae2269355c6fd9c98c0718a870a5
network-connection.txt
*/
Select RecordNumber,TimeGenerated,EventID,SourceName,ComputerName,SID,
	EXTRACT_TOKEN(strings,0,'|') AS UtcTime,
	EXTRACT_TOKEN(strings,1,'|') AS ProcGuid,
	EXTRACT_TOKEN(strings,2,'|') AS ProcId,
	EXTRACT_TOKEN(strings,3,'|') AS ImagePath,
	EXTRACT_TOKEN(strings,4,'|') AS User,
	EXTRACT_TOKEN(strings,5,'|') AS Prot,
	EXTRACT_TOKEN(strings,6,'|') AS Init,
	EXTRACT_TOKEN(strings,7,'|') AS SrcIsIp6,
	EXTRACT_TOKEN(strings,8,'|') AS SrcIp,
	EXTRACT_TOKEN(strings,9,'|') AS SrcHost,
	EXTRACT_TOKEN(strings,10,'|') AS SrcPrt,
	EXTRACT_TOKEN(strings,11,'|') AS SrcPrtNam,
	EXTRACT_TOKEN(strings,12,'|') AS DstIsIp6,
	EXTRACT_TOKEN(strings,13,'|') AS DstIp,
	EXTRACT_TOKEN(strings,14,'|') AS DstHost,
	EXTRACT_TOKEN(strings,15,'|') AS DstPrt,
	EXTRACT_TOKEN(strings,16,'|') AS DstPrtNam
FROM f:\Microsoft-Windows-Sysmon%4Operational.evtx
where EventID = 3
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/*  Last Updated: 14 Apr 2022 09:16 PM
Ref: https://github.com/JamesHabben/sysmon-queries/commit/446142dcf113ae2269355c6fd9c98c0718a870a5
process-create-terminate.txt
*/
Select RecordNumber,TimeGenerated,EventID,SourceName,ComputerName,SID,
	EXTRACT_TOKEN(strings,0,'|') AS UtcTime,
	EXTRACT_TOKEN(strings,1,'|') AS ProcGuid,
	EXTRACT_TOKEN(strings,2,'|') AS ProcId,
	EXTRACT_TOKEN(strings,3,'|') AS ImagePath,
	EXTRACT_TOKEN(strings,4,'|') AS Params,
	EXTRACT_TOKEN(strings,5,'|') AS LogonUser,
	EXTRACT_TOKEN(strings,6,'|') AS LogonGuid,
	EXTRACT_TOKEN(strings,7,'|') AS LogonId,
	EXTRACT_TOKEN(strings,8,'|') AS TermSesId,
	EXTRACT_TOKEN(strings,9,'|') AS IntegLvl,
	EXTRACT_TOKEN(strings,10,'|') AS HashType,
	EXTRACT_TOKEN(strings,11,'|') AS Hash,
	EXTRACT_TOKEN(strings,12,'|') AS ParProcGuid,
	EXTRACT_TOKEN(strings,13,'|') AS ParProcId,
	EXTRACT_TOKEN(strings,14,'|') AS ParImagePath,
	EXTRACT_TOKEN(strings,15,'|') AS ParParams
FROM f:\Microsoft-Windows-Sysmon%4Operational.evtx
where EventID in (1;5)
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
# LogParser
###############
# Security Log
###############
# Find Event id
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5038'"

# Show what eventids in event log sorted by count
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) AS Cntr, EventID FROM Security GROUP BY EventID ORDER BY Cntr DESC"

# Eventid 1102
# Eventlog was cleared
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') as Username, EXTRACT_TOKEN(Strings, 2, '|') AS Workstation FROM Security WHERE EventID = '1102'"

# Eventid 4624
# successful logon
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY')"

# Find Specific user
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY') AND Username = 'Administrator'"

# Find RDP logons
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY') AND LogonType = '10'"

# Find console logons
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY') AND LogonType = '2'"

# Find Specific IP
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY') AND SourceIP = '10.1.47.151'"

# look at NTLM based logons
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType, EXTRACT_TOKEN(strings, 10, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$'"

# group by NTLM users
& LogParser -q:ON -stats:On EVT "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 8, '|') as LogonType, EXTRACT_TOKEN(strings, 9, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 11, '|') AS Workstation, EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName, EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security WHERE EventID = 4624 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$' GROUP BY Username, Domain, LogonType, AuthPackage, Workstation, ProcessName, SourceIP ORDER BY Cntr DESC"

# group by users
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(Strings, 5, '|') as Username, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"

# group by domain
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(Strings, 6, '|') as Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY Domain ORDER BY Cntr DESC"

# group by authpackage
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(Strings, 9, '|') as AuthPackage, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY AuthPackage ORDER BY Cntr DESC"

# group by LogonType
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(Strings, 8, '|') as LogonType, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY LogonType ORDER BY Cntr DESC"

# group by workstation name
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(Strings, 11, '|') as Workstation, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY Workstation ORDER BY Cntr DESC"

# group by process name
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(Strings, 17, '|') as ProcName, COUNT(*) AS Cntr FROM Security WHERE EventID = 4624 GROUP BY ProcName ORDER BY Cntr DESC"
#
# Event id 4625
# unsuccessful logon
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 10, '|') as LogonType,EXTRACT_TOKEN(strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY')"

# Find Specific User
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 10, '|') as LogonType,EXTRACT_TOKEN(strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY') AND Username = 'Administrator'"

# Find Specific IP
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 10, '|') as LogonType,EXTRACT_TOKEN(strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY') AND SourceIP = '10.1.47.151'"

# check ntlm based attempts
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 10, '|') as LogonType, EXTRACT_TOKEN(strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$'"

# group by ntlm users
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 6, '|') as Domain, EXTRACT_TOKEN(Strings, 10, '|') as LogonType,EXTRACT_TOKEN(strings, 11, '|') AS AuthPackage, EXTRACT_TOKEN(Strings, 13, '|') AS Workstation, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP FROM Security WHERE EventID = 4625 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Domain NOT IN ('NT AUTHORITY') AND AuthPackage LIKE '%NtLmSsp%' AND Username NOT LIKE '%$' GROUP BY Username, Domain, LogonType, AuthPackage, Workstation, SourceIP ORDER BY Cntr DESC"

# group by Username
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') as Username FROM Security WHERE EventID = 4625 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"

# event id 4634
# user logoff

LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4634 AND Domain NOT IN ('NT AUTHORITY')"

# Event id 4648
# explicit creds was used
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated as date, EXTRACT_TOKEN(strings, 1, '|') as accountname, EXTRACT_TOKEN(strings, 2, '|') as domain, EXTRACT_TOKEN(strings, 5, '|') as usedaccount, EXTRACT_TOKEN(strings, 6, '|') as useddomain, EXTRACT_TOKEN(strings, 8, '|') as targetserver, EXTRACT_TOKEN(strings, 9, '|') as extradata, EXTRACT_TOKEN(strings, 11, '|') as procname, EXTRACT_TOKEN(strings, 12, '|') as sourceip FROM Security WHERE EventID = 4648"

# Search by accountname
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated as date, EXTRACT_TOKEN(strings, 1, '|') as accountname, EXTRACT_TOKEN(strings, 2, '|') as domain, EXTRACT_TOKEN(strings, 5, '|') as usedaccount, EXTRACT_TOKEN(strings, 6, '|') as useddomain, EXTRACT_TOKEN(strings, 8, '|') as targetserver, EXTRACT_TOKEN(strings, 9, '|') as extradata, EXTRACT_TOKEN(strings, 11, '|') as procname, EXTRACT_TOKEN(strings, 12, '|') as sourceip FROM Security WHERE EventID = 4648 AND accountname = 'Administrator'"

# Search by usedaccount
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated as date, EXTRACT_TOKEN(strings, 1, '|') as accountname, EXTRACT_TOKEN(strings, 2, '|') as domain, EXTRACT_TOKEN(strings, 5, '|') as usedaccount, EXTRACT_TOKEN(strings, 6, '|') as useddomain, EXTRACT_TOKEN(strings, 8, '|') as targetserver, EXTRACT_TOKEN(strings, 9, '|') as extradata, EXTRACT_TOKEN(strings, 11, '|') as procname, EXTRACT_TOKEN(strings, 12, '|') as sourceip FROM Security WHERE EventID = 4648 AND usedaccount = 'Administrator'"

# group by accountname
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 1, '|') as accountname FROM Security WHERE EventID = 4648 GROUP BY accountname ORDER BY Cntr DESC"

# group by used account
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 5, '|') as usedaccount FROM Security WHERE EventID = 4648 GROUP BY usedaccount ORDER BY Cntr DESC"

# event id 4657
# A registry value was modified
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '4657'"

# event id 4663
# An attempt was made to access an object
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '4663'"

# Event id 4672
# Admin logon

LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4672 AND Domain NOT IN ('NT AUTHORITY')
# Find Specific user
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4672 AND Domain NOT IN ('NT AUTHORITY') AND Username = 'Administrator'"
# group by username
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS Username, COUNT(*) AS Cntr FROM Security WHERE EventID = 4672 AND Username NOT IN ('SYSTEM';'ANONYMOUS LOGON';'LOCAL SERVICE';'NETWORK SERVICE') AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"
# group by domain
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(Strings, 2, '|') AS Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4672 AND Domain NOT IN ('NT AUTHORITY') GROUP BY Domain ORDER BY Cntr DESC"
# event id 4688
# new process was created
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688"
# Search by user
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 AND Username = 'Administrator'"
# Search by process name
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 AND Process LIKE '%rundll32.exe%'"
# group by username
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 1, '|') AS Username FROM Security WHERE EventID = 4688 GROUP BY Username ORDER BY Cntr DESC"
# group by process name
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(Strings, 5, '|') AS Process FROM Security WHERE EventID = 4688 GROUP BY Process ORDER BY Cntr DESC"
# event id 4704
# A user right was assigned
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '4704'"
# event id 4705
# A user right was removed
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '4705'"
# event id 4706
# A new trust was created to a domain
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '4706'"
# event id 4720
# A user account was created
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS createduser, EXTRACT_TOKEN(strings, 1, '|') AS createddomain, EXTRACT_TOKEN(strings, 4, '|') as whocreated, EXTRACT_TOKEN(strings, 5, '|') AS whodomain FROM Security WHERE EventID = '4720'"
# Event id 4722
# user account was enabled
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0, '|') as user, EXTRACT_TOKEN(strings, 1, '|') as domain, EXTRACT_TOKEN(strings, 4, '|') as whichaccount, EXTRACT_TOKEN(strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4722"
# event id 4723
# attempt to change password for the account - user changed his own password  EVT
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0, '|') as user, EXTRACT_TOKEN(strings, 1, '|') as domain, EXTRACT_TOKEN(strings, 4, '|') as whichaccount, EXTRACT_TOKEN(strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4723"
# event id 4724
# attempt to reSET user
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0, '|') as user, EXTRACT_TOKEN(strings, 1, '|') as domain, EXTRACT_TOKEN(strings, 4, '|') as whichaccount, EXTRACT_TOKEN(strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4724"
# event id 4725
# user account was disabled
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0, '|') as user, EXTRACT_TOKEN(strings, 1, '|') as domain, EXTRACT_TOKEN(strings, 4, '|') as whichaccount, EXTRACT_TOKEN(strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4725"
# event id 4726
# A user account was deleted
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS deleteduser, EXTRACT_TOKEN(strings, 1, '|') AS deleteddomain, EXTRACT_TOKEN(strings, 4, '|') as whodeleted, EXTRACT_TOKEN(strings, 5, '|') AS whodomain FROM Security WHERE EventID = '4726'"
# event id 4727
# A security-enabled global group was created
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT *  FROM Security WHERE EventID = '4727'"
# event id 4728
# A member was added to a security-enabled global group
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as addeduser, EXTRACT_TOKEN(strings, 2, '|') as togroup, EXTRACT_TOKEN(strings, 3, '|') as groupdomain, EXTRACT_TOKEN(strings, 6, '|') as whoadded, EXTRACT_TOKEN(strings, 7, '|') as whodomain FROM Security WHERE EventID = '4728'"
# event id 4729
# A member was removed FROM a security-enabled global group
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as removeduser, EXTRACT_TOKEN(strings, 2, '|') as FROMgroup, EXTRACT_TOKEN(strings, 3, '|') as groupdomain, EXTRACT_TOKEN(strings, 6, '|') as whoremoved, EXTRACT_TOKEN(strings, 7, '|') as whodomain FROM Security WHERE EventID = '4729'"
# event id 4730
# A security-enabled global group was deleted
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '4730'"
# event id 4731
# A security-enabled local group was created
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0, '|') as createdgroup, EXTRACT_TOKEN(strings, 1, '|') as domain, EXTRACT_TOKEN(strings, 4, '|') as whichaccount, EXTRACT_TOKEN(strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4731"
# event id 4732
#  A member was added to a security-enabled local group
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as addeduser, EXTRACT_TOKEN(strings, 2, '|') as togroup, EXTRACT_TOKEN(strings, 3, '|') as groupdomain, EXTRACT_TOKEN(strings, 6, '|') as whoadded, EXTRACT_TOKEN(strings, 7, '|') as whodomain FROM Security WHERE EventID = '4732'"
# event id 4733
# A member was removed FROM a security-enabled local group
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as removeduser, EXTRACT_TOKEN(strings, 2, '|') as FROMgroup, EXTRACT_TOKEN(strings, 3, '|') as groupdomain, EXTRACT_TOKEN(strings, 6, '|') as whoremoved, EXTRACT_TOKEN(strings, 7, '|') as whodomain FROM Security WHERE EventID = '4733'"
# event id 4734
#  A security-enabled local group was deleted
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS whichgroup, EXTRACT_TOKEN(Strings, 3, '|') AS domaingroup, EXTRACT_TOKEN(Strings, 6, '|') AS who, EXTRACT_TOKEN(Strings, 7, '|') AS workstation FROM Security WHERE EventID = 4734"
# event id 4738
# user account was changed
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 1, '|') as user, EXTRACT_TOKEN(strings, 2, '|') as domain, EXTRACT_TOKEN(strings, 5, '|') as whichaccount, EXTRACT_TOKEN(strings, 6, '|') as whichdomain FROM Security WHERE EventID = 4738"
# event id 4740
# A user account was locked out
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0, '|') as user, EXTRACT_TOKEN(strings, 1, '|') as workstation, EXTRACT_TOKEN(strings, 4, '|') as wholocked, EXTRACT_TOKEN(strings, 5, '|') as whodomain FROM Security WHERE EventID = '4740'"
# event id 4742
# computer account was changed
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 5, '|') as user, EXTRACT_TOKEN(strings, 6, '|') as domain, EXTRACT_TOKEN(strings, 1, '|') as whichaccount, EXTRACT_TOKEN(strings, 2, '|') as whichdomain FROM Security WHERE EventID = 4742"
# event id 4754
# A security-enabled universal group was created
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0, '|') as createdgroup, EXTRACT_TOKEN(strings, 1, '|') as domain, EXTRACT_TOKEN(strings, 4, '|') as whichaccount, EXTRACT_TOKEN(strings, 5, '|') as whichdomain FROM Security WHERE EventID = 4754"
# event id 4756
#  	A member was added to a security-enabled universal group
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as addeduser, EXTRACT_TOKEN(strings, 2, '|') as togroup, EXTRACT_TOKEN(strings, 3, '|') as groupdomain, EXTRACT_TOKEN(strings, 6, '|') as whoadded, EXTRACT_TOKEN(strings, 7, '|') as whodomain FROM Security WHERE EventID = '4756'"
# event id 4757
# A member was removed FROM a security-enabled universal group
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') as removeduser, EXTRACT_TOKEN(strings, 2, '|') as FROMgroup, EXTRACT_TOKEN(strings, 3, '|') as groupdomain, EXTRACT_TOKEN(strings, 6, '|') as whoremoved, EXTRACT_TOKEN(strings, 7, '|') as whodomain FROM Security WHERE EventID = '4757'"
# event id 4758
#  A security-enabled universal group was deleted
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 2, '|') AS whichgroup, EXTRACT_TOKEN(Strings, 3, '|') AS domaingroup, EXTRACT_TOKEN(Strings, 6, '|') AS who, EXTRACT_TOKEN(Strings, 7, '|') AS workstation FROM Security WHERE EventID = 4758"
# event id 4767
# A user account was unlocked
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '4767'"
# event id 4768
# Kerberos TGT was requested
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0, '|') as user, EXTRACT_TOKEN(strings, 1, '|') as domain, EXTRACT_TOKEN(strings, 7, '|') as cipher, EXTRACT_TOKEN(strings, 9, '|') as sourceip FROM Security WHERE EventID = 4768"
# group by user
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 0, '|') as user, COUNT(*) AS Cntr FROM Security WHERE EventID = 4768 AND user NOT LIKE '%$' GROUP BY user ORDER BY Cntr DESC"
# group by domain
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 1, '|') as domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4768 GROUP BY domain ORDER BY Cntr DESC"
# group by cipher
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 7, '|') as cipher, COUNT(*) AS Cntr FROM Security WHERE EventID = 4768 GROUP BY cipher ORDER BY Cntr DESC"
# event id 4769
# Kerberos Service ticket was requested
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0, '|') as user, EXTRACT_TOKEN(strings, 1, '|') as domain, EXTRACT_TOKEN(strings, 2, '|') as service, EXTRACT_TOKEN(strings, 5, '|') as cipher, EXTRACT_TOKEN(strings, 6, '|') as sourceip FROM Security WHERE EventID = 4769"
# group by user
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 0, '|') as user, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 AND user NOT LIKE '%$' GROUP BY user ORDER BY Cntr DESC"
# group by domain
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 1, '|') as domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 GROUP BY domain ORDER BY Cntr DESC"
# group by service
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 2, '|') as service, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 GROUP BY service ORDER BY Cntr DESC"
# group by cipher
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 5, '|') as cipher, COUNT(*) AS Cntr FROM Security WHERE EventID = 4769 GROUP BY cipher ORDER BY Cntr DESC"
# event id 4771
# kerberos pre-atuhentication failed
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0 , '|') as user, EXTRACT_TOKEN(strings, 6 , '|') as sourceip FROM Security WHERE EventID = 4771 AND user NOT LIKE '%$'"
# group by user
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 0, '|') as user, COUNT(user) AS Cntr FROM Security WHERE EventID = 4771 AND user NOT LIKE '%$' GROUP BY user ORDER BY Cntr DESC"
# event id 4776
# domain/computer attemped to validate user credentials
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4776 AND Domain NOT IN ('NT AUTHORITY') AND Username NOT LIKE '%$'"
# Search by username
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') AS Username, EXTRACT_TOKEN(Strings, 2, '|') AS Domain FROM Security WHERE EventID = 4776 AND Domain NOT IN ('NT AUTHORITY') AND Username NOT LIKE '%$' AND Username = 'Administrator'"
# group by username
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(Strings, 1, '|') AS Username, COUNT(*) AS Cntr FROM Security WHERE EventID = 4776 AND Username NOT LIKE '%$' GROUP BY Username ORDER BY Cntr DESC"
# group by domain
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(Strings, 2, '|') AS Domain, COUNT(*) AS Cntr FROM Security WHERE EventID = 4776 GROUP BY Domain ORDER BY Cntr DESC"
# event id 4778
# RDP session reconnected
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date,EXTRACT_TOKEN(Strings, 0, '|') AS Username, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS Workstation, EXTRACT_TOKEN(Strings, 5, '|') AS SourceIP  FROM Security WHERE EventID = 4778"
# event id 4779
# RDP session disconnected
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date,EXTRACT_TOKEN(Strings, 0, '|') AS Username, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 4, '|') AS Workstation, EXTRACT_TOKEN(Strings, 5, '|') AS SourceIP  FROM Security WHERE EventID = 4779"
# event id 4781
# User account was renamed
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS newname, EXTRACT_TOKEN(Strings, 1, '|') AS oldname, EXTRACT_TOKEN(Strings, 2, '|') AS accdomain, EXTRACT_TOKEN(Strings, 5, '|') AS Username, EXTRACT_TOKEN(Strings, 6, '|') AS Domain FROM Security WHERE EventID = 4781"
# event id 4825
# RDP Access denied
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 0, '|') AS Username, EXTRACT_TOKEN(Strings, 1, '|') AS Domain, EXTRACT_TOKEN(Strings, 3, '|') AS SourceIP FROM Security WHERE EventID = 4825"
# event id 4946
# new exception was added to firewAll
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 2, '|') as rulename FROM Security WHERE EventID = 4946"
# group by rule name
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 2, '|') as rulename FROM Security WHERE EventID = 4946 GROUP BY rulename ORDER BY Cntr DESC"
# event id 4948
# rule was deleted FROM firewAll
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 2, '|') as rulename FROM Security WHERE EventID = 4948"
# group by rule name
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 2, '|') as rulename FROM Security WHERE EventID = 4948 GROUP BY rulename ORDER BY Cntr DESC"
# event id 5038
# Code integrity determined that the image hash of a file is not valid
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5038'"
# event id 5136
# A directory service object was modified
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 3, '|') AS Username, EXTRACT_TOKEN(strings, 4, '|') AS Domain, EXTRACT_TOKEN(strings, 8, '|') AS objectdn, EXTRACT_TOKEN(strings, 10, '|') AS objectclass, EXTRACT_TOKEN(strings, 11, '|') AS objectattrib, EXTRACT_TOKEN(strings, 13, '|') AS attribvalue FROM Security WHERE EventID = '5136'"
# group by username
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(strings, 3, '|') AS Username FROM Security WHERE EventID = '5136' GROUP BY Username ORDER BY Cntr DESC"
# group by domain
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(strings, 4, '|') AS Domain FROM Security WHERE EventID = '5136' GROUP BY Domain ORDER BY Cntr DESC"
# group by objectdn
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(strings, 8, '|') AS objectdn FROM Security WHERE EventID = '5136' GROUP BY objectdn ORDER BY Cntr DESC"
# group by objectclass
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(strings, 10, '|') AS objectclass FROM Security WHERE EventID = '5136' GROUP BY objectclass ORDER BY Cntr DESC"
# group by objectattrib
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(strings, 11, '|') AS objectattrib FROM Security WHERE EventID = '5136' GROUP BY objectattrib ORDER BY Cntr DESC"
# group by attribvalue
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) AS Cntr, EXTRACT_TOKEN(strings, 13, '|') AS attribvalue FROM Security WHERE EventID = '5136' GROUP BY attribvalue ORDER BY Cntr DESC"
# event id 5137
# A directory service object was created
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5137'"
# event id 5138
# A directory service object was undeleted
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5138'"
# event id 5139
# A directory service object was moved
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5139'"
# event id 5141
# A directory service object was deleted
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5141'"
# event id 5140
# A network share object was accessed
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5140'"
# event id 5142
# A network share object was added
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5142'"
# event id 5143
# A network share object was modified
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5143'"
# event id 5144
# A network share object was deleted
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5144'"
# event id 5145
# A network share object was checked to see whether client can be granted desired access
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5145'"
# event id 5154
# The Windows Filtering Platform has permitted an application or service to listen on a port for incoming connections
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5154'"
# event id 5155
# The Windows Filtering Platform has blocked an application or service FROM listening on a port for incoming connections
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5155'"
# event id 5156
# The Windows Filtering Platform has Allowed a connection
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5156'"
# event id 5157
# The Windows Filtering Platform has blocked a connection
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5157'"
# event id 5158
# The Windows Filtering Platform has permitted a bind to a local port
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5158'"
# event id 5159
# The Windows Filtering Platform has blocked a bind to a local port
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT * FROM Security WHERE EventID = '5159'"
#############
# System Log
#############
# EventID 7045
# New Service was Installed in system
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0, '|') AS ServiceName, EXTRACT_TOKEN(strings, 1, '|') AS ServicePath, EXTRACT_TOKEN(strings, 4, '|') AS ServiceUser FROM System WHERE EventID = 7045"
# EventID 7036
# Service actions
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 0, '|') as servicename FROM System WHERE EventID = 7036"
# group by service name
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 0, '|') as servicename FROM System WHERE EventID = 7036 GROUP BY servicename ORDER BY Cntr DESC"
#####################
# Task Scheduler Log
#####################
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Date, EventID, EventTypeName,SourceName,Strings, Message, Data,  EXTRACT_TOKEN(strings,0, '|') as taskname, EXTRACT_TOKEN(strings, 1, '|') as username FROM System WHERE EventID IN (100;110;322;200;129;106) ORDER BY Date ASC"
echo EventIDs for Task Schedular Task was run&LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings,0, '|') as taskname, EXTRACT_TOKEN(strings, 1, '|') as username FROM System WHERE EventID IN (100;110;322;200;129;106)"
echo EventID 100&echo Task was run&LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings,0, '|') as taskname, EXTRACT_TOKEN(strings, 1, '|') as username FROM System WHERE EventID = 100"
echo group by taskname&LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 0, '|') as taskname, COUNT(*) as Cntr FROM System WHERE EventID = 100 GROUP BY taskname ORDER BY Cntr DESC"
echo eventid 200 action was executed&LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings,0, '|') as taskname, EXTRACT_TOKEN(strings, 1, '|') as taskaction FROM System WHERE EventID = 200"
echo group by action&LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 1, '|') as taskaction, COUNT(*) as Cntr FROM System WHERE EventID = 200 GROUP BY taskaction ORDER BY Cntr DESC"
echo eventid 140 user updated a task
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 -resolveSIDs:ON "SELECT TimeGenerated as Date, EXTRACT_TOKEN(strings, 0, '|') as taskname, EXTRACT_TOKEN(strings, 1, '|') as user,SID FROM System WHERE EventID = 140"
echo group by user&LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 1, '|') as user, COUNT(*) as Cntr FROM System WHERE EventID = 140 GROUP BY user ORDER BY Cntr DESC"
echo group by taskname&LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 0, '|') as taskname, COUNT(*) as Cntr FROM System WHERE EventID = 140 GROUP BY taskname ORDER BY Cntr DESC"
echo event id 141 user deleted a task&LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated as Date, EXTRACT_TOKEN(strings, 0, '|') as taskname, EXTRACT_TOKEN(strings, 1, '|') as user FROM System WHERE EventID = 141"
echo group by userLogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 1, '|') as user, COUNT(*) as Cntr FROM System WHERE EventID = 141 GROUP BY user ORDER BY Cntr DESC"
echo group by taskname&LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 0, '|') as taskname, COUNT(*) as Cntr FROM System WHERE EventID = 141 GROUP BY taskname ORDER BY Cntr DESC"
echo EventIDs for Task Schedular&echo Task was run&LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings,0, '|') as taskname, EXTRACT_TOKEN(strings, 1, '|') as username FROM System WHERE EventID = 100"

#######################
# Windows FirewAll Log
#######################
# EventID 2004
# New exception rule was added
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(strings, 1, '|') as rulename, EXTRACT_TOKEN(strings, 3, '|') as apppath, EXTRACT_TOKEN(strings, 22, '|') as changedapp FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2004"
# group by apppath
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 3, '|') as apppath FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2004 GROUP BY apppath ORDER BY Cntr DESC"
# event id 2005
# rule was changed
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') as rulename, EXTRACT_TOKEN(Strings, 3, '|') AS apppath, EXTRACT_TOKEN(Strings, 4, '|') AS servicename, EXTRACT_TOKEN(strings, 7, '|') AS localport, EXTRACT_TOKEN(strings, 22, '|') as modifyingapp  FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005"
# group by apppath
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 3, '|') as apppath FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005 GROUP BY apppath ORDER BY Cntr DESC"
# group by rulename
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 1, '|') as rulename FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005 GROUP BY rulename ORDER BY Cntr DESC"
# group by servicename
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 4, '|') as servicename FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005 GROUP BY servicename ORDER BY Cntr DESC"
# group by local port
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 7, '|') as localport FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005 GROUP BY localport ORDER BY Cntr DESC"
# group by modifyingapp
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 22, '|') as modifyingapp FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2005 GROUP BY modifyingapp ORDER BY Cntr DESC"
# event id 2006
# rule was deleted
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated AS Date, EXTRACT_TOKEN(Strings, 1, '|') as rulename, EXTRACT_TOKEN(strings, 3, '|') as changedapp FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2006"
# group by rulename
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 1, '|') as rulename FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2006 GROUP BY rulename ORDER BY Cntr DESC"
# group by changedapp
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 3, '|') as changedapp FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2006 GROUP BY changedapp ORDER BY Cntr DESC"
# EventID 2011
# FirewAll blocked inbound connections to the application, but did not notify the user
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated as date, EXTRACT_TOKEN(strings, 1, '|') as file, EXTRACT_TOKEN(strings, 4, '|') as port FROM 'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2011"
# group by application
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT COUNT(*) as Cntr, EXTRACT_TOKEN(strings, 1, '|') as file FROM'Microsoft-Windows-Windows FirewAll With Advanced Security%4FirewAll.evtx' WHERE EventID = 2011 GROUP BY file ORDER BY Cntr DESC"
######################
# RDP LocalSession Log
# Local logins
######################
# Event id 21
# Successful logon
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated as Date, EXTRACT_TOKEN(strings, 0, '|') as user, EXTRACT_TOKEN(strings, 2, '|') as sourceip FROM System WHERE EventID = 21"
# find Specific user
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated as Date, EXTRACT_TOKEN(strings, 0, '|') as user, EXTRACT_TOKEN(strings, 2, '|') as sourceip FROM System WHERE EventID = 21 AND user LIKE '%Administrator%'"
# group by user
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 0, '|') as user, COUNT(*) as Cntr FROM System WHERE EventID = 21 GROUP BY user ORDER BY Cntr DESC"
#######################
# RDP RemoteSession Log
#######################
# Event ID 1149
# Successful logon
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT TimeGenerated as Date, EXTRACT_TOKEN(strings, 0, '|') as user, EXTRACT_TOKEN(strings, 2, '|') as sourceip FROM 'Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx' WHERE EventID = 1149"
# group by user
LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 0, '|') as user, COUNT(*) as Cntr FROM 'Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx' WHERE EventID = 1149 GROUP BY user ORDER BY Cntr DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
	WHERE ValueName='DisplayName' ORDER BY LastWriteTime DESC"
:: List of recent Files FROM Documents and Settings:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT LastWriteTime, CreationTime, Path INTO Files_FROM_Docs.csv FROM 'c:\documents and settings\*.*' WHERE Path Like '%recent%' AND Path NOT LIKE '%.' ORDER BY LastWriteTime DESC" -i:fs -recurse -o:CSV
:: Search for logons of a Specific user on a Specific server among the events in the Windows Event Log:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated, SourceName, EventCategoryName, Message INTO report.txt FROM Security WHERE EventID = 528 AND SID LIKE '%TESTUSER%'" -resolveSIDs:ON
:: Display the distribution of registry value types:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT ValueType, COUNT(*) INTO DATAGRID FROM \HKLM GROUP BY ValueType"
:: Display All MRU saved commands Ctrl+R :
LogParser -i:REG -stats:on -q:on -o:CSV -E:-1 "SELECT Path, ValueName, Value, HEX_TO_ASC(Value) as Value2 INTO %ohtm%\%ComputerName%_MRU-Lists.csv FROM \HKCU WHERE Path LIKE '%MRU%' OR Path LIKE '%recent%' OR Path LIKE '%Used%' OR Path LIKE '%Usage%' OR Path LIKE '%Time%' OR Path LIKE '%Date%' OR Path LIKE '%Last%' OR Path LIKE '%Updated%' OR Path LIKE '%History%' OR valueName LIKE '%MRU%' OR ValueName LIKE '%recent%' OR ValueName LIKE '%Used%' OR ValueName LIKE '%Usage%' OR ValueName LIKE '%Time%' OR ValueName LIKE '%Date%' OR ValueName LIKE '%Last%' OR ValueName LIKE '%Updated%' OR ValueName LIKE '%History%' ORDER BY Path, ValueName"
:: Create an XML report file containing logon account names and dates FROM the Security Event Log messages:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS LogonDate, EXTRACT_TOKEN(Strings, 0, '|') AS Account INTO Report.xml FROM Security WHERE EventID NOT IN (541;542;543) AND EventType = 8 AND EventCategory = 2"
:: Search ISA Web Proxy log for fully-qualified domain names per user
"SELECT DISTINCT TO_LOWERCASE(cs-username) As User, r-host FROM isaproxylog.w3c WHERE s-svcname = 'w3proxy' ORDER BY User"
:: Search ISA Web Proxy log for IP addresses that sent requests for a URL ending with "gate.php" on an external network (suggesting that a client is connecting to a ZeuS botnet Command and Control server):
SELECT COUNT(DISTINCT c-ip) FROM isaproxylog.w3c WHERE cs-uri Like '%/gate.php' AND cs-Network = 'External'
:: 10 largest Files on the C: drive
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 10 Path, Name, Size FROM C:\*.* ORDER BY Size DESC" -i:FS -recurse:0
:: or
:: Return a hash of All .exe Files in the system folder:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT Path, HASHMD5_FILE(Path) FROM C:\Windows\System32\*.exe" -i:FS -recurse:0 -o:datagrid
:: Find duplicate hash values in the system folder:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT HASHMD5_FILE(Path) AS Hash, COUNT(*) AS NumberOfCopies FROM C:\Windows\System32\*.exe GROUP BY Hash HAVING NumberOfCopies > 1" -i:FS -recurse:1 -o:datagrid
:: Return a hash of All .ocx Files in the system folder:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT Path, HASHMD5_FILE(Path) FROM C:\Windows\System32\*.ocx" -i:FS -recurse:0 -o:datagrid
:: Load a portion of the registry into a SQL table.
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * INTO MyTable FROM \HKLM" -E:-10 -i:REG -o:SQL -server:MyServer\SQLEXPRESS -database:MyDatabase -driver:"SQL Server" -createTable:ON
Windows Authentication Allows us to avoid specifying the username and password on the command line.
:: -username:TestSQLUser -password:TestSQLPassword
:: The command Allowed for 100 parsing errors before aborting. These parsing errors should reflect "Error opening key "HKLM\???????????": Access is denied." conditions. Run the LogParser command with elevated privileges.
:: Parse errors:
:: Error opening key "HKLM\SAM\SAM": Access is denied.
:: Error opening key "HKLM\SAM\SAM": Access is denied.
:: Error opening key "HKLM\SECURITY": Access is denied.
:: Error opening key "HKLM\SAM\SAM": Access is denied.
:: Error opening key "HKLM\SECURITY": Access is denied.
:: Center\Service\Recording\Restricted": Access is denied.
:: You might want to run LogParser on All .sql Files in a folder. This works best if All queries are of the same type so you can specify input format and parameters.
FOR %%%i IN (*.sql) DO @LogParser file:%%%i > %%~ni.txt
:: Display users' job title breakdown FROM Active Directory:
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT title, MUL(PROPCOUNT(*), 100.0) AS Percentage INTO DATAGRID FROM 'LDAP://myusername:mypassword@mydomain/CN=Users,DC=mydomain,DC =com' WHERE title IS NOT NULL GROUP BY title ORDER BY Percentage DESC" -objClass:user
:: Display titles of current channels on MSDN BLogs:
LogParser -i:XML -fMode:Tree "SELECT title INTO MSDNBlogs.txt FROM https://blogs.msn.com/MainFeed.aspx#/rss/channel/item"
::	Top bandwidth usage by URL
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT top 50 DISTINCT SUBSTR(TO_LOWERCASE(cs-uri-stem), 0, 55) AS Url, COUNT(*) AS Hits, AVG(sc-bytes) AS AvgBytes, SUM(sc-bytes) as ServedBytes FROM '%IISLogs%\*.log' GROUP BY Url HAVING Hits >= 20 ORDER BY ServedBytes DESC"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT date as Date, QUANTIZE(time, 3600) AS Hour, sc-status as Status, COUNT(*) AS ErrorCount FROM '%IISLogs%\*.log' WHERE sc-status >= 400 GROUP BY date, hour, sc-status HAVING ErrorCount > 25 ORDER BY ErrorCount DESC"
::	Top hits by URL
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 100 cs-uri-stem as Url, COUNT(cs-uri-stem) AS Hits FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY COUNT(cs-uri-stem) DESC"
::	Top bandwidth and hits by IP / User-Agent
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) as Agent, Sum(sc-bytes) AS TotalBytes, COUNT(*) as Hits FROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent) ORDER BY TotalBytes desc"
::	Top bandwidth by hour by IP / User-Agent
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 TO_STRING(time, 'h') as Hour, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) as Agent, Sum(sc-bytes) AS TotalBytes, COUNT(*) as Hits FROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent), hour ORDER BY sum(sc-bytes) desc"
::	Top hits by hour by IP / User-Agent
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 TO_STRING(time, 'h') as Hour, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) as Agent, COUNT(*) as Hits, Sum(sc-bytes) AS TotalBytes FROM '%IISLogs%\*.log' group by c-ip, cs(User-Agent), hour ORDER BY Hits desc"
:: A good indicator for hacking activies or other attacks is the number of errors per hour.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT Date AS Date, QUANTIZE(time, 3600) AS Hour, sc-status AS Status, COUNT(*) AS ErrorCount FROM '%IISLogs%\*.log' WHERE  sc-status >= 400 GROUP BY Date, hour, sc-status HAVING ErrorCount > 25 ORDER BY ErrorCount DESC"
:: Detect unusuAlly high number of hits on a single URL from one IP address.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT DISTINCT date AS Date, cs-uri-stem AS URL, c-ip AS IPAddress, COUNT(*) AS Hits FROM '%IISLogs%\*.log' GROUP BY date, c-ip, cs-uri-stem HAVING Hits > 500 ORDER BY Hits Desc"
:: Get OS version from users hitting your site
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT DISTINCT cs-username, cs(user-agent) FROM '%IISLogs%\*.log' WHERE cs-username <> NULL GROUP BY cs-username, cs(user-agent)"
:: You may want to look for your longest requests (stems and/or queries), and the ones with most bytes received by the server. I'd also try one that groups by the bytes received and the IP, so that you can see if a particular request format that's likely repeated by one IP.
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 cs-uri-stem, cs-uri-query, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) as Agent, cs-bytes, c-ip, FROM '%IISLogs%\*.log' WHERE cs-uri-stem != '/search' ORDER BY LEN(cs-uri-query) desc"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On "SELECT TOP 30 COUNT(*) AS Hits cs-uri-stem, cs-uri-query, c-ip AS IPAddr, SUBSTR(cs(User-Agent), 0, 70) as Agent, cs-bytes, c-ip, FROM '%IISLogs%\*.log' GROUP BY c-ip, cs(User-Agent), cs-bytes ORDER BY Hits desc"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +-------------------------------------------------------------------------------+
:: |  Samsung Health data - How to get to the data - Read Jason like a csv file.   |
:: |  The dates found in com.samsung.shealth.step_daily_trend.<date>.csv           |
:: |  contain GUID file names that point to corresponding data in the jason Files. |
:: |  1) Download Samsung Health data from GalaxyS8+ to %OneDrive%                 |
:: +-------------------------------------------------------------------------------+
SET Root='%OneDrive%\Samsung\samsunghealth_bobmaars_20230817001983\*.csv'
SET Needle='%f1216b50-6cd8-43f0-a2f9-%'
SET Root=%OneDrive%\Samsung
LogParser -i:TEXTLINE -recurse:-1 -splitLongLines:Off -stats:On -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT LogFilename, Text FROM %Root% WHERE Text LIKE %Needle%"
:: Count the number of jason Files in Specific folder...
LogParser -i:FS -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as ExtCntrs FROM '%Root%\*.json' WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY ExtCntrs DESC"
:: Below find .json Files
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, Size, CreationTime as Created, LastWriteTime as LastWritten, EXTRACT_EXTENSION(Name) AS Ext, HASHMD5_FILE(Path) AS Hash, Attributes FROM '%Root%\*.json' WHERE Hash IS NOT NULL AND Size >=1 AND Ext LIKE '%.json' OR Ext LIKE '%json' ORDER BY LastWritten,Size DESC"
:: Read Specific jason file as if it were a csv file. May be tricky because there is 1 record not formatted. Is not "pretty".
:: Look for corresponding GUID in each file e.g.:  mDetailInfoId":"5416a542-6901-fb85-b86a-158a00663b6d"
:: Then pull data for e.g.: :[{"distance":24.21,"mCalorie":1.6,"mOthersTime":0,"mRunTime":0,"mStartTime":4800000,"mTimeUnit":600000,"mWalkTime":22011,"runStep":0,"walkStep":33},
:: Find Specific Text String, Needle in Haystack,in a number of log Files...
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid -Recurse:-1 "SELECT Text as LineFROMFile FROM '%Root%\*.json' WHERE Text LIKE '%mDetailInfoId%'"
:: Below MAY or May not find .csv Files - 100% Certain there are none...
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path, Name, Size, CreationTime as Created, LastWriteTime as LastWritten, EXTRACT_EXTENSION(Name) AS Ext, HASHMD5_FILE(Path) AS Hash, Attributes FROM '%Root%\*.csv' WHERE Hash IS NOT NULL AND Size >=1 AND Ext LIKE '%.csv' OR Ext LIKE '%json' ORDER BY LastWritten,Size DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -h -i:CSV
Fields: step_count,binning_data,active_time,recommendation,run_step_count,update_time,source_package_name,create_time,source_info,speed,distance,calorie,walk_step_count,deviceuuid,pkg_name,healthy_step,achievement,datauuid,day_time
SET hcsv="C:\GalaxyS8+\Samsung Health\samsung.shealth.tracker.pedometer_day_summary.csv"
SET icsv='C:\GalaxyS8+\Samsung Health\samsunghealth_bobmaars_202209221927\com.samsung.shealth.tracker.pedometer_day_summary.202209221927.csv'
LogParser -i:CSV -iHeaderFile:%hcsv% -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT * FROM %icsv% "
LogParser -i:CSV -iHeaderFile:%hcsv% -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT create_time,update_time,active_time,step_count,walk_step_count,calorie,distance FROM %icsv% ORDER BY create_time ASC"

 -dQuotes:ON -fixedFields:OFF -nFields:-1 -dtLines:10 WHERE "Last Name" LIKE '%maars%'
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Fields: duration,version_code,run_step,walk_step,com.samsung.health.step_count.start_time,com.samsung.health.step_count.sample_position_type,com.samsung.health.step_count.custom,com.samsung.health.step_count.update_time,com.samsung.health.step_count.create_time,com.samsung.health.step_count.count,com.samsung.health.step_count.speed,com.samsung.health.step_count.distance,com.samsung.health.step_count.calorie,com.samsung.health.step_count.time_offset,com.samsung.health.step_count.deviceuuid,com.samsung.health.step_count.pkg_name,com.samsung.health.step_count.end_time,com.samsung.health.step_count.datauuid
SET icsv='C:\GalaxyS8+\Samsung Health\samsunghealth_bobmaars_202209221927\com.samsung.shealth.tracker.pedometer_step_count.202209221927.csv'
SET hcsv="C:\GalaxyS8+\Samsung Health\samsung.shealth.tracker.pedometer_step_count.csv"
LogParser -i:CSV -iHeaderFile:%hcsv% -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT * FROM %icsv% "
LogParser -i:CSV -iHeaderFile:%hcsv% -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT com.samsung.health.step_count.start_time as Start_Time, com.samsung.health.step_count.end_time AS End_Time, com.samsung.health.step_count.create_time As Created, com.samsung.health.step_count.custom AS CStep_Count, com.samsung.health.step_count.count AS Step_Count, com.samsung.health.step_count.distance AS Distance, com.samsung.health.step_count.calorie AS Calarie FROM %icsv% ORDER BY Start_Time ASC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Fields: binning_data,update_time,create_time,source_pkg_name,source_type,count,speed,distance,calorie,deviceuuid,pkg_name,datauuid,day_time
SET icsv='C:\GalaxyS8+\Samsung Health\samsunghealth_bobmaars_202209221927\com.samsung.shealth.step_daily_trend.202209221927.csv'
SET hcsv="C:\GalaxyS8+\Samsung Health\samsung.shealth.step_daily_trend.csv"
LogParser -i:CSV -iHeaderFile:%hcsv% -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT * FROM %icsv% "
LogParser -i:CSV -iHeaderFile:%hcsv% -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT create_time,count,speed,distance,calorie FROM %icsv% ORDER BY create_time ASC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Fields: source,tag_id,com.samsung.health.heart_rate.heart_beat_count,com.samsung.health.heart_rate.start_time,com.samsung.health.heart_rate.custom,com.samsung.health.heart_rate.binning_data,com.samsung.health.heart_rate.update_time,com.samsung.health.heart_rate.create_time,com.samsung.health.heart_rate.max,com.samsung.health.heart_rate.min,com.samsung.health.heart_rate.time_offset,com.samsung.health.heart_rate.deviceuuid,com.samsung.health.heart_rate.comment,com.samsung.health.heart_rate.pkg_name,com.samsung.health.heart_rate.end_time,com.samsung.health.heart_rate.datauuid,com.samsung.health.heart_rate.heart_rate
SET icsv='C:\GalaxyS8+\Samsung Health\samsunghealth_bobmaars_202209221927\com.samsung.shealth.tracker.heart_rate.202209221927.csv'
SET hcsv="C:\GalaxyS8+\Samsung Health\samsung.shealth.tracker.heart_rate.csv"
LogParser -i:CSV -iHeaderFile:%hcsv% -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT * FROM %icsv% "
LogParser -i:CSV -iHeaderFile:%hcsv% -nSkipLines:1 -rtp:-1 -o:datagrid "SELECT com.samsung.health.heart_rate.start_time AS start_time, com.samsung.health.heart_rate.end_time AS end_time, com.samsung.health.heart_rate.max AS heart_rate.max, com.samsung.health.heart_rate.min AS heart_rate.min, com.samsung.health.heart_rate.heart_rate AS heart_rate FROM %icsv% ORDER BY start_time ASC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::  01) 20 newest Files on the web site
::  02) 20 most recently modified Files on the web site
::  03) Hits per URL
::  04) File extensions used by web application
::  05) Hits per URL per day
::  06) Errors per hour
::  07) Excessive hits by IP / User-Agent
::  08) Errors per hour (to be followed by IP / User-Agent involved in excessive errors per hour)
::  09) User Logins
::  10) User-Agents
::  11) Queries at Analyze your IIS Log Files – Favorite Log Parser Queries
::  12) Number of Hits per Client IP, including a Reverse DNS lookup (slow)
::  13) Top 25 File Types
::  14) Top 25 URLs
::  15) Number of hits per hour for the month of March
::  16) Number of hits per Method (GET, POST, etc)
::  17) Number of requests made by user
::  18) Extract Values FROM Query String (d and t) and use them for Aggregation
::  19) Find the Slowest 25 URLs (in average) in the site
::  20) List the count of each Status and Substatus code
::  21) List All the requests by user agent
::  22) List All the Win32 Error codes that have been logged
::  23) Queries at ISAscripts.org:
::  24) Search ISA Web Proxy logs for a count of unique IP addresses NOT accessing a particular file or filetype FROM the External network.
::  25) Search ISA Web Proxy logs for a count of unique client IP addresses FROM the External network.
::  26) Search ISA Web Proxy logs for a count of unique IP addresses accessing a particular file or filetype FROM the External network.
::  27) SELECT COUNT(DISTINCT c-ip) FROM isaproxylog.w3c WHERE cs-uri Like '%.zip' AND cs-Network = 'External'
::  28) Search ISA Web Proxy logs for a count of unique IP addresses accessing the robots.txt file FROM the External network in Web Proxy logs.
::  29) Search ISA Web Proxy logs for a list of unique client IP addresses in ISA Web Proxy or IIS W3C Extended logs.
::  30) Search ISA Web Proxy logs for a count of HTTP Filter error messages.
::  31) Search ISA Web Proxy logs for the top 20 external IP addresses that have generated Denied entries.
::  32) Search ISA Web Proxy logs for the top 10 external FQDNs that have generated Denied entries (reverse DNS lookups).
::  33) Search ISA Web Proxy logs for the top 20 users based on total bytes sent or received.
::  34) Search ISA Web Proxy logs for IPs and FQDNs accessed by each user.
::  35) Search ISA Web Proxy logs for percentage of log lines SpecificAlly Denied, categorized by governing rule in both FirewAll and Web Proxy logs.
::  36) Search ISA Web Proxy logs for percentage of log lines with Allowed or Establish actions, categorized by governing rule in both FirewAll and Web Proxy log.
::  37) Search ISA FirewAll logs for top 20 external IP addresses that have generated Denied entries.
::  38) Search ISA FirewAll logs for percentage of each type of status code.
::  39) Search ISA FirewAll logs for top 20 external IP addresses that have sent Ping of Death (or SYN attack or LAND attack) packets.
::  40) Search ISA FirewAll logs for top 20 external IP addresses that have sent packets whose headers were logged as raw hex.
::  41) Search ISA FirewAll logs for count of agent applications.
::  42) Search ISA FirewAll logs for top 20 users based on total bytes sent or received.
::  43) Search ISA FirewAll logs for percentage of log lines SpecificAlly Denied, categorized by governing rule in both FirewAll and Web Proxy logs.
::  44) Search ISA FirewAll logs for percentage of log lines with Allowed or Establish actions, categorized by governing rule in both FirewAll and Web Proxy log.
::  45) Search IIS Logs for unique referrer URLs with some qualifiers to filter out noise.
::  46) Search IIS Logs for unique user-agents with some qualifiers to filter out noise.
::  47) Search for unique client IP addresses in ISA Web Proxy or IIS W3C Extended logs.
::  48) Search IIS logs for unique referrer FQDNs in IIS logs with some qualifiers to filter out noise.
::  49) Queries at Log Parser Plus:
::  50) Return a listing of Web pages, and referring pages, that returned a 200 status (or 300 or 400 or 500) status code
::  51) Bandwidth usage by request: Return pages sorted by the total number of bytes transferred, as well as the total number of requests and average bytes
::  52) Browsers (User-Agents) and their frequency
::  53) Cookie lengths with IP / User-Agent and number of requests made with that cookie/IP / User-Agent
::  54) Data sent and received, by file type
::  55) Domains referring traffic for resources
::  56) Convert FileZilla Server logs to W3C extended log format
::  57) HTTP Status Codes (pie chart)
::  58) HTTP Status Codes (text)
::  59) HTTP status codes and percentage of total
::  60) POSTs per IP / User-Agent by total requests
::  61) Requests using suspicious query parameters
::  62) Query parameters and their frequency
::  63) Query parameters, their frequency and IP / User-Agent
::  64) Requests by file type (extension)
::  65) Requests per day
::  66) Requests by hour and requests by hour per day
::  67) Requests by seconds to process and requests by seconds to process, with percentages
::  68) Requests, bandwidth, and last visit, by IP / User-Agent
::  69) Queries at Log Parser 2.2 and ASP.NET:
::  70) Find text (in large text file)
::  71) Find the 10 largest Files FROM a Specific folder, including its subfolders
::  72) Find the 20 slowest pages in your Web site
::  73) Find the 20 most commonly used .aspx pages in your Web site
::  74) Queries at Rahul Soni's blog:
::  75) Find the peak time for your IIS Server
::  76) Checking traffic/requests between a Specific client and server
::  77) Searching Specific column names FROM a CSV file
::  78) Searching Files for culprits when you don't have Visual Studio on the Server.
::  79) What could be a more reliable way to find out "A word or phrase in the file"?
::  80) Analyzing the IISlogs to see if there is any pattern for errors
::  81) Search for All the fieldnames available for a given input type
::  82) Queries at Steve Bunting's blog:
::  83) Find Remote Desktop connects and reconnects
::  84) Queries at Marc Grote's Using the LogParser Utility to Analyze Exchange/IIS Logs:
::  85) Find OWA users
::  86) Show OWA usage
::  87) Queries at Jeff Atwood's Coding Horror:
::  88) Top 10 items retrieved
::  89) Top 10 slowest items
::  90) All Unique Urls retrieved
::  91) HTTP errors per hour
::  92) HTTP errors ORDERed by Url and Status
::  93) Win32 error codes by total and page
::  94) HTTP methods (GET, POST, etc) used per Url
::  95) Bytes sent FROM the server
::  96) Bytes sent FROM the client
::  97)  events FROM the system eventlog, ORDERed by number of occurrences and event type (error, warning, info).
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT EventID, EventTypeName, Message, COUNT(*) as Entries FROM System group by EventID, Message, EventTypeName ORDER BY EventTypeName, Entries DESC"
Show failed logon attempts
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SID FROM Security where EventID IN (529;530;531;532;533;534;535;537;539)"
Show failed logon attempts and resolve SIDs to account names
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT SID, RESOLVE_SID(SID) as Username FROM Security where EventID IN (529;530;531;532;533;534;535;537;539)
Find IP addresses with the most rejected packets in URLSCAN
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 10 ClientIP, COUNT(*) as Entries FROM URLSCAN WHERE Comment LIKE 'Url%' GROUP BY ClientIP ORDER BY Entries DESC" -o:DATAGRID
Find IP addresses with the most rejected packets in URLSCAN, but add DNS names (slow)

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 10 REVERSEDNS(ClientIP), COUNT(*) as Entries FROM URLSCAN WHERE Comment LIKE 'Url%' GROUP BY ClientIP ORDER BY Entries DESC" -o:DATAGRID
parse IIS 6 HTTPERR log entries
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TOP 10 src-ip, s-reason, COUNT(*) as Hits FROM HTTPERR group by src-ip, s-reason ORDER BY Hits DESC"
see All User-Agents that sent requests
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT cs(User-Agent) FROM '%IISLogs%\*.log' ORDER BY cs(User-Agent)"
see All IP addresses and User-Agents that sent requests
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT c-ip, cs(User-Agent) FROM '%IISLogs%\*.log' ORDER BY cs(User-Agent)"
see how many hits the corresponding Agents and IP addresses have produced, use
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT c-ip AS IPAddr, cs(User-Agent), COUNT(*) as Hits FROM '%IISLogs%\*.log' group by cs(User-Agent), Client ORDER BY cs(User-Agent), Hits DESC"
see how many different people are using NewsGator
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT DISTINCT c-ip AS IPAddr, cs(User-Agent), COUNT(*) as Hits FROM '%IISLogs%\*.log' where cs(User-Agent) like 'news%' group by cs(User-Agent), Client ORDER BY cs(User-Agent), Hits DESC"
Mark Burnett's Forensic Log Parsing with Microsoft's LogParser
:: -i:FS
Have any Files been added? Check for newest Files on the web site
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TOP 20 Path, CreationTime FROM c:\inetpub\wwwroot\*.* ORDER BY CreationTime DESC"
Have any Files been modified?
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TOP 20 Path, LastWriteTime FROM c:\inetpub\wwwroot\*.* ORDER BY LastWriteTime DESC"
Identify file extensions in use
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as Files FROM c:\inetpub\wwwroot\*.*, c:\inetpub\scripts\*.* WHERE Attributes NOT LIKE 'D%' GROUP BY Extension ORDER BY Files DESC"
Overused scripts may be a sign of abuse. Are there abnormal use patterns?

LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT TO_STRING(TO_TIMESTAMP(date, time), 'yyyy-MM-dd') AS Day, cs-uri-stem, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status<400 or sc-status>=500) AND (TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' OR TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%') GROUP BY Day, cs-uri-stem ORDER BY cs-uri-stem, Day"
Excessive errors may be a sign of hacking attempts
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT date, QUANTIZE(time, 3600) AS hour, sc-status, COUNT(*) AS Errors FROM ex03*.log WHERE sc-status>=400 GROUP BY date, hour, sc-status HAVING Errors>25 ORDER BY Errors DESC"
A high number of hits to a single URL FROM a single IP could indicate a SQL Injection vulnerability is being exploited.
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT DISTINCT date, cs-uri-stem, c-ip, COUNT(*) AS Hits FROM '%IISLogs%\*.log' GROUP BY date, c-ip, cs-uri-stem HAVING Hits>50 ORDER BY Hits Desc"
High numbers of 500 HTTP status codes or other errors could indicate a SQL Injection vulnerability is being exploited
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT cs-uri-query, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE sc-status>=500 GROUP BY cs-uri-query ORDER BY Total DESC"
GET requests to ASP pages that normAlly only receive POST requests could indicate a SQL Injection vulnerability is being exploited. What ASP errors are seen?
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid "SELECT cs-uri-query, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE sc-status>=500 GROUP BY cs-uri-query ORDER BY Total DESC"
echo What status codes are returned by the server?
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT cs-uri-stem, sc-status, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%' GROUP BY cs-uri-stem, sc-status ORDER BY cs-uri-stem, sc-status"
echo Win32 status codes, too
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT cs-uri-stem, WIN32_ERROR_DESCRIPTION(sc-win32-status) as Error, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE sc-win32-status>0 and (TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%') GROUP BY cs-uri-stem, Error ORDER BY cs-uri-stem, Error"
echo What HTTP methods are used for each page?
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT cs-uri-stem, cs-method, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status<400 or sc-status>=500) AND (TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%') GROUP BY cs-uri-stem, cs-method ORDER BY cs-uri-stem, cs-method"
echo Bytes sent to client
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT cs-uri-stem, COUNT(*) as Hits, AVG(sc-bytes) AS Avg, Max(sc-bytes) AS Max, Min(sc-bytes) AS Min, Sum(sc-bytes) AS Total FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%' GROUP BY cs-uri-stem ORDER BY cs-uri-stem"
echo Bytes sent FROM client
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT cs-uri-stem, COUNT(*) as Hits, AVG(cs-bytes) AS Avg, Max(cs-bytes) AS Max, Min(cs-bytes) AS Min, Sum(cs-bytes) AS Total FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%' GROUP BY cs-uri-stem ORDER BY cs-uri-stem"
echo Time spent processing request
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT cs-uri-stem, COUNT(*) as Hits, AVG(time-taken) AS Avg, Max(time-taken) AS Max, Min(time-taken) AS Min, Sum(time-taken) AS Total FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs-uri-stem) LIKE '%.asp%' or TO_LOWERCASE(cs-uri-stem) LIKE '%.exe%' GROUP BY cs-uri-stem ORDER BY cs-uri-stem"
echo Authenticated users;if you normAlly have anonymous users, authenticated users should be explained
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT cs-username, COUNT(*) AS Hits FROM '%IISLogs%\*.log' WHERE cs-username IS NOT NULL GROUP BY cs-username ORDER BY Hits Desc"
echo Any non-standard user-agents?
LogParser -i:IISW3C -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT DISTINCT cs(User-Agent) FROM '%IISLogs%\*.log' WHERE TO_LOWERCASE(cs(User-Agent)) NOT LIKE '%mozilla%' AND TO_LOWERCASE(cs(User-Agent)) NOT LIKE '%opera%' ORDER BY cs(User-Agent)"
::  Using Log Parser FROM C#
::  See also:
::  LogQL. Parse CSV or other delimited Files. Requires Java.
::  Parse-O-Matic. Scripting language that supports conventions such as arrays and regular expressions and offers many ways to find, compare, and alter data, including the capability to compare strings, numbers, lengths, and patterns.
::  Evil Through the Lens of Web Logs [pdf] by Russ McRee (russ@holisticinfosec.org). Other Log Parser examples are offered, other log parsing tools are described and (more importantly) why you are reviewing logs is explained.
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Examining Network Traffic and Performance Logs with Log Parser • Chapter 4 Page 138
:: While Log Parser does not intrinsically support finding column names and then querying for them, you can write add-on code to pull those names and then query for them.The following C# example pulls the column names from any CSV Perfmon file and then stores those names for querying one at a time for minimum, maximum, and average values for the entire file. This can also be accomplished a little more brutally by using a temp file and then interrogating it via a second query inside a batch file. Both examples are given. Which you choose is more of a matter of preference, as the performance is similar.
:: NOTE: If you don't have Visual Studio installed, you can download and install the .NET SDK, which includes the necessary tools.
DIR "%AppDataL%\Programs\Microsoft VS Code\Code.exe"
DIR /B /S "%AppDataL%\Programs\Microsoft VS Code\tlbimp*.*"
"C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.8 Tools\x64\TlbImp.exe"
DIR /B /S "C:\tlbimp*.*"
---CH04LP_perfmon.cs---
DIR "%OneDrive%\Log Parser 2.2\C#-Scripts\CH04LP_perfmon.cs"
DIR "%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 04\CH04LP_perfmon.cs"
:: Perform the following steps to use the C# sample (you need the .NET framework installed):
1. Make an Interop wrapper for LogParser.dll.
START "Interop" /B "C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.8 Tools\x64\TlbImp.exe" LogParser.dll /out:%SysInternals%\Interop.MSUtil.dll
:: Analyse the .dll
procexp.exe
icacls "%SysInternals%\Interop.MSUtil.dll" /grant Everyone:F
listdlls -d %SysInternals%\Interop.MSUtil.dll
:: Error opening <App> (1588): Access is denied.
2. Compile the Ch04LP_Perfmon.cs file into an executable (.EXE) with the following command:
START "csc" /B "C:\Program Files\Microsoft Visual Studio\2022\Community\MSBuild\Current\Bin\Roslyn\csc.exe" /r:%SysInternals%\Interop.MSUtil.dll /out:%SysInternals%\Ch04LP_perfmon.exe "%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 04\CH04LP_perfmon.cs"
:: Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 04\CH04LP_perfmon.cs(71,19): error CS1010: Newline in constant
:: Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 04\CH04LP_perfmon.cs(71,70): error CS1003: Syntax error, ',' expected
:: Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 04\CH04LP_perfmon.cs(72,5): error CS1003: Syntax error, ',' expected
:: Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 04\CH04LP_perfmon.cs(72,5): error CS1010: Newline in constant
:: Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 04\CH04LP_perfmon.cs(72,8): error CS1003: Syntax error, ',' expected
:: Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 04\CH04LP_perfmon.cs(73,55): error CS1026: ) expected

3. Run the new executable:
Ch04LP_Perfmon.exe <performance log filename.csv>
4. Each output line has the NT counter name, the Average Value,The Minimum Value and the Maximum Value on the following line:
\\serverName\Memory\Page Faults/sec 743 15.498725 14296.662888
5. To drill down on a particular counter that you find interesting:
---Ch04CounterDrill.sql---
SELECT [(PDH-CSV 4.0) (Pacific Standard Time)(480)] AS time, [\\serverName\Memory\Page Faults/sec] FROM FOO_Log.CSV ORDER BY time DESC
---Ch04CounterDrill.sql---
:: If you prefer scripting, here is a Windows Shell equivalent.
:: www.syngress.com - 140 Chapter 4 • Examining Network Traffic and Performance Logs with Log Parser
---Ch04LP_perfmon.cmd---
@echo off
if "%1"=="" goto :usage
if "%1"=="-h" goto :usage
if "%1"=="/h" goto :usage
if "%1"=="-?" goto :usage
if "%1"=="/?" goto :usage
REM setup variables
set countername=
set filename=%1
set %filename%=filename
REM make a temp directory and cleanup old ones
DIR /S /B %odl%\Ch04
IF EXIST %odl%\Ch04 RD %odl%\Ch04 /S /Q
MD %odl%\Ch04
REM get Column Names onto separate lines
@logparser.exe file:"%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 04\Ch04Top1.sql" -q:on -i:csv -o:csv -headerrow:off -headers:off
@logparser.exe file:"%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 04\Ch04CRLF.sql" -q:on -i:textline -headers:off -oDQuotes:OFF -o:csv
REM loop through the perfmon file and get the Average/MIN/MAX
FOR /F "skip=3 delims=," %%f in (.\%odl%\Ch04\counterlist2.csv) do (
set countername=
set countername=%%f
set %%countername%%=countername
@logparser.exe file: Ch04AVG.sql -q:on -i:csv
@logparser.exe file: Ch04MAX.sql -q:on -i:csv
@logparser.exe file: Ch04MIN.sql -q:on -i:csv)
REM Clean Up
echo cleaning up temp files
rd %odl%\Ch04 /S /Q
goto :eof
:usage
@echo Ch04LP_perfmon.cmd (CSVfilename.cmd)
goto :eof
:eof
@echo on
Include files for the previous example:
---Ch04Top1.sql---
SELECT TOP 1 * FROM %filename% TO .\%odl%\Ch04\counterlist1.csv
---Ch04LP_perfmon.cmd---
--- Ch04CRLF.sql---
SELECT REPLACE_CHR(Text,',','\u000a') FROM .\%odl%\Ch04\counterlist1.csv TO .\%odl%\Ch04\counterlist2.csv
--- Ch04CRLF.sql---
--- Ch04AVG.sql---
SELECT 'Average', '%countername%', AVG(TO_INT([%countername%])) FROM %filename%
--- Ch04AVG.sql---
:: www.syngress.com - Examining Network Traffic and Performance Logs with Log Parser • Chapter 4 141
---Ch04MAX.sql---
SELECT 'Maximum', '%countername%', MAX(TO_REAL([%countername%])) FROM %filename%
---Ch04MAX.sql---
---Ch04MIN.sql---
SELECT 'Minimum', '%countername%', MIN(TO_REAL([%countername%])) FROM %filename%
---Ch04MAX.sql---
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +---------------------------------------------------------------------------+
:: |  Test general crap..                                             |
:: +---------------------------------------------------------------------------+
 WHERE TO_DATE(CreationTime) = TO_DATE(SUB(SYSTEM_TIMESTAMP(), TO_TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd HH:mm:ss')))
 WHERE SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-01 01:00', 'yyyy-MM-dd HH:mm') )
 SELECT SUB( TO_LOCALTIME(SYSTEM_TIMESTAMP()), TIMESTAMP('0000-01-02 00:00:00', 'yyyy-MM-dd hh:mm:ss') ) AS LastDay
 TO_INT(QUANTIZE(TimeGenerated, 86400)) AS Day
lpd1=echo LP Total App Errors Today&LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS Day,COUNT(*) AS [Total Errors] FROM Application WHERE TimeWritten > TO_LOCALTIME( SUB( SYSTEM_TIMESTAMP(), TIMESTAMP('0000-01-03', 'yyyy-MM-dd') ) ) AND EventType = 1 OR EventType = 2 GROUP BY Day ORDER BY Day ASC"
LogParser -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON "SELECT EventLog,TimeGenerated, EventTypeName,SourceName, Message from application,security,System where TimeGenerated < '2022-06-07 14:00:00' and TimeGenerated > '2022-06-08 00:00:00' ORDER BY TimeGenerated desc"
LogParser -stats:On -rtp:-1 -o:datagrid -resolveSIDs:ON "SELECT EventLog, TimeGenerated, EventID, EventTypeName, EventCategory, SourceName, Strings, Message from Application where (eventcategory ='3' or eventcategory ='12' or EventTypeName like 'error event%' or strings LIKE '%SQL%' ) ORDER BY TimeGenerated DESC"
 into MyTable1 EVT -o:SQL -server SQLSERVER01\INSTANCE01 -database:LoggingDB -driver:"SQL Server" -username:LoggingUser -password:Password -createTable:ON
LogParser -i:IISW3C -rtp:-1 -o:datagrid -stats:On -E:-1 "SELECT TO_TIMESTAMP(date, time) AS utc-TIMESTAMP, TO_LOCALTIME(utc-TIMESTAMP) AS local-TIMESTAMP,* FROM '%IISLogs%\*.log' WHERE WHERE local-TIMESTAMP between TIMESTAMP('2022/06/01 00:00:00', 'yyyyyy-MM-dd hh:mm:ss') and TIMESTAMP('2022/06/08 00:00:00', 'yyyyyy-MM-dd hh:mm:ss')"
 TO_TIMESTAMP(date, time) as TIMESTAMP,
 TO_STRING(TO_TIMESTAMP(date, time), 'yyyy-MM-dd') AS Day,
SELECT * FROM SYSTEM WHERE TimeWritten > TO_LOCALTIME( SUB( SYSTEM_TIMESTAMP(), TIMESTAMP('0000-01-03', 'yyyy-MM-dd') ) )
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:TEXTLINE -stats:On -rtp:-1 -o:datagrid "SELECT Text FROM https://rewards.bing.com/pointsbreakdown WHERE Text LIKE '%243080%' "
LogParser -i:TEXTLINE -stats:On -rtp:-1 -o:datagrid "SELECT Text FROM https://rewards.bing.com/ WHERE Text LIKE '%243080%' "
LogParser -i:TEXTLINE -stats:On -rtp:-1 -o:datagrid "SELECT Text FROM https://www.bing.com/ WHERE Text LIKE '%Microsoft Rewards%' OR Text LIKE '%243080%' "
LogParser -i:TEXTLINE -stats:On -rtp:-1 -o:datagrid "SELECT Text FROM https://www.bing.com/ WHERE Text LIKE '%Microsoft Rewards%' OR Text LIKE '%243080%' OR Text LIKE '%Points%' OR Text LIKE '%Your last reward%' OR Text LIKE '%available-points%' OR Text LIKE '%lifetime points%' OR Text LIKE '%Available Points%' OR Text LIKE '%Streak count%' "
LogParser -i:TEXTLINE -stats:On -rtp:-1 -o:datagrid "SELECT Text FROM https://rewards.bing.com/ WHERE Text LIKE '%Microsoft Rewards%' OR Text LIKE '%243080%' OR Text LIKE '%Points%' OR Text LIKE '%Your last reward%' OR Text LIKE '%available-points%' OR Text LIKE '%lifetime points%' OR Text LIKE '%Available Points%' OR Text LIKE '%Streak count%' "
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
W3C to XML Field Mappings - See Page 173 LpgParser Toolkit
+------------------------------------+-----------------------------
| W3C Data Field                     | XML Data Field
+------------------------------------+-----------------------------
| LogFilename                        | EventLog
| RowNumber                          | RecordNumber
| to_TIMESTAMP( SYSTEM_DATE(), time) | TimeGenerated
| time                               | TimeWritten
| sc-status                          | EventID
| cs-method                          | EventType
| cs-method                          | EventTypeName
| cs-method                          | EventCategory
| c-ip                               | SourceName
| cs-uri-stem                        | Strings
| c-ip                               | ComputerName
| c-ip                               | SID
| cs-uri-stem                        | Message
| cs-uri-stem                        | Data
| Master                             | Craftsman
+------------------------------------+-----------------------------
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Find Specific Files in folder
SET Root=%UserProfile%
LogParser -i:FS -rtp:-1 -o:datagrid -q:on -stats:On -Recurse:-1 -E:-19 "SELECT TOP 1000 Path, Name, Size, CreationTime FROM %Root%\*.* ORDER BY CreationTime DESC"
LogParser -i:FS -rtp:-1 -o:datagrid -q:on -stats:On -Recurse:-1 -E:-19 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "%Root%\*.*" WHERE ext LIKE '%7z%' AND Ext LIKE '%zip%' AND Hash IS NOT NULL AND Size >=100000 ORDER BY Created,Path DESC"
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
SET FSfld=Path,Name,Size,Attributes,CreationTime,LastWriteTime,FileVersion,ProductVersion,InternalName,ProductName,CompanyName,LegalCopyright,LegalTrademarks,PrivateBuild,Comments,FileDescription,OriginalFilename

 WHERE Size >= 1024 ORDER BY ExtCntrs DESC
,SUB(TO_INT(Size),-1),
 DIV(size,1048576) AS Size(Mb)

echo (%Date%) - yyyymmdd=%Date:~-4%%Date:~-10,2%%Date:~-7,2% - yyyyddmm=%Date:~-4%%Date:~-7,2%%Date:~-10,2% - ddmmyyyy=%Date:~-7,2%%Date:~-10,2%%Date:~-4%
SET Root='%Root%\*.*'
SET Root=C:\$Data&echo RootFolder=%Root%
SET ymd=%Date:~-4%%Date:~-10,2%%Date:~-7,2%
echo Count Files in folder %Root%&LogParser -i:FS -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as ExtCntrs FROM '%Root%\*.*' WHERE Attributes NOT LIKE 'D%'GROUP BY Extension ORDER BY ExtCntrs DESC"

echo Chart Files in folder %Root%&LogParser -i:FS -Recurse:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%ymd% (Column3D)" "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as ExtCntrs INTO %ohtm%\%ComputerName%_Column3D.gif FROM 'C:\$Data\*.*' WHERE Attributes NOT LIKE 'D%'GROUP BY Extension ORDER BY ExtCntrs DESC"
echo Chart Files in folder %Root%&LogParser -i:FS -Recurse:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%ymd% (Line)" "SELECT TO_LOWERCASE(SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))) AS Extension, COUNT(*) as ExtCntrs INTO %ohtm%\%ComputerName%_Column3D.gif FROM 'C:\$Data\*.*' WHERE Attributes NOT LIKE 'D%'GROUP BY Extension ORDER BY ExtCntrs DESC"
SET FSfld=Path,Name,Size,CreationTime,LastAccessTime,LastWriteTime,FileVersion
LogParser -i:FS -Recurse:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-7,2%%Date:~-10,2% (Column3D)"
echo Chart Files in folder %Root%&

LogParser -i:FS -Recurse:-1 -view:ON -o:CHART -groupSize:1024x768 -chartType:Column3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%ymd% (Column3D)" "SELECT TOP 100 %FSfld% INTO %ohtm%\%ComputerName%_Column3D.gif FROM %Root%\*.*"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::-------------------------------------------------------------------------------------------------------------------------------
echo Find Specific Files in folder&LogParser -i:FS -rtp:-1 -o:datagrid -q:on -stats:On -Recurse:-1 -E:-1
echo List Specific Files into CSV&LogParser -i:FS -o:CSV -q:on -stats:On -Recurse:-1 -E:-1
"SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,HASHMD5_FILE(Path) AS Hash FROM "C:\$Data\*.*" WHERE Ext LIKE '%zip%' OR Ext LIKE '%7z%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Hash,Created DESC">>%ohtm%\%ComputerName%_ZIP-Data.csv
::-------------------------------------------------------------------------------------------------------------------------------
echo List Specific Files into CSV
SET CSV=%ohtm%\%ComputerName%_ZIP-Data.csv
SET LPf=Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,HASHMD5_FILE(Path) AS Hash
START "LogParser" /HIGH /WAIT /B LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -o:CSV "SELECT %LPf% FROM "C:\$Data\*.*" WHERE Ext LIKE '%zip%' OR Ext LIKE '%7z%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Hash,Created DESC">%CSV%
START "LogParser" /HIGH /WAIT /B LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -o:CSV "SELECT %LPf%  FROM 'C:\Program Files (x86)\*.*' WHERE Ext LIKE '%zip%' OR Ext LIKE '%7z%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Hash,Created DESC">%CSV%
START "LogParser" /HIGH /WAIT /B LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -o:CSV "SELECT %LPf%  FROM 'C:\Program Files\*.*' WHERE Ext LIKE '%zip%' OR Ext LIKE '%7z%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Hash,Created DESC">%CSV%
START "LogParser" /HIGH /WAIT /B LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -o:CSV "SELECT %LPf% FROM 'C:\ProgramData\*.*' WHERE Ext LIKE '%zip%' OR Ext LIKE '%7z%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Hash,Created DESC">%CSV%
START "LogParser" /HIGH /WAIT /B LogParser -i:FS -o:CSV -q:on -stats:On -Recurse:-1 -E:-19 "SELECT %LPf% FROM '%UserProfile%\*.*' WHERE Ext LIKE '%zip%' OR Ext LIKE '%7z%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Hash,Created DESC">%CSV%
START "LogParser" /HIGH /WAIT /B LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -o:CSV "SELECT %LPf% FROM 'C:\WINDOWS\*.*' WHERE Ext LIKE '%zip%' OR Ext LIKE '%7z%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Hash,Created DESC">%CSV%
Notepad++ %CSV%
::-------------------------------------------------------------------------------------------------------------------------------
::Test MultFol=('C:\$Data\*.*','C:\Program Files (x86)\*.*','C:\Program Files\*.*','C:\ProgramData\*.*','%UserProfile%ars\*.*','C:\WINDOWS\*.*')
::Test MultFol=("C:\$Data","C:\Program Files (x86)","C:\Program Files","C:\ProgramData","%UserProfile%ars","C:\WINDOWS")
::Test MultFol=("C:\$Data\*.*","C:\Program Files (x86)\*.*","C:\Program Files\*.*","C:\ProgramData\*.*","%UserProfile%ars\*.*","C:\WINDOWS\*.*") - Error: detected extra argument "Files" after query
::Test MultFol=('C:\$Data\*.*','C:\Program Files (x86)\*.*','C:\Program Files\*.*','C:\ProgramData\*.*','%UserProfile%ars\*.*','C:\WINDOWS\*.*') - Cannot open <from-entity>: Error searching for Files in folder   %OneDrive%\('C:\$Data: The filename, directory name, or volume label syntax is incorrect.
::Test MultFol=('C:\$Data\','C:\Program Files (x86)\','C:\Program Files\','C:\ProgramData\','%UserProfile%ars\','C:\WINDOWS\')&echo *** %MultFol%
::Test "LogParser" /HIGH /WAIT /B LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -o:CSV "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,HASHMD5_FILE(Path) AS Hash FROM %MultFol% WHERE Ext LIKE '%zip%' OR Ext LIKE '%7z%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Hash,Created DESC">>%ohtm%\%ComputerName%_ZIP-Data.csv
::Test "LogParser" /HIGH /WAIT /B LogParser -i:FS -rtp:-1 -o:datagrid -q:on -stats:On -Recurse:-1 -E:-19 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,HASHMD5_FILE(Path) AS Hash FROM %MultFol% WHERE Ext LIKE '%zip%' OR Ext LIKE '%7z%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Hash,Created DESC"
::Test "LogParser" /HIGH /WAIT /B LogParser -i:FS -rtp:-1 -o:datagrid -q:on -stats:On -Recurse:-1 -E:-19 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_EXTENSION(Name) AS Ext,HASHMD5_FILE(Path) AS Hash FROM 'C:\$Data\*.*' WHERE Ext LIKE '%zip%' OR Ext LIKE '%7z%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Hash,Created DESC"
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│   Configure Microsoft Edge and run VPN            │
└───────────────────────────────────────────────────┘
NOTE You need to purchase a VPN first.. Microsoft does not have a VPN...
https://www.windowscentral.com/software-apps/windows-11/how-to-increase-privacy-using-built-in-vpn-on-microsoft-edge
Open Edge and type: edge://settings/privacy/SecureNetworkSites
:: VPN extensions for Microsoft Edge - TOO Expensive...
NordVPN - Known as one of the best VPN extensions for Microsoft Edge2. - https://cybernews.com/best-vpn/vpn-for-microsoft-edge/
Surfshark - Offers cutting-edge VPN technology for the Edge browser2. - https://cybernews.com/best-vpn/vpn-for-microsoft-edge/
IPVanish - A quality VPN Windows app for Edge2. - https://cybernews.com/best-vpn/vpn-for-microsoft-edge/
PrivateVPN - An Edge VPN with customization options2. - https://cybernews.com/best-vpn/vpn-for-microsoft-edge/
PureVPN - A secure VPN for Edge2. - https://cybernews.com/best-vpn/vpn-for-microsoft-edge/

:: Powershell
Add-VpnConnection -Name 'MyNewVpn' -ServerAddress 'vpn.example.com'
rasdial MyNewVpn myUsername mySuperSecretPassword
rasdial MyNewVpn /DISCONNECT
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
::-------------------------------------------------------------------------------------------------------------------------------
SET Title=Setup Path for Registry and Environment LogParser Event
Title %Title%
echo %Date% !Time! %Title%
cmd /V:ON /K "SET LogEvent=Yes&&echo %Date% !Time! [RC] LogEvent= !LogEvent! RC=%ErrorLevel%"
IF /I %LogEvent%==Yes (EVENTCREATE /l Application /so W10START /T information /id 521 /d "%Date% !Time! %c% %Title%") 2>&1 >NUL
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPg /T REG_SZ /f /d "LogParser -rtp:-1 -o:datagrid"
REG ADD "HKEY_CURRENT_USER\Environment" /V LPg /T REG_SZ /f /d "LogParser -rtp:-1 -o:datagrid"
REG QUERY "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPg 2>&1
REG QUERY "HKEY_CURRENT_USER\Environment" /V LPg 2>&1
SETX LPg "LogParser -rtp:-1 -o:datagrid"
SETX /M LPg "LogParser -rtp:-1 -o:datagrid"
SET | Find /I "LPg"
::-------------------------------------------------------------------------------------------------------------------------------
SET Title=Setup Path for Registry and Environment LogParser Chart Event
Title %Title%
echo %Date% !Time! %Title%
IF /I %LogEvent%==Yes (EVENTCREATE /l Application /so W10START /T information /id 521 /d "%Date% !Time! %c% %Title%") 2>&1 >NUL
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPc /T REG_SZ /f /d "LogParser EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
REG ADD "HKEY_CURRENT_USER\Environment" /V LPc /T REG_SZ /f /d "LogParser EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
REG QUERY "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPc 2>&1
REG QUERY "HKEY_CURRENT_USER\Environment" /V LPc 2>&1
SETX LPc "LogParser EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
SETX /M LPc "LogParser EVT -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO"
SET | Find /I "LPc"
::-------------------------------------------------------------------------------------------------------------------------------
SET Title=Setup Path for Registry and Environment LogParser Chart Bar3D
Title %Title%
echo %Date% !Time! %Title%
IF /I %LogEvent%==Yes (EVENTCREATE /l Application /so W10START /T information /id 521 /d "%Date% !Time! %c% %Title%") 2>&1 >NUL
REG ADD "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPWc /T REG_SZ /f /d "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
REG ADD "HKEY_CURRENT_USER\Environment" /V LPWc /T REG_SZ /f /d "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
REG QUERY "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment" /V LPWc 2>&1
REG QUERY "HKEY_CURRENT_USER\Environment" /V LPWc 2>&1
SETX LPWc "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
SETX /M LPWc "LogParser -i:W3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO"
SET | Find /I "LPWc"
::-------------------------------------------------------------------------------------------------------------------------------
LogParser -i:REG -rtp:-1 -o:datagrid -Stats:On -E:5 "SELECT KeyName,ValueName,ValueType,Value FROM '\HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment' WHERE ValueName LIKE '%LP%' ORDER BY KeyName"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
:: Create a File System query to list the number of Files in each folder based on below examples...
LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT TOP 200 Path,Name,Size,CreationTime,HASHMD5_FILE(Path) AS Hash FROM 'C:\Garmin\*.*' WHERE Size >1 ORDER BY Size DESC"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SourceName, EventID, MUL(PROPCOUNT(*) ON (SourceName), 100.0) AS Percent FROM System GROUP BY SourceName, EventID ORDER BY SourceName, Percent DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Find Specific Files in folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 "SELECT Path,Name,TO_INT(Size) AS Size,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash FROM "%OneDrive%\Benchmarks\*.*" WHERE Ext LIKE '%txt%' AND Hash IS NOT NULL AND Size >=10 ORDER BY Created,Path DESC"
SET Root=%OneDrive%\Benchmarks
echo List All Files with (zero) 0 bytes in folder&LogParser -i:FS -stats:on -q:off -rtp:-1 -o:datagrid -Recurse:-1 -E:-1 -stats:On "SELECT Path,Name,Size,EXTRACT_FILENAME(Name) AS FName,EXTRACT_EXTENSION(Name) AS Ext,Attributes,HASHMD5_FILE(Path) AS Hash,CreationTime AS Created,LastAccessTime AS LastAccess,LastWriteTime AS LastWrite FROM '%Root%\*.*' WHERE Size =0 AND Hash IS NOT NULL ORDER BY Path DESC"

Compact /S:"C:\$Data" /I /Q *.*
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Install LogParser Chart Software
Log Parser 2.2                                   {4AC23178-EEBC-4BAF-8CC0-AB15C8897AC9}                2.2.10
Microsoft Chart Controls for Microsoft .NET      {41785C66-90F2-40CE-8CB5-1C94BFC97280}                3.5.0.0
Microsoft Chart Controls for Microsoft .NET FΓÇª {41785C66-90F2-40CE-8CB5-1C94BFC97280}                3.5.0.0
https://download.cnet.com/Microsoft-Chart-Controls-for-Microsoft-NET-Framework-3-5/3001-2383_4-75452695.html
File : MSChart.exe
Microsoft Office 2003 Web Components             {90120000-00A4-0409-0000-0000000FF1CE}                12.0.4518.1014
https://download.cnet.com/Office-2003-Add-in-Office-Web-Components/3001-2070_4-10742090.html
File: owc11.exe

FOR %%i IN (
"{4AC23178-EEBC-4BAF-8CC0-AB15C8897AC9}"
"{41785C66-90F2-40CE-8CB5-1C94BFC97280}"
"{90120000-00A4-0409-0000-0000000FF1CE}"
) DO echo ** WinGet Installing: %%i&WinGet Install --id %%i --source WinGet --verbose-logs&echo WinGet %%i ReturnCode= %ErrorLevel%

FOR %%i IN (
"Log Parser 2.2"
"Microsoft Chart Controls for Microsoft .NE"
"Microsoft Office 2003 Web Components"
) DO echo ** WinGet Installing: %%i&WinGet Install --moniker %%i --source WinGet --verbose-logs&echo WinGet %%i ReturnCode= %ErrorLevel%
) DO echo ** WinGet Installing: %%i&WinGet Install --name %%i --source WinGet --verbose-logs&echo WinGet %%i ReturnCode= %ErrorLevel%
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Create an .html using 2-Columns: -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-TwoColumnReport.tpl"  INTO '%ohtm%\%ComputerName%_TwoColumn-Report.html'
:: Create an .html using 3-Columns: -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-ThreeColumnReport.tpl"INTO '%ohtm%\%ComputerName%_ThreeColumn-Report.html'
:: Create an .html using 4-Columns: -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-FourColumnReport.tpl" INTO '%ohtm%\%ComputerName%_FourColumn-Report.html'
:: Create an .html using 5-Columns: -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-FiveColumnReport.tpl" INTO '%ohtm%\%ComputerName%_FiveColumn-Report.html'
:: Create an .html using 6-Columns: -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-SixColumnReport.tpl"  INTO '%ohtm%\%ComputerName%_SixColumn-Report.html'

LogParser -i:REG -stats:On -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime INTO '%ohtm%\%ComputerName%_SixColumn-Report.html' FROM \HKEY_CURRENT_USER\Software\PrivateKey" -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-SixColumnReport.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_SixColumn-Report.html"

LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -E:5 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime FROM \HKEY_CURRENT_USER\Software\PrivateKey"

:: Below is a working example ThreeColumns. -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-AllDetSoftware.tpl" But css is broken...
laswbad=LogParser -i:REG -stats:On "SELECT KeyName as App, ValueName as What, Value as Data, LastWriteTime AS InstalDate INTO '%ohtm%\%ComputerName%_AllInstalledSoftware-Report.html' FROM \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall WHERE ValueName LIKE '%Display%' OR ValueName LIKE '%Publisher%' OR ValueName LIKE '%%inno%' OR ValueName LIKE '%%install%' ORDER BY App ASC" -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-AllDetSoftware.tpl"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_AllInstalledSoftware-Report.html"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT * FROM Security WHERE EventID IN (219)"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:EVT -o:CHART -groupSize:1024x768 -chartType:Column3D -view:On "SELECT SourceName, COUNT(*) AS [Number of Events] INTO %ohtm%\%ComputerName%_Events.gif FROM System GROUP BY SourceName ORDER BY [Number of Events] DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Ref: https://blogs.iis.net/robert_mcmurray/advanced-log-parser-charts-part-4-adding-custom-input-formats
:: COM saved: %OneDrive%\Scripts\MSUtil.LogQuery.FtpRscaScriptlet.sct
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT CASE UserName WHEN '' THEN 'anonymous' ELSE TO_LOWERCASE(UserName) END AS User,COUNT(*) AS Sessions INTO SessionCountByUser.gif FROM 1 GROUP BY User" -i:COM -iProgID:MSUtil.LogQuery.FtpRscaScriptlet -chartType:PieExploded -o:CHART -groupSize:1024x768 -values:on -categories:off -legend:on -chartTitle:"User Sessions"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT CASE UserName WHEN '' THEN 'Anonymous' ELSE 'Authenticated' END AS AuthType,COUNT(*) AS Sessions INTO AuthenticatedSessions.gif FROM 1 GROUP BY AuthType" -i:COM -iProgID:MSUtil.LogQuery.FtpRscaScriptlet -chartType:PieExploded -o:CHART -groupSize:1024x768 -values:on -categories:off -legend:on -chartTitle:"Authenticated Sessions"

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT CASE UserName WHEN '' THEN 'anonymous' ELSE TO_LOWERCASE(UserName) END AS User,COUNT(*) AS Sessions INTO SessionCountByUser.gif FROM 1 GROUP BY User" -i:COM -iProgID:MSUtil.LogQuery.FtpRscaScriptlet -chartType:Column3D -o:CHART -groupSize:1024x768 -values:on -legend:off -chartTitle:"User Sessions"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
START Windows Application from command Line. NOTE: Window store apps are started via URLs not via the exe file.
@For /f "tokens=1* delims=" %A in ('REG QUERY HKCR /f "URL:*" /s /d ^| findstr /c:"URL:" ^| findstr /V /c:"URL: " ^| Sort') Do @Echo %A %B
To use them in Run dialog or a shortcut type (eg for Journal) URL:ms-journal:\\
Dir /A:D /B /O:N /S "C:\Program Files\WindowsApps"|FIND /I "journal"
dir /S /B "C:\Program Files\WindowsApps\Microsoft.MicrosoftJournal_1.23075.1229.0_x64__8wekyb3d8bbwe\*.exe"
"C:\Program Files\WindowsApps\Microsoft.MicrosoftJournal_1.23075.1229.0_x64__8wekyb3d8bbwe\Journal.exe"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Remove Strip off "Quotes" from Field
1) LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT EXTRACT_TOKEN(text,0,' ') as field1,EXTRACT_TOKEN(text,1,' ') as field2,EXTRACT_TOKEN(text,1,'\"') as field3,EXTRACT_TOKEN(text,2,'\"') as field4 from quotes.tsv" -i:TEXTLINE
2) LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT field1,field2,strcat(replace_chr(field3,'\"',''),replace_chr(field4,'\"','')) as newfield from quotes.tsv" -iseparator:space -headerRow:OFF
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser -i:IISW3C -rtp:-1 -o:datagrid -e:1 file:"%OneDrive%\Log Parser 2.2\Queries\404.sql"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -e:1 file:"%OneDrive%\Log Parser 2.2\Queries\Status.sql"
LogParser -i:IISW3C -view:ON -o:CHART -groupSize:1024x768 -chartType:ColumnStacked -e:1 file:"%OneDrive%\Log Parser 2.2\Queries\Content.sql"
LogParser -i:IISW3C -view:ON -o:CHART -groupSize:1024x768 -chartType:ColumnStacked -e:1 file:"%OneDrive%\Log Parser 2.2\Queries\Top25IPs.sql"
LogParser -i:IISW3C -view:ON -o:CHART -groupSize:1024x768 -chartType:ColumnStacked -e:1 file:"%OneDrive%\Log Parser 2.2\Queries\W3SVC1hits.sql"
LogParser -i:IISW3C -view:ON -o:CHART -groupSize:1024x768 -chartType:ColumnStacked -chartTitle:"Bandwidth" -e:1 file:"%OneDrive%\Log Parser 2.2\Queries\Bandwidth.sql"
LogParser -i:IISW3C -view:ON -o:CHART -groupSize:1024x768 -chartType:Line -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date% Hits" -e:1 file:"%OneDrive%\Log Parser 2.2\Queries\W3SVC1hits.sql"

SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600)),
COUNT(*) AS Hit_Frequency
INTO %ohtm%\%ComputerName%_\W3SVC1hits.jpg
FROM %IISLogs%\*.log
WHERE TO_TIME(time)
BETWEEN TIMESTAMP('00:00:01','hh:mm:ss') AND TIMESTAMP('23:59:59','hh:mm:ss')
AND DATE > '2023-01-01' AND date < '2023-05-09'
GROUP BY TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600))
ORDER BY TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time),3600))
DESC
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: +----------------------------------------------------------------------------------------------+
:: Below works, Need to delete 5 lines at the top and 5 lines at the bottom of the input file though... Don't need the header... -OR Sort it +40 and delete top 10 lines...
:: Note after the sort there are 10 to 20 lines of garbage to be removed from the top, depending how deep the folders go... Normally 10 is what to remove...
Dir /O:N /S /R "E:\$Music\Spyro Gyra*.mp3"|Sort /+40 /O "%ohtm%\%ComputerName%_FindMusicResults.txt"&more +10 "%ohtm%\%ComputerName%_FindMusicResults.txt" >"%ohtm%\%ComputerName%_FindMusicResults.tsv"&&move /y "%ohtm%\%ComputerName%_FindMusicResults.tsv" "%ohtm%\%ComputerName%_FindMusicResults.txt" >nul&&NotePad++ "%ohtm%\%ComputerName%_FindMusicResults.txt"
LogParser -i:TEXTLINE -rtp:-1 -o:datagrid -E:-1 "SELECT SUBSTR(text, 0, 10) AS Date, SUBSTR(text, 11, 9) AS Time, SUBSTR(text, 25, 12) AS Size, SUBSTR(text, 39, 999) AS SongName FROM '%ohtm%\%ComputerName%_FindMusicResults.txt' WHERE TRIM(Date) LIKE '%Directory%' AND TRIM(Date) LIKE '%Volume%' OR SongName NOT LIKE '%bytes%' AND TO_INT(TRIM(Size))<=10 ORDER BY SongName,Date ASC"

LogParser -i:TEXTLINE -rtp:-1 -o:datagrid -E:-1 "SELECT SUBSTR(text, 0, 10) AS Date, SUBSTR(text, 11, 9) AS Time, SUBSTR(text, 25, 13) AS Size, SUBSTR(text, 39, 999) AS SongName FROM '%ohtm%\%ComputerName%_FindMusicResults.txt' WHERE TRIM(Date) NOT LIKE '%Directory%' AND TRIM(Date) NOT LIKE '%Volume%' AND SongName NOT LIKE '%bytes%' OR TO_INT(TRIM(Size))>1000 ORDER BY SongName,Date ASC"
echo This displays all Files that are Zone.Identifiers&LogParser -i:TEXTLINE -rtp:-1 -o:datagrid -E:-1 "SELECT SUBSTR(text, 0, 10) AS Date, SUBSTR(text, 11, 9) AS Time, SUBSTR(text, 25, 13) AS Size, SUBSTR(text, 39, 999) AS SongName FROM '%ohtm%\%ComputerName%_FindMusicResults.txt' WHERE TRIM(Date) NOT LIKE '%Directory%' AND TRIM(Date) NOT LIKE '%Volume%' AND SongName NOT LIKE '%bytes%' AND SongName IS NOT NULL AND TO_INT(TRIM(Size))>100 ORDER BY SongName,Date ASC"
:: NOT LIKE '%.mp3:Zone.Identifier:$DATA%'  WHERE TO_INT(sc-status)=200  Directory of     Volume in drive      Volume Serial

LogParser -i:TEXTLINE -rtp:-1 -o:datagrid -E:-1 "SELECT text FROM '%ohtm%\%ComputerName%_FindMusicResults.txt'"
:: When you download a file from the internet, Windows operating system automatically adds an alternate data stream (ADS) to that file to identify it as a foreign file that must be handled with extra care. This newly added ADS is called "Zone.Identifier" and has a small content "[ZoneTransfer] ZoneId=3". Using this extra data, Windows can tell that this file came from the internet. Every time you access such a file, Windows may show a warning message indicating that since you downloaded this file, it could be harmful and that you should take extra precaution.
:: How to get rid of :Zone.Identifier Files
:: gpedit.msc > User configuration > Administrative templates >Windows Components > Attachment Manager and set Do not preserve zone information in file attachments.
:: Removing these Files: use the Unblock-File PowerShell cmdlet -> cd e:\'$Music - dir .\* | Unblock-File -- This will clear the Zone.Identifier from all the Files in that folder.
:: NOTE: Because the file name contains a : colon, is not actually a valid character in a file name...
cd "E:\$Music\ && find . -name "*:Zone.Identifier" -type f -delete" :: The filename, directory name, or volume label syntax is incorrect.
Dir /A:HRS /O:N /S "E:\$Music\*mp3:Zone.Identifier:$DATA"
Dir /S "E:\$Music\*mp3:Zone.Identifier:$DATA"
Del /S /Q "E:\$Music\*..mp3:Zone.Identifier:$DATA"
:: Test +----------------------------------------------------------------------------------------------+
:: Test Direct output to csv file then read it in using LogParser : Dir /O:N /S /R "E:\$Music\Spyro Gyra*.mp3">"%ohtm%\%ComputerName%_MusicFiles.csv"
:: Test Heading: Date  Time  Size  SongName
:: Test Windows 11 How do I Insert a Line at Specific Line Number into a txt file using dos command
:: Test powershell (gc "%ohtm%\%ComputerName%_MusicFiles.csv" -raw) -replace '(.*\n){66}', \"'$0$([char]0x0c)\" > "%ohtm%\%ComputerName%_MusicFiles1.csv"
:: Test OR - Using a hybrid JScript/batch utility called REPL.BAT that performs a regex search and replace on stdin and writes the result to stdout:
:: Test https://stackoverflow.com/a/4402290/1012053 --- JREPL.BAT has replaced REPL.BAT
:: Test type test.txt|repl "foo" "bar" >test.txt.new move /y test.txt.new test.txt
:: Test type "file.txt"|repl "(.*\n){66}" "$&\x0C" mx >"file.txt.new" | move /y "file.txt.new" "file.txt" >nul
:: Test type "%ohtm%\%ComputerName%_MusicFiles.csv"|repl "(.*\n){4}" "Date        Time          Size         SongName" mx >"%ohtm%\%ComputerName%_MusicFiles1.csv" | move /y "%ohtm%\%ComputerName%_MusicFiles1.csv" "%ohtm%\%ComputerName%_MusicFiles.csv"
:: Test notepad++ "%ohtm%\%ComputerName%_MusicFiles.csv"
:: Test The above assumes you have REPL.BAT in your current directory
:: Test +----------------------------------------------------------------------------------------------+
:: Test NOTE: Dir /O:N /S /R /T:C /W "E:\$Music\Spyro Gyra*.mp3" - /W Displays 2 lists (1) /O:N AND (2) /T:C
:: Test echo Date        Time          Size         SongName>"%odl%\DirHDR.inp"&type "%odl%\DirHDR.inp"
:: Test Dir /O:N /S /R "E:\$Music\Spyro Gyra*.mp3">"%ohtm%\%ComputerName%_DirMusic.tsv"&NotePad++ "%ohtm%\%ComputerName%_DirMusic.tsv"
:: Test ERROR: sed -n -e 5,99999p "%ohtm%\%ComputerName%_DirMusic.tsv" > "%ohtm%\%ComputerName%_FindMusicResults" --- ERROR: sed: couldn't flush stdout: Permission denied
:: Test Below Error: SELECT clause: Syntax Error: unknown field 'text'
:: Test echo Find Music File Spyro Gyra&Dir /O:N /S /R "E:\$Music\Spyro Gyra*.mp3" | LogParser -i:TSV -rtp:-1 -o:datagrid -iSeparator:space -fixedSep:off -nSkipLines:2 "SELECT SUBSTR(text, 0, 10) AS Date, SUBSTR(text, 11, 8) AS Time, SUBSTR(text, 25, 12) AS Size, SUBSTR(text, 39, 999) AS SongName FROM STDIN"
:: Test echo Find Music File Spyro Gyra&dir /s "E:\$Music\Spyro Gyra*.mp3" | LogParser -i:TSV -rtp:-1 -o:datagrid -iSeparator:space -fixedSep:off -nSkipLines:2 "SELECT * FROM STDIN"
:: Test Data ---  Date        Time            Size       SongName
:: Test           01...+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+....1....+....1....+....2....+...|
:: Test Data ---  03/28/2023  09:49 PM        13,070,311 Spyro Gyra - 20 _ 20.mp3
:: Test Heading:  Date        Time          Size         SongName
:: Test SUBSTR(text, 0, 10) AS Date, SUBSTR(text, 11, 8) AS Time, SUBSTR(text, 25, 12) AS Size, SUBSTR(text, 39, 999) AS SongName
:: Test Nope:    EXTRACT_TOKEN(Strings,  0, '  ') AS Date,EXTRACT_TOKEN(Strings,  1, '  ') AS Time,EXTRACT_TOKEN(Strings,  2, '  ') AS Size,EXTRACT_TOKEN(Strings,  5, '  ') AS SongName  ::Error: SELECT clause: Syntax Error: unknown field 'Strings'
:: Test Manually Insert this line into file at LINE# 6::  Date        Time          Size         SongName
:: Test =echo Find Music File $1&dir /s "E:\$Music\$1*.mp3" | LogParser -i:TSV -rtp:-1 -o:datagrid -iSeparator:space -fixedSep:off -nSkipLines:4 "SELECT * FROM STDIN"
:: Test echo Find Music File Spyro Gyra&Dir /O:N /S /R /T:C /W "E:\$Music\Spyro Gyra*.mp3" | LogParser -i:TSV -rtp:-1 -o:datagrid -iSeparator:space -fixedSep:off -nSkipLines:5 "SELECT Date,Time,Size,SongName FROM STDIN"
:: Test -nSkipLines:2    Date, Time, AmPm, Size, SName    ORDER BY SName DESC ---- SUBSTR(Name, LAST_INDEX_OF(Name,'.'), STRLEN(Name))
:: Test LogParser -i:TSV -iSeparator:space -nSep:2 -fixedSep:OFF -iHeaderFile:"%odl%\DirHDR.inp" -stats:On -headerRow:On -iw:On -nSkipLines:7 -rtp:-1 -o:datagrid -E:-1 "SELECT Date,Time,Size,SongName FROM STDIN"
:: Test +----------------------------------------------------------------------------------------------+
:: Test Instructions:
:: Test 1) Create the csv file using DIR command
:: Test    Dir /O:N /S /R "E:\$Music\Spyro Gyra*.mp3">"%ohtm%\%ComputerName%_DirMusic.tsv"&NotePad++ "%ohtm%\%ComputerName%_DirMusic.tsv"
:: Test 2) Edit the csv file and delete the top 5 lines and last -> (Not necessary to insert Heading: Date        Time  XM        Size       SongName)
:: Test    echo Date        Time          Size         SongName>"%odl%\DirHDR.inp"&type "%odl%\DirHDR.inp"
:: Test 3) Save and run LogParser :
:: Test    LogParser -i:CSV -rtp:-1 -o:datagrid -headerRow:On -iHeaderFile:"%odl%\DirHDR.inp" -iDQuotes:Auto -fixedFields:ON "SELECT Date,Time,Size,SongName FROM '%ohtm%\%ComputerName%_FindMusicResults'"
:: Test Error: SELECT clause: Syntax Error: unknown field 'Date'.
:: Test The closest match for input format 'CSV' is 'Date        Time  XM        Size       SongName'.
:: Test    LogParser -i:TSV -rtp:-1 -o:datagrid -headerRow:On -fixedFields:ON "SELECT Date,Time,Size,SongName FROM '%ohtm%\%ComputerName%_FindMusicResults'"
:: Test LogParser -i:TSV -iSeparator:space -nFields:8 -fixedSep:OFF -nSep:1 -iHeaderFile:"%odl%\DirHDR.inp" -stats:On -headerRow:On -iw:On -nSkipLines:1 -rtp:-1 -o:datagrid -E:-1 "SELECT Date,Time,XM,Size,SongName FROM '%ohtm%\%ComputerName%_FindMusicResults'"
:: Test Full SongName is messed up because of spaces in the Name...
:: +----------------------------------------------------------------------------------------------+
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
echo Get a list of all the words in file&LogParser -i:TEXTWORD -rtp:-1 -o:datagrid -E:-1 "SELECT Text, COUNT(*) AS Total FROM '%OneDrive%\AboutMe_Combined.txt' GROUP BY Text ORDER BY Text,Total ASC"
echo Get a list of all the words in file&LogParser -i:TEXTWORD -rtp:-1 -o:datagrid -E:-1 "SELECT Text, COUNT(*) AS Total FROM '%OneDrive%\Batch\macros.Doskey' GROUP BY Text ORDER BY Text,Total ASC"
echo Get a list of all the words in file&LogParser -i:TEXTWORD -rtp:-1 -o:datagrid -E:-1 "SELECT Text, COUNT(*) AS Total FROM '%OneDrive%\AboutMe_LogParser.txt' Where Text NOT LIKE '%;= %' GROUP BY Text ORDER BY Text,Total ASC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Log Parser sample queries
http://cyprix.3x.ro/Files/LogParser /Samples/Queries/Readme.htm[11/9/2012 3:02:36 PM]

:: Get the number of hits for each IIS AppPool
:: SELECT SUBSTR( User\u0020Data, ADD( INDEX_OF(User\u0020Data, '"'), 1), LAST_INDEX_OF( SUBSTR( User\u0020Data, ADD( INDEX_OF(User\u0020Data, '"'), 1) ), '"' ) ) AS AppPool, COUNT(*) AS Total FROM *.csv WHERE Event\u0020Name='HttpRequest' AND Type='Deliver' GROUP BY AppPool ORDER BY Total DESC

:: Get Code errors from IIS Logs
echo For each ASP error, get the Url and the ASP script line number&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT SUBSTR(STRCAT(cs-uri-stem, REPLACE_IF_NOT_NULL(cs-uri-query, STRCAT('?', cs-uri-query)) ),0,INDEX_OF(STRCAT(cs-uri-stem, REPLACE_IF_NOT_NULL(cs-uri-query,STRCAT('?',cs-uri-query))),'|')) AS Uri, SUBSTR(cs-uri-query, ADD(1, LAST_INDEX_OF(cs-uri-query,'|'))) AS ErrorMsg, REPLACE_IF_NOT_NULL(cs-uri-query, SUBSTR(cs-uri-query, ADD(INDEX_OF(cs-uri-query,'|'),1), INDEX_OF( SUBSTR(cs-uri-query, ADD(INDEX_OF(cs-uri-query,'|'),1)),'|'))) AS LineNo, COUNT(*) AS Total FROM '%IISLogs%\*.log' WHERE (sc-status = 500) AND (cs-uri-stem LIKE '%.asp') GROUP BY  Uri,ErrorMsg,LineNo ORDER BY Total DESC"

:: UrlScan queries
:: Get the IP with the highest Count
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT c-ip AS IPAddrIP, COUNT(*) AS NumIP FROM '%IISLogs%\*.log' GROUP BY ClientIP ORDER BY NumIP DESC"

:: Get logon failures from the Security Event Log
LogParser -i:EVT -rtp:-1 -o:datagrid "SELECT STRCAT( SUBSTR( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1), INDEX_OF( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1)),'|')),0, INDEX_OF( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1), INDEX_OF( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1)),'|')),'.')), STRCAT( '\\', SUBSTR( Strings,0, INDEX_OF(Strings,'|')))) AS User, COUNT(*) AS Total FROM Security WHERE EventType = 16 AND EventCategory = 2 GROUP BY User ORDER BY Total DESC"

:: Get logon successes from the Security Event Log
LogParser -i:EVT -rtp:-1 -o:datagrid "SELECT STRCAT( SUBSTR( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1), INDEX_OF( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1)),'|')),0, INDEX_OF( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1), INDEX_OF( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1)),'|')),'.')), STRCAT( '\\', SUBSTR( Strings,0, INDEX_OF(Strings,'|')))) AS User, COUNT(*) AS Total FROM Security WHERE EventType = 8 AND EventCategory = 2 GROUP BY User ORDER BY Total DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser Split Text using special character e.g. ":"
File: "%OneDrive%\Batch\TestSplitTextOnChar.txt"
:: Below splits data if the Input file is a Text File...
LogParser -i:TSV -rtp:-1 -o:datagrid -iSeparator:":" -fixedSep:OFF -nSep:1 -stats:On -headerRow:On -iw:On -E:-1 "SELECT Message FROM '%OneDrive%\Batch\TestSplitTextOnChar.txt'"
:: How do I split event data using LogParser using a seperator character keyword?
:: |   EXTRACT_PREFIX and EXTRACT_SUFFIX - lets you nominate a character as a separator character where the string should be split.
EXTRACT_PREFIX splits the string at the specified instance of the separator (counting from the left-hand side) and returns the sub-string before (ie on the left-hand side of) the separator
EXTRACT_SUFFIX splits the string at the specified instance of the separator (counting from the right-hand side) and returns the sub-string after (ie on the right-hand side of) the separator
LogParser -i:CSV "SELECT DISTINCT EXTRACT_SUFFIX(Message,0,'=') as User FROM "%OneDrive%\Batch\TestSplitTextOnChar.txt"
-nSkipLines:4
LogParser -i:CSV -rtp:-1 -o:datagrid -dQuotes:ON -iHeaderFile:%OneDrive%\MSExcel\ContactsHeader.csv -fixedFields:OFF -nFields:-1 -dtLines:10id "SELECT * FROM %OneDrive%\MSExcel\Contacts-29Jul2021.CSV WHERE "Last Name" LIKE '%maars%' ORDER BY Date ASC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
EXTRACT_TOKEN
LogParser -i:EVT -rtp:-1 -o:datagrid "SELECT EventTypeName, TimeGenerated, SID from system"
LogParser -i:EVT -rtp:-1 -o:datagrid -resolveSIDs:on "SELECT EventTypeName,  TimeGenerated, SID from system"
LogParser -i:EVT -resolveSIDs:on -o:nat -rtp:-1 "SELECT EventTypeName,  TimeGenerated, SID into stdout from system"
LogParser -i:EVT -resolveSIDs:on -o:nat -rtp:-1 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' '), TO_DATE(TimeGenerated), SID into stdout from system"
LogParser -i:EVT -resolveSIDs:on -o:nat -rtp:-1 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') as TypeEvent, TO_DATE(TimeGenerated) as DateGenerated, SID as SecurityID into stdout from system"
LogParser -i:EVT -resolveSIDs:on -o:nat -rtp:-1 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') as TypeEvent, TO_DATE(TimeGenerated) as DateGenerated, SID as SecurityID into stdout from system where SourceName = 'Service Control Manager'"
LogParser -i:EVT -resolveSIDs:on -o:nat -rtp:-1 "SELECT EXTRACT_TOKEN(EventTypeName, 0, ' ') as TypeEvent, TO_DATE(TimeGenerated) as DateGenerated, SID as SecurityID into stdout from system where SourceName = 'Service Control Manager' and SID is not null"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
file:///C:/inetpub/wwwroot/LogParser %20Documentation/Advanced%20Log%20Parser%20Charts%20Part%201%20-%20Working%20With%20Configuration%20Scripts.html
:: Specifying Configuration Scripts
LogParser -i:IISW3C -o:CHART -groupSize:1024x768 -view:ON -chartType:Area -chartTitle:"About" -Recurse:-1-categories:ON -values:ON -legend:OFF -config:"%OneDrive%\WebScripts\\HitsByDay.js" "SELECT Date, COUNT(*) AS Hits INTO HitsByDay.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date"

LogParser "SELECT Date, COUNT(*) AS Hits INTO HitsByDay.gif FROM '%IISLogs%\*.log' GROUP BY Date ORDER BY Date" -i:W3C -fileType:GIF -groupSize:800x600 -chartType:Area -categories:ON -values:ON -legend:OFF -config:"%OneDrive%\WebScripts\\HitsByDay.js"
:: COM Interface:
Option Explicit

Dim objLogQuery, strSQL
Dim objInputW3CFormat, objOutputChartFormat

Set objLogQuery = WScript.CreateObject("MSUtil.LogQuery")
Set objInputW3CFormat = WScript.CreateObject("MSUtil.LogQuery.W3CInputFormat")
Set objOutputChartFormat = WScript.CreateObject("MSUtil.LogQuery.ChartOutputFormat")

strSQL = "SELECT Date, COUNT(*) AS Hits " & _
    " INTO HitsByDay.gif " & _
    " FROM *.log " & _
    " GROUP BY Date " & _
    " ORDER BY Date"

objOutputChartFormat.groupSize = "800x600"
objOutputChartFormat.fileType = "GIF"
objOutputChartFormat.chartType = "Area"
objOutputChartFormat.categories = "ON"
objOutputChartFormat.values = "ON"
objOutputChartFormat.legend = "OFF"
objOutputChartFormat.config = "HitsByDay.js"

objLogQuery.ExecuteBatch strSQL, objInputW3CFormat, objOutputChartFormat;
Error executing script "%OneDrive%\WebScripts\HitsByDay.js": Error executing script at line 1: Expected ';'
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Refer to:
LogParser -i:NCSA -o:CHART -groupSize:1024x768 -view:ON -chartType:Column3D -legend:ON -categories:ON -values:ON -view:ON -chartTitle:"Status Code Count" -recurse:-1 "SELECT StatusCode, COUNT(*) INTO %odl%\StatusCount.gif FROM '%IISLogs%\*.log' GROUP BY StatusCode ORDER BY StatusCode"
LogParser -i:NCSA -o:CHART -groupSize:1024x768 -view:ON -chartType:Column3D -legend:ON -categories:ON -values:ON -view:ON -chartTitle:"User Agent Type" -recurse:-1 "SELECT User-Agent, COUNT(*) As UserAgent INTO %odl%\UserAgentType.gif FROM '%IISLogs%\*.log' GROUP BY User-Agent"
LogParser -i:NCSA -o:CHART -groupSize:1024x768 -view:ON -chartType:Column3D -legend:ON -categories:ON -values:ON -view:ON -chartTitle:"Hits by IP with 404 Status" -recurse:-1 "SELECT DISTINCT RemoteHostName AS Client, COUNT(*) as Hits INTO %odl%\HitsbyIPwith404Status.gif FROM '%IISLogs%\*.log' WHERE StatusCode IN (404) GROUP BY RemoteHostName, Client ORDER BY RemoteHostName, Hits DESC"

LogParser -o:CHART -chartType:Column3D -legend:ON -categories:ON -values:ON -view:ON -chartTitle:"Host Logon Failure" "SELECT TO_LOWERCASE(EXTRACT_TOKEN(Strings,11,'|')) AS SourceAddress, COUNT(EventID) AS TotalLogonFailures INTO %odl%\HostLogonFailure.gif FROM Security WHERE (EventID IN (529; 530; 531; 532; 533; 534; 535; 539)) AND (SourceAddress IS NOT NULL) GROUP BY SourceAddress ORDER BY TotalLogonFailures ASC"

LogParser -o:CHART -chartType:Column3D -legend:ON -categories:ON -values:ON -view:ON -chartTitle:"Host Logon Success" "SELECT TO_LOWERCASE(EXTRACT_TOKEN(Strings,13,'|')) AS SourceAddress, COUNT(EventID) AS TotalLogonSuccess INTO %odl%\SuccessLogon.gif FROM Security WHERE (EventID IN (528; 538; 540; 551; 552)) AND (IPV4_TO_INT(SourceAddress) BETWEEN IPV4_TO_INT('192.168.100.0') AND IPV4_TO_INT('192.168.100.255')) GROUP BY SourceAddress ORDER BY TotalLogonSuccess ASC"
:: Search for Recently Modified and Created Files
LogParser -i:FS "SELECT TOP 20 Path, HASHMD5_FILE(Path), LastWriteTime, CreationTime, LastAccessTime INTO DATAGRID FROM %OneDrive%\*.* WHERE (HASHMD5_FILE(Path) IS NOT NULL) ORDER BY LastWriteTime DESC"
:: Download AWStats: https://awstats.sourceforge.io/#DOWNLOAD
:: Needs Pearl installed...
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
NOTE: Below needs some work for Examples... LogParser -rtp:-1 -o:datagrid -h EXAMPLES
echo ##  LogParser Examples ##&LogParser -rtp:-1 -o:datagrid -i:TEXTLINE -q:On -recurse "SELECT Text FROM %OneDrive%\AboutMe_LogParser.txt WHERE Text LIKE '%chart%'"
echo ##  LogParser Examples ##&LogParser -rtp:-1 -o:datagrid -i:TEXTLINE -q:On -recurse "SELECT Text FROM %OneDrive%\AboutMe_LogParser.txt WHERE Text LIKE '%LogParser %'"
echo ##  LogParser Examples ##&LogParser -rtp:-1 -o:datagrid -i:TEXTLINE -q:On -recurse "SELECT Text FROM %OneDrive%\AboutMe_LogParser.txt WHERE Text LIKE '%Application%'"
echo ##  LogParser Examples ##&LogParser -rtp:-1 -o:datagrid -i:TEXTLINE -q:On -recurse "SELECT Text FROM %OneDrive%\AboutMe_LogParser.txt WHERE Text LIKE '%Security%'"
echo ##  LogParser Examples ##&LogParser -rtp:-1 -o:datagrid -i:TEXTLINE -q:On -recurse "SELECT Text FROM %OneDrive%\AboutMe_LogParser.txt WHERE Text LIKE '%System%'"
echo ##  LogParser Examples ##&LogParser -rtp:-1 -o:datagrid -i:TEXTLINE -q:On -recurse "SELECT Text FROM %OneDrive%\AboutMe_LogParser.txt WHERE Text LIKE '%%iis%'"
%windir%\System32\cmd.exe /F:on /k doskey /macrofile=%OneDrive%\Batch\macros.doskey&Title CONSOLE
:: Debugger (The Bugger)
:: You can SET alias to perform your development activities LIKE building, opening your favorite IDE or debugger.
:: To open your project using appropriate version of Visual Studio:
::     C:\>Doskey worksln="C:\Program Files (x86)\Microsoft Visual Studio\2019\Common7\IDE\devenv.exe" C:\git\work\somedir\work.sln
:: To trigger build command:
::  C:\>Doskey buildall=pushd C:\git\work&buildir\build.cmd x64 checked&popd
:: To configure windbg with favorite settings:
::  C:\>Doskey dbg=C:\debuggers\windbg.exe -o -y C:\git\work\bin\symboldirPDB -srcpath C:\git\work $*
::  C:\>dbg work.exe hello world
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: NO If you want a persistent change, you can add the desired DOSKEY command to your Command Prompt's AutoRun registry key. Below is an example only..
:: NO REG ADD "HKCU\Software\Microsoft\Command Processor" /V "AutoRun" /d "doskey ..... = \"C:\Program Files\.....exe\" $*"
:: NO LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime From '\HKCU\Software\Microsoft\Command Processor' ORDER BY Path"
:: NO LogParser -i:REG -stats:On -rtp:-1 -o:datagrid -recurse:-1 -E:-1 "SELECT Path,KeyName,ValueName,ValueType,Value,LastWriteTime From '\HKCU\Software\Microsoft' WHERE  KeyName Like '%AutoRun%' OR ValueName Like '%AutoRun%' ORDER BY Path"
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
All pages hit by a Specific IP address:
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs-uri-stem, count(cs-uri-stem) as requestcount FROM '%IISLogs%\*.log' where c-ip = '000.00.00.000' group by cs-uri-stem ORDER BY count(cs-uri-stem) desc"
Hits on a Specific page by a Specific IP address:
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT c-ip, count(c-ip) as requestcount FROM '%IISLogs%\*.log' where cs-uri-stem like '/search.aspx%' group by c-ip ORDER BY count(c-ip) desc"
Hits per hour generated by a Specific IP address:
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date, time), 3600)), count(*) as numberrequests FROM '%IISLogs%\*.log' where c-ip='000.000.00.000' group by TO_LOCALTIME(QUANTIZE(TO_TIMESTAMP(date,time), 3600))"
Pages being hit and the Specific IP addresses doing it:
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs-uri-stem, c-ip, count(cs-uri-stem) FROM '%IISLogs%\*.log' where cs-uri-stem like '%aspx%' or cs-uri-stem like '%ashx%' group by cs-uri-stem, c-ip ORDER BY count(cs-uri-stem) desc"
IP addresses driving traffic:
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT cs-uri-stem, c-ip, count(cs-uri-stem) FROM '%IISLogs%\*.log' where cs-uri-stem like '%aspx%' or cs-uri-stem like '%ashx%' group by cs-uri-stem, c-ip ORDER BY count(cs-uri-stem) desc"
Top 25 URLs:
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TOP 25 cs-uri-stem as Url, COUNT(*) As Hits FROM '%IISLogs%\*.log' GROUP BY cs-uri-stem ORDER BY Hits DESC"
Number of requests made by a Specific user:
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TOP 25 cs-username As User, COUNT(*) as Hits FROM '%IISLogs%\*.log' WHERE User Is Not Null GROUP BY User"
Top 25 types of Files: -groupSize:640x480 -groupSize:1024x768    Unexpected internal error calling chart object method ExportPicture:
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT TOP 25 EXTRACT_EXTENSION(cs-uri-stem) As Extension, COUNT(*) As Hits FROM '%IISLogs%\*.log' GROUP BY Extension ORDER BY Hits DESC"
LogParser -i:W3C -o:CHART -groupSize:640x480 -chartType:Bar3D -ChartTitle:"FileTypes" -values:ON -view:on -E:-1 "SELECT TOP 25 EXTRACT_EXTENSION(cs-uri-stem) As Extension, COUNT(*) As Hits INTO '%ohtm%\%ComputerName%_FileTypes.gif' FROM '%IISLogs%\*.log' GROUP BY Extension ORDER BY Hits DESC"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: Windows keeps a cache of recently used DNS (Domain Name System) names.View the cache with the following command:
ipconfig /displaydns | FindStr /I /C:".com" --   ipconfig /displaydns>%ohtm%\%ComputerName%_DisplayDNS.txt
ipconfig /displaydns | LogParser -i:TEXTLINE -stats:on -q:off -rtp:-1 -o:datagrid -E:-1 "SELECT DISTINCT SUBSTR(text,ADD(INDEX_OF(text,':'),2)) AS [DNS Name] FROM stdin WHERE text like '%record name%' ORDER BY [DNS Name]"
::                             SUBSTR( string <STRING>, START <INTEGER> [ , length <INTEGER> ])
:: Breakdown Command: DISTINCT SUBSTR(text,ADD(INDEX_OF(text,':'),2))
                                 |          |    |                +---
                                 |          |    +-------------------- Look for value ':' in Text
                                 |          +-------------------------
                                 +------------------------------------
Examples using INDEX_OF
SUBSTR(LogData3, INDEX_OF(LogData3, 'foo'), 5) as KeeperFlag
INDEX_OF(Message, ' For more information, ') AS Exclude,
SUBSTR(CutHere, 0, INDEX_OF(CutHere, 'End: ')) AS part1,
SUBSTR(myMessage, ADD(INDEX_OF(myMessage, '"'),1),
TO_STRING(index_of(Parameters, '%40')) AS URLEnCodedAt,
ADD(INDEX_OF(myData, LocAddr),
STRLEN(LocAddr)))), 0, ' ') AS ForgnAddr,
EXTRACT_PREFIX(EXTRACT_SUFFIX(Filename, 0, '\\'), 0, '.'),'yyyyMMdd')
:: Using Dos Command with Logparser to display outout
Dir /S C:\$Data>%ohtm%\%ComputerName%_Dir.txt&LogParser -i:TEXTLINE -stats:on -q:off -rtp:-1 -o:datagrid "SELECT TOP 50 myText USING INDEX_OF(Text, '<DIR>') AS GetDir, CASE GetDir WHEN NULL THEN Text ELSE NULL END AS myText FROM '%ohtm%\%ComputerName%_Dir.txt' WHERE myText IS NOT NULL"
NotePad++  %ohtm%\%ComputerName%_Dir.txt
LogParser -i:tsv -linefilter:-0 -o:datagrid "SELECT * from '%ohtm%\%ComputerName%_Dir.txt'"
:: Above Error: Input format: TSV (TSV Format) Parses text Files containing tab- or space- separated values -linefilter:+0
REPLACE_CHR(EXTRACT_VALUE(Text, 'error'),'"','') AS Error,
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
LogParser"SELECT title INTO channels.txt FROM 'https://learn.microsoft.com/en-us/graph/'" -i:XML -fMode:Tree -o:TPL -TPL:mytemplate.tpl
https://graph.microsoft.com
https://learn.microsoft.com/en-us/graph/
https://learn.microsoft.com/en-us/graph/overview
Operation	                                URL
GET my profile	                            https://graph.microsoft.com/v1.0/me
GET my Files	                            https://graph.microsoft.com/v1.0/me/drive/root/children
GET my photo	                            https://graph.microsoft.com/v1.0/me/photo/$value
GET my mail	                                https://graph.microsoft.com/v1.0/me/messages
GET my high importance email	            https://graph.microsoft.com/v1.0/me/messages?$filter=importance%20eq%20'high'
GET my calendar events	                    https://graph.microsoft.com/v1.0/me/events
GET my manager	                            https://graph.microsoft.com/v1.0/me/manager
GET last user to modify file foo.txt	    https://graph.microsoft.com/v1.0/me/drive/root/children/foo.txt/lastModifiedByUser
GET Microsoft 365 groups I'm a member of	https://graph.microsoft.com/v1.0/me/memberOf/$/microsoft.graph.group?$filter=groupTypes/any(a:a%20eq%20'unified')
GET users in my organization	            https://graph.microsoft.com/v1.0/users
GET groups in my organization	            https://graph.microsoft.com/v1.0/groups
GET people related to me	                https://graph.microsoft.com/v1.0/me/people
GET items trending around me	            https://graph.microsoft.com/beta/me/insights/trending
GET my notes	                            https://graph.microsoft.com/v1.0/me/onenote/notebooks
https://developer.microsoft.com/en-us/graph/graph-explorer?request=me&method=GET&version=v1.0&GraphUrl=https://graph.microsoft.com
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
# Get all event logs
$eventLogs = Get-WinEvent -ListProvider * -ErrorAction SilentlyContinue | Select-Object Name, ID, Description | Format-Table -Property Name, ID, Description
:: Below powershell lists all Event Log information to csv - NOTE: Takes time to complete...
$searchTerm = "Microsoft"
$eventLogs = Get-WinEvent -ListLog *
$outputFile = "$ENV:logs\$ENV:computername-search_results.csv"
$data = @()

foreach ($log in $eventLogs) {
    try {
        $results = Get-WinEvent -LogName $log.LogName -ErrorAction SilentlyContinue | Where-Object { $_.Message -like "*$searchTerm*" }
        if ($results) {
            foreach ($event in $results) {
                $data += [PSCustomObject]@{
                    LogName      = $log.LogName
                    TimeCreated  = $event.TimeCreated
                    ProviderName = $event.ProviderName
                    EventID      = $event.Id
                    Message      = $event.Message
                }
            }
        }
    } catch {
        Write-Output "Error processing $($log.LogName)"
    }
}

# Export to CSV
$data | Export-Csv -Path $outputFile -NoTypeInformation

DIR /S /B "%odl%\%ComputerName%-search_results.csv"

logparser "SELECT * FROM * WHERE Message LIKE '%Microsoft%'" -i:EVT -o:CSV -q:ON > "%odl%\%ComputerName%_results.csv"
:: logparser "SELECT * FROM System WHERE Message LIKE '%Microsoft%'" -i:EVT -o:CSV -q:ON > "%odl%\%ComputerName%_System_results.csv"
:: logparser "SELECT * FROM Application WHERE Message LIKE '%Microsoft%'" -i:EVT -o:CSV -q:ON > "%odl%\%ComputerName%_Application_results.csv"
:: logparser "SELECT * FROM Security WHERE Message LIKE '%Microsoft%'" -i:EVT -o:CSV -q:ON > "%odl%\%ComputerName%_Security_results.csv"

::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

Set Root=D:\Garmin-32Gb-Before-Backup\Map
Set Fil=City Navigator North America NT 2024.1 2.img
SET Select=%Root%\%Fil% & echo Processing file: %Select%
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT TOP 5 Index, Text FROM '%Select%' WHERE Text Like '%garmin%'"

Set Root=C:\$Data\OneDrive\Logs
Set Fil=SURF5_GeoTagMetaData.xmp
SET Select=%Root%\%Fil% & echo Processing file: %Select%
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT EXTRACT_TOKEN(Text, 0, '<>') FROM '%Select%'"
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT Index, SUBSTR(Text, 4, 25) AS Exif from '%Select%' WHERE Text LIKE '%exif:%'"

LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid "SELECT DISTINCT SUBSTR(EXTRACT_TOKEN(Text, 4, 'exif:('),0,INDEX_OF(EXTRACT_TOKEN(Text,4, 'exif:(' ),')')) AS Exif from '%Select%' WHERE Text LIKE '%exif:%'"

LogParser -i:EVT -rtp:-1 -o:datagrid "SELECT STRCAT( SUBSTR( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1), INDEX_OF( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1)),'|')),0, INDEX_OF( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1), INDEX_OF( SUBSTR( Strings, ADD(INDEX_OF(Strings,'|'),1)),'|')),'.')), STRCAT( '\\', SUBSTR( Strings,0, INDEX_OF(Strings,'|')))) AS User, COUNT(*) AS Total FROM Security WHERE EventType = 16 AND EventCategory = 2 GROUP BY User ORDER BY Total DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT SUBSTR(Message, 0, INDEX_OF(Message, ':')) AS Description FROM security"
LogParser"SELECT ValueType, COUNT(*) INTO DATAGRID FROM \HKLM GROUP BY ValueType"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
---Ch11Intervals.sql---
:: The MOD function returns the leftover parts or remainder of a division equation.The dividend of the MOD function must be an even multiple of the value used in the QUANTIZE function. In this way the WHERE clause will only keep records where the QUANTIZE value and the dividend are both factors of myTime. 900 is divisible 3 times by 300, so the MOD function in the WHERE clause keeps every third 300 second interval.The casual translation of this query is,"Produce 5 minutes of records from the Security log every fifteen minutes"
LogParser -i:EVT -rtp:-1 -o:datagrid "SELECT DISTINCT TimeGenerated USING TO_INT(QUANTIZE(TimeGenerated, 300)) as myTime FROM security WHERE MOD(myTime, 900) = 0"
---Ch11TimeRange.sql--- Handling Complex Data • Chapter 11 343
:: The security event log will usually have many entries and, often, interest in that log is time–sensitive, so it makes a good example. Log Parser has a specific statement to make querying with ranges of data very simple.The BETWEEN statement allows the WHERE clause: expressionA BETWEEN expressionB AND expressionC Expression can be a field, alias, function, or constant. Writing this with relational operators has the same results in the output, but would require more typing and increase the chance of errors.
LogParser -i:EVT -rtp:-1 -o:datagrid "SELECT TimeGenerated FROM security WHERE TO_TIME(TimeGenerated) BETWEEN TIMESTAMP('01/01 00:00:00', 'MM/dd hh:mm:ss') AND TIMESTAMP('01/01 01:00:00', 'MM/dd hh:mm:ss') OR TO_TIME(TimeGenerated) BETWEEN TIMESTAMP('01/01 03:07:00', 'MM/dd hh:mm:ss') AND TIMESTAMP('01/01 03:08:00', 'MM/dd hh:mm:ss')"
:: The equivalent query using relational operators requires more parentheses to keep the grouping together and a little more typing.
LogParser -i:EVT -rtp:-1 -o:datagrid "SELECT TimeGenerated FROM security WHERE (TO_TIME(TimeGenerated) >= TIMESTAMP('01/01 00:00:00', 'MM/dd hh:mm:ss') AND TO_TIME(TimeGenerated) <= TIMESTAMP('01/01 01:00:00', 'MM/dd hh:mm:ss')) OR (TO_TIME(TimeGenerated) >= TIMESTAMP('01/01 03:07:00', 'MM/dd hh:mm:ss') AND TO_TIME(TimeGenerated) <= TIMESTAMP('01/01 03:08:00', 'MM/dd hh:mm:ss'))"
---Ch11TimeRange.sql---
344 Chapter 11 • Handling Complex Data Time -- this one maintains the original timestamp for the record IIS
-- This first field serves as a file name for the INTO clause
-- multiplexing the output to a new file every hour
echo %Date% !Time! [MSG] 344 Chapter 11 • Handling Complex Data Time&&LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:On -stats:On -Recurse:-1 -E:-1 "SELECT TO_STRING(QUANTIZE(TO_TIMESTAMP(date,time), 3600), 'yyyyMMdd-hh') AS Stamp FROM '%IISLogs%\*.log'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
---Ch11NetStat.sql---
echo %Date% !Time! [MSG] Handling Complex Data • Chapter 11 347
netstat -a -o -n | LogParser -i:tsv -nSkipLines:4 -headerrow:off -o:datagrid file:"%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 11\Ch11NetStat.sql"
netstat -a -o -n | LogParser -i:tsv -nSkipLines:4 -headerrow:off -o:datagrid file:"%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 11\Ch11NetStatP349.sql"
:: This is piped directly to Log Parser so there is no input file, but in order for the –nSkipLines parameter to be available, the CSV input format is used and the lack of headers is also specified with -headerrow:off. Once Log Parser starts to receive the data via STDIN this query begins the process of cleaning things up.
SELECT TRIM(EXTRACT_TOKEN(myData, 0, ' ')) AS Proto, EXTRACT_TOKEN(TRIM(SUBSTR(myData, STRLEN(Proto))), 0, ' ') AS LocAddr, EXTRACT_TOKEN(TRIM(SUBSTR(myData, ADD(INDEX_OF(myData, LocAddr), STRLEN(LocAddr)))), 0, ' ') AS ForgnAddr, EXTRACT_TOKEN(TRIM(SUBSTR(myData, ADD(INDEX_OF(myData, ForgnAddr), STRLEN(ForgnAddr)))), 0, ' ') AS State, TO_INT(EXTRACT_TOKEN(TRIM(SUBSTR(myData, ADD(index_of(myData, State), STRLEN(State)))), 0, ' ')) as PID USING REPLACE_STR(Field1, '*:* ', '*:* NULL') AS myData FROM STDIN
---Ch11NetStat.sql---
NetStat -a -o -n | LogParser -i:TSV -rtp:-1 -iSeparator:space -nSep:2 -fixedSep:OFF -nSkipLines:2-o:datagrid "SELECT '10.10.10.0' FROM STDIN WHERE State = 'LISTENING'"
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
:: www.syngress.com - 36 Chapter 1 • Introducing Log Parser Continued
:: The first stage is a single query that uses the IISW3C input format with the checkpoint feature to parse only new IIS log file entries, returning aggregated data that we save to a temporary CSV file. This first-stage query calculates the total number of requests per hour, URL, and HTTP status code:
---Ch01WebStatsQuery1.sql--- file:Ch01WebStatsQuery1.sql
LogParser –i:IISW3C –iCheckPoint:"%odl%\%ComputerName%_WebStats.lpc" –o:CSV –headers:OFF "SELECT QUANTIZE(TO_TIMESTAMP(date, time), 3600) AS Hour, cs-uri-stem, sc-status, COUNT(*) AS Hits INTO '%ohtm%\%ComputerName%_WebStats.csv' FROM '%IISLogs%\*.log' GROUP BY Hour, cs-uri-stem, sc-status"
---Ch01WebStatsQuery1.sql---
NotePad++ %odl%\%ComputerName%_WebStats.lpc
NotePad++ %odl%\%ComputerName%_WebStats.csv
---Ch01WebStatsMerge.sql---
:: THEN we need to merge the temporary CSV file with the previous '%odl%\%ComputerName%_WebStatsDataBase.csv' CSV file containing the data we have extracted so far from all the log Files. This can be accomplished by a simple query that uses the CSV input format to parse both the temporary CSV file and the database CSV file, merges the entries, and generates a third "updated database" CSV file:
:: This query is executed as follows:
LogParser.exe –i:CSV –headerRow:OFF –o:CSV –headers:OFF "SELECT Field1, Field2, Field3, SUM(Field4) INTO '%ohtm%\%ComputerName%_WebStatsUpdateDB.csv' FROM '%odl%\%ComputerName%_WebStats.csv' GROUP BY Field1, Field2, Field3"
---Ch01WebStatsMerge.sql---
:: www.syngress.com -Introducing Log Parser • Chapter 1 37 Continued
:: In the final step of the first stage, we replace the "old" database CSV file with the new updated database CSV file, using the following shell commands:
copy /Y "%odl%\%ComputerName%_WebStatsUpdateDB.csv" "%odl%\%ComputerName%_WebStatsDataBase.csv"
del "%odl%\%ComputerName%_WebStatsTemp1.csv"
del "%odl%\%ComputerName%_WebStatsUpdateDB.csv"
:: In the second stage, we can query the '%odl%\%ComputerName%_WebStatsDataBase.csv' file multiple times with different queries to generate the charts we are interested in. Our first query extracts the top 10 requested URLs from the '%odl%\%ComputerName%_WebStatsDataBase.csv' file:
:: LogParser -i:xxx -view:ON -o:CHART -groupSize:1024x768 -chartType:??? -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% LogParser Chart Examples" "
LogParser -i:CSV -headerRow:OFF -o:CHART -chartType:Bar3D -view:ON -groupSize:1024x768 "SELECT
IF NOT EXIST %ohtm% (MkDir C:\$Data\OneDrive\HTML-Out)
Dir /S %ohtm%
---Ch01WebStatsTop10Requests.sql---file:"%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 01\Ch01WebStatsTop10Requests.sql"
LogParser -i:CSV -headerRow:OFF -view:ON -groupSize:1024x768 -o:CHART -chartType:Bar3D "SELECT TOP 10 Field2 AS URL, SUM(Field4) AS Hits INTO '%ohtm%\Top10Urls.gif' FROM '%odl%\%ComputerName%_WebStatsDataBase.csv' GROUP BY URL ORDER BY Hits DESC"
LogParser -i:CSV -headerRow:OFF -rtp:-1 -o:datagrid "SELECT TOP 20 Field2 AS URL, SUM(Field4) AS Hits FROM '%odl%\%ComputerName%_WebStatsDataBase.csv' GROUP BY URL ORDER BY Hits DESC"
:: Task completed with errors. Unexpected internal error calling chart object method ExportPicture:   Exception occurred.
:: Reinstalled owc11 and MSChart
LogParser -i:CSV -headerRow:OFF -view:ON -o:CHART -groupSize:1024x768 -chartType:Bar3D -legend:AUTO -values:AUTO -categories:AUTO -chartTitle:"%Date:~-4%%Date:~-10,2%%Date:~-7,2% %ComputerName% Ch01WebStatsTop10Requests"
LogParser -i:CSV -headerRow:OFF -view:ON -o:CHART -chartType:Bar3D "SELECT TOP 10 Field2 AS URL, SUM(Field4) AS Hits INTO '%ohtm%\%ComputerName%_Top10Urls.html' FROM '%odl%\%ComputerName%_WebStatsDataBase.csv' GROUP BY URL ORDER BY Hits DESC"

---Ch01WebStatsTop10Requests.sql---
:: Our second query extracts the hourly distribution of hits:
---Ch01WebStatsHitsPerHour.sql---
"SELECT TO_STRING(Field1, 'hh') AS Hour, SUM(Field4) AS Hits INTO "%ohtm%\%ComputerName%_HourlyHits.gif" FROM '%odl%\%ComputerName%_WebStatsDataBase.csv' GROUP BY Hour ORDER BY Hour ASC"
---Ch01WebStatsHitsPerHour.sql---
:: Our third query extracts the status code distribution:
---Ch01WebStatsStatusCodes.sql---
"SELECT Field3 AS Status, SUM(Field4) AS Hits INTO "%ohtm%\%ComputerName%_StatusCodes.gif" FROM '%odl%\%ComputerName%_WebStatsDataBase.csv' GROUP BY Status ORDER BY Hits DESC"
---Ch01WebStatsStatusCodes.sql---
:: www.syngress.com - 38 Chapter 1 • Introducing Log Parser - Continued
:: Putting it all together, our Web statistics system is implemented by the following batch file, which can be scheduled to run at 10-minute intervals:
REM -----------------------------------------------------------------------------------------------
REM First stage
REM
REM
REM Parse the latest log file entries and write aggregated data
REM into the "%odl%\%ComputerName%_WebStatsTemp1.csv" temporary CSV file
REM
LogParser.exe file:Ch01WebStatsQuery1.sql -i:IISW3C -iCheckPoint:"%odl%\%ComputerName%_WebStats.lpc" -o:CSV -headers:OFF
REM
REM If it's the first time we parse the log Files, then the temporary
REM CSV file is our database CSV file; otherwise, we need to merge the
REM temporary file with the database file
REM
IF EXIST "%odl%\%ComputerName%_WebStatsDataBase.csv" (
LogParser file:"%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 01\Ch01WebStatsMerge.sql" -i:CSV -headerRow:OFF -o:CSV-headers:OFF
copy /Y "%odl%\%ComputerName%_WebStatsDataBase.csv" "%odl%\%ComputerName%_WebStatsDataBase.csv"
del "%odl%\%ComputerName%_WebStatsTemp1.csv"
del "%odl%\%ComputerName%_WebStatsDataBase.csv"
) else (
ren "%odl%\%ComputerName%_WebStatsTemp1.csv" '%odl%\%ComputerName%_WebStatsDataBase.csv'
)
REM
REM Second stage
REM
REM
REM Generate the Top 10 requested URL's chart
REM
LogParser.exe file:"%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 01\Ch01WebStatsTop10Requests.sql" -i:CSV -headerRow:OFF-o:CHART -chartType:Bar3D
REM
REM Generate the Status Code distribution chart
REM
LogParser.exe file:"%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 01\Ch01WebStatsStatusCodes.sql" -i:CSV -headerRow:OFF -o:CHART -chartType:Pie
REM
REM Generate the Hourly Hits chart
REM
LogParser.exe file:"%OneDrive%\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 01\Ch01WebStatsHitsPerHour.sql" -i:CSV -headerRow:OFF -o:CHART -chartType:RadarLineFilled

::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
Using LogParser How do I locate data in a text file between two fields like < and > or " and " - (a needle in a haystack)
LogParser -i:TEXTLINE -q:On -stats:On -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT Text as DataFound FROM 'C:\$Data\OneDrive\Logs\BcLogTrace.txt' WHERE Text LIKE '%Unable to copy%'"
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
┌────────────────────────────────────────┐
│    Registring all .ocx files           │
└────────────────────────────────────────┘
::Note that the MSI package contains the following OCX files among many other files inside the archive:
FOR /D %i IN (
ComCt232.ocx
ComCt332.ocx
comctl32.ocx
ComDlg32.ocx
dbgrid32.ocx
dblist32.ocx
mci32.ocx
MSAdoDc.ocx
MSChrt20.ocx
mscomct2.ocx
mscomctl.ocx
MSComm32.ocx
MSDatGrd.ocx
MSDatLst.ocx
MSDatRep.ocx
MSFlxGrd.ocx
MShflxgd.ocx
MSINET.ocx
msmapi32.ocx
msmask32.ocx
msrdc20.ocx
MSWINSCK.ocx
PicClp32.ocx
richtx32.ocx
sysinfo.ocx
TabCtl32.ocx
wbclsdsr.ocx
) DO (
 echo %Date% !Time! [MSG] Processing: .ocx file: %i
 Start "Regsvr32" /D "%OneDrive%\" /High /WAIT /B regsvr32 C:\Windows\SysWOW64\%i
)
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
:: Append data to file...
SET log= &&echo %Date% !Time! [RC] SET log= %log%&&cmd /E:ON /V:ON /K "SET log="%ohtm%\%ComputerName%_LogParserHelp.txt"&&echo %Date% !Time! [RC] SET log= !log! RC=%ErrorLevel%"
echo Create LogParser Help File&LogParser -h >!log!&LogParser -h GRAMMAR >>!log!&LogParser -h FUNCTIONS >>!log!&LogParser -h EXAMPLES >>!log!&LogParser -h -c >>!log!&Notepad++ !log!
LogParser -i:CSV -rtp:-1 -o:datagrid -q:off "SELECT Field1 AS LPHelp FROM %log%"
LogParser -i:CSV -q:off -o:TPL -TPL:"%OneDrive%\LP-Templates\LP-LogParserHelp.tpl" "SELECT SUBSTR(Field1, 0, 150) AS LPHelp INTO '%ohtm%\%ComputerName%_LogParserHelp.html' FROM '%log%'"&START "LPHTML" /D /NORMAL /B Chrome.exe "%ohtm%\%ComputerName%_LogParserHelp.html"
:: FileName, RowNumber, Field1 AS LPHelp
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off -Recurse:-1 "SELECT * FROM '%IISLogs%\*.log' WHERE sc-status <> 200"
LogParser -i:IISW3C -rtp:-1 -o:datagrid -q:off "SELECT * FROM '%IISLogs%\*.log' WHERE sc-status <> 200"
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________
:: 148 Chapter 5 • Managing Snort Alerts - Gathering Snort Logs
:: Log Parser is a perfect match for Snort for managing intrusion detection logs.
:: Notepad++ "C:\$Data\OneDrive\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 05\Ch05-Commands.txt"
:: Notepad++ "C:\Program Files (x86)\Snort\etc\snort.conf"

# Output LogParser (Line 538)
output "C:\$Data\OneDrive\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 05\alert_csv": "C:\$Data\OneDrive\Log Parser 2.2\Microsoft Log Parser Toolkit\Chapter 05\alert.csv" default

To configure Snort to use the CSV output format, simply add the following line in the snort.conf file:
Notepad++ "C:\Program Files (x86)\Snort\etc\snort.conf"
output alert_csv: alert.csv default
This configures Snort to create a CSV log file named alert.csv in the configured logs directory using the default output fields. By default the CSV output processor includes these fields:
■ timestamp
■ sig_generator
■ sig_id
■ sig_rev
■ msg
■ proto
■ src
■ srcport
■ dst
■ dstport
■ ethsrc
■ ethdst
■ ethlen
■ tcpfags
■ tcpseq
■ tcpack
■ tcplen
■ tcpwindow
■ ttl
■ tos
■ id
■ dgmlen
■ iplen
■ icmptype
■ icmpcode
■ icmpid
■ icmpseq
Snort CSV logs do not include a header row, so we need a separate file to name each column. In the file download for this chapter, I have included the file AlertHeader.csv to use for this purpose.To read CSV Snort alerts, you would use a command like this:
LogParser file:alert.sql -i:CSV -headerRow:off -iHeaderFile:AlertHeader.csv -
iTsFormat:mm/dd/yy-hh:mm:ss
Note that we specify the CSV input format, but instead of using the header row, we specify a header file using the iHeaderFile option. We also specify the timestamp format so Log Parser can interpret that field as an actual time stamp rather than a string.
NOTE: All of the queries in this chapter use the year in the timestamp date, which Snort does not log by default. To configure Snort to log the year, use the –y option when starting Snort. If your timestamps do not include the year, the queries in this chapter will return the error, "Semantic Error: argument of function TO_TIME must be a TIMESTAMP."
::_______________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_______________________________________________________________________________________________________________________________

chkdsk D: /r /i /c /b
chkdsk D: /scan /perf /sdcleanup

Services
"C:\Windows\SysWOW64\NahimicSvc32.exe"     NahimicService
"C:\Windows\system32\NahimicService.exe"
To view all services (active and disabled):
sc queryex type=service state=all

To display only the names of services:
sc queryex type=service state=all | find /i "NahimicService"

To check the status of a specific service (replace DeviceInstall with the desired service name):
sc queryex DeviceInstall

LogParser -i:EVT -stats:On -q:Off -rtp:-1 -o:datagrid -E:-1 "SELECT EXTRACT_TOKEN(strings, 0, '|') as TimeS, COUNT(*) as Cntr, TimeGenerated AS EventTime, EventID FROM Application, Security, System WHERE EventID IN (4697;6008;4618;4649;4719) GROUP BY TimeS,EventTime,EventID ORDER BY EventTime DESC"
LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 "SELECT TimeGenerated AS EventTime, EventID, ComputerName, Message, Data FROM Application, Security, System WHERE EventID IN (4697;6008;4618;4649;4719) ORDER BY EventTime, EventID DESC"

:: EventLog, RecordNumber, TimeGenerated, TimeWritten, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, Strings, ComputerName, SID, Message, Data
:: EventLog,TimeGenerated,EventID,SourceName,EventType,EventCategory,SID,Message,Data
:: TimeGenerated, EventID, EventType, EventTypeName, EventCategory, EventCategoryName, SourceName, Strings, SID, Message

LogParser -i:EVT -stats:on -q:off -rtp:-1 -o:datagrid -resolveSIDs:ON -E:-1 ""SELECT TimeGenerated, SourceName, EventCategoryName, Message INTO report.txt FROM Security WHERE EventID = 528 AND SID LIKE '%BobM%'"
doskey /MACROS:ALL | LogParser -i:TSV -fixedSep:off -headerRow:Off -linefilter:-; -rtp:-1 -o:datagrid "SELECT EXTRACT_PREFIX(Field1, 0, '=') AS DKCmd, EXTRACT_SUFFIX(Field1,0,'&&') AS Command FROM STDIN ORDER BY DKCmd"

______________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│                │
└───────────────────────────────────────────────────┘
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│                │
└───────────────────────────────────────────────────┘
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│                │
└───────────────────────────────────────────────────┘
_________________________________________________________________________________________________________________________________
┌───────────────────────────────────────────────────┐
│                │
└───────────────────────────────────────────────────┘
_________________________________________________________________________________________________________________________________
:: +---------------------------------------------------------------------------+
:: |	           |
:: +---------------------------------------------------------------------------+
_________________________________________________________________________________________________________________________________


_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________


_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
_________________________________________________________________________________________________________________________________
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
::_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion


